{"version":3,"file":"spreadsheet.js","sources":["../sources/math/methods/helpers.js","../sources/views/date.js","../sources/locale.js","../sources/locales/en.js","../sources/views/align.js","../sources/views/border.js","../sources/views/color.js","../sources/views/dialog.js","../sources/views/form.js","../sources/views/formlate.js","../sources/views/icons.js","../sources/views/list_suggest.js","../sources/views/suggest_formula.js","../sources/operations/undo_group.js","../sources/operations/save.js","../sources/helpers/column_names.js","../sources/toolbar/defaults.js","../sources/operations/styles.js","../sources/operations/formats.js","../sources/math/parser.js","../sources/views/button.js","../sources/views/live_editor.js","../sources/views/separator.js","../sources/views/sheets.js","../sources/views/toggle.js","../sources/views/toolbar_title.js","../sources/views/multicheckbox.js","../sources/views/formlist.js","../sources/views/ui.js","../sources/views/series.js","../sources/editors/date.js","../sources/editors/richselect.js","../sources/toolbar/actions.js","../sources/toolbar/buttons.js","../sources/toolbar/all_elements.js","../sources/toolbar.js","../sources/toolbar/helpers.js","../sources/operations/column_operations.js","../sources/table.js","../sources/hotkeys.js","../sources/math/methods/numbers.js","../sources/math/methods/strings.js","../sources/math/methods/date.js","../sources/math/methods/other.js","../sources/math/methods.js","../sources/operations/types.js","../sources/editor.js","../sources/helpers/array.js","../sources/sheets.js","../sources/dialogs/common.js","../sources/math/writer.js","../sources/dialogs/imagecell.js","../sources/dialogs/imagetop.js","../sources/math/cache.js","../sources/math/updater.js","../sources/math/sheet.js","../sources/math/ranges.js","../sources/dialogs/sparkline.js","../sources/dialogs/ranges.js","../sources/dialogs/dropdown.js","../sources/operations/lock_cell.js","../sources/operations/spans.js","../sources/operations/filter.js","../sources/dialogs/filter.js","../sources/dialogs/format.js","../sources/dialogs/conditional.js","../sources/dialogs/export.js","../sources/dialogs/link.js","../sources/dialogs/print.js","../sources/dialogs/comments.js","../sources/dialogs/sizing.js","../sources/dialogs/index.js","../sources/operations/undo.js","../sources/operations/views.js","../sources/chart.js","../sources/operations/add_row_col.js","../sources/math/math.js","../sources/math/placeholder.js","../sources/operations/conditional_formats.js","../sources/operations/dropdown.js","../sources/operations/clipboard.js","../sources/operations/data.js","../sources/operations/hide_row_col.js","../sources/operations/resize.js","../sources/operations/selection.js","../sources/helpers/expand_selection.js","../sources/operations/sorting.js","../sources/operations/hide_gridlines.js","../sources/operations/hide_headers.js","../sources/operations/comments.js","../sources/operations/states.js","../sources/operations/import.js","../sources/operations/print.js","../sources/operations/export.js","../sources/operations/load.js","../sources/operations/clear_styles.js","../sources/api/row_col_operations.js","../sources/api/lock_cell.js","../sources/api/freeze.js","../sources/api/hide_gridlines.js","../sources/api/hide_headers.js","../sources/api/hide_rows.js","../sources/api/math.js","../sources/api/operations.js","../sources/api/core.js","../sources/api/save.js","../sources/api/dropdown.js","../sources/api/filter.js","../sources/api/confirm.js","../sources/api/undo.js","../sources/api/number_formats.js","../sources/menu.js","../sources/helpers/conditional.js","../sources/spreadsheet.js","../sources/context.js","../sources/operations/index.js","../sources/api/index.js"],"sourcesContent":["export function dayOfTheYear(date){\n\tconst start = new Date(date.getFullYear(), 0, 0);\n\tconst diff = (date - start) + ((start.getTimezoneOffset() - date.getTimezoneOffset()) * 60 * 1000);\n\treturn Math.floor(diff / (1000 * 60 * 60 * 24));\n}\n\nexport function getJsDateFromExcel(excelDate) {\n\tconst date = new Date(Math.round((excelDate - 25569) * 86400 * 1000));\n\treturn new Date(date.getTime() + date.getTimezoneOffset() * 60000);\n}\n\nexport function getExcelDateFromJs(jsDate) {\n\tconst returnDateTime = 25569 + ((jsDate.getTime() - (jsDate.getTimezoneOffset() * 60000)) / (86400 * 1000));\n\treturn returnDateTime.toString();\n}\n\nexport function _to_number(v){\n\tif(v || v === 0){\n\t\tv = v*1;\n\t\tif(!isNaN(v)) return v;\n\t}\n\treturn false;\n}\n\nexport function _combine(data){\n\tvar arr = [];\n\tfor (var i = 0; i < data.length; i++){\n\t\tarr = arr.concat(data[i]);\n\t}\n\treturn arr;\n}","import {getJsDateFromExcel, getExcelDateFromJs} from \"../math/methods/helpers\";\n\nfunction getJsDate(value){\n\tif ((value || value === 0) && !(value instanceof Date) && !isNaN(value)){\n\t\tvalue = getJsDateFromExcel(value);\n\t}\n\treturn value;\n}\n\nfunction getExcelDate(value){\n\tif (value && value instanceof Date){\n\t\tvalue = getExcelDateFromJs(value);\n\t}\n\treturn value;\n}\n\nwebix.protoUI({\n\t$cssName: \"datepicker\",\n\tname: \"ssheet-datepicker\",\n\tgetValue:function(){\n\t\tconst value = webix.ui.datepicker.prototype.getValue.apply(this);\n\t\treturn getExcelDate(value) || \"\";\n\t},\n\t$prepareValue:function(value){\n\t\tvalue = getJsDate(value);\n\t\treturn webix.ui.datepicker.prototype.$prepareValue.apply(this, [value]);\n\t}\n}, webix.ui.datepicker);\n\nwebix.protoUI({\n\t$cssName: \"daterangepicker\",\n\tname: \"ssheet-daterangepicker\",\n\tgetValue:function(){\n\t\tlet value = webix.ui.datepicker.prototype.getValue.apply(this);\n\t\tif (value){\n\t\t\tvalue = webix.copy(value);\n\t\t\tvalue.start = getExcelDate(value.start);\n\t\t\tvalue.end = getExcelDate(value.end);\n\t\t}\n\t\treturn value || \"\";\n\t},\n\t$prepareValue:function(value){\n\t\tif (!value){\n\t\t\tvalue = { start:null, end:null };\n\t\t}\n\t\telse if (!value.start && !value.end)\n\t\t\tvalue = { start:value };\n\n\t\tvalue.start = getJsDate(value.start);\n\t\tvalue.end = getJsDate(value.end);\n\n\t\treturn webix.ui.daterangepicker.prototype.$prepareValue.apply(this, [value]);\n\t}\n}, webix.ui.daterangepicker);","import en from \"./locales/en\";\nwebix.i18n.spreadsheet = en;","export default {\n\tlabels:{\n\t\t// formats\n\t\t\"common\": \"Common\",\n\t\t\"currency\": \"Currency\",\n\t\t\"number\": \"Number\",\n\t\t\"percent\": \"Percent\",\n\t\t\"date\": \"Date\",\n\t\t\"string\": \"Text\",\n\t\t\"custom-format\": \"Custom\",\n\t\t\"decimal-places\":\"Decimal places\",\n\t\t\"separator\":\"Group separator\",\n\t\t\"negative\":\"Negative number\",\n\t\t\"date-format\":\"Date format\",\n\t\t\"format-docs\":\"How to create a format\",\n\t\t// titles\n\t\t\"undo-redo\": \"Undo/Redo\",\n\t\t\"font\": \"Font\",\n\t\t\"text\": \"Text\",\n\t\t\"cell\": \"Cell\",\n\t\t\"align\": \"Align\",\n\t\t\"format\": \"Number\",\n\t\t\"column\": \"Column\",\n\t\t\"borders\": \"Borders\",\n\t\t\"px\": \"px\",\n\t\t\"apply\": \"Apply\",\n\t\t// popups and dialogs\n\t\t\"cancel\": \"Cancel\",\n\t\t\"save\": \"Save\",\n\t\t// multisheets\n\t\t\"sheet\": \"Sheet\",\n\t\t// conditions\n\t\t\"conditional-format\": \"Conditional Format\",\n\t\t\"condition\": \"Condition\",\n\t\t\"conditional-style\": \"Style\",\n\t\t\"conditional-operator\": \"Operator\",\n\t\t\"conditional-between\":\"between\",\n\t\t\"conditional-not-equal\":\"not equal\",\n\t\t// ranges\n\t\t\"range\": \"Range\",\n\t\t\"range-title\": \"Named ranges\",\n\t\t\"range-name\": \"Name\",\n\t\t\"range-cells\": \"Range\",\n\t\t// images\n\t\t\"image-or\": \"or\",\n\t\t\"image-title\": \"Add image\",\n\t\t\"image-upload\": \"Select file for upload\",\n\t\t\"image-url\": \"URL (e.g. http://*)\",\n\t\t// sparklines\n\t\t\"sparkline-title\": \"Add sparkline\",\n\t\t\"sparkline-type\": \"Type\",\n\t\t\"sparkline-range\": \"Range\",\n\t\t\"sparkline-color\": \"Color\",\n\t\t\"sparkline-positive\": \"Positive\",\n\t\t\"sparkline-negative\": \"Negative\",\n\t\t// custom format\n\t\t\"format-title\": \"Set format\",\n\t\t\"format-pattern\": \"Format pattern\",\n\t\t//dropdown\n\t\t\"dropdown-empty\": \"Empty cells\",\n\t\t\"dropdown-title\": \"Add dropdown\",\n\t\t\"dropdown-range\": \"Range\",\n\t\t// confirm\n\t\t\"ok\": \"OK\",\n\t\t// import/export\n\t\t\"import-title\": \"Import\",\n\t\t\"import-not-support\": \"Sorry, your browser does not support import\",\n\t\t\"export-title\": \"Export\",\n\t\t\"export-name\": \"Name of xslx file\",\n\t\t\"export-all-sheets\":\"Export all sheets\",\n\t\t// add link\n\t\t\"link-title\": \"Add Link\",\n\t\t\"link-name\": \"Text\",\n\t\t\"link-url\": \"URL\",\n\t\t//images\n\t\t\"image\": \"Image\",\n\t\t\"add-image-cell\":\"Add to cell\",\n\t\t\"add-image-top\":\"Add above cells\",\n\t\t//charts\n\t\t\"graph\": \"Graph\",\n\t\t\"add-sparkline\":\"Add to cell\",\n\t\t\"add-chart\":\"Add above cells\",\n\t\t//conditional format labels\n\t\t\"display\" : \"Display\",\n\t\t\"value\" : \"Value\",\n\t\t// confirm messages\n\t\t\"range-remove-confirm\": \"Are you sure you want to remove the range permanently?\",\n\t\t\"sheet-remove-confirm\": \"Are you sure you want to remove the sheet permanently?\",\n\t\t\"merge-cell-confirm\":\"Only the left top value will remain after merging. Continue?\",\n\t\t\"error-range\": \"The range is incorrect!\",\n\t\t//print\n\t\t\"print\":\"Print\",\n\t\t\"print-title\":\"Before you print..\",\n\t\t\"print-settings\":\"General settings\",\n\t\t\"print-paper\":\"Paper size\",\n\t\t\"print-layout\":\"Layout\",\n\t\t\"current-sheet\":\"Current sheet\",\n\t\t\"all-sheets\":\"All sheets\",\n\t\t\"selection\":\"Selected cells\",\n\t\t\"borderless\":\"Hide gridlines\",\n\t\t\"sheet-names\":\"Show sheet names\",\n\t\t\"skip-rows\":\"Skip empty rows\",\n\t\t\"margin\":\"Hide margins\",\n\t\t\"page-letter\":\"Letter\",\n\t\t\"page-a4\":\"A4 (210x297mm)\",\n\t\t\"page-a3\":\"A3 (297x420mm)\",\n\t\t\"page-width\":\"Page width\",\n\t\t\"page-actual\":\"Actual Size\",\n\t\t\"page-portrait\":\"Portrait\",\n\t\t\"page-landscape\":\"Landscape\",\n\t\t//comment\n\t\t\"comment\":\"Comment\",\n\t\t//resize\n\t\t\"width\":\"Width\",\n\t\t\"height\":\"Height\",\n\t\t\"fit-content\": \"Fit to content\",\n\t\t\"default-size\":\"Reset to default\",\n\t\t//views\n\t\t\"edit-view\":\"Edit\",\n\t\t\"remove-view\":\"Remove\",\n\t\t\"chart-edit\":\"Edit chart\",\n\n\t\t\"chart-common\":\"Common\",\n\t\t\"chart-series\":\"Series\",\n\t\t\"chart-extras\":\"Extras\",\n\n\t\t\"export-view\":\"Download\",\n\t\t\"export-view-pdf\":\"PDF document\",\n\t\t\"export-view-png\":\"PNG image\",\n\t\t\"export-view-excel\":\"Excel file\",\n\n\t\t\"line-chart\":\"Line\",\n\t\t\"area-chart\":\"Area\",\n\t\t\"bar-chart\":\"Bar\",\n\t\t\"donut-chart\":\"Donut\",\n\t\t\"pie-chart\":\"Pie\",\n\t\t\"radar-chart\":\"Radar\",\n\t\t\"spline-chart\":\"Spline\",\n\t\t\"splinearea-chart\":\"Spline Area\",\n\n\t\t\"chart-axis\":\"Axis\",\n\t\t\"chart-scale\":\"Lines\",\n\t\t\"chart-scale-color\":\"Scale color\",\n\t\t\"chart-xAxis-title\":\"X axis title\",\n\t\t\"chart-yAxis-title\":\"Y axis title\",\n\t\t\"chart-col-xAxis\":\"Use left column as xAxis\",\n\t\t\"chart-row-xAxis\":\"Use top row as xAxis\",\n\t\t\"chart-xAxis-range\":\"xAxis range\",\n\n\t\t\"chart-legend\":\"Legend\",\n\t\t\"chart-row-legend\":\"Use top row as legend\",\n\t\t\"chart-col-legend\":\"Use left column as legend\",\n\t\t\"chart-legend-range\":\"Legend range\",\n\t\t\"chart-legend-align\":\"Align\",\n\t\t\"chart-legend-left\":\"Left\",\n\t\t\"chart-legend-right\":\"Right\",\n\t\t\"chart-legend-center\":\"Center\",\n\t\t\"chart-legend-valign\":\"Vertical align\",\n\t\t\"chart-legend-top\":\"Top\",\n\t\t\"chart-legend-middle\":\"Middle\",\n\t\t\"chart-legend-bottom\":\"Bottom\",\n\n\t\t\"chart-item\":\"Data\",\n\t\t\"stacked-chart\":\"Stacked\",\n\t\t\"chart-range\":\"Range\",\n\t\t\"chart-series-color\":\"Color\",\n\t\t\"add-line\":\"Add line\",\n\t\t\"chart-type\":\"Type\",\n\t\t\"chart-tooltip\":\"Tooltips\",\n\n\t\t\"chart-data-from\":\"Data series from\",\n\t\t\"chart-columns\":\"columns\",\n\t\t\"chart-rows\":\"rows\",\n\n\t\t\"chart-markers\":\"Markers\",\n\t\t\"chart-markers-square\":\"Square\",\n\t\t\"chart-markers-triangle\":\"Triangle\",\n\t\t\"chart-markers-diamond\":\"Diamond\",\n\t\t\"chart-markers-round\":\"Round\",\n\n\t\t\"chart-pie-text\":\"Show values inside\",\n\t\t\"chart-pie-3d\":\"3D\",\n\n\t\t\"chart-radar-circle\":\"Circled lines\"\n\t},\n\ttooltips: {\n\t\t\"color\": \"Font color\",\n\t\t\"background\": \"Background color\",\n\t\t\"font-family\": \"Font family\",\n\t\t\"font-size\": \"Font size\",\n\t\t\"text-align\": \"Horizontal align\",\n\t\t\"vertical-align\": \"Vertical align\",\n\t\t\"borders\": \"Borders\",\n\t\t\"borders-no\": \"Clear borders\",\n\t\t\"borders-left\": \"Left border\",\n\t\t\"borders-top\": \"Top border\",\n\t\t\"borders-right\": \"Right border\",\n\t\t\"borders-bottom\": \"Bottom border\",\n\t\t\"borders-all\": \"All borders\",\n\t\t\"borders-outer\": \"Outer borders\",\n\t\t\"borders-top-bottom\": \"Top and bottom borders\",\n\t\t\"borders-color\": \"Border color\",\n\t\t\"align-left\": \"Left align\",\n\t\t\"align-center\": \"Center align\",\n\t\t\"align-right\": \"Right align\",\n\t\t\"align-top\": \"Top align\",\n\t\t\"align-middle\": \"Middle align\",\n\t\t\"align-bottom\": \"Bottom align\",\n\t\t\"span\": \"Merge\",\n\t\t\"wrap\": \"Text wrap\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"format\": \"Number format\",\n\t\t\"increase-decimals\":\"Increase decimal places\",\n\t\t\"decrease-decimals\":\"Decrease decimal places\",\n\t\t\"font-weight\": \"Bold\",\n\t\t\"font-style\": \"Italic\",\n\t\t\"text-decoration\": \"Underline\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"create-filter\": \"Create/remove filters\",\n\t\t\"freeze-columns\" : \"Freeze/unfreeze columns\",\n\t\t\"add-range\": \"Set name for the selected range\",\n\t\t\"conditional\": \"Conditional formatting\",\n\t\t\"add-sheet\": \"Add Sheet\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"clear\": \"Clear\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"row\": \"Rows\",\n\t\t\"column\": \"Columns\",\n\t\t\"sheet\": \"Sheet\",\n\t\t\"add-image\": \"Image\",\n\t\t\"add-sparkline\": \"Graph\",\n\t\t\"add-comment\": \"Comment\"\n\t},\n\tmenus:{\n\t\t\"remove-sheet\": \"Remove sheet\",\n\t\t\"rename-sheet\": \"Rename sheet\",\n\t\t\"file\": \"File\",\n\t\t\"new\": \"New\",\n\t\t\"new-sheet\": \"New sheet\",\n\t\t\"excel-import\": \"Import from Excel\",\n\t\t\"excel-export\": \"Export to Excel\",\n\t\t\"sheet\": \"Sheets\",\n\t\t\"copy-sheet\": \"Copy to new sheet\",\n\t\t\"edit\": \"Edit\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"columns\": \"Columns\",\n\t\t\"insert-column\": \"Insert column\",\n\t\t\"delete-column\": \"Delete column\",\n\t\t\"show-column\": \"Show column\",\n\t\t\"hide-column\": \"Hide column\",\n\t\t\"resize-column\": \"Resize column\",\n\t\t\"rows\": \"Rows\",\n\t\t\"insert-row\": \"Insert row\",\n\t\t\"delete-row\": \"Delete row\",\n\t\t\"show-row\": \"Show row\",\n\t\t\"hide-row\": \"Hide row\",\n\t\t\"resize-row\": \"Resize row\",\n\t\t\"insert\": \"Insert\",\n\t\t\"conditional-format\": \"Conditional format\",\n\t\t\"clear\": \"Clear\",\n\t\t\"clear-value\":\"Values\",\n\t\t\"clear-style\":\"Styles\",\n\t\t\"clear-conditional-formats\":\"Conditional formats\",\n\t\t\"clear-dropdown-editors\":\"Dropdowns and filters\",\n\t\t\"clear-comments\":\"Comments\",\n\t\t\"clear-all\":\"All\",\n\t\t\"image\": \"Image\",\n\t\t\"add-image-cell\":\"Add to cell\",\n\t\t\"add-image-top\":\"Add above cells\",\n\t\t\"graph\": \"Graph\",\n\t\t\"add-sparkline\":\"Add to cell\",\n\t\t\"add-chart\":\"Add above cells\",\n\t\t\"data\": \"Data\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"add-range\": \"Named ranges\",\n\t\t\"sort\": \"Sort\",\n\t\t\"sort-asc\": \"Sort A to Z\",\n\t\t\"sort-desc\": \"Sort Z to A\",\n\t\t\"view\": \"View\",\n\t\t\"freeze-columns\": \"Freeze/unfreeze columns\",\n\t\t\"freeze-rows\": \"Freeze/unfreeze rows\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"create-filter\": \"Create/remove filters\",\n\t\t\"add-dropdown\": \"Add dropdown\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"print\": \"Print\",\n\t\t\"add-comment\":\"Comment\"\n\t},\n\ttable:{\n\t\t\"math-error\":\"ERROR\",\n\t\t\"format-error\":\"INCORRECT FORMAT\"\n\t},\n\tliveEditor:{\n\t\t\"edit\":\"Edit:\"\n\t},\n\tformats:{\n\t\t\"dateFormat\": \"mm/dd/yyyy\",\n\t\t\"timeFormat\": \"hh:mm AM/PM\",\n\t\t\"longDateFormat\": \"dd mmmm yyyy\",\n\t\t\"fullDateFormat\": \"mm/dd/yyyy hh:mm AM/PM\",\n\t\t\"parseDateTime\": \"%m/%d/%Y %G:%i:%s\",\n\t\t\"parseDate\": \"%m/%d/%Y\"\n\t}\n};\n","webix.protoUI({\n\tname: \"ssheet-align\",\n\t$cssName:\"richselect\",\n\t$init: function(config){\n\t\tconfig.options =  {\n\t\t\tview:\"datasuggest\",\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-icons\",\n\t\t\t\ttooltip: {\n\t\t\t\t\ttemplate:\"#tooltip#\"\n\t\t\t\t},\n\t\t\t\txCount:3, yCount:1\n\t\t\t},\n\t\t\tdata: config.data\n\t\t};\n\t}\n},webix.ui.richselect);","webix.protoUI({\n\tname: \"ssheet-borders-suggest\",\n\tdefaults:{\n\t\twidth: 300\n\t},\n\t$init: function(config){\n\t\tconfig.body = {\n\t\t\tmargin: 6,\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-icons\", scroll: false, select: true,\n\t\t\t\t\txCount: 4,\n\t\t\t\t\tyCount: 2,\n\t\t\t\t\ttooltip: {\n\t\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\t\treturn webix.i18n.spreadsheet.tooltips[\"borders-\"+obj.id];\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonAfterSelect: function(){\n\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView();\n\t\t\t\t\t\t\tsuggest.updateMasterValue(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\tvar css = \"webix_ssheet_button_icon webix_ssheet_icon ssi-borders-\"+obj.value;\n\t\t\t\t\t\treturn \"<span class='\"+css+\"'></span>\";\n\t\t\t\t\t},\n\t\t\t\t\tdata: config.data\n\t\t\t\t},\n\t\t\t\t{ view: \"ssheet-separator\"},\n\t\t\t\t{\n\t\t\t\t\trows:[\n\t\t\t\t\t\t{ view: \"ssheet-color\", css: config.css, name: config.name, width: 68,\n\t\t\t\t\t\t\tvalue: webix.skin.$name == \"contrast\" ? \"#ffffff\" : \"#000000\",\n\t\t\t\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"borders-color\"],\n\t\t\t\t\t\t\ttitle: \"<span class='webix_icon wxi-pencil'></span>\",\n\t\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\t\tonChange: function(){\n\t\t\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView().getParentView();\n\t\t\t\t\t\t\t\t\tsuggest.updateMasterValue(false);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"richselect\", css:\"webix_ssheet_border_type\", value:\"thin\", suggest:{\n\t\t\t\t\t\t\t\tfitMaster:false,\n\t\t\t\t\t\t\t\twidth:130,\n\t\t\t\t\t\t\t\tcss: \"webix_ssheet_suggest\",\n\t\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\t\ttemplate:\"<div class='webix_ssheet_border webix_ssheet_border_#id#'></div>\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata:[\n\t\t\t\t\t\t\t\t\t{ id:\"thin\" },\n\t\t\t\t\t\t\t\t\t{ id:\"medium\" },\n\t\t\t\t\t\t\t\t\t{ id:\"thick\" },\n\t\t\t\t\t\t\t\t\t{ id:\"dashed\" }, \n\t\t\t\t\t\t\t\t\t{ id:\"dotted\" },\n\t\t\t\t\t\t\t\t\t{ id:\"double\" }\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ }\n\t\t\t\t\t]\n\t\t\t\t}\n\n\t\t\t]\n\t\t};\n\t},\n\tupdateMasterValue: function(hide){\n\t\tvar value = this.getValue();\n\t\tvar master = webix.$$(this.config.master);\n\t\tmaster.setValue(value);\n\t\tif(hide)\n\t\t\tthis.hide();\n\t},\n\tsetValue: function(value){\n\t\tif(value[0])\n\t\t\tthis.getList().select(value[0]);\n\t\tif(value[1])\n\t\t\tthis.getColorView().setValue(value[1]);\n\t\tif(value[2])\n\t\t\tthis.getTypeView().setValue(value[2]);\n\t},\n\tgetValue: function(){\n\t\treturn [this.getList().getSelectedId(), this.getColorView().getValue()||\"\", this.getTypeView().getValue()||\"\"];\n\t},\n\tgetList: function(){\n\t\treturn this.getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getBody().getChildViews()[2].getChildViews()[0];\n\t},\n\tgetTypeView: function(){\n\t\treturn this.getBody().getChildViews()[2].getChildViews()[1];\n\t},\n\tgetItemText:function(){\n\t\treturn \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-borders-all'>\";\n\t}\n},webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-borders\",\n\t$cssName: \"richselect\",\n\t$init: function(config){\n\t\tconfig.options = {\n\t\t\tview: \"ssheet-borders-suggest\",\n\t\t\tfitMaster: false,\n\t\t\tdata: config.data\n\t\t};\n\n\t\tthis.$ready.push(webix.bind(function(){\n\t\t\tthis.getPopup().config.master = this.config.id;\n\t\t},this));\n\n\t},\n\tsetValue: function(value){\n\t\tif(webix.isArray(value)){\n\t\t\tif(!this.config.value || value[0] !=  this.config.value[0] || value[1] !=  this.config.value[1]){\n\t\t\t\tthis.getPopup().setValue(value);\n\t\t\t}\n\t\t\tthis.config.value = value;\n\t\t\tif (value[0])\n\t\t\t\tthis.callEvent(\"onChange\");\n\t\t}\n\t\treturn value;\n\t},\n\tgetValue: function(){\n\t\treturn  this.getPopup().getValue().join(\",\");\n\t},\n\tgetList: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[1].getChildViews()[0];\n\t}\n},webix.ui.richselect);","// toolbar: color selector\nwebix.protoUI({\n\t$cssName: \"colorboard\",\n\tname: \"ssheet-colorboard\",\n\tdefaults:{\n\t\theight:202,\n\t\twidth:220,\n\t\tcss: \"webix_ssheet_colorboard\",\n\t\ttype:\"classic\",\n\t\tpalette: [\n\t\t\t[\"#000000\", \"#434343\", \"#666666\", \"#999999\", \"#b7b7b7\", \"#cccccc\", \"#d9d9d9\", \"#efefef\", \"#f3f3f3\", \"#ffffff\"],\n\t\t\t[\"#980000\", \"#ff0000\", \"#ff9900\", \"#ffff00\", \"#00ff00\", \"#00ffff\", \"#4a86e8\", \"#0000ff\", \"#9900ff\", \"#ff00ff\"],\n\t\t\t[\"#e6b8af\", \"#f4cccc\", \"#fce5cd\", \"#fff2cc\", \"#d9ead3\", \"#d0e0e3\", \"#c9daf8\", \"#cfe2f3\", \"#d9d2e9\", \"#ead1dc\"],\n\t\t\t[\"#dd7e6b\", \"#ea9999\", \"#f9cb9c\", \"#ffe599\", \"#b6d7a8\", \"#a2c4c9\", \"#a4c2f4\", \"#9fc5e8\", \"#b4a7d6\", \"#d5a6bd\"],\n\t\t\t[\"#cc4125\", \"#e06666\", \"#f6b26b\", \"#ffd966\", \"#93c47d\", \"#76a5af\", \"#6d9eeb\", \"#6fa8dc\", \"#8e7cc3\", \"#c27ba0\"],\n\t\t\t[\"#a61c00\", \"#cc0000\", \"#e69138\", \"#f1c232\", \"#6aa84f\", \"#45818e\", \"#3c78d8\", \"#3d85c6\", \"#674ea7\", \"#a64d79\"],\n\t\t\t[\"#85200c\", \"#990000\", \"#b45f06\", \"#bf9000\", \"#38761d\", \"#134f5c\", \"#1155cc\", \"#0b5394\", \"#351c75\", \"#741b47\"],\n\t\t\t[\"#5b0f00\", \"#660000\", \"#783f04\", \"#7f6000\", \"#274e13\", \"#0c343d\", \"#1c4587\", \"#073763\", \"#20124d\", \"#4c1130\"]\n\t\t]\n\t},\n\t$init:function(){\n\t\tthis.attachEvent(\"onSelect\", function(value){\n\t\t\tthis.getParentView().setMasterValue({ value:value });\n\t\t});\n\t}\n}, webix.ui.colorboard);\n\nwebix.protoUI({\n\t$cssName: \"richselect\",\n\tname: \"ssheet-color\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_color\",\n\t\ticon: \"wxi-menu-down\",\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\"\n\t\t\t}\n\t\t}\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_color\";\n\t},\n\t$renderInput: function(config, divStart, id){\n\t\tvar color  = this.renderColor.call(this);\n\t\tdivStart = divStart.replace(/([^>]>)(.*)(<\\/div)/, function(match, p1, p2, p3){\n\t\t\treturn p1+config.title +color+p3;\n\t\t});\n\n\t\treturn webix.ui.colorpicker.prototype.$renderInput.call(this,config, divStart, id);\n\t},\n\t$setValue: function(value){\n\t\tvar popup =  webix.$$(this.config.popup.toString());\n\t\tvar colorboard = popup.getBody();\n\t\tvalue = value || \"\";\n\t\tcolorboard.setValue(value);\n\t\tthis.config.value = value;\n\t\tthis.getColorNode().style.backgroundColor = value;\n\t},\n\trenderColor: function(){\n\t\treturn \"<div class='webix_ssheet_cp_color' style='background-color:\"+this.config.value+\";'> </div>\";\n\t},\n\tgetColorNode: function(){\n\t\treturn this.$view.firstChild.firstChild.childNodes[1];\n\t},\n\t$renderIcon:function(){\n\t\treturn webix.ui.text.prototype.$renderIcon.apply(this,arguments);\n\t}\n},webix.ui.colorpicker);","webix.protoUI({\n\t$cssName: \"window\",\n\tname: \"ssheet-dialog\",\n\t$init: function(config){\n\t\tthis.$view.className += \" webix_ssheet_dialog\";\n\t\tthis.config.buttons = config.buttons;\n\t\tthis.config.close = true;\n\t},\n\tgetBodyConfig: function(content){\n\t\tcontent.borderless = true;\n\t\tvar elements = this.getFormElements(content);\n\t\tvar config = {\n\t\t\tview: \"form\",\n\t\t\tcss: \"webix_ssheet_form\",\n\t\t\tpadding: webix.skin.$active.layoutPadding.form,\n\t\t\telements: elements\n\t\t};\n\t\treturn config;\n\t},\n\tgetFormElements: function(content){\n\t\tvar elements;\n\t\tif(webix.isArray(content))\n\t\t\telements= content;\n\t\telse{\n\t\t\telements = [];\n\t\t\telements.push(content);\n\t\t}\n\t\tif(this.config.buttons){\n\t\t\telements.push({height:1});\n\t\t\telements.push( {\n\t\t\t\tmargin: 10,\n\t\t\t\tcols:[\n\t\t\t\t\t{},\n\t\t\t\t\t{view: \"button\", css: \"ssheet_cancel_button\", label: webix.i18n.spreadsheet.labels.cancel, autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onCancelClick\",[]);\n\t\t\t\t\t}},\n\t\t\t\t\t{view: \"button\", label: webix.i18n.spreadsheet.labels.save, hotkey: \"enter\", autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onSaveClick\",[]);\n\t\t\t\t\t}}\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\t\treturn elements;\n\t},\n\tbody_setter: function(value){\n\t\tif(typeof value == \"object\"){\n\t\t\tif(webix.isUndefined(value.padding))\n\t\t\t\tvalue.padding = webix.skin.$active.layoutPadding.form;\n\t\t\tif(value.view == \"form\" && value.elements){\n\t\t\t\tvalue.elements = this.getFormElements(value.elements);\n\t\t\t\tif(!value.css)\n\t\t\t\t\tvalue.css = \"webix_ssheet_form\";\n\t\t\t}\n\t\t\telse\n\t\t\t\tvalue = this.getBodyConfig(value);\n\t\t}\n\n\t\treturn webix.ui.window.prototype.body_setter.call(this,value);\n\t},\n\tdefaults:{\n\t\tmove:true,\n\t\thead: \"Dialog\",\n\t\tbuttons: true,\n\t\tclose:true,\n\t\t//we need to retain focus in table area, so disabling the autofocusing feature\n\t\tautofocus:false,\n\t\twidth: 350\n\t}\n}, webix.ui.window, webix.IdSpace);\n\n\n\nwebix.protoUI({\n\t$cssName: \"datatable\",\n\tname: \"ssheet-dialog-table\",\n\t$init: function(config){\n\t\tif(!config.headerRowHeight)\n\t\t\tconfig.headerRowHeight = 34;\n\t\tthis.$view.className += \" webix_ssheet_dialog_table\";\n\t}\n},webix.ui.datatable);","webix.protoUI({\n\tname: \"ssheet-form-popup\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_form\";\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-form-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_suggest\";\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\t$cssName: \"colorpicker\",\n\tname: \"ssheet-colorpicker\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_colorpicker\";\n\t},\n\tdefaults:{\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\",\n\t\t\t}\n\t\t}\n\t}\n}, webix.ui.colorpicker);","webix.protoUI({\n\tname:\"formlate\",\n\tsetValue:function(a){ return this.setHTML(a); },\n\tgetValue:function(){ return \"\"; }\n}, webix.ui.template);","webix.protoUI({\n\tname:\"ssheet-icons\",\n\t$cssName: \"dataview\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_dataview\";\n\t},\n\tdefaults:{\n\t\tborderless: true,\n\t\ttemplate: \"<span class='webix_ssheet_button_icon #css#' ></span>\",\n\t\ttype:{\n\t\t\twidth: 36,\n\t\t\theight: 36\n\t\t}\n\t}\n},webix.ui.dataview);","webix.protoUI({\n\tname: \"ssheet-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tcss: \"webix_ssheet_suggest\"\n\t}\n},webix.ui.contextmenu);","webix.protoUI({\n\tname: \"suggest-formula\",\n\tdefaults: {\n\t\tfitMaster: false,\n\t\twidth: 200,\n\t\tfilter(item, value) {\n\t\t\tconst editor = webix.$$(this.config.master);\n\t\t\tconst cursor = editor.getInputNode().selectionStart;\n\t\t\tconst val = editor.getValue();\n\n\t\t\tif(val.charAt(0) !== \"=\") return;\n\n\t\t\tlet str1 = val.substring(0, cursor).match(/([a-zA-Z]+)$/);\n\t\t\tlet str2 = val.charAt(cursor).search(/[^A-Za-z0-9]/);\n\n\t\t\tif(str1 && (cursor === val.length || str2 === 0))\n\t\t\t\tvalue = str1[0];\n\n\t\t\treturn item.value.toString().toLowerCase().indexOf(value.toLowerCase()) === 0;\n\t\t}\n\t},\n\t$init() {\n\t\tthis.attachEvent(\"onBeforeShow\", (node) => {\n\t\t\tif(node.tagName){\n\t\t\t\tconst editor = webix.$$(this.config.master);\n\t\t\t\tconst text = editor.getValue();\n\n\t\t\t\t//only for formulas\n\t\t\t\tif(!text || text.charAt(0) !== \"=\") return false;\n\n\t\t\t\tconst sizes = webix.html.offset(node);\n\n\t\t\t\tconst selectionStart = editor.getInputNode().selectionStart;\n\t\t\t\tconst textWidth = webix.html.getTextSize(text.substring(0, selectionStart), \"webix_ssheet_formula\").width;\n\n\t\t\t\tconst y = sizes.y + sizes.height;\n\t\t\t\tconst x = sizes.x + textWidth;\n\n\t\t\t\twebix.ui.popup.prototype.show.apply(this, [{x, y}]);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t},\n\tsetMasterValue(data, refresh) {\n\t\tconst text = data.id ? this.getItemText(data.id) : (data.text||data.value);\n\t\twebix.$$(this.config.master).setValueHere(text);\n\n\t\tif (!refresh)\n\t\t\tthis.hide(true);\n\n\t\tthis.callEvent(\"onValueSuggest\", [data, text]);\n\t},\n\t$enterKey: function() {\n\t\tif (this.isVisible())\n\t\t\treturn webix.ui.suggest.prototype.$enterKey.apply(this, arguments);\n\t}\n}, webix.ui.suggest);","const group = {\n\tvalue: null,\n\tset: function(method, master){\n\t\tif(!this.value){\n\t\t\tthis.start();\n\t\t\tmethod.call(master);\n\t\t\tthis.end();\n\t\t}\n\t\telse\n\t\t\tmethod.call(master);\n\t},\n\tstart(){\n\t\tthis.value = webix.uid();\n\t},\n\tend(){\n\t\tthis.value = null;\n\t}\n};\n\nexport default group;","export function init(view){\n\tconst events = [\n\t\t{name:\"onSheetAdd\", type:\"insert\"},\n\t\t{name:\"onSheetRemove\", type:\"remove\"},\n\t\t{name:\"onSheetRename\", type:\"rename\"},\n\t\t{name:\"onCellChange\"},\n\t\t{name:\"onStyleChange\"},\n\t\t{name:\"onAction\"},\n\t\t{name:\"onRowOperation\"},\n\t\t{name:\"onColumnOperation\"},\n\t\t{name:\"onAfterConditionSet\"},\n\t\t{name:\"onAfterRangeSet\"},\n\t\t{name:\"onAfterSpan\"},\n\t\t{name:\"onAfterSplit\"},\n\t\t{name:\"onAfterFilter\", view: \"cells\"},\n\t\t{name:\"onRowResize\", view: \"cells\"},\n\t\t{name:\"onColumnResize\", view: \"cells\"}\n\t];\n\n\tlet thread;\n\tfor (let i = 0; i < events.length; i++){\n\t\tconst handler = events[i];\n\t\t(handler.view ? view.$$(handler.view) : view).attachEvent(handler.name, function(name, newName){\n\t\t\tif (view._loading_data) return;\n\n\t\t\tlet params;\n\t\t\tif(handler.type)\n\t\t\t\tparams = handler.type == \"rename\" ? [handler.type, newName, name] : [handler.type, name];\n\t\t\telse\n\t\t\t\tparams = [\"update\", view.getActiveSheet()];\n\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(() => view.callEvent(\"onChange\", params));\n\t\t});\n\t}\n\n\tview.attachEvent(\"onChange\", function(){\n\t\tsave(view, \"all\");\n\t});\n}\n\nexport function save(view, name, data){\n\tvar save = view.config.save;\n\tvar url;\n\tif (!save) return;\n\n\tif(name == \"all\"){\n\t\tif(!save.all)\n\t\t\treturn;\n\t\tdata = { data: view.serialize({ sheets: true }) };\n\t\turl = save.all;\n\t}\n\telse{\n\t\turl = typeof save === \"string\" ? save + \"/\" + name : save[name];\n\t}\n\n\turl = webix.proxy.$parse(url);\n\n\tif(url){\n\t\tif (typeof url === \"function\")\n\t\t\treturn url(name, data);\n\n\t\tif (url.$proxy && url.save)\n\t\t\treturn url.save(view, data, null, null);\n\n\t\tvar ajax = webix.ajax();\n\t\tif (name === \"all\")\n\t\t\tajax.headers({ \"Content-type\" : \"application/json\" });\n\t\tajax.post(url, data);\n\t}\n}","export const decode = {};\nexport const encode = {};\n\nconst alpha = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\nfor (var i=1; i<1000; i++){\n\tvar prefixIndex = parseInt((i-1)/alpha.length);\n\tvar str = (prefixIndex?alpha[prefixIndex-1]:\"\")+alpha[(i-1)%(alpha.length)];\n\n\tdecode[str] = i;\n\tencode[i] = str;\n}\n\nencode[0]=encode[1];\n\n\nexport function adress(text){\n\tvar size = (text.charCodeAt(1) < 59) ? 1 : 2;\n\tvar col = text.substr(0, size);\n\tvar row = text.substr(size);\n\n\treturn [row*1, decode[col]];\n}\n\nexport function range(text, view){\n\tvar nind = text.indexOf(\"!\");\n\tvar sheet = \"\";\n\n\t//parse sheet names\n\tif (nind !== -1){\n\t\tsheet = text.substr(0, nind);\n\t\tif (sheet[0] === \"'\")\n\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\ttext = text.substr(nind+1);\n\t}\n\n\tvar parts = text.split(\":\");\n\tif (parts.length != 2 && view){\n\t\ttext = view.ranges.getCode(text, sheet);\n\t\tif (!text) return null;\n\t\tparts = text.split(\":\");\n\t} \n\n\tvar d1 = adress(parts[0]);\n\tvar d2 = adress(parts[1]);\n\treturn [d1[0], d1[1], d2[0], d2[1], sheet];\n}\n\n\nvar notAlphaNum = /[^A-Za-z0-9]/;\nfunction escapeSheet(text){\n\tif (notAlphaNum.test(text))\n\t\treturn `'${text}'`;\n\treturn text;\n}\n\nexport function toRange(x,y,x2,y2,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+encode[y]+x+\":\"+encode[y2]+x2;\n}\nexport function toSheetRange(x,y,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+x+\":\"+y;\n}\n\nexport function rangeObj(text, view){\n\tif (typeof text === \"object\") return text;\n\tlet a = range(text, view);\n\treturn { start:{ row:a[0], column:a[1]}, end:{ row:a[2], column:a[3] }, sheet: a[4] };\n}\n\nexport function eachRange(text, view, callback, data){\n\tvar range = rangeObj(text);\n\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\tfor (let column = range.start.column; column <=  range.end.column; column++) {\n\t\t\tcallback(view, {row: row, column: column}, data);\n\t\t}\n\t}\n}\n\nvar rangeTest = /(([A-Za-z0-9]+|'[^']+')!|)[A-Z]+[0-9]+:[A-Z]+[0-9]+/;\nexport function isRange(text){\n\treturn rangeTest.test(text);\n}\n\nexport function changeRange(text,name,inc,start){\n\tlet updated = false;\n\n\tif(isRange(text)){\n\t\tlet [r1,c1,r2,c2,sheet] = range(text);\n\n\t\t//ranges like B2:A1\n\t\tif(r1 > r2)\n\t\t\t[r1, r2] = [r2, r1];\n\t\tif(c1 > c2)\n\t\t\t[c1, c2] = [c2, c1];\n\n\t\tif (name === \"row\" && start.row <= r2){\n\t\t\tif((inc < 0 && start.row < r1) || (inc > 0 && start.row <= r1))\n\t\t\t\tr1 += inc;\n\t\t\tr2 += inc;\n\n\t\t\tif(r2<r1)\n\t\t\t\treturn \"\";\n\n\t\t\tupdated = true;\n\t\t}\n\t\telse if (name === \"column\" && start.column <= c2){\n\t\t\tif((inc < 0 && start.column < c1) || (inc > 0 && start.column <= c1))\n\t\t\t\tc1 += inc;\n\t\t\tc2 += inc;\n\n\t\t\tif(c2<c1)\n\t\t\t\treturn \"\";\n\n\t\t\tupdated = true;\n\t\t}\n\t\tif(updated)\n\t\t\ttext = toRange(r1,c1,r2,c2,sheet);\n\t}\n\n\treturn text;\n}","export const toolbarSizes = {\n\twidth:38,\n\tmargin: 7,\n\tpaddingY: 1,\n\tsectorPadding: 5,\n\tsectorMargin: 0\n};\n\n// default styles for toolbar elements\nexport const defaultStyles = {\n\t\"color\"         : \"#666666\",\n\t\"background\"    : \"#ffffff\",\n\t\"font-family\"   : \"'PT Sans', Tahoma\",\n\t\"font-size\" : \"15px\",\n\t\"text-align\": \"left\",\n\t\"vertical-align\": \"middle\",\n\t\"white-space\": \"nowrap\",\n\t\"format\": \"common\"\n};\n\nexport function setSkinDefaults(){\n\tconst skin = webix.skin.$name;\n\tconst material = skin == \"material\" || skin == \"mini\";\n\ttoolbarSizes.width = webix.skin.$active.inputHeight+2;\n\ttoolbarSizes.titleHeight = webix.skin.$name == \"mini\" ? 18 : 20;\n\n\tdefaultStyles[\"font-family\"] = material ? \"'Roboto', sans-serif\" : \"'PT Sans', Tahoma\";\n\n\tif(skin == \"contrast\"){\n\t\tdefaultStyles.background = \"#393939\";\n\t\tdefaultStyles.color = \"#ffffff\";\n\t}\n}","import group from \"./undo_group\";\nimport {save} from \"./save\";\nimport {eachRange} from \"../helpers/column_names\";\nimport {defaultStyles} from \"../toolbar/defaults\";\n\n//do not change order, it will break server side compatibility\n//add new options to the end of this list\nexport const style_names = [\n\t\"color\",\"background\",\"text-align\",\n\t\"font-family\",\"font-size\",\n\t\"font-style\",\"text-decoration\",\"font-weight\",\n\t\"vertical-align\", \"wrap\", \"borders\", \"format\",\n\t\"border-right\", \"border-bottom\",\"border-left\", \"border-top\"\n];\n\nconst _style_map = {\n\t\"text-align\": {\n\t\tleft: () => \"justify-content:flex-start;\",\n\t\tcenter: () => \"justify-content:center;\",\n\t\tright: () => \"justify-content:flex-end;\"\t\t\n\t},\n\t\"vertical-align\": {\n\t\ttop: () => \"align-items:flex-start;\",\n\t\tmiddle: () => \"align-items:center;\",\n\t\tbottom: () => \"align-items:flex-end;\"\n\t},\n\twrap: {\n\t\twrap: ()=> {\n\t\t\treturn \"white-space: normal !important;\";\n\t\t}\n\t},\n\t\"border-left\": obj => {\n\t\treturn getBorderCss(\"border-left\", obj);\n\t},\n\t\"border-top\": obj => {\n\t\treturn getBorderCss(\"border-top\", obj);\n\t},\n\t\"border-right\": obj => {\n\t\treturn getBorderCss(\"border-right\", obj);\n\t},\n\t\"border-bottom\": obj => {\n\t\treturn getBorderCss(\"border-bottom\", obj);\n\t},\n\t\"font-weight\": obj => {\n\t\t//Roboto bold - font-weight:500 (looks better, than 700). Roboto is default font for material skins.\n\t\tif(obj[\"font-weight\"] == \"bold\"){\n\t\t\tconst family = obj[\"font-family\"] || defaultStyles[\"font-family\"];\n\t\t\treturn \"font-weight:\" + (family == \"'Roboto', sans-serif\" ? 500 : 700) + \";\";\n\t\t}\n\t\treturn \"\";\n\t}\n};\n\nfunction getBorderCss(pos, obj){\n\tlet border = obj[pos];\n\tif(border){\n\t\tlet [color, type] = border.split(\",\");\n\n\t\ttype = type || \"thin\";\n\t\tlet size = \"1px\";\n\t\tif(type == \"medium\")\n\t\t\tsize = \"2px\";\n\t\telse if(type == \"thick\" || type == \"double\")\n\t\t\tsize = \"3px\";\n\n\t\tif([\"thin\", \"medium\", \"thick\"].indexOf(type) != -1)\n\t\t\ttype = \"solid\";\n\n\t\treturn `${pos}: ${size} ${type} ${color} !important;`;\n\t}\n\treturn \"\";\n}\n\nconst border_checks = {\n\t\"border-left\":\t\tfunction(cell, area, mode){ return cell.column == area.start.column || mode ==\"no\"; },\n\t\"border-right\":\t\tfunction(cell, area, mode){ return cell.column == area.end.column || mode == \"all\" || mode ==\"no\"; },\n\t\"border-top\":\t\tfunction(cell, area , mode){ return cell.row == area.start.row || mode ==\"no\"; },\n\t\"border-bottom\":\tfunction(cell, area, mode){ return cell.row == area.end.row || mode == \"all\"|| mode ==\"no\"; }\n};\n\nconst _style_handlers = {\n\t\"borders\": function(view, style, value, cell){\n\t\tconst area = view.$$(\"cells\").getSelectArea();\n\t\tvalue = value.split(\",\");\n\t\tconst type = value[0];\n\t\tlet color = value[1];\n\t\tlet lineStyle = value[2];\n\n\t\tvar modes = [\"border-left\", \"border-right\", \"border-bottom\", \"border-top\"];\n\n\t\tif(type == \"top-bottom\"){\n\t\t\tmodes = [\"border-top\",\"border-bottom\"];\n\t\t}\n\t\telse if (type != \"no\" && type != \"all\" && type != \"outer\")\n\t\t\tmodes = [\"border-\"+type];\n\n\t\tfor (var i = 0; i < modes.length; i++){\n\t\t\tvar mode = modes[i];\n\t\t\tlet result = view.callEvent(\"onAction\", [\"check-borders\", {row:cell.row, column:cell.column, area, type, mode}]);\n\t\t\tif (result === true || border_checks[mode](cell, area, type)){\n\t\t\t\tconst border = type == \"no\" ? \"\" : `${color},${lineStyle}`;\n\t\t\t\tstyle = _updateStyle(view, style, mode, border, cell);\n\t\t\t}\n\t\t}\n\t\treturn style;\n\t}\n};\n\nvar sizeEl;\nexport function init(view){\n\tview.attachEvent(\"onStyleSet\", (name, value) => _applyStyles(view, name, value));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, style) => {\n\t\tif(type == \"style\")\n\t\t\t_undoStyle(view, row, column, style);\n\t});\n\n\treset(view);\n\n\tif (!sizeEl)\n\t\tsizeEl = webix.html.create(\"DIV\", { style:\"visibility:hidden; position:absolute; top:0px; left:0px; height:auto;\"}, \"\");\n}\n\nfunction reset(view){\n\tview._styles = {};\n\tview._styles_cache = {};\n\tview._styles_max = 1;\n\n\tlet prefix = \".wss_\"+view.$index;\n\twebix.html.removeStyle(prefix);\n}\n\nexport function getStyle(view, cell){\n\tconst styles = view.getRow(cell.row).$cellCss;\n\tconst span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\n\tif(span){\n\t\tconst spanStyles = span[5].split(\" \");\n\t\tfor (let i = 0; i < spanStyles.length; i++){\n\t\t\tconst spanStyle = view._styles[spanStyles[i]];\n\t\t\tif(spanStyle)\n\t\t\t\treturn spanStyle;\n\t\t}\n\t}\n\n\tif (styles){\n\t\tconst styleid = styles[cell.column];\n\t\tif (styleid)\n\t\t\treturn view._styles[styleid];\n\t}\n\treturn null;\n}\n\n// undo\nfunction _undoStyle(view, row, column, style){\n\tvar cell = {row: row, column: column};\n\tsetStyle(view, cell, style);\n}\n\nfunction _serialize(view, obj){\n\tvar styles = [];\n\n\tfor (var key in view._styles_cache)\n\t\tstyles.push([view._styles_cache[key].id, key]);\n\n\tobj.styles = styles;\n}\n\nexport function addStyle(view, props, origin){\n\tvar style = {\n\t\tprops:_styleFromText(\";;;;;;;;;;;;;;;\")\n\t};\n\n\tif (origin)\n\t\tfor (var key in origin.props)\n\t\t\tstyle.props[key] = origin.props[key];\n\n\tfor (let  key in props)\n\t\tstyle.props[key] = props[key];\n\t\t\n\n\tstyle.text = _styleToText(style);\n\tvar cache = view._styles_cache[style.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view, style);\n\n\treturn style;\n}\n\nfunction _parse(view, obj){\n\tif (obj.styles)\n\t\tfor (let i=0; i < obj.styles.length; i++){\n\t\t\tvar styleObj = obj.styles[i];\n\t\t\tvar style = {\n\t\t\t\tid: styleObj[0],\n\t\t\t\ttext:styleObj[1],\n\t\t\t\tprops: _styleFromText(styleObj[1])\n\t\t\t};\n\n\t\t\t_addStyle(view, style, true);\n\t\t}\n\n\tfor (let i = 0; i < obj.data.length; i++){\n\t\tvar [row, column, , css] = obj.data[i];\n\n\t\tif (css)\n\t\t\tupdate_style_data(view, row, column, view._styles[css]);\n\t}\n}\n\nfunction _applyStyles(view, name, value){\n\t//this - spreadsheet\n\tgroup.set(function(){\n\t\tview.eachSelectedCell(function(cell){\n\t\t\t_applyCellStyles(view, cell, name, value);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _applyCellStyles(view, cell, name, value){\n\tvar ostyle = getStyle(view, cell);\n\tvar nstyle = _updateStyle(view, ostyle, name, value, cell);\n\n\tif (nstyle && nstyle != ostyle)\n\t\t_setStyle(view, cell, nstyle, ostyle);\n}\n\nfunction _updateStyle(view, style, name, value, cell){\n\n\tif(_style_handlers[name]){\n\t\treturn _style_handlers[name](view, style, value, cell);\n\t}\n\n\tif (style && style.props[name] == value) return style;\n\n\tvar nstyle = { text:\"\", id:0, props: (style?webix.copy(style.props):{}) };\n\tnstyle.props[name] = value;\n\tnstyle.text = _styleToText(nstyle);\n\n\tvar cache = view._styles_cache[nstyle.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view,nstyle);\n\n\treturn nstyle;\n}\n\nfunction update_style_data(view, row, column, style){\n\tconst item = view.getRow(row);\n\n\titem.$cellCss = item.$cellCss || {};\n\titem.$cellFormat = item.$cellFormat || {};\n\n\tif(style){\n\t\titem.$cellCss[column] = style.id;\n\t\titem.$cellFormat[column] = style.props.format || null;\n\t} else {\n\t\tdelete item.$cellCss[column];\n\t\tdelete item.$cellFormat[column];\n\t}\n}\n\nexport function setStyle(view, cell, style){\n\tvar old = getStyle(view, cell);\n\treturn _setStyle(view, cell, style, old);\n}\n\nexport function setRangeStyle(view, range, style) {\n\teachRange(range, view, _setStyle, style);\n}\n\nexport function getTextSize(view, text, css, baseWidth){\n\tsizeEl.innerHTML = text;\n\tsizeEl.style.width = baseWidth ? baseWidth+\"px\" : \"auto\";\n\n\tsizeEl.className = \"webix_table_cell webix_cell \"+css;\n\tview._table.$view.appendChild(sizeEl);\n\n\tconst width = Math.max(0, sizeEl.offsetWidth+1);\n\tconst height = Math.max(0, sizeEl.offsetHeight+1);\n\n\tview._table.$view.removeChild(sizeEl);\n\tsizeEl.innerHTML = \"\";\n\n\treturn { width, height };\n}\n\nfunction _setStyle(view, cell, style, old){\n\tgroup.set(()=>{\n\t\tif(view.callEvent(\"onBeforeStyleChange\", [cell.row, cell.column, style, old])){\n\t\t\tconst format = style && style.props.format || null;\n\t\t\tconst oldFormat = old && old.props.format || null;\n\t\t\tconst formatChanged = format != oldFormat;\n\t\t\tif(!formatChanged || formatChanged && view.callEvent(\"onBeforeFormatChange\", [cell.row, cell.column, format, oldFormat])){\n\t\t\t\tupdate_style_data(view, cell.row, cell.column, style);\n\t\t\t\tview.callEvent(\"onStyleChange\", [cell.row, cell.column, style, old]);\n\n\t\t\t\tif(formatChanged)\n\t\t\t\t\tview.callEvent(\"onFormatChange\", [cell.row, cell.column, format, oldFormat]);\n\n\t\t\t\tview.saveCell(cell.row,cell.column);\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction _buildCssString(style) {\n\tlet css = \"\";\n\n\tfor (var key in style){\n\t\tif (style[key]){\n\t\t\tif( _style_map[key]){\n\t\t\t\tif(_style_map[key][style[key]])\n\t\t\t\t\tcss += _style_map[key][style[key]](style);\n\t\t\t\telse if(typeof  _style_map[key] == \"function\")\n\t\t\t\t\tcss += _style_map[key](style);\n\t\t\t}\n\t\t\telse\n\t\t\t\tcss+= key+\":\"+style[key]+\";\";\n\t\t}\n\t}\n\n\treturn css;\n}\n\nfunction _addStyle(view, style, silent){\n\tview._styles_cache[style.text] = style;\n\n\twhile (!style.id || view._styles[style.id])\n\t\tstyle.id = \"wss\"+(view._styles_max++);\n\tview._styles[style.id] = style;\n\n\tconst css = _buildCssString(style.props);\n\tlet prefix = \".wss_\"+view.$index;\n\twebix.html.addStyle(prefix+\" .\"+style.id+\"{\"+css+\"}\", prefix);\n\n\tif (!silent)\n\t\tsave(view, \"styles\", { name:style.id, text: style.text } );\n}\n\nfunction _styleToText(style){\n\tvar id = [];\n\tfor (var i=0; i<style_names.length; i++)\n\t\tid.push(style.props[style_names[i]]);\n\treturn id.join(\";\");\n}\n\nfunction _styleFromText(text){\n\tvar parts = text.split(\";\");\n\tvar props = {};\n\tfor (var i=0; i<style_names.length; i++)\n\t\tprops[style_names[i]] = parts[i];\n\treturn props;\n}\n\n\n\nexport function clearRangeStyle(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tlet style = getStyle(view,cell);\n\t\t\tif (style)\n\t\t\t\tsetStyle(view, cell, null);\n\t\t});\n\t});\n}\n\nexport function compactStyles(view){\n\tlet params  = view.serialize();\n\n\tlet data = params.data;\n\tlet styles = params.styles;\n\n\tlet used = {};\n\tfor (let i=0; i<data.length; i++){\n\t\tlet name = data[i][3];\n\t\tif (name)\n\t\t\tused[name] = 1;\n\t}\n\n\tlet newStyles = [];\n\tfor(let i = 0; i<styles.length; i++){\n\t\tlet name = styles[i][0];\n\t\tif (used[name])\n\t\t\tnewStyles.push(styles[i]);\n\t}\n\n\tparams.styles = newStyles;\n\treset(view);\n\t_parse(view, params);\n}","import {addStyle} from \"./styles\";\nimport {getJsDateFromExcel} from \"../math/methods/helpers\";\nimport group from \"./undo_group\";\n\nexport function init(view){\n\tview.attachEvent(\"onDataParse\", (data) => load(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => serialize(view, data, config));\n}\n\nexport let formatHelpers = {};\n\nlet formats;\nlet formatsCount;\nlet formatSources;\nlet formatCache;\n\nexport function setDefaultFormats(){\n\tconst formatsLocale = webix.i18n.spreadsheet.formats;\n\tformats = {};\n\tformatsCount = 0;\n\tformatSources = {};\n\tformatCache = {};\n\tformatHelpers = {\n\t\tprice : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_price\";\n\t\t\t\treturn webix.i18n.priceFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.priceSettings.decimalSize, \n\t\t\t\tsymbol: webix.i18n.priceFormat(\"\"),\n\t\t\t\tseparator: 1, negative:1, type: \"price\"\n\t\t\t}, getDelimiters(\"price\"))\n\t\t},\n\t\t\"int\" : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_int\";\n\t\t\t\treturn webix.i18n.numberFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.decimalSize,\n\t\t\t\tseparator: 1, negative:1, type: \"int\",\n\t\t\t}, getDelimiters(\"int\"))\n\t\t},\n\t\tpercent : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_percent\";\n\t\t\t\treturn Math.round(value*100)+\"%\";\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: 0, separator: 0, negative:1, type: \"percent\",\n\t\t\t}, getDelimiters(\"percent\"))\n\t\t},\n\t\tdate : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_date\";\n\t\t\t\treturn format2code(formatsLocale.dateFormat, getDelimiters(\"date\"))(value);\n\t\t\t},\n\t\t\tvalues: { type:\"date\", date:formatsLocale.dateFormat }\n\t\t},\n\t\tstring : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_text\";\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\tvalues: { type:\"string\" }\n\t\t}\n\t};\n\n\tfor(let i in formatHelpers){\n\t\tformatSources[i] = serializeFormat(formToValues(i, formatHelpers[i].values));\n\t\tformatCache[formatSources[i]] = i;\n\t}\n}\n\nexport function getDelimiters(type){\n\tif(type == \"price\")\n\t\treturn { groupSign:webix.i18n.priceSettings.groupDelimiter, decimalSign:webix.i18n.priceSettings.decimalDelimiter };\n\telse \n\t\treturn { groupSign:webix.i18n.groupDelimiter, decimalSign:webix.i18n.decimalDelimiter };\n}\n\nfunction serialize(view, data){\n\tconst formats = [];\n\tconst defaultFormats = [\"percent\", \"int\", \"price\", \"date\", \"string\"];\n\n\tfor(let i in formatSources){\n\t\tif(defaultFormats.indexOf(i) == -1) //exclude default formats\n\t\t\tformats.push([i,formatSources[i]]);\n\t}\n\tdata.formats = formats;\n}\n\nfunction load(view,data){\n\tvar i,\n\t\tformats = data.formats;\n\n\tif(formats)\n\t\tfor(i = 0; i < formats.length; i++)\n\t\t\tcreateFormatName(formats[i][1],formats[i][0]);\n}\n\nexport function getFormat(name){\n\treturn formatHelpers[name] ? formatHelpers[name].getFormat : formatHelpers[name];\n}\n\nexport function getFormatSource(name, toexcel){\n\tif(toexcel){\n\t\tlet parsed = parseFormat({values: formatHelpers[name].values, format: formatSources[name]});\n\t\treturn serializeFormat(parsed, true);\n\t}\n\telse\n\t\treturn formatSources[name];\n}\n\nfunction createFormatName(str, values){\n\tif (formatCache[str]) return formatCache[str];\n\n\tlet name = typeof(values) == \"object\" ? \"fmt\"+(formatsCount) : values;\n\tformatsCount++;\n\n\tformats[name] = str;\n\n\tvalues = webix.extend(\n\t\ttypeof(values) == \"object\" ? values : { format:str, type:\"custom\" }, \n\t\tgetDelimiters(\"custom\")\n\t);\n\n\tformatHelpers[name] = {\n\t\tgetFormat:format2code(str, {decimalSign: values.decimalSign, groupSign: values.groupSign}),\n\t\tvalues: values\n\t};\n\n\tformatSources[name] = str;\n\tformatCache[str] = name;\n\n\treturn name;\n}\n\nexport function addFormat(view, row, column, format, type){\n\tif(!type)\n\t\ttype = {format:format, type: \"custom\"};\n\tconst old = view.getStyle(row, column);\n\tconst nev = addStyle(view, { format:createFormatName(format, type) }, old);\n\tview.setStyle(row, column, nev);\n}\n\nexport function removeFormat(view, row, column){\n\tconst old = view.getStyle(row, column);\n\tconst nev = addStyle(view, { format:\"\" }, old);\n\tview.setStyle(row, column, nev);\n}\n\nfunction splitFormat(str){\n\tvar conditional = str.match(/.*\\[[><=].*/g);\n\tvar parts = str.split(\";\");\n\tif (!conditional){\n\t\tif (parts.length > 1){\n\t\t\tparts[0] = (parts.length > 2 ? \"[>0]\" : \"[>=0]\")+parts[0];\n\t\t\tparts[1] = \"[<0]\"+parts[1];\n\t\t\tif (parts[2])\n\t\t\t\tparts[2] = \"[=0]\"+parts[2];\n\t\t}\n\t}\n\treturn parts;\n}\n\nexport function format2code(str, delimiters){\n\tconst errorMessage = webix.i18n.spreadsheet.table[\"format-error\"];\n\tlet parts = splitFormat(str);\n\tlet code = [\"var spaces = \\\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\";\"];\n\tfor (var i=0; i<parts.length; i++){\n\t\tvar separated = separateFmt(parts[i]);\n\t\tcode.push(genCode(separated.condition, separated.color.toLowerCase(), separated.fmt, i, parts.length > 0, delimiters));\n\t}\n\n\treturn new Function(\"val\",\"extra\", `try{ ${code.join(\"\\n\")} return val; } catch(err) { return \"${errorMessage}\"; }`);\n}\n\nfunction genCode(check, color, line, ind, isAbs, delimiters){\n\tvar str = \"\";\n\tif (check){\n\t\tif (!ind) str+=\"if\"; else str+=\"else if\";\n\t\tif (check[0] === \"=\") check = \"=\"+check;\n\t\tstr+=\"(val\"+check+\"){\";\n\t\tif (isAbs) str+=\"val = Math.abs(val);\";\n\t}\n\tif (color)\n\t\tstr+=\"extra.css = \\\"webix_ssheet_format_\"+color+\"\\\";\";\n\n\tstr += genFormatCode(line, delimiters);\n\n\treturn str+(check?\"}\":\"\");\n}\n\nconst dateTypes = {\n\t\"yy\": \"%y\",\n\t\"yyyy\": \"%Y\",\n\t\"m\": \"%n\",\n\t\"mm\": \"%m\",\n\t\"mmm\": \"%M\",\n\t\"mmmm\": \"%F\",\n\t\"mmmmm\":\"%F\", //not supported by webix\n\t\"d\": \"%j\",\n\t\"dd\": \"%d\",\n\t\"ddd\": \"%D\",\n\t\"dddd\": \"%l\"\n};\n\nconst timeTypes = {\n\t\"h\": \"%G\",\n\t\"hh\": \"%H\",\n\t\"m\": \"%i\", //not supported by webix\n\t\"mm\": \"%i\",\n\t\"s\": \"%s\", //not supported by webix\n\t\"ss\": \"%s\",\n\t\"AM/PM\": \"%A\"\n};\n\nconst dateOrder = Object.keys(dateTypes).sort((a, b) => b.length - a.length);\nconst timeOrder = Object.keys(timeTypes).sort((a, b) => b.length - a.length);\n\nfunction excelDateToWebix(text, lastDateType){\n\tconst typesOrder = [\n\t\t{name:\"date\", order:dateOrder, types:dateTypes}, \n\t\t{name:\"time\", order:timeOrder, types:timeTypes}\n\t];\n\n\t// \"m\"/\"mm\" format can be either date (%n/%m) or time (%i), so check last date type\n\tconst basedOnLast = /^m{1,2}(?!m)/.test(text);\n\tif(basedOnLast && lastDateType != \"date\")\n\t\ttypesOrder.reverse();\n\n\tfor(let i = 0; i < typesOrder.length; i++){\n\t\tconst type = typesOrder[i];\n\t\tfor(let j = 0; j < type.order.length; j++)\n\t\t\tif(text.indexOf(type.order[j]) == 0)\n\t\t\t\treturn {\n\t\t\t\t\tformat: type.types[type.order[j]],\n\t\t\t\t\tlength: type.order[j].length,\n\t\t\t\t\ttype: type.name\n\t\t\t\t};\n\t}\n}\n\nfunction genFormatCode(line, delimiters){\n\tif (!line)\n\t\treturn \"return val;\";\n\n\tlet str = \"return \\\"\\\"\";\n\n\tlet isQuote;\n\tlet fmt = \"\";\n\tlet multiply = 1;\n\tlet comma, numberPlaceholder, textPlaceholder;\n\tlet date = [];\n\tlet lastDateType = \"date\";\n\n\tfor (var i=0; i<line.length; i++){\n\t\tvar betweenPlaceholders = placeholder(line[i-1])&&placeholder(line[i+1]);\n\t\tif (line[i] == \"\\\"\"){\n\t\t\tif(webix.isUndefined(isQuote))\n\t\t\t\tisQuote = i;\n\t\t\telse {\n\t\t\t\tstr += `+\"${line.substr(isQuote+1, i-isQuote-1)}\"`;\n\t\t\t\tisQuote = undefined;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tif (!webix.isUndefined(isQuote))\n\t\t\tcontinue;\n\t\tif(line[i] == \"%\")\n\t\t\tmultiply = multiply*100;\n\n\t\tif(/[a-zA-Z]/.test(line[i])){\n\t\t\tconst datePart = excelDateToWebix(line.substr(i), lastDateType);\n\t\t\tif(datePart){\n\t\t\t\tif(numberPlaceholder || textPlaceholder)\n\t\t\t\t\treturn \"throw \\\"unexpected number placeholder\\\";\";\n\t\t\t\tdate.push(datePart.format);\n\t\t\t\tstr += \"/*date*/\"; //update this value after date format is ready\n\t\t\t\tlastDateType = datePart.type;\n\t\t\t\ti += datePart.length-1;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse\n\t\t\t\tstr += `+\"${line[i]}\"`;\n\t\t}\n\t\telse if (line[i] === delimiters.decimalSign && betweenPlaceholders){\n\t\t\tfmt+= delimiters.decimalSign;\n\t\t}\n\t\telse if(line[i]==\"@\"){\n\t\t\tif(numberPlaceholder || date.length)\n\t\t\t\treturn \"throw \\\"unexpected number placeholder\\\";\";\n\t\t\tif(!textPlaceholder){\n\t\t\t\tstr+=\"+fmt\";\n\t\t\t\ttextPlaceholder = true;\n\t\t\t}\n\t\t\tfmt+=line[i];\t\t\n\t\t}\n\t\telse if (placeholder(line[i])){\n\t\t\tif(textPlaceholder || date.length)\n\t\t\t\treturn \"throw \\\"unexpected text placeholder\\\";\";\n\t\t\tif (!numberPlaceholder) {\n\t\t\t\tstr+=\"+fmt\";\n\t\t\t\tnumberPlaceholder=true;\n\t\t\t}\n\t\t\tfmt+=line[i];\n\t\t}\n\t\telse if (line[i] === delimiters.groupSign && betweenPlaceholders)\n\t\t\tcomma = true;\n\t\telse\n\t\t\tstr += `+\"${line[i]}\"`;\n\t}\n\n\tif(date.length){\n\t\t// 12-hour or 24-hour clock depends on AM/PM in format\n\t\tif(date.indexOf(\"%A\") != -1)\n\t\t\tdate = date.map(datePart => {\n\t\t\t\tswitch(datePart){\n\t\t\t\t\tcase \"%G\": return \"%g\";\n\t\t\t\t\tcase \"%H\": return \"%h\";\n\t\t\t\t\tdefault: return datePart;\n\t\t\t\t}\n\t\t\t});\n\n\t\tfor(let i = 0; i < date.length; i++)\n\t\t\tstr = str.replace(\"/*date*/\", `+dateParts[${i}]`);\n\t}\n\n\treturn `\n\t\t${date.length ? `val = (${getJsDateFromExcel})(val); var dateParts = webix.Date.dateToStr(\"${date.join(\";\")}\")(val).split(\";\");` : \"\"}\n\t\t${fmt ? `${numberFormat(fmt, comma, delimiters, multiply)};` : \"\"}\n\t\t${str};`;\n}\n\nfunction numberFormat(fmt, comma, delimiters, multiply){\n\tvar str = `if(/^@+$/.test(\"${fmt}\") || isNaN(val)){ var fmt = val; }else {`;\n\tvar decimal = delimiters.decimalSign;\n\tvar [left, right] = getParts(fmt, decimal);\n\tright = (right || \"\").split(\"\").reverse().join(\"\");\n\n\t//calculate indexes in mask\n\tvar lzeros = left.indexOf(\"0\"); if (lzeros>=0) lzeros = left.length - lzeros;\n\tvar lfills = left.indexOf(\"?\"); if (lfills>=0) lfills = left.length - lfills;\n\tvar rzeros = right.indexOf(\"0\"); if (rzeros>=0) rzeros = right.length - rzeros;\n\tvar rfills = right.indexOf(\"?\"); if (rfills>=0) rfills = right.length - rfills;\n\tvar rmax = right.length;\n\n\tstr += `\n\tval = val*${multiply};\n\tvar parts = val.toFixed(${rmax}).split(\".\");\n\tvar left = parts[0];\n\tvar lsize = left.length; \n\tvar right = parts[1] || \"\";\n\tif (left.length < ${lzeros}) left = \"0000000000\".substr(0, ${lzeros} - left.length)+left;\n\tif (left.length < ${lfills}) left = spaces.substr(0, 6*(${lfills} - left.length))+left;\n\tif (${comma}) {\n\t\tvar buf = [];\n\t\tvar start = 3;\n\t\twhile (lsize > start) { buf.push(left.substr(left.length-start,3)); start+=3; }\n\t\tvar last = left.substr(0,left.length-start+3);\n\t\tif (last !== \"-\")\n\t\t\tbuf.push(last);\n\t\telse\n\t\t\tbuf.push(\"-\"+buf.pop());\n\n\t\tleft = buf.reverse().join(\"${delimiters.groupSign}\");\n\t}\n\tif (right){\n\t\tvar zpoint = right.length-1;\n\t\twhile (zpoint >= ${rzeros}){\n\t\t\tif (right[zpoint] !== \"0\"){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tzpoint--;\n\t\t}\n\n\t\tif (zpoint <= right.length)\n\t\t\tright = right.substr(0, zpoint+1);\n\n\t\tif (right.length < ${rfills}){\n\t\t\tright += spaces.substr(0, 6*(${rfills} - right.length));\n\t\t}\n\t}\n\tvar fmt = left+(right?\"${decimal}\":\"\")+right;\n\t`;\n\n\treturn str+\"}\\n\";\n}\n\nfunction updateDecimals(fmt, inc, val){\n\tlet parsed = parseFormat(fmt);\n\tfor(let i = 0; i < parsed.length; i++){\n\t\tif(parsed[i].decimals){\n\t\t\tif(inc>0)\n\t\t\t\tparsed[i].right.placeholders += Array(inc+1).join(\"0\");\n\t\t\telse\n\t\t\t\tparsed[i].right.placeholders = parsed[i].right.placeholders.slice(0, inc);\n\t\t}\n\t\telse{\n\t\t\tconst withoutText = !parsed[i].left.text && !parsed[i].right.text;\n\t\t\tconst withoutPlaceholders = !parsed[i].left.placeholders && !parsed[i].right.placeholders;\n\t\t\t//check if cell value have decimals (not cell format)\n\t\t\tif(inc < 0 && withoutText && withoutPlaceholders && webix.rules.isNumber(val) && val.indexOf(\".\") > -1){\n\t\t\t\tparsed[i].left.placeholders = \"0\";\n\t\t\t\tparsed[i].right.placeholders = Array(val.split(\".\")[1].length).join(Array(inc+1).join(\"0\"));\n\t\t\t}\n\t\t\t//ignore text\n\t\t\telse if(inc > 0 && (parsed[i].left.placeholders || withoutText)){\n\t\t\t\tparsed[i].left.placeholders = parsed[i].left.placeholders || \"0\";\n\t\t\t\tparsed[i].right.placeholders = Array(inc+1).join(\"0\");\n\t\t\t\tparsed[i].decimals = true;\n\t\t\t}\n\t\t}\n\t\tparsed[i].decimals = parsed[i].right.placeholders.length > 0;\n\t}\n\n\treturn serializeFormat(parsed);\n}\n\nexport function changeAreaDecimals(view, inc, row, column){\n\tlet cells = getCells(view, row, column);\n\tif(cells.length == 0)\n\t\treturn;\n\n\tconst item = view.$$(\"cells\").getItem(cells[0].row)[cells[0].column];\n\tconst firstValue = item ? item.toString() : item;\n\tconst firstStyle = view.getStyle(cells[0].row, cells[0].column);\n\n\tif(webix.rules.isNumber(firstValue) || (firstStyle && firstStyle.props.format)){\n\t\tgroup.set(function(){\n\t\t\tfor(let i = 0; i < cells.length; i++)\n\t\t\t\tchangeCellDecimals(view, inc, cells[i]);\n\t\t});\n\t\tview.refresh();\n\n\t\tlet format = view.getStyle(cells[0].row, cells[0].column).props.format || \"common\";\n\t\tformat = isCustom(format) ? \"custom\" : format;\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"format\", value:format}]);\n\t}\n}\n\nexport function changeCellDecimals(view, inc, cell){\n\tlet format;\n\tconst style = view.getStyle(cell.row, cell.column);\n\tlet value = view.$$(\"cells\").getItem(cell.row)[cell.column];\n\tvalue = value ? value.toString() : \"\";\n\n\tif(style && style.props.format){\n\t\tconst name = style.props.format;\n\t\tformat = webix.copy({values:formatHelpers[name].values, format:getFormatSource(name)});\n\t\tformat.format = updateDecimals(format, inc, value);\n\n\t\tif(format.values && format.values.hasOwnProperty(\"zeros\"))\n\t\t\tformat.values.zeros = Math.max(format.values.zeros+inc, 0);\n\t}\n\t//add format for cell without format\n\telse{\n\t\tconst zeros = webix.rules.isNumber(value) && value.split(\".\")[1] ? Math.max(value.split(\".\")[1].length+inc, 0) : Math.max(inc, 0);\n\n\t\tformat = {values:{negative:1, zeros:zeros, separator:0, type:\"int\"}};\n\t\tformat.format = serializeFormat(formToValues(format.values.type, format.values));\n\t}\n\taddFormat(view, cell.row, cell.column, format.format, format.values);\n}\n\nexport function isCustom(name){\n\treturn name != \"common\" && (name.indexOf(\"fmt\") != -1 || formatHelpers[name].values.type == \"custom\");\n}\n\nexport function formToValues(type, formValues){\n\tif(type == \"string\")\n\t\treturn [{left:{text:\"@\"}}];\n\tif(formValues.date)\n\t\treturn [{left:{text:formValues.date}}];\n\n\tlet values = [{condition:\">=0\", left:{text:\"\"},right:{text:\"\"}}, {condition:\"<0\", left:{text:\"\"}, right:{text:\"\"}}];\n\twebix.extend(values, getDelimiters(type));\n\tvalues[0].right.placeholders = values[1].right.placeholders = formValues.zeros ? Array(formValues.zeros + 1).join(\"0\") : \"\";\n\tvalues[0].separator = values[1].separator = formValues.separator && type != \"percent\";\n\tvalues[0].left.placeholders = values[1].left.placeholders = values[0].separator ? \"#\"+values.groupSign +\"0\" : \"0\";\n\tvalues[0].decimals = values[1].decimals = formValues.zeros ? true : false;\n\tvalues[1].color = formValues.negative != 1 ? \"red\" : \"\";\n\tvalues[1].left.text += formValues.negative < 3 ? \"-\" : \"\";\n\tif(formValues.negative == 4)\n\t\tvalues[1].left.text += \"(\";\n\n\tif(type === \"percent\")\n\t\tvalues[0].right.text = values[1].right.text += \"%\";\n\telse if(type === \"price\"){\n\t\tconst symbol = formatHelpers.price.values.symbol;\n\t\tconst right = symbol.indexOf(\" \") == 0;\n\n\t\tvalues[1][right?\"right\":\"left\"].text += symbol;\n\t\tvalues[0][right?\"right\":\"left\"].text += symbol;\n\t}\n\n\tif(formValues.negative == 4)\n\t\tvalues[1].right.text += \")\";\n\n\treturn values;\n}\n\nexport function serializeFormat(values, toExcel){\n\tlet fmt = \"\";\n\tfor(let i = 0; i < values.length; i++){\n\t\tif(values[i].condition)\n\t\t\tfmt += \"[\"+values[i].condition+\"]\";\n\t\tif(values[i].color)\n\t\t\tfmt += \"[\"+values[i].color+\"]\";\n\n\t\tif(values[i].left){\n\t\t\tif(values[i].left.text){\n\t\t\t\tlet leftText = values[i].left.text;\n\t\t\t\tfmt += leftText;\n\t\t\t}\n\t\t\tif(values[i].left.placeholders){\n\t\t\t\tlet leftPlaceholders = values[i].left.placeholders;\n\t\t\t\tfmt += toExcel ? leftPlaceholders.replace(values.groupSign, \",\") : leftPlaceholders;\n\t\t\t}\n\t\t}\n\n\t\tif(values[i].decimals)\n\t\t\tfmt += toExcel ? \".\" : values.decimalSign;\n\n\t\tif(values[i].right){\n\t\t\tif(values[i].right.placeholders)\n\t\t\t\tfmt += values[i].right.placeholders;\n\t\t\tif(values[i].right.text){\n\t\t\t\tlet rightText = values[i].right.text;\n\n\t\t\t\tfmt += rightText;\n\t\t\t}\n\t\t}\n\t\tif(i != values.length - 1)\n\t\t\tfmt += \";\";\n\t}\n\treturn fmt;\n}\n\nfunction parseFormat(fmt){\n\tconst fmtParts = fmt.format.split(\";\");\n\tlet values = [];\n\n\tfor(let i = 0; i < fmtParts.length; i++){\n\t\tlet separated = separateFmt(fmtParts[i]);\n\t\tvalues[i] = {color:separated.color, condition:separated.condition, left:{}, right:{}};\n\n\t\tconst format = separated.fmt;\n\n\t\tvalues.groupSign = fmt.values.groupSign;\n\t\tvalues.decimalSign = fmt.values.decimalSign;\n\n\t\tif(format.indexOf(values.groupSign) > -1)\n\t\t\tvalues[i].separator = true;\n\n\t\tconst sepFmtParts = getParts(format, values.decimalSign);\n\n\t\tlet left = sepFmtParts[0];\n\t\tlet right = sepFmtParts[1] || \"\";\n\n\t\tif(sepFmtParts[1])\n\t\t\tvalues[i].decimals = true;\n\n\t\tleft = getFmtPartValues(left, \"left\", values.groupSign);\n\t\tright = getFmtPartValues(right, \"right\", values.groupSign);\n\n\t\tvalues[i].left = {\n\t\t\ttext: left.leftText,\n\t\t\tplaceholders: left.placeholders\n\t\t};\n\n\t\tvalues[i].right = {\n\t\t\ttext: left.rightText + right.rightText,\n\t\t\tplaceholders: right.placeholders\n\t\t};\n\t}\n\treturn values;\n}\n\nfunction getFmtPartValues(fmtPart, type, groupSign){\n\tlet firstPlaceholder;\n\tif(type == \"left\"){\n\t\tfirstPlaceholder = fmtPart.match(/[#?0]/);\n\t\tfirstPlaceholder = firstPlaceholder ? firstPlaceholder.index : Infinity;\n\t}\n\n\tlet leftText = \"\";\n\tlet rightText = \"\";\n\tlet placeholders = \"\";\n\tfor(let k = 0; k < fmtPart.length; k++){\n\t\tif(!placeholder(fmtPart[k])){\n\t\t\tif(fmtPart[k] == groupSign && placeholder(fmtPart[k+1]) && placeholder(fmtPart[k-1])){\n\t\t\t\tplaceholders += fmtPart[k];\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(type == \"left\")\n\t\t\t\tif(k < firstPlaceholder){\n\t\t\t\t\tleftText += fmtPart[k];\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\trightText += fmtPart[k];\n\t\t}\n\t\telse\n\t\t\tplaceholders += fmtPart[k];\n\t}\n\treturn {leftText: leftText, rightText: rightText, placeholders: placeholders};\n}\n\nfunction separateFmt(line){\n\tlet color = \"\";\n\tlet check = \"\";\n\tlet start = line.indexOf(\"[\");\n\tif (start !== -1){\n\t\tif (line[1].match(/[><=]/)){\n\t\t\tlet end = line.indexOf(\"]\");\n\t\t\tcheck = line.substr(start+1, end-start-1);\n\t\t\tline = line.substr(end+1);\n\t\t}\n\t}\n\n\tstart = line.indexOf(\"[\");\n\tif (start !== -1){\n\t\tlet end = line.indexOf(\"]\");\n\t\tcolor = line.substr(start+1, end-start-1);\n\t\tline = line.substr(end+1);\n\t}\n\treturn {condition:check, color:color, fmt:line};\n}\n\nfunction getCells(view, row, column){\n\tif(row && column){\n\t\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\t\tlet cells = [];\n\t\t\tfor (let r = row.row; r<=column.row; r++)\n\t\t\t\tfor (let c = row.column; c<=column.column; c++)\n\t\t\t\t\tcells.push({row: r, column: c});\n\t\t\treturn cells;\n\t\t}\n\t\telse\n\t\t\treturn [{row: row, column: column}];\n\t}\n\telse\n\t\treturn view.getSelectedId(true);\n}\n\nfunction placeholder(val){\n\treturn val === \"0\" || val === \"#\" || val === \"?\";\n}\n\nfunction getParts(str, decimal){\n\t// it is nessesary to use \"/\" before decimal to escape regex special characters\n\tconst match = str.match(\"[#?0][/\"+decimal+\"][#?0]\");\n\tif(match)\n\t\treturn [str.substring(0, match.index+1), str.substring(match.index+2)];\n\telse\n\t\treturn [str];\n}\n\n//simple check: take into account only first condition\nexport function checkFormat(format, type, checkTime){\n\tformat = format && format.fmt ? format.fmt : getFormatSource(format);\n\tif(!format) return;\n\tconst parts = splitFormat(format);\n\tconst separated = separateFmt(parts[0]).fmt;\n\n\tlet quot;\n\tif(separated)\n\t\tfor(let i = 0; i < separated.length; i++){\n\t\t\tif(separated[i] == \"\\\"\")\n\t\t\t\tquot = !quot;\n\t\t\tif(quot) continue;\n\n\t\t\tif(type == \"date\" && /[a-zA-Z]/.test(separated)){\n\t\t\t\tconst datePart = excelDateToWebix(separated.substr(i), \"date\");\n\t\t\t\tif(datePart){\n\t\t\t\t\tif(checkTime){\n\t\t\t\t\t\tif(datePart.type == \"time\")\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(type == \"string\" && separated[i] == \"@\")\n\t\t\t\treturn true;\n\t\t}\n}\n\nexport function getFormatName(view, row, col){\n\tconst item = view.getRow(row);\n\treturn item && item.$cellFormat && item.$cellFormat[col];\n}\n\nexport function isDateInvalid(value){\n\treturn value < -99974430.925 || value > 100025569.125;\n}\n\nexport function getDateEditFormat(item, col){\n\tconst formatName = item.$cellFormat[col];\n\tconst locale = webix.i18n.spreadsheet.formats;\n\tconst isTime = checkFormat(formatName, \"date\", true);\n\n\treturn webix.Date.dateToStr( locale[isTime ? \"parseDateTime\" : \"parseDate\"] );\n}","import {getFormatName, getFormatSource} from \"../operations/formats\";\n\nfunction isChar(char){\n\tvar code = char.charCodeAt(0);\n\t// #(35) - errors like #REF!, $(36) - absolute cell reference, a-zA-Z(65-122) - chars\n\treturn (code>=65 && code<=122) || code == 35 || code == 36;\n}\nfunction isNumber(char){\n\tvar code = char.charCodeAt(0);\n\treturn code>=48 && code<=57;\n}\n\nfunction getWord(formula, i, passive){\n\tvar max = formula.length;\n\tvar sheet = passive;\n\tvar quotes = false;\n\n\tfor(var j=i; j<max; j++){\n\t\tvar key =  formula[j];\n\t\tif (key === \"'\"){\n\t\t\tquotes = !quotes;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!quotes){\n\t\t\tif (key == \"!\"){\n\t\t\t\tif(formula[i] == \"#\") //error\n\t\t\t\t\tcontinue;\n\t\t\t\telse{\n\t\t\t\t\t//multi-sheet math\n\t\t\t\t\tsheet = formula.substr(i, j-i);\n\t\t\t\t\tif (sheet[0] === \"'\")\n\t\t\t\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\t\t\t\ti=j+1;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (!isChar(key) && !isNumber(key)){\n\t\t\t\treturn [formula.substr(i, j-i), j, i, sheet];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn [formula.substr(i), j, i, sheet];\n}\n\nvar operand = /^[A-Z$]+[0-9]+$/;\nfunction isPosition(text){\n\treturn operand.test(text);\n}\n\nexport function position(word){\n\tvar row = 0, sum = 0, x = 1, mode = 1, flags = 0;  \n\tvar chars = false;\n\n\tfor (var j =word.length-1; j>=0; j--){\n\t\tvar key = word[j].charCodeAt(0);\n\t\tif (key === 36) {\n\t\t\tflags = flags+mode;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (key < 58){\n\t\t\t//numeric\n\t\t\tsum += (key - 48)*x;\n\t\t\tx *= 10;\n\t\t} else {\n\t\t\tif (!chars){\n\t\t\t\tx = 1; row = sum; sum = 0; chars = true; mode += 1;\n\t\t\t}\n\t\t\t//alpha\n\t\t\tsum += (key - 64)*x;\n\t\t\tx*=26;\n\t\t}\n\t}\n\n\t/*\n\t\t$X$Y => flags = 3\n\t\t$XY  => flags = 2\n\t\tX$Y  => flags = 1\n\t\tXY   => flags = 0\n\t*/\n\treturn [row, sum, flags];\n}\n\nfunction errorCode(e){\n\treturn `this.e(\"${e}\")`;\n}\n\nfunction operandCode(deps, word, sheet){\n\tlet [r,c] = position(word);\n\n\tif (sheet !== \"\"){\n\t\tdeps.push([r,c,r,c,sheet]);\n\t\treturn `this.vs(\"${sheet}\",${r},${c})`;\n\t} else {\n\t\tdeps.push([r,c,r,c,\"\"]);\n\t\treturn `this.v(${r},${c})`;\n\t}\n}\n\nfunction methodCode(word){\n\treturn `this.m.${word}`;\n}\n\nfunction namedRangeCode(deps, view, word, sheet){\n\tvar code  = view.ranges.getCode(word, sheet);\n\tif(!code) return \"\";\n\n\tvar sheetInd = code.indexOf(\"!\");\n\tif (sheetInd !== -1){\n\t\tsheet = code.substr(0, sheetInd);\n\t\tif (sheet[0] === \"'\")\n\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\tcode = code.substr(sheetInd+1);\n\t}\n\n\tlet [a,b] = code.split(\":\");\n\treturn rangeCode(deps, a, b, sheet);\n}\n\nfunction templateCode(word){\n\treturn `this.p.${word}`;\n}\n\nfunction rangeCode(deps, a, b, sheet){\n\tlet [r1,c1] = position(a);\n\tlet [r2,c2] = position(b);\n\n\tif (r1>r2) { let t=r1; r1=r2; r2=t; }\n\tif (c1>c2) { let t=c1; c1=c2; c2=t; }\n\t\n\tif (sheet === \"\"){\n\t\tdeps.push([r1,c1,r2,c2,\"\"]);\n\t\treturn `this.r(${r1},${c1},${r2},${c2})`;\n\t} else {\n\t\tdeps.push([r1,c1,r2,c2, sheet]);\n\t\treturn `this.rs(\"${sheet}\",${r1},${c1},${r2},${c2})`;\n\t}\n}\n\nexport function split(formula, crosssheet, ranges){\n\tvar lines = [];\n\tvar index = 0;\n\tvar quotes = false, ph = false;\n\tfor (var i = formula[i] === \"=\" ? 1 : 0; i < formula.length; i++){\n\t\tvar key = formula[i];\n\t\tif (key == \"\\\"\"){\n\t\t\tquotes = !quotes;\n\t\t} else if (!quotes){\n\t\t\tif (key == \"{\" && formula[i+1] == \"{\"){\n\t\t\t\tph = true;\n\t\t\t} else if (key == \"}\" && formula[i+1] == \"}\"){\n\t\t\t\tph = false;\n\t\t\t} else if (!ph){\n\t\t\t\tconst escaped = key === \"'\";\n\t\t\t\tif (escaped || isChar(key)){\n\t\t\t\t\tlet [word, end, ,sheet] = getWord(formula, i, \"\");\n\t\t\t\t\tlet next = end - 1;\n\t\t\t\t\tlet value;\n\t\t\t\t\tif (!sheet || (!crosssheet && sheet)){\n\t\t\t\t\t\tif(sheet){\n\t\t\t\t\t\t\t// 'sheet'! - 3 extra symbols, sheet! - 1 extra symbol\n\t\t\t\t\t\t\ti += sheet.length + (escaped ? 3 : 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (formula[next+1] !== \"(\" && (isPosition(word) || (ranges && ranges[word]))){\n\t\t\t\t\t\t\tvalue = crosssheet ? word : position(word);\n\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if(crosssheet){\n\t\t\t\t\t\tvalue = [sheet, word, escaped];\n\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t}\n\t\t\t\t\ti = next;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (index!=formula.length)\n\t\tlines.push(formula.substr(index));\n\treturn lines;\n}\n\nfunction pushLine(lines, formula, i, index, value){\n\tif (i!==0)\n\t\tlines.push(formula.substr(index, i-index));\n\tlines.push(value);\n}\n\nexport function parse(formula, view, passive = \"\"){\n\tvar code =\"return \";\n\tvar deps = [];\n\n\tvar quotes = false;\n\tvar pair = \"\", pairsheet = \"\";\n\n\tif (formula[0] != \"=\") return false;\n\n\tfor (var i = 1; i < formula.length; i++){\n\t\tvar key = formula[i];\n\n\t\tif (key == \"\\\"\")\n\t\t\tquotes = !quotes;\n\t\telse if (key == \"{\" && formula[i+1] == \"{\"){\n\t\t\tlet [word, end] = getWord(formula, i+2);\n\t\t\ti = end + 1;\n\t\t\tcode += templateCode(word);\n\t\t\tcontinue;\n\t\t}\n\t\telse if (!quotes && (key == \"'\" || isChar(key))){\n\t\t\tlet [rawword, end, start, sheet] = getWord(formula, i, passive);\n\n\t\t\t//lower case formulas, fix them\n\t\t\tlet word = rawword.toUpperCase();\n\n\t\t\ti = end - 1;\n\n\t\t\t//errors like #REF!\n\t\t\tif(word[0] == \"#\"){\n\t\t\t\tcode += errorCode(word);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse if (formula[i+1] == \"(\"){\n\t\t\t\tcode += methodCode(word);\n\t\t\t}\n\t\t\telse if (isPosition(word)){\n\t\t\t\tif (formula[i+1] == \":\"){\n\t\t\t\t\tpair = word; pairsheet = sheet;\n\t\t\t\t\ti++;\n\t\t\t\t} else {\n\t\t\t\t\tif (pair !== \"\"){\n\t\t\t\t\t\tcode += rangeCode(deps, pair, word, pairsheet);\n\t\t\t\t\t\tpair = \"\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst cell = operandCode(deps, word, sheet);\n\t\t\t\t\t\tif(formula[end] == \"+\")\n\t\t\t\t\t\t\tcode += `(isNaN(${cell} * 1) ? ${cell} : ${cell} * 1)`;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tcode += cell;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet range = namedRangeCode(deps, view, word, sheet);\n\t\t\t\t//we have some error word in a formula\n\t\t\t\t//break from loop to skip formula updating\n\t\t\t\tif (range == \"\"){\n\t\t\t\t\tcode += errorCode(\"#REF!\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcode += range;\n\t\t\t}\n\n\t\t\t//operator, or range, or parameter\n\t\t\tif (word !== rawword){\n\t\t\t\tformula = formula.substr(0, start)+word+formula.substr(end);\n\t\t\t}\n\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!quotes){\n\t\t\t//special handling for & operator, string concat\n\t\t\tif (key === \"&\" && formula[i+1] !== \"&\")\n\t\t\t\tcode += \"+\\\"\\\"+\";\n\t\t\t//convert <> to !=\n\t\t\telse if (key === \"<\" && formula[i+1] === \">\"){\n\t\t\t\tcode += \"!=\";\n\t\t\t\ti++;\n\t\t\t//convert = to ==\n\t\t\t} else if (key === \"=\" && formula[i-1] !== \"<\" && formula[i-1] !== \">\")\n\t\t\t\tcode += \"==\";\n\t\t\telse\n\t\t\t\tcode += key;\n\t\t} else\n\t\t\tcode += key;\n\t}\n\n\n\treturn { code: code+\";\", triggers:deps, text: formula };\n}\n\nexport function getMathFormat(view, value){\n\tlet level = 0;\n\tlet blockLevel;\n\tconst ranges = view.ranges._ranges;\n\tconst parts = split(value, true, ranges);\n\n\tfor(let i = 0; i < parts.length; i++){\n\t\t// parts[i] can contain numbers, math operators, formulas, etc.\n\t\tif(i%2 === 0){\n\t\t\t// check formulas and round brackets which are not in quotes\n\t\t\tconst methods = parts[i].match(/(([a-zA-Z]*\\()|\\))(?=(?:[^\"]|\"[^\"]*\")*$)/g);\n\t\t\tif(methods)\n\t\t\t\tmethods.forEach(part => {\n\t\t\t\t\tif(part.indexOf(\"(\") > -1){\n\t\t\t\t\t\tlevel++;\n\t\t\t\t\t\t// some methods block format addition (like count,odd,etc.)\n\t\t\t\t\t\tconst safeMethods = /^(SUM|AVERAGE|MAX|MIN|INT|ROUND|ROUNDDOWN|ROUNDUP|TRUNC)?\\($/gi;\n\t\t\t\t\t\tif(!blockLevel && !safeMethods.test(part))\n\t\t\t\t\t\t\tblockLevel = level;\n\t\t\t\t\t}\n\t\t\t\t\telse if(--level < blockLevel)\n\t\t\t\t\t\tblockLevel = null;\n\t\t\t\t});\n\t\t}\n\t\t// parts[i] can be named range, cell from the active / non-active sheet\n\t\telse if(!blockLevel){\n\t\t\tif(webix.isArray(parts[i])){\n\t\t\t\tif(parts[i][0] == view.getActiveSheet())\n\t\t\t\t\tparts[i] = parts[i][1];\n\t\t\t\telse\n\t\t\t\t\tcontinue; // ignore non-active sheets\n\t\t\t}\n\n\t\t\t// if range - check first cell position\n\t\t\tconst cell = /^[A-Za-z]+$/.test(parts[i]) ? position(ranges[parts[i]].split(\":\")[0]) : position(parts[i]);\n\t\t\tconst name = getFormatName(view, cell[0], cell[1]);\n\n\t\t\t// first cell with number format\n\t\t\tif(name)\n\t\t\t\treturn {fmt: getFormatSource(name)};\n\t\t}\n\t}\n}","webix.protoUI({\n\tname: \"ssheet-button\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 40\n\t},\n\t$init: function(config){\n\t\tthis.$view.className += \" webix_ssheet_button\"+(config.arrow?\" webix_ssheet_button_menu\":\"\");\n\t\tif(config.label || config.icon){\n\t\t\tlet icon = (config.icon||config.name),\n\t\t\t\ttext = config.label||\"\";\n\t\t\tif(config.arrow)\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon_arrow webix_icon wxi-menu-down'></span>\";\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+icon+\"'></span> \"+text;\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nwebix.protoUI({\n\tname: \"ssheet-button-icon-top\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 70,\n\t\theight: 70\n\t},\n\t$init: function(config){\n\t\tthis.$view.className += \" ssheet_button_icon_top\";\n\t\tif(config.label) {\n\t\t\tlet icon = (config.icon || config.name||\"\"),\n\t\t\t\ttext = config.label;\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + icon + \"'></span><br/>\";\n\t\t\tconfig.label += \"<span class='ssheet_button_icon_top_text'>\"+text+\"</span>\";\n\t\t\tif (config.arrow)\n\t\t\t\tconfig.label += \"<br/><span class='ssheet_button_icon_top_arrow webix_icon wxi-menu-down'></span>\";\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nfunction getPopupConfig(options){\n\treturn {\n\t\tview: \"ssheet-suggest\",\n\t\tcss: \"webix_ssheet_suggest\",\n\t\tautowidth:true,\n\t\ttemplate: function(obj){\n\t\t\tvar text = \"\";\n\t\t\tif(obj.icon)\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + obj.icon + \"'></span> \";\n\t\t\ttext += obj.value || webix.i18n.spreadsheet.menus[obj.id] || obj.id;\n\t\t\treturn text;\n\t\t},\n\t\tdata: options,\n\t\ton:{\n\t\t\tonItemClick: function(id){\n\t\t\t\tvar button = this.config.master;\n\t\t\t\tif(button){\n\t\t\t\t\tlet view = webix.$$(button).getTopParentView();\n\t\t\t\t\tvar params = [this.getItem(id)];\n\t\t\t\t\tif(webix.$$(button).config.area){\n\t\t\t\t\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\t\t\t\t\tif(area)\n\t\t\t\t\t\t\tparams = params.concat([area.start,area.end]);\n\t\t\t\t\t}\n\t\t\t\t\tview.callEvent(\"onCommand\",params);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}","import \"./suggest_formula\";\nimport {split, position} from \"../math/parser\";\n\nwebix.protoUI({\n\tname: \"live-editor\",\n\t$cssName:\"texthighlight\",\n\t$init(config){\n\t\tconfig.suggest = {\n\t\t\tview: \"suggest-formula\",\n\t\t\tdata: config.suggestData\n\t\t};\n\t\tconfig.highlight = this.highlight;\n\n\t\tthis._highlightedCells = {};\n\t\tthis.$view.className += \" webix_ssheet_formula\";\n\n\t\tthis.attachEvent(\"onKeyPress\", (code, e) => {\n\t\t\tdelete this._update_range;\n\t\t\tif(code === 13) {\n\t\t\t\t//ignore Enter key if it was pressed to select some value from suggest\n\t\t\t\tif ((new Date() - (this._last_value_set || 0)) > 300){\n\t\t\t\t\tthis.showActiveSheet();\n\t\t\t\t\tthis.updateCellValue();\n\t\t\t\t\t//we have 'enter' hot key to activate editor\n\t\t\t\t\twebix.delay(()=>{\n\t\t\t\t\t\tthis.getTopParentView()._table.moveSelection(\"down\");\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\twebix.html.preventEvent(e);\n\t\t\t}\n\t\t});\n\n\t\tthis.attachEvent(\"onAfterRender\", function(){\n\t\t\twebix.eventRemove(this.keydownEv);\n\n\t\t\tthis.keydownEv = webix.event(this.getInputNode(), \"keydown\", e => {\n\t\t\t\tthis.endEdit(e);\n\t\t\t});\n\t\t});\n\t},\n\thighlight(value){\n\t\tlet html = \"\";\n\t\tconst master = this.getTopParentView();\n\t\tconst escapeText = webix.template.escape;\n\n\t\tfor(let area in this._highlightedCells){\n\t\t\tconst cells = this._highlightedCells[area];\n\t\t\tthis.changeCellCss(cells[0], cells[1], cells[2], true);\n\t\t}\n\t\tthis._highlightedCells = {};\n\n\t\t//value can be null\n\t\tif(value && value[0]==\"=\"){\n\t\t\tconst ranges = master.ranges._ranges;\n\t\t\tconst parts = split(value, true, ranges);\n\t\t\tconst sheet = master.getActiveSheet();\n\n\t\t\tlet colorIndex = 1;\n\n\t\t\tfor(let i = 0; i < parts.length; i++){\n\t\t\t\tif(i%2 === 0)\n\t\t\t\t\thtml += escapeText(parts[i]);\n\t\t\t\telse{\n\t\t\t\t\tconst crossheet = webix.isArray(parts[i]);\n\t\t\t\t\tconst cellSheet = crossheet ? this.prepareSheet(parts[i][0], parts[i][2]) : \"\";\n\t\t\t\t\tconst activeMath = this._activeMath;\n\n\t\t\t\t\tconst activeSheet = !crossheet && (!activeMath || activeMath == sheet);\n\t\t\t\t\tlet cell = position(crossheet ? parts[i][1] : parts[i]);\n\t\t\t\t\tconst cellText = crossheet ? cellSheet+parts[i][1] : parts[i];\n\n\t\t\t\t\tconst rangeName = /^[A-Za-z]+$/.test(parts[i]);\n\t\t\t\t\tif(activeSheet || (crossheet && parts[i][0] == sheet)){\n\t\t\t\t\t\tlet repeatedColor;\n\t\t\t\t\t\t//range\n\t\t\t\t\t\tif((parts[i+1] == \":\" && parts[i+2]) || rangeName){\n\t\t\t\t\t\t\tlet nextCell, nextCellText;\n\n\t\t\t\t\t\t\tif(rangeName){\n\t\t\t\t\t\t\t\tconst cells = ranges[parts[i]].split(\":\");\n\t\t\t\t\t\t\t\tcell = position(cells[0]);\n\t\t\t\t\t\t\t\tnextCell = position(cells[1]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tnextCell = position(crossheet ? parts[i+2][1] : parts[i+2]);\n\t\t\t\t\t\t\t\tnextCellText = crossheet ? cellSheet+parts[i+2][1] : parts[i+2];\n\t\t\t\t\t\t\t\ti+=2;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\trepeatedColor = this.setColor(cell[0], cell[1], nextCell[0], nextCell[1], colorIndex);\n\t\t\t\t\t\t\thtml += `<span class=\"webix_ssheet_highlight_color_${repeatedColor||colorIndex}\">${rangeName ? parts[i] : cellText+\":\"+nextCellText}</span>`;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//cell\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\trepeatedColor = this.setColor(cell[0], cell[1], cell[0], cell[1], colorIndex);\n\t\t\t\t\t\t\thtml += `<span class=\"webix_ssheet_highlight_color_${repeatedColor||colorIndex}\">${cellText}</span>`;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst colors = 7;\n\t\t\t\t\t\tif(!repeatedColor)\n\t\t\t\t\t\t\tcolorIndex += colorIndex == colors ? -1*(colors-1) : 1;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\thtml += cellText;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\thtml = escapeText(value);\n\n\t\tmaster.$$(\"cells\").refresh();\n\n\t\tif(document.activeElement == this.getInputNode())\n\t\t\tthis.paintValue();\n\t\treturn html;\n\t},\n\tshowActiveSheet(){\n\t\tconst master = this.getTopParentView();\n\n\t\tif(this._activeMath){\n\t\t\tif(this._activeMath != master.getActiveSheet()){\n\t\t\t\tconst val = this.getValue();\n\n\t\t\t\tconst cell = this.config.activeCell;\n\t\t\t\tthis.define({activeCell:null});\n\n\t\t\t\tmaster.showSheet(this._activeMath);\n\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tmaster._table.select(cell.row, cell.column);\n\t\t\t\t\tthis.setValue(val);\n\t\t\t\t\tthis.updateCellValue();\n\t\t\t\t});\n\t\t\t}\n\t\t\tdelete this._activeMath;\n\t\t}\n\t},\n\tchangeCellCss(row, col, index, remove){\n\t\tconst css = `webix_ssheet_highlight_background_${index}`;\n\t\tfor (let r = row.start; r <= row.end; r++)\n\t\t\tfor (let c = col.start; c <=  col.end; c++)\n\t\t\t\tthis.getTopParentView().$$(\"cells\")[remove?\"removeCellCss\":\"addCellCss\"](r, c, css, true);\n\t},\n\tendEdit(e){\n\t\tlet code = e.which || e.keyCode;\n\n\t\t//if it is a formula - force user to finish it by click outside or 'enter'\n\t\tif(code == 9 || (code>36 && code<41 && this.getValue().charAt(0)!==\"=\")){\n\t\t\tlet dir = (code == 40)?\"down\":(code === 39?\"right\":(code ==37?\"left\":\"up\"));\n\t\t\tif (code === 9)\n\t\t\t\tdir = \"right\";\n\n\t\t\tthis.updateCellValue();\n\t\t\tthis.getTopParentView()._table.moveSelection(dir);\n\t\t}\n\t},\n\tpaintValue(){\n\t\tlet master = this.getTopParentView();\n\t\tif(!this._activeMath || this._activeMath == master.getActiveSheet()){\n\t\t\tlet cell = this.config.activeCell;\n\t\t\tlet node = master._table.getItemNode(cell);\n\t\t\tif(cell && node) \n\t\t\t\tnode.innerHTML = `<div>${webix.template.escape(this.getValue())}</div>`;\n\t\t}\n\t},\n\tupdateCellValue() {\n\t\tlet newv = this.getValue();\n\t\tlet master = this.getTopParentView();\n\t\tlet cell = this.config.activeCell;\n\n\t\tif (!cell)\n\t\t\tthis.setValue(\"\");\n\t\telse{\n\t\t\tlet val = master.getCellValue(cell.row, cell.column);\n\n\t\t\tif(newv != val){\n\t\t\t\tthis.config.value = newv;\n\t\t\t\tmaster.setCellValue(cell.row, cell.column, newv);\n\t\t\t\tmaster.refresh();\n\t\t\t}\n\t\t}\n\n\t\tdelete master.$handleSelection;\n\t},\n\t$setValueHere(value){\n\t\tthis.setValueHere(value);\n\t},\n\tsetValueHere(value) {\n\t\tthis._last_value_set = new Date();\n\n\t\tconst formula = this.getValue();\n\t\tif(formula && formula.charAt(0)===\"=\"){\n\t\t\tconst cursor = this.getInputNode().selectionStart;\n\t\t\tlet str1 = formula.substring(0, cursor);\n\t\t\tlet str2 = formula.substring(cursor);\n\n\t\t\tconst updatedStr = /[a-zA-Z]+\\(?$/.test(str1) ? str1.replace(/[a-zA-Z]+\\(?$/, value) : str1 + value;\n\n\t\t\t//suggest called via up/down key\n\t\t\tstr1 = updatedStr + (str2[0] == \"(\" ? \"\" : \"(\");\n\n\t\t\tthis.setValue(str1 + str2);\n\t\t\tthis.getInputNode().setSelectionRange(str1.length, str1.length);\n\t\t}\n\t},\n\texpectRange(){\n\t\tlet text = this.getValue().trim();\n\t\tlet last = text.substr(text.length-1,1);\n\t\treturn last.match(/[(,]/);\n\t},\n\texpectOperator(){\n\t\tlet text = this.getValue();\n\t\tconst cursor = this.getInputNode().selectionStart;\n\t\treturn text[0] == \"=\" && text[cursor-1] && text[cursor-1].match(/[+&\\-/*%=(:,]/);\n\t},\n\tsetRange(range, replace){\n\t\tconst cursor = this.getInputNode().selectionStart;\n\t\tconst formula = this.getValue();\n\n\t\tlet str1, str2;\n\n\t\t//check if range was added by click\n\t\tif(replace)\n\t\t\treplace = this._update_range && cursor == this._update_range.pos + this._update_range.len;\n\n\t\tconst lastPos = replace ? this._update_range.pos : cursor;\n\n\t\tstr1 = formula.substring(0, lastPos) + range;\n\t\tstr2 = formula.substring(cursor);\n\n\t\tthis._update_range = {pos: lastPos, len: range.length};\n\n\t\tthis.setValue(str1 + str2);\n\t},\n\tprepareSheet(sheet, escaped){\n\t\tconst condition = webix.isUndefined(escaped) ? sheet.indexOf(\" \") != -1 : escaped;\n\t\treturn (condition ? `'${sheet}'` : sheet) + \"!\";\n\t},\n\tprepareArea(first, second){\n\t\treturn {\n\t\t\tstart: Math.min(first, second),\n\t\t\tend: Math.max(first, second)\n\t\t};\n\t},\n\tsetColor(row1, col1, row2, col2, color){\n\t\tconst row = this.prepareArea(row1, row2);\n\t\tconst col = this.prepareArea(col1, col2);\n\t\tconst index = [row.start, row.end, col.start, col.end].join(\",\");\n\t\tconst coloredArea = this._highlightedCells[index];\n\n\t\tif(!coloredArea){\n\t\t\tthis._highlightedCells[index] = [row, col, color];\n\t\t\tthis.changeCellCss(row, col, color);\n\t\t}\n\t\telse\n\t\t\treturn coloredArea[2];\n\t}\n}, webix.ui.texthighlight);","webix.protoUI({\n\tname: \"ssheet-separator\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_toolbar_spacer\",\n\t\ttemplate: \" \",\n\t\twidth: 1,\n\t\tborderless: true\n\t}\n},webix.ui.view);","webix.protoUI({\n\tname: \"sheets\",\n\tdefaults:{\n\t\tlayout: \"x\",\n\t\tborderless: true,\n\t\tcss:\"ssheet_list_sheets\",\n\t\tselect: true,\n\t\tdrag: \"order\",\n\t\tdragscroll:\"x\",\n\t\tscroll:false\n\t}\n},webix.EditAbility,webix.ui.list);","// toolbar: toogle button\nwebix.protoUI({\n\t$cssName: \"toggle\",\n\tname:\"ssheet-toggle\",\n\ttoggle:function(){\n\t\tvar value = this.getValue() == this.config.onValue?true:false;\n\t\tthis.setValue(!value);\n\t},\n\t$setValue:function(value){\n\t\tif(value == this.config.offValue)\n\t\t\tvalue = false;\n\t\telse if(value == this.config.onValue)\n\t\t\tvalue = true;\n\t\twebix.ui.toggle.prototype.$setValue.call(this,value);\n\t},\n\tgetValue:function(){\n\t\tvar config = this.config;\n\t\tvar value = config.value;\n\t\treturn  !value || value==config.offValue?(config.offValue||false):(config.onValue||true);\n\t},\n\tdefaults:{\n\t\ttemplate:function(obj, common){\n\t\t\tvar css = (obj.value === true ||obj.value == obj.onValue) ? \" webix_pressed\" : \"\";\n\t\t\tvar inp = common.$renderInput(obj, common);\n\t\t\treturn \"<div class='webix_el_box\"+css+\"' style='width:\"+obj.awidth+\"px; height:\"+obj.aheight+\"px'>\"+inp+\"</div>\";\n\t\t}\n\t}\n}, webix.ui.toggle);\n\n\n// toolbar: silent toggle button\nwebix.protoUI({\n\tname:\"ssheet-toggle-silent\",\n\t$cssName:\"toggle\",\n\t$allowsClear:false,\n\tsetValue:function(){\n\t\tthis.blockEvent();\n\t\twebix.ui.toggle.prototype.setValue.apply(this, arguments);\n\t\tthis.unblockEvent();\n\t}\n}, webix.ui.toggle);","webix.protoUI({\n\tname: \"ssheet-bar-title\",\n\tdefaults:{\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_subbar_title\";\n\t}\n},webix.ui.template);","webix.protoUI({\n\tname:\"multicheckbox\",\n\tdefaults:{\n\t\tpadding:0,\n\t\ttype:\"clean\",\n\t\tborderless:true,\n\t\telementsConfig:{\n\t\t\tlabelWidth:10\n\t\t}\n\t},\n\t$init:function(config){\n\t\tconfig.rows = [{height:0.000001}];\n\t\tthis.$ready.push(function(){\n\t\t\tthis._initOnChange();\n\t\t});\n\t},\n\t_initOnChange(){\n\t\tthis.attachEvent(\"onChange\", function(newv){\n\t\t\tconst name = this.$eventSource.config.name;\n\n\t\t\tthis.blockEvent();\n\t\t\tif(name == \"$all\"){\n\t\t\t\tfor(let i in this.elements)\n\t\t\t\t\tthis.elements[i].setValue(newv);\n\t\t\t\tif(!newv)\n\t\t\t\t\tthis._getCheckboxes()[0].setValue(1);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tconst count = this.getValue().length;\n\t\t\t\tthis.elements.$all.setValue(count == this._count ? 1 : 0);\n\t\t\t\tif(!count)\n\t\t\t\t\tthis._getCheckboxes()[0].setValue(1);\n\t\t\t}\n\t\t\tthis.unblockEvent();\n\t\t});\n\t},\n\tsetValue:function(value){\n\t\tthis.elements = {};\n\t\tthis._count = value.length;\n\n\t\tif(value.length > 1){\n\t\t\tlet elements = [];\n\t\t\tlet base = [];\n\t\t\tconst maxHeight = 400;\n\n\t\t\tvalue.forEach(sheet => {\n\t\t\t\tbase.push({ view: \"checkbox\", labelRight: sheet.name, name: sheet.name, value: sheet.active});\n\t\t\t});\n\n\t\t\tconst baseHeight = base.length * webix.skin.$active.inputHeight;\n\t\t\tconst scroll = baseHeight > maxHeight;\n\n\t\t\telements.push({\n\t\t\t\tview:\"scrollview\", body:{rows:base},\n\t\t\t\tscroll: scroll,\n\t\t\t\theight: scroll ? maxHeight : baseHeight\n\t\t\t});\n\n\t\t\telements.push({ template:\"<div class='ss_sep_line'></div>\", height:10 });\n\t\t\telements.push({ view:\"checkbox\", labelRight:webix.i18n.spreadsheet.labels[\"export-all-sheets\"], name:\"$all\", value:0 });\n\n\t\t\twebix.ui(elements, this);\n\t\t}\n\t\telse if(this.getChildViews().length > 1){\n\t\t\twebix.ui([{height:0.000001}], this);\n\t\t}\n\t},\n\tgetValue:function(){\n\t\tconst checkboxes = this._getCheckboxes();\n\t\tlet output = [];\n\n\t\t//save order\n\t\tfor(let i = 0; i < checkboxes.length; i++)\n\t\t\tif(checkboxes[i].getValue())\n\t\t\t\toutput.push(checkboxes[i].config.name);\n\n\t\treturn output;\n\t},\n\t_getCheckboxes(){\n\t\tconst scrollview = this.queryView(\"scrollview\");\n\t\treturn scrollview ? scrollview.getBody().getChildViews() : [];\n\t}\n}, webix.ui.form);","webix.protoUI({\n\tname:\"formlist\",\n\tdefaults:{\n\t\tpaddingY: 5,\n\t\theight: 120,\n\t},\n\t$init:function(config){\n\n\t\tconfig.cols = [\n\t\t\t{\n\t\t\t\tcss:\"webix_inp_label\",\n\t\t\t\ttemplate:config.label,\n\t\t\t\twidth:config.labelWidth,\n\t\t\t\tborderless:true\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"list\",\n\t\t\t\tdata:config.data,\n\t\t\t\tcss:config.css,\n\t\t\t\ttemplate:config.template,\n\t\t\t\tselect: true,\n\t\t\t\tscroll:false,\n\t\t\t\tborderless:true,\n\t\t\t\ton:{\n\t\t\t\t\tonSelectChange:()=>{\n\t\t\t\t\t\tthis.getParentView().callEvent(\"onChange\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t},\n\tsetValue:function(value){this.getChildViews()[1].select(value);},\n\tgetValue:function(){return this.getChildViews()[1].getSelectedId();},\n\trefresh: function(){this.getChildViews()[1].refresh();},\n\tfocus:function(){}\n}, webix.ui.layout);","webix.protoUI({\n\tname: \"ssheet-ui\",\n\tdefaults:{\n\t\tmove:true,\n\t\tcss:\"webix_shadow_none webix_ssheet_ui\",\n\t\thead:false,\n\t\tresize:true,\n\t\ttoFront:true,\n\t\tminWidth:50,\n\t\tminHeight:200,\n\t\tescHide:false,\n\t\tautofit:false\n\t},\n\t$init:function(){\n\t\t// prevent block selection\n\t\tthis.$view.setAttribute(\"webixignore\", \"1\");\n\n\t\tthis.$ready.push(function(){\n\t\t\twebix.UIManager.addHotKey(\"delete\", webix.bind(this._removeView, this));\n\t\t\twebix.UIManager.addHotKey(\"backspace\", webix.bind(this._removeView, this));\n\t\t\tthis.getMenu();\n\t\t});\n\t\tthis.attachEvent(\"onDestruct\", function(){\n\t\t\twebix.eventRemove(this._clickEv);\n\t\t\tthis._menu.destructor();\n\t\t});\n\t},\n\tmove_setter:function(value){\n\t\tif (value){\n\t\t\twebix.DragControl.addDrag(this.$view, this);\n\t\t}\n\t\treturn value;\n\t},\n\t$dragPos:function(pos, e){\n\t\tthis.callEvent(\"onViewMove\", [pos, e]);\n\t\treturn pos;\n\t},\n\t$dragCreate:function(object, e){\n\t\tconst trg = e.target;\n\t\tif (!trg.getAttribute || trg.getAttribute(\"webix_disable_drag\") || trg.getAttribute(\"webixignore\"))\n\t\t\treturn;\n\n\t\tthis.getMenu().hide();\n\t\tconst elOffset = webix.html.offset(object);\n\t\tconst elPos = webix.html.pos(e);\n\t\tconst pOffset = webix.html.offset(object.parentNode);\n\t\tconst state = webix.$$(this.config.master).getScrollState();\n\n\t\twebix.DragControl.top = elOffset.y - elPos.y - pOffset.y;\n\t\twebix.DragControl.left = elOffset.x - elPos.x - pOffset.x + state.x;\n\n\t\treturn webix.toNode(this.$view);\n\t},\n\t$dragDestroy:function(node, drag){\n\t\tconst x = this.config.left = parseInt(drag.style.left,10);\n\t\tconst y = this.config.top = parseInt(drag.style.top,10);\n\n\t\twebix.DragControl.top = webix.DragControl.left = 0;\n\n\t\tthis.callEvent(\"onViewMoveEnd\", [x, y]);\n\t\treturn;\n\t},\n\tgetMenu:function(){\n\t\tconst labels = webix.i18n.spreadsheet.labels;\n\t\tif(!this._menu){\n\t\t\tlet data = [\n\t\t\t\t{ value:labels[\"export-view\"], submenu:[\n\t\t\t\t\t{ id:\"pdf\", value:labels[\"export-view-pdf\"] },\n\t\t\t\t\t{ id:\"png\", value:labels[\"export-view-png\"] },\n\t\t\t\t\t{ id:\"excel\", value:labels[\"export-view-excel\"] }\n\t\t\t\t] }\n\t\t\t];\n\n\t\t\tif(!webix.$$(this.config.master).getTopParentView().config.readonly)\n\t\t\t\tdata = [\n\t\t\t\t\t{ id:\"edit\", value:labels[\"edit-view\"] },\n\t\t\t\t\t...data,\n\t\t\t\t\t{ id:\"del\", value:labels[\"remove-view\"] }\n\t\t\t\t];\n\n\t\t\tthis._menu = webix.ui({\n\t\t\t\tview:\"contextmenu\",\n\t\t\t\tsubmenuConfig:{\n\t\t\t\t\texternalUI: this.config.id\n\t\t\t\t},\n\t\t\t\tdata:data,\n\t\t\t\ton:{\n\t\t\t\t\tonMenuItemClick: id => this._menuActions(id),\n\t\t\t\t\tonBeforeShow: () => this._toggleExcel()\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst dots = webix.html.create(\"span\", {\"class\":\"webix_ssheet_view_menu webix_icon wxi-dots\"});\n\t\t\tthis._clickEv = webix.event(dots, \"click\", ()=> {\n\t\t\t\tif(this._menu.isVisible())\n\t\t\t\t\tthis._menu.hide();\n\t\t\t\telse\n\t\t\t\t\tthis._menu.show(dots);\n\t\t\t});\n\t\t\tthis.$view.firstChild.appendChild(dots);\n\t\t}\n\t\treturn this._menu;\n\t},\n\t_menuActions:function(id){\n\t\tswitch(id){\n\t\t\tcase \"del\":\n\t\t\t\tthis.callEvent(\"onViewRemove\", []);\n\t\t\t\tbreak;\n\t\t\tcase \"edit\":\n\t\t\t\tthis.callEvent(\"onViewEdit\", []);\n\t\t\t\tbreak;\n\t\t\tcase \"pdf\":\n\t\t\t\twebix.toPDF(this.getBody(), {display:\"image\"});\n\t\t\t\tbreak;\n\t\t\tcase \"png\":\n\t\t\t\twebix.toPNG(this.getBody());\n\t\t\t\tbreak;\n\t\t\tcase \"excel\":\n\t\t\t\twebix.toExcel(this.getBody(), {header: false});\n\t\t\t\tbreak;\n\t\t}\n\t},\n\t_toggleExcel:function(){\n\t\tconst view = this.getBody();\n\t\tif(view.data && view.data.pull)\n\t\t\tthis._menu.showItem(\"excel\");\n\t\telse\n\t\t\tthis._menu.hideItem(\"excel\");\n\t},\n\t_removeView:function(view){\n\t\tif(view && view.getTopParentView() == this)\n\t\t\tthis.callEvent(\"onViewRemove\", []);\n\t}\n}, webix.ui.window);","webix.protoUI({\n\tname: \"ssheet-series\",\n\t$init: function(config){\n\t\tconfig.rows = [\n\t\t\t{\n\t\t\t\tview: \"scrollview\",\n\t\t\t\tborderless: true,\n\t\t\t\tbody: {\n\t\t\t\t\tview: \"accordion\",\n\t\t\t\t\tcss: \"webix_ssheet_accordion\",\n\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\tmulti: true,\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\trows: [\n\t\t\t\t\t\tthis.getSectionConfig()\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonAfterScroll:function(){\n\t\t\t\t\t\t//close possibly open selector popups\n\t\t\t\t\t\twebix.callEvent(\"onClick\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{ view:\"button\", label:webix.i18n.spreadsheet.labels[\"add-line\"], click:()=>{\n\t\t\t\tthis.addSection();\n\t\t\t}}\n\t\t];\n\t},\n\tgetSectionConfig: function(i){\n\t\tconst view = this;\n\t\tconst labels = webix.i18n.spreadsheet.labels;\n\t\tconst trashIcon = \"<span class='webix_icon webix_ssheet_series_icon wxi-trash'></span>\";\n\t\tconst padding = webix.skin.$active.dataPadding-2;\n\n\t\treturn {\n\t\t\tview:\"accordionitem\",\n\t\t\theader:`${labels[\"chart-item\"]} ${i ? i+1 : 1} ${trashIcon}`,\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\tpadding,\n\t\t\t\telementsConfig:{\n\t\t\t\t\tlabelWidth:180\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonChange: () => {\n\t\t\t\t\t\tthis.callEvent(\"onChange\", []);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", label:labels[\"chart-range\"], name:\"range\", range:true, on:{\n\t\t\t\t\t\tonChange: function(val, oldVal) {\n\t\t\t\t\t\t\tconst upper = val.toUpperCase();\n\t\t\t\t\t\t\tif(val != upper){\n\t\t\t\t\t\t\t\tthis.blockEvent();\n\t\t\t\t\t\t\t\tthis.setValue(upper);\n\t\t\t\t\t\t\t\tthis.unblockEvent();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tview.callEvent(\"onRangeChange\", [upper, oldVal]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"chart-series-color\"], name:\"color\"},\n\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-tooltip\"], name:\"tooltip\" },\n\t\t\t\t\t{ view:\"richselect\", label:labels[\"chart-markers\"], value:\"square\", name:\"marker\", hidden: !this.markersVisible,\n\t\t\t\t\t\tsuggest:{\n\t\t\t\t\t\t\tview: \"ssheet-form-suggest\",\n\t\t\t\t\t\t\tdata: [\n\t\t\t\t\t\t\t\t{id:\"square\", value:labels[\"chart-markers-square\"]},\n\t\t\t\t\t\t\t\t{id:\"triangle\", value:labels[\"chart-markers-triangle\"]},\n\t\t\t\t\t\t\t\t{id:\"diamond\", value:labels[\"chart-markers-diamond\"]},\n\t\t\t\t\t\t\t\t{id:\"round\", value:labels[\"chart-markers-round\"]}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\tonClick:{\n\t\t\t\t\"wxi-trash\": function(){\n\t\t\t\t\tconst layout = this.getParentView();\n\t\t\t\t\tlayout.removeView(this);\n\n\t\t\t\t\tconst childs = layout.getChildViews();\n\n\t\t\t\t\tfor (let i = 0; i < childs.length; i++) {\n\t\t\t\t\t\tchilds[i].define({header:`${labels[\"chart-item\"]} ${i+1} ${trashIcon}`});\n\t\t\t\t\t\tchilds[i].refresh();\n\t\t\t\t\t}\n\n\t\t\t\t\tview.callEvent(\"onChange\", []);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t},\n\taddSection: function(){\n\t\tconst layout = this.getLayout();\n\t\tconst lastIndex = layout.getChildViews().length;\n\t\tconst layoutId = layout.addView(this.getSectionConfig(lastIndex));\n\n\t\twebix.$$(layoutId).queryView({name: \"range\"}).focus();\n\t},\n\tsetValue: function(value){\n\t\tvalue = value || [];\n\n\t\tconst layout = this.getLayout();\n\t\tconst childs = layout.getChildViews();\n\t\tconst count = childs.length;\n\n\t\tif(count > value.length)\n\t\t\tfor(let i = count; i > value.length; i--)\n\t\t\t\tthis.getLayout().removeView(childs[i-1]);\n\t\telse if(value.length > count)\n\t\t\tfor(let i = value.length; i > count; i--)\n\t\t\t\tthis.addSection();\n\n\t\tfor(let i = 0; i < childs.length; i++){\n\t\t\tconst form = childs[i].getChildViews()[0];\n\t\t\tconst range = form.queryView({name: \"range\"});\n\n\t\t\t//block range events to ignore onRangeChange\n\t\t\trange.blockEvent();\n\t\t\tform.setValues(value[i]);\n\t\t\trange.unblockEvent();\n\t\t}\n\t},\n\tsetSubValue: function(sub, value){\n\t\tsub.blockEvent();\n\t\tsub.setValue(value);\n\t\tsub.unblockEvent();\n\t},\n\tgetLayout(){\n\t\treturn this.queryView(\"scrollview\").getBody();\n\t},\n\thideMarkers: function(show){\n\t\tthis.markersVisible = show;\n\t\tthis.queryView(\"richselect\", \"all\").forEach(marker => {\n\t\t\tif(show)\n\t\t\t\tmarker.show();\n\t\t\telse\n\t\t\t\tmarker.hide();\n\t\t});\n\t},\n\tgetValue: function(){\n\t\tconst value = [];\n\n\t\tconst layout = this.getLayout();\n\t\tlayout.getChildViews().forEach(child => {\n\t\t\tvalue.push(child.getChildViews()[0].getValues());\n\t\t});\n\t\treturn value;\n\t}\n}, webix.ui.layout);","import {getJsDateFromExcel, getExcelDateFromJs} from \"../math/methods/helpers\";\nimport {getDateEditFormat} from \"../operations/formats\";\n\nwebix.editors.excel_date = webix.extend({\n\tcreatePopup:function(){\n\t\tconst editor = webix.editors.excel_date;\n\n\t\tif(!editor.popup){\n\t\t\tconst popup = webix.ui({\n\t\t\t\tview:\"popup\",\n\t\t\t\tbody:{ \n\t\t\t\t\tview:\"calendar\",\n\t\t\t\t\ticons:true,\n\t\t\t\t\ttimepicker:true,\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonChange: function(val){\n\t\t\t\t\t\t\tval = val[0];\n\t\t\t\t\t\t\tthis.getParentView()._last_input_target.value = val ? getExcelDateFromJs(val) : \"\";\n\t\t\t\t\t\t\twebix.callEvent(\"onEditEnd\", []);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonEnter: function(){\n\t\t\t\t\t\twebix.callEvent(\"onEditEnd\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\teditor.popup = popup.config.id;\n\t\t}\n\n\t\treturn editor.popup;\n\t},\n\trender:function(){\n\t\tconst node = webix.html.create(\"div\", {\n\t\t\t\"class\":\"webix_dt_editor\"\n\t\t}, \"<input type='text'>\");\n\n\t\tthis.popup = this.createPopup();\n\n\t\twebix.event(node.firstChild, \"click\", ()=> this.getPopup().show(node));\n\n\t\treturn node;\n\t},\n\tgetPopup(){\n\t\treturn webix.$$(this.popup);\n\t},\n\tshowPopup:function(){\n\t\tconst input = this.getInputNode();\n\t\tconst popup = this.getPopup();\n\n\t\tpopup._last_input_target = input;\n\t\tpopup.show(input);\n\n\t\tinput.setAttribute(\"aria-expanded\", \"true\");\n\t},\n\tupdateCalendar(value){\n\t\tconst calendar = this.getPopup().getBody();\n\n\t\tcalendar.blockEvent();\n\t\tcalendar.setValue(value);\n\t\tcalendar.unblockEvent();\n\t},\n\tafterRender:function(){\n\t\tthis.showPopup();\n\t},\n\tsetValue:function(value){\n\t\tconst noDate = (value === \"\" || isNaN(value*1));\n\t\tvalue = noDate ? new Date() : getJsDateFromExcel(value);\n\t\tthis.updateCalendar(value);\n\n\t\tconst format = getDateEditFormat(this.config.row, this.config.id);\n\t\tthis.getInputNode().value = format(value);\n\t},\n\tgetValue:function(){\n\t\tconst value = this.getInputNode().value;\n\t\tthis.getPopup().hide();\n\t\treturn value;\n\t}\n}, webix.editors.text);","webix.editors.ss_richselect = webix.extend({\n\tgetFormat:function(value){\n\t\tconst list = this.getInputNode();\n\t\tlet item;\n\n\t\tif (value && list.exists(value))\n\t\t\titem = list.getItem(value);\n\t\treturn item && item.format;\n\t},\n\tpopupInit:function(popup){\n\t\twebix.editors.richselect.popupInit.apply(this, arguments);\n\n\t\tpopup.getList().define(\"template\", function(obj){\n\t\t\treturn obj.$value || obj.value;\n\t\t});\n\t}\n}, webix.editors.richselect);","import {changeAreaDecimals} from \"../operations/formats\";\n\nexport const actions = {\n\tspan: function(view){\n\t\tvar range = view.$$(\"cells\").getSelectArea();\n\t\tif(range){\n\t\t\tif(isMerged(view,range)){\n\t\t\t\tview.splitCell();\n\t\t\t}\n\t\t\telse{\n\t\t\t\tlet values = [];\n\t\t\t\tfor(let r = range.start.row; r<=range.end.row; r++){\n\t\t\t\t\tfor(let c = range.start.column; c<=range.end.column; c++){\n\t\t\t\t\t\tlet value = view.getCellValue(r,c);\n\t\t\t\t\t\tif(value) values.push(value);\n\t\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t\t}\n\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t}\n\t\t\t\tif(values.length>1){\n\t\t\t\t\tview.confirm({\n\t\t\t\t\t\ttext:webix.i18n.spreadsheet.labels[\"merge-cell-confirm\"]\n\t\t\t\t\t}).then(()=> view.combineCells() );\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tview.combineCells();\n\t\t\t}\n\t\t}\n\t},\n\tundo: function(view){\n\t\tview.undo();\n\t},\n\tredo: function(view){\n\t\tview.redo();\n\t},\n\t\"hide-gridlines\": function(view){\n\t\tview.hideGridlines(\"toggle\");\n\t},\n\t\"hide-headers\": function(view){\n\t\tview.hideHeaders(\"toggle\");\n\t},\n\t\"freeze-columns\": function(view){\n\t\tvar table = view.$$(\"cells\");\n\t\tvar select = table.getSelectedId();\n\t\tview.freezeColumns(select && select.column!=\"rowId\"?select.column : 0);\n\t},\n\t\"freeze-rows\":function(view){\n\t\tvar table = view.$$(\"cells\");\n\t\tvar select = table.getSelectedId();\n\t\tview.freezeRows(select ? select.row : 0);\n\t},\n\t\"increase-decimals\": function(view){\n\t\tchangeAreaDecimals(view, 1);\n\t},\n\t\"decrease-decimals\": function(view){\n\t\tchangeAreaDecimals(view, -1);\n\t},\n};\n\nfunction isMerged(view,range){\n\tvar i, j,\n\t\tc0 = range.start,\n\t\tc1 = range.end;\n\n\tfor( i = c0.row*1; i <= c1.row*1; i++ ){\n\t\tfor( j = c0.column*1; j <= c1.column*1; j++ ){\n\t\t\tif(view.$$(\"cells\").getSpan(i, j))\n\t\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n","import {toolbarSizes, defaultStyles} from \"./defaults\";\nimport {formatHelpers} from \"../operations/formats\";\n\n// options for 'font-family' select\nexport const fontFamily = [\n\t{id: \"Arial\", value: \"Arial\"},\n\t{id: \"'Roboto', sans-serif\", value: \"Roboto\"},\n\t{id: \"'PT Sans', Tahoma\", value: \"PT Sans\"},\n\t{id: \"Tahoma\", value: \"Tahoma\"},\n\t{id: \"Verdana\", value: \"Verdana\"},\n\t{id: \"Calibri, Tahoma\", value:\"Calibri\"}\n];\n\n// options for 'format' select\nfunction getCellFormats(){\n\tconst locale = webix.i18n.spreadsheet.labels;\n\treturn [\n\t\t{id: \"common\", value: locale.common },\n\t\t{id: \"price\", value: locale.currency, example: \"98.20\"},\n\t\t{id: \"int\", value: locale.number, example: \"2120.02\"},\n\t\t{id: \"percent\", value: locale.percent, example:\"0.5\"},\n\t\t{id: \"date\", value: locale.date, example:\"45000\"},\n\t\t{id: \"string\", value: locale.string, example:\"012345\"},\n\t\t{id: \"custom\", value: locale[\"custom-format\"]},\n\t];\n}\n\nexport function getColumnOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet colOperations = [\n\t\t{ id:\"add\",    group:\"column\", value:locale[\"insert-column\"]},\n\t\t{ id:\"del\",    group:\"column\", value:locale[\"delete-column\"]},\n\t\t{ id:\"show\",   group:\"column\", value:locale[\"show-column\"]},\n\t\t{ id:\"hide\",   group:\"column\", value:locale[\"hide-column\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\tcolOperations.push({ id:\"resize\", group:\"column\", value:locale[\"resize-column\"]});\n\treturn colOperations;\n}\n\nexport function getRowOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet rowOperations = [\n\t\t{ id:\"add\",    group:\"row\", value:locale[\"insert-row\"]},\n\t\t{ id:\"del\",    group:\"row\", value:locale[\"delete-row\"]},\n\t\t{ id:\"show\",   group:\"row\", value:locale[\"show-row\"]},\n\t\t{ id:\"hide\",   group:\"row\", value:locale[\"hide-row\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\trowOperations.push({ id:\"resize\", group:\"row\", value:locale[\"resize-row\"]});\n\treturn rowOperations;\n}\n\n// options for 'clear' select\nexport function getClearOperation(){\n\treturn [\n\t\t{id: \"clear-value\",               value: getLocaleClear(\"value\")},\n\t\t{id: \"clear-style\",               value: getLocaleClear(\"style\")},\n\t\t{id: \"clear-conditional-formats\", value: getLocaleClear(\"conditional-formats\")},\n\t\t{id: \"clear-dropdown-editors\",    value: getLocaleClear(\"dropdown-editors\")},\n\t\t{id: \"clear-comments\",            value: getLocaleClear(\"comments\")},\n\t\t{ $template: \"Separator\" },\n\t\t{id: \"clear-all\",                 value: getLocaleClear(\"all\")}\n\t];\n}\n\n// options for 'borders' select\nconst borders = [\n\t{id: \"no\", value: \"no\"},\n\t{id: \"left\", value: \"left\"},\n\t{id: \"top\", value: \"top\"},\n\t{id: \"right\", value: \"right\"},\n\t{id: \"bottom\", value: \"bottom\"},\n\t{id: \"all\", value: \"all\"},\n\t{id: \"outer\", value: \"outer\"},\n\t{id: \"top-bottom\", value: \"top-bottom\"}\n];\n\nfunction getLocaleClear(value){\n\tvar locale = webix.i18n.spreadsheet.menus;\n\treturn locale[\"clear\"] + \" \" + locale[\"clear-\"+value].toLowerCase();\n}\n\n// options for 'font-size' select\nfunction getFontSize(){\n\tvar numbers = [\n\t\t\"8\",\"9\",\"10\",\"11\",\"12\",\"14\",\"15\",\n\t\t\"16\",\"18\",\"20\",\"22\",\"24\",\"28\",\"36\"\n\t];\n\tvar  fontSize = [];\n\n\tfor(var i =0; i < numbers.length; i++){\n\t\tfontSize.push({id: numbers[i]+webix.i18n.spreadsheet.labels.px, value: numbers[i]});\n\t}\n\treturn fontSize;\n}\n\nexport const styleFormats = {\n\t\"font-weight\": \"bold\",\n\t\"font-style\": \"italic\",\n\t\"text-decoration\": \"underline\"\n};\n\nexport const ui = {\n\tbutton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-toggle\", width: config.width||toolbarSizes.width, id: config.name, name: config.name,  label: config.label,\n\t\t\tcss: config.css||\"\", onValue: styleFormats[config.name], offValue: \"normal\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\tcolorButton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-color\",  css: config.css,  name: config.name, width: config.width||toolbarSizes.width+24,\n\t\t\ttitle: \"<span class='webix_ssheet_button_icon webix_ssheet_color_button_icon webix_ssheet_icon ssi-\"+config.name+\"' ></span>\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\ttoggleButton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-toggle-silent\", width: toolbarSizes.width, id: config.name, name: config.name,\n\t\t\tlabel: \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+config.name+\"'></span>\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\ticonButton: function(config){\n\t\tvar btn = webix.copy(config);\n\t\twebix.extend(btn, {view: \"button\", width: toolbarSizes.width, id: config.name,\n\t\t\tlabel: \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+config.name+\"'></span>\",\n\t\t\tcss: \"\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||webix.i18n.spreadsheet.menus[config.name]||\"\"\n\t\t});\n\t\tif(config.onValue){\n\t\t\twebix.extend(btn,{view: \"ssheet-toggle\", onValue: config.onValue, offValue: config.offValue},true);\n\t\t}\n\n\t\treturn btn;\n\t},\n\tsegmented: function(config){\n\t\treturn  {\n\t\t\tview: \"segmented\", name: config.name, css:config.css||\"\", width: config.width||toolbarSizes.width+76,  options:config.options\n\t\t};\n\t},\n\tselect: function(config){\n\t\twebix.extend(config,{\n\t\t\tview: \"richselect\",\n\t\t\tid: config.name,\n\t\t\tvalue: defaultStyles[config.name],\n\t\t\tsuggest: {\n\t\t\t\tcss: \"webix_ssheet_suggest\",\n\t\t\t\t//fitMaster: false,\n\t\t\t\tpadding: 0,\n\t\t\t\tdata: config.options\n\t\t\t}\n\t\t});\n\n\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\tif(config.popupWidth){\n\t\t\tconfig.suggest.fitMaster = false;\n\t\t\tconfig.suggest.width = config.popupWidth;\n\t\t}\n\t\tif(config.popupTemplate)\n\t\t\tconfig.suggest.body = {\n\t\t\t\ttemplate: config.popupTemplate\n\t\t\t};\n\t\tif(config.popupEvents){\n\t\t\tconfig.suggest.body = config.suggest.body || {};\n\t\t\tconfig.suggest.body.on = config.popupEvents;\n\t\t}\n\t\treturn config;\n\t},\n\tseparator: function(){\n\t\treturn {\n\t\t\tview: \"ssheet-separator\"\n\t\t};\n\t},\n\ttitle: function(config){\n\t\tvar title = config.title;\n\t\tif(title.indexOf(\"$\") === 0)\n\t\t\ttitle = \"\";\n\t\ttitle = webix.i18n.spreadsheet.labels[config.title]||title;\n\n\t\treturn {\n\t\t\ttemplate: title, view: \"ssheet-bar-title\", height: toolbarSizes.titleHeight\n\t\t};\n\t},\n\tborders: function(config){\n\t\treturn {view: \"ssheet-borders\", width:config.width||toolbarSizes.width+24, data: borders, id: config.name, name: config.name,\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\talign: function(config){\n\t\treturn {view: \"ssheet-align\", value: defaultStyles[config.name], width:config.width||toolbarSizes.width+24, data: config.options,\n\t\t\tname: config.name, tooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\tcondFormat: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-cond-format\",\n\t\t\twidth: 40,\n\t\t\tid: config.name,\n\t\t\tname: config.name\n\t\t};\n\t}\n};\n\nexport const buttonsMap = {\n\t\"font-family\": function(){\n\t\treturn  ui.select({name: \"font-family\", options:fontFamily, width: 100});\n\t},\n\t\"font-size\": function(){\n\t\treturn  ui.select({name: \"font-size\", options:getFontSize(), width: 64});\n\t},\n\t\"font-weight\": function(){\n\t\treturn ui.button({name:\"font-weight\",label: \"B\", css: \"webix_ssheet_bold\"});\n\t},\n\t\"font-style\": function(){\n\t\treturn ui.button({name: \"font-style\",label: \"I\",css:\"webix_ssheet_italic\"});\n\t},\n\t\"text-decoration\": function(){\n\t\treturn ui.button({name: \"text-decoration\",label: \"U\",css: \"webix_ssheet_underline\"});\n\t},\n\t\"color\": function(){\n\t\treturn ui.colorButton({name: \"color\",icon:\"font\",css:\"webix_ssheet_color\"});\n\t},\n\t\"background\": function(){\n\t\treturn  ui.colorButton({name: \"background\",icon:\"paint-brush\",css:\"webix_ssheet_background\", width: 64});\n\t},\n\t\"borders\": function(){\n\t\treturn ui.borders({ name: \"borders\" });\n\t},\n\t\"text-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn ui.align({name: \"text-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"left\", css: \"webix_ssheet_icon ssi-left\", tooltip: locale[\"align-left\"]},\n\t\t\t{id: \"center\", css: \"webix_ssheet_icon ssi-center\", tooltip: locale[\"align-center\"]},\n\t\t\t{id: \"right\", css: \"webix_ssheet_icon ssi-right\", tooltip: locale[\"align-right\"]}\n\t\t]});\n\t},\n\t\"vertical-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn  ui.align({name: \"vertical-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"top\", css: \"webix_ssheet_icon ssi-top\", tooltip: locale[\"align-top\"]},\n\t\t\t{id: \"middle\", css: \"webix_ssheet_icon ssi-middle\", tooltip: locale[\"align-middle\"]},\n\t\t\t{id: \"bottom\", css: \"webix_ssheet_icon ssi-bottom\", tooltip: locale[\"align-bottom\"]}\n\t\t]});\n\t},\n\t\"wrap\": function(){\n\t\treturn ui.iconButton({name: \"wrap\", onValue:\"wrap\", offValue:\"nowrap\"});\n\t},\n\t\"format\": function(){\n\t\treturn ui.select({\n\t\t\tname: \"format\", width: 106, options:getCellFormats(), popupWidth: 180,\n\t\t\tpopupTemplate: function(obj){\n\t\t\t\t//make it look like an actual cell\n\t\t\t\tvar format =  formatHelpers[obj.id] ? formatHelpers[obj.id].getFormat : \"\";\n\t\t\t\tvar cell = {css:\"\"};\n\t\t\t\tvar example = format && obj.example?format(obj.example, cell):\"\";\n\t\t\t\treturn obj.value + (format?\"<span class='webix_ssheet_right\"+(cell.css?\" \"+cell.css:\"\")+\"'>\"+example+\"</span>\":\"\");\n\t\t\t},\n\t\t\tpopupEvents:{\n\t\t\t\tonItemClick: function(id){\n\t\t\t\t\tif(id == \"custom\")\n\t\t\t\t\t\tthis.getTopParentView().callEvent(\"onCommand\", [{id:id}]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\t\"column\": function(view){\n\t\treturn {\n\t\t\tname: \"column\",\n\t\t\tview: \"ssheet-button\", icon: \"column\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getColumnOperation(view)\n\t\t};\n\t},\n\t\"row\": function(view){\n\t\treturn {\n\t\t\tname: \"row\", view: \"ssheet-button\", icon: \"row\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getRowOperation(view)\n\t\t};\n\t},\n\t\"clear\": function(){\n\t\treturn {\n\t\t\tname: \"clear\", view: \"ssheet-button\", icon: \"clear-styles\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getClearOperation()\n\t\t};\n\t},\n\t\"image\":function(){\n\t\treturn {\n\t\t\tname:\"image\", view:\"ssheet-button\", icon:\"add-image\",\n\t\t\tarrow:true, options:[\n\t\t\t\t{id:\"add-image-cell\", value: webix.i18n.spreadsheet.labels[\"add-image-cell\"]},\n\t\t\t\t{id:\"add-image-top\", value: webix.i18n.spreadsheet.labels[\"add-image-top\"]}\n\t\t\t]\n\t\t};\n\t},\n\t\"graph\":function(){\n\t\treturn {\n\t\t\tname:\"graph\", view:\"ssheet-button\", icon:\"add-sparkline\",\n\t\t\tarrow:true, options:[\n\t\t\t\t{id:\"add-sparkline\", value:webix.i18n.spreadsheet.labels[\"add-sparkline\"]},\n\t\t\t\t{id:\"add-chart\", value: webix.i18n.spreadsheet.labels[\"add-chart\"]}\n\t\t\t]\n\t\t};\n\t},\n\t\"comment\": function(){\n\t\treturn {\n\t\t\tname: \"comment\",\n\t\t\tview: \"ssheet-button\", icon: \"comments\",\n\t\t\tarrow: true, area: true, width: 55\n\t\t};\n\t},\n\t\"create-filter\": function(){\n\t\treturn ui.toggleButton({name: \"create-filter\"});\n\t},\n\t\"hide-gridlines\": function(){\n\t\treturn ui.toggleButton({name: \"hide-gridlines\"});\n\t},\n\t\"hide-headers\": function(){\n\t\treturn ui.toggleButton({name: \"hide-headers\"});\n\t}\n};","import {toolbarSizes} from \"./defaults\";\n\nfunction getText(text){\n\tvar locale = webix.i18n.spreadsheet;\n\treturn locale.menus[text] || locale.labels[text] || locale.tooltips[text] || text;\n}\nfunction calcButtons(){\n\tvar i, name, width,\n\t\tgroups = {\n\t\t\t\"undo\":[\"undo\",\"redo\"],\n\t\t\t\"insert\":[\"add-sparkline\",\"add-image\",\"add-comment\"]\n\t\t},\n\t\tresult = {};\n\n\tfor( name in groups){\n\t\tresult[name] = 0;\n\t\tfor(i=0; i < groups[name].length; i++){\n\t\t\twidth = webix.html.getTextSize(getText(groups[name][i]), \"webix_ssheet_button_measure\").width + 7;\n\t\t\tresult[name] = Math.max(width,result[name]);\n\t\t}\n\t}\n\treturn result;\n}\nexport function getAllElements(){\n\tvar sizes = calcButtons();\n\tvar titleHeight = toolbarSizes.titleHeight;\n\n\treturn [\n\t\t{\n\t\t\tpadding: 3,\n\t\t\tmargin: 0,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"sheet\", view: \"ssheet-button-icon-top\", label: getText(\"sheet\"), arrow: true,\n\t\t\t\t\t\t\toptions:[\n\t\t\t\t\t\t\t\t{id: \"new-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"copy-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"remove-sheet\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"excel-import\"},\n\t\t\t\t\t\t\t\t{$button: \"excel-export\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"print\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t{template: getText(\"file\"), view: \"ssheet-bar-title\", height: titleHeight, width: 85}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"undo\", view: \"ssheet-button\", label: getText(\"undo\"), width: sizes.undo },\n\t\t\t\t{$button: \"redo\", view: \"ssheet-button\", label: getText(\"redo\"), width: sizes.undo},\n\t\t\t\t{template: getText(\"undo-redo\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-family\", width: (webix.skin.$active.inputHeight+2)*3+4},\n\t\t\t\t\t\t\t\t{$button: \"font-size\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{$button: \"borders\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-weight\"},\n\t\t\t\t\t\t\t\t{$button: \"font-style\"},\n\t\t\t\t\t\t\t\t{$button: \"text-decoration\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t{$button: \"background\"},\n\t\t\t\t\t\t{$button: \"color\"}\n\t\t\t\t\t]\n\n\t\t\t\t},\n\t\t\t\t{template: getText(\"font\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"text-align\"},\n\t\t\t\t\t\t{$button: \"span\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"vertical-align\"},\n\n\t\t\t\t\t\t{$button: \"wrap\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"align\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"format\"},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"increase-decimals\"},\n\t\t\t\t\t\t{$button: \"decrease-decimals\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\n\t\t\t\t{template: getText(\"number\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-asc\"},\n\t\t\t\t\t{ $button: \"create-filter\"},\n\t\t\t\t\t{ $button: \"conditional-format\"},\n\t\t\t\t\t{ $button: \"add-link\"},\n\t\t\t\t\t{ $button: \"clear\"}\n\t\t\t\t]},\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-desc\"},\n\t\t\t\t\t{ $button: \"add-range\"},\n\t\t\t\t\t{ $button: \"lock-cell\"},\n\t\t\t\t\t{ $button: \"add-dropdown\"}\n\t\t\t\t]},\n\t\t\t\t{template: getText(\"edit\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"image\", view: \"ssheet-button\", label: getText(\"image\"), width:sizes.insert},\n\t\t\t\t\t\t{$button: \"add-comment\", view: \"ssheet-button\", label: getText(\"comment\"), width:sizes.insert},\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{$button: \"graph\", view: \"ssheet-button\", label: getText(\"graph\"), width:sizes.insert},\n\t\t\t\t{template: getText(\"insert\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{rows:[\n\t\t\t\t\t\t\t{$button:\"row\"},\n\t\t\t\t\t\t\t{$button:\"column\"}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"hide-gridlines\"},\n\t\t\t\t\t\t\t\t{$button:\"hide-headers\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"freeze-rows\"},\n\t\t\t\t\t\t\t\t{$button:\"freeze-columns\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"view\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{}\n\t];\n}","import {actions} from \"./toolbar/actions\";\nimport {defaultStyles} from \"./toolbar/defaults\";\nimport {toolbarButtons, getButtons} from \"./toolbar/helpers\";\nimport * as elm from \"./toolbar/all_elements\";\nimport {isCustom} from \"./operations/formats\";\n\nconst buttons = {\n\t\"undo-redo\": [\"undo\",\"redo\"],\n\t\"font\": [\"font-family\",\"font-size\",\"font-weight\",\"font-style\",\"text-decoration\",\"color\",\"background\",\"borders\"],\n\t\"align\": [\"text-align\",\"vertical-align\",\"wrap\",\"span\"],\n\t\"format\": [\"format\"]\n};\n\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tif (action.id == \"toolbar-update\")\n\t\t\tupdateValue(view, action.name, action.value);\n\t});\n\n\tvar elements = [];\n\n\tif(view.config.toolbar){\n\t\tlet allElements =  view.config.toolbar;\n\t\tif(allElements == \"full\"){\n\t\t\tallElements = elm.getAllElements();\n\t\t\tif(webix.isUndefined(view.config.bottombar))\n\t\t\t\tview.config.bottombar = true;\n\t\t}\n\t\telements =   toolbarButtons(view, allElements);\n\t}\n\telse\n\t\telements =   getButtons(view, view.config.buttons || buttons);\n\n\tvar bar = {\n\t\tview:\"toolbar\",\n\t\tcss: \"webix_ssheet_toolbar webix_layout_toolbar\",\n\t\tid:\"bar\",\n\t\tpadding:0,\n\t\telements: elements,\n\t\ton: {\n\t\t\tonChange: function (){\n\t\t\t\tvar source = this.$eventSource;\n\t\t\t\tvar value = source.getValue();\n\t\t\t\tvar name = source.config.name;\n\t\t\t\tif(name == \"format\" && value == \"common\")\n\t\t\t\t\tvalue = \"\";\n\t\t\t\tif(!(name == \"format\" && value == \"custom\"))\n\t\t\t\t\tview.callEvent(\"onStyleSet\", [name, value]);\n\t\t\t},\n\t\t\tonItemClick: function (id){\n\t\t\t\tvar viewId = view.innerId(id);\n\t\t\t\tif (actions[viewId])\n\t\t\t\t\tactions[viewId].call(this, view);\n\t\t\t\telse\n\t\t\t\t\tview.callEvent(\"onCommand\", [{ id: viewId }]);\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"toolbar\", bar]);\n\treturn bar;\n\n}\n\nfunction ready(view){\n\tview.attachEvent(\"onAfterSelect\", (selected) => setValues(view, selected));\n}\n\nfunction setValues(view, selected) {\n\tconst barStyles = getBarStyles(view, selected);\n\tview.$$(\"bar\").setValues(barStyles);\n}\n\nfunction updateValue(view, name, value){\n\tconst element = view.$$(\"bar\").elements[name];\n\n\tif (element)\n\t\telement.setValue(value);\n}\n\nfunction getBarStyles(view, selected){\n\tconst dropdowns = [\n\t\t\"font-family\",\n\t\t\"font-size\",\n\t\t\"text-align\",\n\t\t\"vertical-align\",\n\t\t\"format\",\n\t\t\"background\",\n\t\t\"color\"\n\t];\n\n\tconst cell = selected[0];\n\tconst barStyles = getCellStyles(view, cell);\n\n\tfor(let i = 1; i < selected.length; i++){\n\t\tconst cellStyle = getCellStyles(view, selected[i]);\n\n\t\tfor(let k = dropdowns.length-1; k >= 0; k--){\n\t\t\tconst property = dropdowns[k];\n\t\t\tif(barStyles[property] != cellStyle[property]){\n\t\t\t\tdelete barStyles[property];\n\t\t\t\tdropdowns.splice(k, 1);\n\t\t\t}\n\t\t}\n\n\t\tif(!dropdowns.length)\n\t\t\tbreak;\n\t}\n\n\treturn barStyles;\n}\n\nfunction getCellStyles(view, cell){\n\tconst span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\tif(span)\n\t\t[cell.row, cell.column] = span;\n\n\tconst obj = view.getStyle(cell.row, cell.column);\n\tconst styles = obj ? webix.copy(obj.props) : {};\n\n\tfor (let i in defaultStyles)\n\t\tif(!styles[i])\n\t\t\tstyles[i] = defaultStyles[i];\n\n\tstyles.format = isCustom(styles.format) ? \"custom\" : styles.format;\n\n\treturn styles;\n}","import {ui, buttonsMap} from \"./buttons\";\n\nexport function toolbarButtons(view,structure){\n\tvar checkButtons = function(cells){\n\t\tfor(var i =0; i < cells.length; i++){\n\t\t\tvar name = cells[i].$button;\n\t\t\tif (name){\n\t\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\t\twebix.extend(cells[i], base);\n\t\t\t}\n\t\t\t\n\t\t\tif(cells[i].rows)\n\t\t\t\tcheckButtons(cells[i].rows);\n\t\t\tif(cells[i].cols)\n\t\t\t\tcheckButtons(cells[i].cols);\n\t\t}\n\t};\n\tcheckButtons(structure);\n\treturn structure;\n}\n\nexport function getButtons(view,structure){\n\tvar config = [];\n\tfor(var block in structure){\n\t\tconfig.push(elementsBlock(view, block, structure[block]));\n\t\tconfig.push(ui.separator());\n\t}\n\treturn config;\n}\n\nfunction blockColumns(view, buttons){\n\tvar cols = [];\n\tfor(var i =0; i < buttons.length; i++){\n\t\tlet name = buttons[i];\n\t\tif(typeof name == \"object\"){\n\t\t\tcols.push(name);\n\t\t}\n\t\telse {\n\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\tcols.push(base);\n\t\t}\n\t}\n\treturn cols;\n}\n\n\nfunction elementsBlock(view, name, columns){\n\tvar block = {\n\t\trows:[\n\t\t\t{\n\t\t\t\tpadding:2,\n\t\t\t\tcols:[{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: blockColumns(view, columns)\n\t\t\t\t}]\n\t\t\t},\n\t\t\tui.title({title:name})\n\t\t]\n\t};\n\treturn block;\n}","import {getTextSize} from \"./styles\";\n\nexport function selectRow(row, view, endRow){\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow:row,\n\t\tcolumn:columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: (endRow || row),\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectAll(view){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow: order[0],\n\t\tcolumn: columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: order[order.length-1],\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectColumn(column, view, endColumn){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar startRow = order[0];\n\tvar lastRow = order[order.length-1];\n\n\tvar start = {row: startRow, column: column};\n\tvar last = {row: lastRow, column: (endColumn || column) };\n\n\t_selectRange(start, last, view);\n}\n\nexport function isColSelected(column, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (column >= selectedArea.start.column && column <= selectedArea.end.column)\n\t\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function isCellSelected(row, column, view){\n\treturn isRowSelected(row, view) && isColSelected(column, view);\n}\n\nexport function isRowSelected(row, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (row >= selectedArea.start.row && row <= selectedArea.end.row)\n\t\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function selectColumns(column, view) {\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\n\tif (!selectedArea)\n\t\tselectColumn(column, view);\n\telse {\n\t\tlet col1 = Math.min(selectedArea.start.column, selectedArea.end.column, column);\n\t\tlet col2 = Math.max(selectedArea.start.column, selectedArea.end.column, column);\n\t\tselectColumn(col1, view, col2);\n\t}\n}\n\nfunction _selectRange(a, b, view){\n\tview.$$(\"cells\").addSelectArea(a, b);\n}\n\n\nexport function adjustColumn(column, view) {\n\tlet width = 25;\n\tconst columnWidth = view._table.getColumnConfig(column).width;\n\n\tview._table.eachRow(function(row) {\n\t\tconst span = view._table.getSpan(row, column);\n\t\tif(span && span[2] > 1)\n\t\t\treturn;\n\n\t\tconst text = this.getText(row, column);\n\t\tconst style = view.getStyle(row, column);\n\t\tconst css = style ? style.id : \"\";\n\n\t\tif (text.replace(/<\\/?[^>]+(>|$)/g, \"\")) {\n\t\t\tconst size = getTextSize(view, text, css);\n\n\t\t\tif(view.getCellEditor(row, column))\n\t\t\t\tsize.width += 20;\n\t\t\tif(view.getCellFilter(row, column))\n\t\t\t\tsize.width += 20;\n\n\t\t\tif(style && style.props.wrap == \"wrap\" && size.width > columnWidth)\n\t\t\t\tsize.width = columnWidth;\n\t\t\tif (size.width > width)\n\t\t\t\twidth = size.width;\n\t\t}\n\t});\n\tview._table.setColumnWidth(column, width);\n}\n\nexport function adjustRow(row, view) {\n\tlet height = 25;\n\n\tview._table.eachColumn(function(column) {\n\t\tif(column != \"rowId\"){\n\t\t\tconst text = this.getText(row, column);\n\n\t\t\t// if there is text wrap in cell we need to know width to get correct height\n\t\t\tlet width = this.getColumnConfig(column).width;\n\t\t\tconst span = view._table.getSpan(row, column);\n\t\t\tif(span)\n\t\t\t\twidth = view._table.getSpanNode({row:span[0], column:span[1]}).offsetWidth;\n\n\t\t\tlet style = view.getStyle(row, column);\n\t\t\tlet css = style ? style.id : \"\";\n\n\t\t\tif (text.replace(/<\\/?[^>]+(>|$)/g, \"\")) {\n\t\t\t\tlet size = getTextSize(view, text, css, width);\n\t\t\t\tif (size.height > height) height = size.height;\n\t\t\t}\n\t\t}\n\t});\n\tview._table.setRowHeight(row, height);\n}\n\nexport function highlightColRow(start,end, view){\n\tif(!view._table.config.header) return;\n\n\tconst css = \"webix_highlight\";\n\n\tlet sr = start.row, er = end.row, sc = start.column, ec = end.column;\n\tif(er<sr) [sr, er] = [er, sr];\n\tif(ec<sc) [sc, ec] = [ec, sc];\n\n\tview._table.eachRow(function(row){\n\t\tif(row < sr || row > er)\n\t\t\tview._table.removeCellCss(row, \"rowId\", css);\n\t\telse\n\t\t\tview._table.addCellCss(row, \"rowId\", css);\n\t});\n\n\tview._table.eachColumn(function(col){\n\t\tconst node = view._table.getHeaderNode(col);\n\t\tif(col == \"rowId\" || !node) return;\n\n\t\tif(col < sc || col > ec)\n\t\t\twebix.html.removeCss(node, css);\n\t\telse\n\t\t\twebix.html.addCss(node, css, true);\n\t});\n}","import * as cop from \"./operations/column_operations\";\nimport * as nms from \"./helpers/column_names\";\nimport * as fmt from \"./operations/formats\";\n\nexport function init(view, extra){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tvar datatable = {\n\t\tview:\"datatable\", id:\"cells\", css:\"webix_ssheet_table webix_data_border wss_\"+view.$index,\n\t\theaderRowHeight: webix.skin.$name == \"contrast\" || webix.skin.$name == \"flat\" ? 24 : 20,\n\t\tspans: true,\n\t\tleftSplit: 1,\n\t\tareaselect:true,\n\t\tminColumnWidth:38,\n\t\teditable:true,\n\t\teditaction:(extra.liveEditor ? \"custom\" : \"dblclick\"),\n\t\tminRowHeight:1,\n\t\tnavigation:true\n\t};\n\n\t//enable clipboard by default\n\tif (extra.clipboard !== false){\n\t\textra.clipboard = \"custom\";\n\t\tif(extra.clipboardDecimalDelimiter)\n\t\t\textra.templateCopy = function(item) {\n\t\t\t\tif(webix.rules.isNumber(item))\n\t\t\t\t\titem = item.toString().replace(\".\", extra.clipboardDecimalDelimiter);\n\t\t\t\treturn item;\n\t\t\t};\n\t}\n\tif (extra)\n\t\tdatatable = webix.extend(datatable, extra, true);\n\n\treturn datatable;\n}\n\nfunction ready(view){\n\tvar grid = view._table;\n\n\tvar showCommentHandler = webix.event(document.body, \"mousemove\", function(){\n\t\tvar thread;\n\t\treturn function(e) {\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(function(e){\n\t\t\t\tif(view.comments._activeComment.editStatus)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar cell = grid.locate(e);\n\t\t\t\tvar visible = view.comments.commentsView && view.comments.commentsView.isVisible();\n\n\t\t\t\tif(cell && view.comments.get(cell.row, cell.column)){\n\t\t\t\t\tvar activeCell = view.comments._activeComment.cell;\n\t\t\t\t\tif((activeCell && (activeCell.row != cell.row || activeCell.column != cell.column)) || !visible)\n\t\t\t\t\t\tview.callEvent(\"onCommand\",[{id: \"add-comment\", cell, viewonly: true }]);\n\t\t\t\t}\n\t\t\t\telse if(visible && !view.comments.commentsView.$view.contains(e.target))\n\t\t\t\t\tview.callEvent(\"onCommentHide\", []);\n\t\t\t}, true, [e], 250);\n\t\t};\n\t}());\n\n\t//in grid math\n\tif (view.config.math){\n\t\tgrid.config.editMath = true;\n\t}\n\n\t//saving value after edit\n\tgrid.attachEvent(\"onBeforeEditStop\", (st, ed) => {\n\t\t//ignore empty cells\n\t\tif (st.old === webix.undefined && st.value === \"\") return;\n\n\t\tif (st.value != st.old){\n\t\t\tview.setCellValue(ed.row, ed.column, st.value);\n\t\t\tgrid.refresh();\n\t\t}\n\t\tst.value = st.old;\n\t});\n\n\tgrid.attachEvent(\"onEnter\", function(ev){\n\t\tif (grid.getEditor()){\n\t\t\twebix.delay(function(){\n\t\t\t\tgrid.moveSelection(\"down\");\n\t\t\t});\n\t\t}\n\t\twebix.html.preventEvent(ev);\n\t});\n\n\t//prevent editing of locked cells\n\tview.attachEvent(\"onBeforeEditStart\", (row, column) => !view.isCellLocked(row, column));\n\tgrid.attachEvent(\"onBeforeEditStart\", (editor) => \n\t\tview.callEvent(\"onBeforeEditStart\", [editor.row, editor.column]) );\n\n\t//column drag event checking\n\tlet dragStartColumn;\n\tlet dragEndColumn;\n\n\t//column and row selection\n\tgrid.attachEvent(\"onBeforeSelect\", (id) => id.column != \"rowId\" );\n\tgrid.attachEvent(\"onBeforeBlockSelect\", (start, end, finalStep) => {\n\t\tif (finalStep &&\n\t\t(start.column !== \"rowId\" || end.column !== \"rowId\")) {\n\t\t\tif (start.column === \"rowId\") start.column = 1;\n\t\t\tif (end.column === \"rowId\") end.column = 1;\n\t\t}\n\t\tif(start.column !== \"rowId\" || end.column !== \"rowId\"){\n\t\t\tcop.highlightColRow(start,end, view);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t});\n\n\tfunction highlightHeaders(){\n\t\tlet ids = grid.getSelectedId(true);\n\t\tif(ids.length){\n\t\t\tlet start = ids[0];\n\t\t\tlet end = ids[ids.length-1]?ids[ids.length-1]:ids[0];\n\t\t\tcop.highlightColRow(start, end, view);\n\t\t}\n\t\telse {\n\t\t\tlet data = {row:0, column:0};\n\t\t\tcop.highlightColRow(data, data, view);\n\t\t}\n\t}\n\n\tgrid.attachEvent(\"onSelectChange\", () => highlightHeaders());\n\tgrid.attachEvent(\"onAfterColumnShow\", () => {\n\t\twebix.delay(() => highlightHeaders());\n\t});\n\tgrid.attachEvent(\"onColumnResize\", () => {\n\t\twebix.delay(() => highlightHeaders());\n\t});\n\n\twebix.event(grid.$view.firstChild, \"mousedown\", e => {\n\t\tconst resizeColumn = grid.config.resizeColumn;\n\t\tconst col = grid.locate(e);\n\n\t\tif(col && col.cind){\n\t\t\tif(resizeColumn){\n\t\t\t\tconst dx = grid.getColumnConfig(col.column).width;\n\t\t\t\tconst pos = webix.html.posRelative(e);\n\t\t\t\tif(pos.x < resizeColumn.size || dx-pos.x < resizeColumn.size+1)\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\tdragStartColumn = col.cind;\n\t\t}\n\t});\n\n\twebix.event(grid.$view.firstChild, \"mousemove\", e => {\n\t\tif(dragStartColumn){\n\t\t\tconst col = grid.locate(e);\n\n\t\t\tif(col){\n\t\t\t\tdragEndColumn = col.cind;\n\t\t\t\tcop.highlightColRow(\n\t\t\t\t\t{column: grid.columnId(dragStartColumn)},\n\t\t\t\t\t{column: grid.columnId(dragEndColumn||1)},\n\t\t\t\t\tview\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t});\n\n\tconst selectColumnHandler = webix.event(document.body, \"mouseup\", () => {\n\t\tif(dragStartColumn){\n\t\t\tif(dragEndColumn != null){\n\t\t\t\tcop.selectColumn(\n\t\t\t\t\tgrid.columnId(dragStartColumn),\n\t\t\t\t\tview,\n\t\t\t\t\tgrid.columnId(dragEndColumn||1)\n\t\t\t\t);\n\t\t\t\tdragEndColumn = null;\n\t\t\t}\n\t\t\tdragStartColumn = null;\n\t\t}\n\t});\n\n\tgrid.attachEvent(\"onItemDblClick\", (id) => {\n\t\tif (id.column === \"rowId\")\n\t\t\tcop.adjustRow(id.row, view);\n\t});\n\n\tlet lastHeaderClick = 0;\n\tgrid.attachEvent(\"onHeaderClick\", (id, e) => {\n\t\tif(id.column == \"rowId\"){\n\t\t\tcop.selectAll(view);\n\t\t\treturn;\n\t\t}\n\t\tlet headerClick = new Date();\n\t\tlet dblClick = (headerClick - lastHeaderClick <= 300);\n\n\t\tif (dblClick) {\n\t\t\tcop.adjustColumn(id.column, view);\n\t\t} else {\n\t\t\tlastHeaderClick = headerClick;\n\t\t\tif (e.shiftKey) {\n\t\t\t\tcop.selectColumns(id.column, view);\n\t\t\t} else {\n\t\t\t\tcop.selectColumn(id.column, view);\n\t\t\t}\n\t\t}\n\t});\n\n\t//select rows by shift click\n\tvar lastClickedRow = null;\n\tgrid.attachEvent(\"onItemClick\", (cell, e) => {\n\t\tif (cell.column === \"rowId\") {\n\t\t\tif (!e.shiftKey)\n\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\telse {\n\t\t\t\tif (!lastClickedRow)\n\t\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\t\telse\n\t\t\t\t\tcop.selectRow(lastClickedRow, view, cell.row);\n\t\t\t}\n\t\t\tlastClickedRow = cell.row;\n\t\t}\n\t});\n\n\t//reset API\n\tview.attachEvent(\"onReset\", () => reset(view));\n\n\tview.attachEvent(\"onBeforeSheetShow\", () => grid.editStop());\n\n\tgrid.attachEvent(\"onBlur\", function(){\n\t\t//after focus moved out, check and if it is somewhere\n\t\t//on the spreadsheet controls them move focus back to datatable\n\t\twebix.delay(function(){\n\t\t\tvar target = document.activeElement;\n\n\t\t\tif (target && target.tagName == \"INPUT\") return;\n\n\t\t\tvar focus = webix.UIManager.getFocus();\n\t\t\tvar need_focus = focus &&\n\t\t\t\tfocus != grid &&\n\t\t\t\tfocus.getTopParentView &&\n\t\t\t\tfocus.getTopParentView() === view;\n\n\t\t\tif (need_focus)\n\t\t\t\twebix.UIManager.setFocus(grid);\n\n\t\t}, this, [], 100);\n\t});\n\n\tsetDefaultCss(view);\n\n\tview.attachEvent(\"onDestruct\", () => {\n\t\twebix.eventRemove(showCommentHandler);\n\t\twebix.eventRemove(selectColumnHandler);\n\t});\n}\n\nexport function cell_template(view, obj, common, value, column, valueOnly){\n\tconst col = column.id;\n\tconst row = obj.id;\n\tlet css = \"\";\n\n\tconst text = value === \"\" || isNaN(value);\n\tconst format = fmt.getFormatName(view, row, col);\n\tconst invalidDate = fmt.checkFormat(format, \"date\") && fmt.isDateInvalid(value);\n\n\tlet extra = \"\";\n\tif (!valueOnly){\n\t\textra += view.comments.get(row, col) ? \"<div class='ssheet_commented_sign'></div>\" : \"\";\n\t\textra += view.getCellFilter(row, col) ? \"<div class='ssheet_filter_sign'></div>\" : \"\";\n\t}\n\n\t//text can be formatted only in case of string number format\n\tif(!invalidDate && (!text || fmt.checkFormat(format, \"string\"))){\n\t\tif (format){\n\t\t\tconst cell = { css:\"\" };\n\t\t\tconst helper = fmt.getFormat(format);\n\t\t\tif (helper){\n\t\t\t\tlet newValue = helper(value, cell);\n\n\t\t\t\tif(newValue != webix.i18n.spreadsheet.table[\"format-error\"]){\n\t\t\t\t\tif (cell.css)\n\t\t\t\t\t\tcss = `class=\"${cell.css}\"`;\n\t\t\t\t\tvalue = newValue;\n\t\t\t\t}\n\t\t\t\telse if(!text)\n\t\t\t\t\tvalue = value * 1;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tvalue = value * 1;\n\t}\n\n\t//print only cell values (td with position:relative ignores borders while printing)\n\tif(view._print && !(value || value === 0))\n\t\treturn \"\";\n\n\tif(webix.isUndefined(value) || value === null)\n\t\tvalue = \"\";\n\n\treturn `<div ${css}>${value}</div>${view._print ? \"\" : extra}`;\n}\n\nexport function reset(view){\n\tconst grid = view.$$(\"cells\");\n\tgrid.clearAll();\n\n\tconst columns = view.config.columnCount;\n\tconst rows = view.config.rowCount;\n\n\tconst cols = [{\n\t\tid:\"rowId\", header:\"\", width:40,\n\t\tcss:\"sheet_column_0\",\n\t\ttemplate:(el) => {\n\t\t\treturn el.id;\n\t\t}\n\t}];\n\n\tfor (let i=1; i<=columns; i++){\n\t\tcols.push({\n\t\t\tid:i,\n\t\t\teditor:\"text\",\n\t\t\theader:{\n\t\t\t\ttext: nms.encode[i]\n\t\t\t},\n\t\t\ttemplate:function(obj, common, value, column){\n\t\t\t\treturn cell_template(view, obj, common, value, column);\n\t\t\t}\n\t\t});\n\t\tview.callEvent(\"onColumnInit\",[cols[i]]);\n\t}\n\tgrid.refreshColumns(cols);\n\n\tconst data = [];\n\tfor (let i=1; i<=rows; i++)\n\t\tdata.push({ id:i });\n\n\tgrid.parse(data);\n}\n\n// nowrap by default\nfunction setDefaultCss(view){\n\twebix.html.addStyle(\"#\"+view._table.$view.id+\".webix_dtable .webix_cell { white-space:nowrap;}\");\n}\n","import group from \"./operations/undo_group\";\nimport {selectAll} from \"./operations/column_operations\";\nimport {styleFormats} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tvar grid = view.$$(\"cells\");\n\n\tvar key = webix.env.isMac ? \"command\" : \"ctrl\";\n\twebix.UIManager.addHotKey(key+\"-a\", () => { if(!grid.getEditor()) selectAll(view); }, grid);\n\n\tif(!view.config.readonly){\n\t\twebix.UIManager.addHotKey(\"any\", (view, ev) => {\n\t\t\t//ignore shift key\n\t\t\tif ((ev.which || ev.keyCode)  == 16) return;\n\n\t\t\tvar sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tgrid.$anyKey = true;\n\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"enter\", (view) => {\n\t\t\tvar sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tif(view.config.liveEditor)\n\t\t\t\t\tgrid.callEvent(\"onBeforeLiveEditor\", [sel[0]]);\n\t\t\t\telse\n\t\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"backspace\", () => del(view), grid);\n\t\twebix.UIManager.addHotKey(\"delete\", () => del(view), grid);\n\n\t\tvar redo = webix.env.isMac ? \"command-shift-z\" : \"ctrl-y\";\n\t\twebix.UIManager.addHotKey(redo, () => view.redo(), grid);\n\t\twebix.UIManager.addHotKey(key+\"-z\", () => view.undo(), grid);\n\n\t\twebix.UIManager.addHotKey(key+\"-b\", () => styleHotKey(view, \"font-weight\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-i\", () => styleHotKey(view, \"font-style\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-u\", (v, e) => ctrlU(view, e), grid);\n\t\twebix.UIManager.addHotKey(key+\"-p\", (v, e) => ctrlP(view, e), grid);\n\t}\n}\n\nfunction del(view) {\n\tgroup.set(function(){\n\t\tview.eachSelectedCell((cell) => view.setCellValue(cell.row,cell.column, \"\"));\n\t\tview.refresh();\n\t});\n}\n\nfunction ctrlU(view, e) {\n\tstyleHotKey(view, \"text-decoration\");\n\treturn webix.html.preventEvent(e);\n}\nfunction ctrlP(view, e) {\n\tview.callEvent(\"onCommand\",[{id: \"print\"}]);\n\treturn webix.html.preventEvent(e);\n}\n\nfunction styleHotKey(view, attr) { \n\tvar cell = view.getSelectedId();\n\tif(cell){\n\t\tvar style = view.getStyle(cell.row, cell.column);\n\n\t\tvar elementOn = styleFormats[attr];\n\t\tvar elementOff = \"normal\";\n\n\t\tvar state = (style && style.props[attr] === elementOn)? elementOff : elementOn;\n\t\tview.callEvent(\"onStyleSet\", [attr, state]);\n\t}\n}","import {_to_number, _combine} from \"./helpers\";\n\n/*Empty cells, logical values like TRUE, or text are ignored.*/\nexport function SUM(){\n\tvar sum = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false) sum+=v;\n\t}\n\treturn sum;\n}\n\n/*If a range or cell reference argument contains text, logical values, or empty cells, those values are ignored; \nhowever, cells with the value zero are included.*/\nexport function AVERAGE(){\n\tvar sum = 0, count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false){\n\t\t\tsum+=v; count++;\n\t\t}\n\t}\n\treturn sum/count;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are not counted. */\nexport function COUNT(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false)\n\t\t\tcount++;\n\t}\n\treturn count;\n}\n\n/*counts the number of cells that are not empty in a range, zero is excluded.*/\nexport function COUNTA(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++)\n\t\tif(set[i] && set[i]*1 !==0 ) count++;\n\treturn count;\n}\n\n/*Counts empty cells in a specified range of cells. Cells with zero values are not counted.*/\nexport function COUNTBLANK(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++)\n\t\tif(!set[i]*1) count++;\n\treturn count;\n}\n\n/*Empty cells, logical values, or text in the array or reference are ignored.\nIf the arguments contain no numbers, MAX returns 0 (zero).*/\nexport function MAX(){\n\tvar max = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false && (v>max || max ===\"\"))\n\t\t\tmax = v;\n\t}\n\treturn max || 0;\n}\n\n/*Empty cells, logical values, or text in the array or reference are ignored. \nIf the arguments contain no numbers, MIN returns 0.*/\nexport function MIN(){\n\tvar min = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false && (v<min || min ===\"\"))\n\t\t\tmin = v;\n\t}\n\treturn min || 0;\n}\n\n/* Only numbers in the array or reference are multiplied. \nEmpty cells, logical values, and text in the array or reference are ignored.*/\nexport function PRODUCT(){\n\tvar product = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(v !== false)\n\t\t\tproduct = product===\"\"?v:product*v;\n\t}\n\treturn product;\n}\n\n/* For valid products only numbers are multiplied. Empty cells, logical values, and text are ignored.\nTreats array entries that are not numeric as if they were zeros.*/\nexport function SUMPRODUCT(sets){\n\tvar length = sets[0].length;\n\tfor(let i in sets)\n\t\tif(sets[i].length !== length)\n\t\t\treturn;\n\n\tvar sp = 0;\n\tfor (let i = 0; i < sets[0].length; i++){\n\t\tvar product = \"\";\n\t\tfor(var s in sets){\n\t\t\tvar v = _to_number(sets[s][i]);\n\t\t\tif(v !== false) product = product===\"\" ? v: product*v;\n\t\t\telse{ product = 0; break; }\n\t\t}\n\t\tif(!webix.isUndefined(product)) sp+=product;\n\t}\n\treturn sp;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function SUMSQ(){\n\tvar sq = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(typeof v ===\"number\")\n\t\t\tsq += Math.pow(v, 2);\n\t}\n\treturn sq;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function VARP(){\n\tvar set = _combine(arguments);\n\tvar count = this.COUNT(set);\n\tvar avg = this.AVERAGE(set);\n\t\n\tvar sum = 0;\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(v !== false)\n\t\t\tsum += Math.pow(v - avg, 2);\n\t}\n\treturn sum/count;\n}\n\n/* Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function STDEVP(){\n\tvar set = _combine(arguments);\n\treturn Math.sqrt(this.VARP(set));\n}\n\n/*real numbers*/\nexport function POWER(num, pow){\n\tvar n = _to_number(num), p = _to_number(pow);\n\tif(typeof n == \"number\" && typeof p ==\"number\")\n\t\treturn Math.pow(n, p);\n\t\n}\n\n/*real numbers*/\nexport function QUOTIENT(num, div){\n\tvar n = _to_number(num), d = _to_number(div);\n\tif(typeof n == \"number\" && typeof d ==\"number\")\n\t\treturn n/d;\n}\n\n/*Returns a positive square root.*/\nexport function SQRT(num){\n\tvar v = _to_number(num);\n\tif(v !== false && v>=0)\n\t\treturn Math.sqrt(v);\n}\n\nexport function ABS(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn Math.abs(v);\n}\n\nexport function RAND(){\n\treturn Math.random();\n}\n\nexport function PI(){\n\treturn Math.PI;\n}\n\n/*Rounds a number down to the nearest integer*/\nexport function INT(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn Math.round(v);\n}\n\n/*rounds a number to a specified number of digits*/\nexport function ROUND(num, digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn parseFloat(v.toFixed(d));\n}\n\n/*rounds a number down to a specified number of digits*/\nexport function ROUNDDOWN(num, digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn  Math.floor(v*Math.pow(10, d))/Math.pow(10,d);\n}\n\n/*rounds a number up to a specified number of digits*/\nexport function ROUNDUP(num,digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn Math.ceil(v*Math.pow(10, d))/Math.pow(10,d);\n}\n\n/*Truncates a number to an integer by removing the fractional part of the number.*/\nexport function TRUNC(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn parseInt(v);\n}\n\n/*Returns number rounded up to the nearest even integer*/\nexport function EVEN(num){\n\tvar v = _to_number(num);\n\tif(v !== false){\n\t\tvar r = Math.round(v);\n\t\treturn r%2?r+1:r;\n\t}\n}\n\n/*Returns number rounded up to the nearest odd integer*/\nexport function ODD(num){\n\tvar v = _to_number(num);\n\tif(v !== false){\n\t\tvar r = Math.round(v);\n\t\treturn r%2?r:r+1;\n\t}\n}","export function CONCATENATE(){\n\tvar data = Array.prototype.slice.call(arguments);\n\tdata = data.map(function(obj){\n\t\tif (typeof obj === \"object\")\n\t\t\treturn obj.join(\"\");\n\t\treturn obj;\n\t});\n\treturn data.join(\"\");\n}\n \nexport function LEFT(text, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(0, count);\n}\n\nexport function MID(text, start, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(start, start + count);\n}\n\nexport function RIGHT(text, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(text.length - count);\n}\n\nexport function LOWER(text) {\n\tif (!text) { return \"\"; }\n\treturn text.toLowerCase();\n}\n\nexport function UPPER(text) {\n\tif (!text) { return \"\"; }\n\treturn text.toUpperCase();\n}\n\nexport function PROPER(text) {\n\tif (!text) { return \"\"; }\n\tvar temp = text.toLowerCase().split(\" \");\n\ttext = \"\";\n\tfor (var idx in temp) {\n\t\ttext += (text ? \" \" : \"\") + temp[idx].substring(0, 1).toUpperCase() + temp[idx].substring(1);\n\t}\n\treturn text;\n}\n\nexport function TRIM(text) {\n\tif (!text) { return \"\"; }\n\treturn text.trim();\n}\n\nexport function LEN(text) {\n\tif (!text && text !== 0) { return 0; }\n\treturn text.toString().length;\n}","import {getJsDateFromExcel, getExcelDateFromJs, dayOfTheYear} from \"./helpers\";\n\nexport function DATE(year, month, day){\n\tconst date = new Date(year, month-1, day);\n\treturn getExcelDateFromJs(date);\n}\n\nexport function TIME(hour, minute, second){\n\tconst date = new Date(1900, 0, 1, hour, minute, second);\n\treturn getExcelDateFromJs(date);\n}\n\nexport function DAY(date){\n\treturn getJsDateFromExcel(date).getDate();\n}\n\nexport function MONTH(date){\n\treturn getJsDateFromExcel(date).getMonth()+1;\n}\n\nexport function YEAR(date){\n\treturn getJsDateFromExcel(date).getFullYear();\n}\n\nexport function NOW(){\n\tconst date = new Date();\n\treturn getExcelDateFromJs(date);\n}\n\nexport function DATEDIF(start, end, unit){\n\tif(unit != \"D\"){\n\t\tstart = getJsDateFromExcel(start);\n\t\tend = getJsDateFromExcel(end);\n\t}\n\n\tswitch(unit){\n\t\tcase \"Y\":\n\t\t\treturn end.getFullYear() - start.getFullYear();\n\t\tcase \"M\":{\n\t\t\tlet months = (end.getFullYear() - start.getFullYear()) * 12;\n\t\t\treturn months + end.getMonth() - (start.getMonth());\n\t\t}\n\t\tcase \"D\":{ \n\t\t\treturn Math.floor(end - start);\n\t\t}\n\t\tcase \"MD\":{\n\t\t\tconst diff = end.getDate() - start.getDate();\n\t\t\tif(diff < 0){\n\t\t\t\tconst startDateDays = new Date(start.getFullYear(), start.getMonth() + 1, 0).getDate();\n\t\t\t\treturn end.getDate() + startDateDays - start.getDate();\n\t\t\t}\n\t\t\treturn diff;\n\t\t}\n\t\tcase \"YM\":{\n\t\t\tconst months = end.getMonth() - start.getMonth();\n\t\t\treturn months < 0 ? 12 + months : months;\n\t\t}\n\t\tcase \"YD\":{\n\t\t\tconst diff = dayOfTheYear(end) - dayOfTheYear(start);\n\t\t\treturn diff < 0 ? 365 + diff : diff;\n\t\t}\n\t}\n}","export function IMAGE(url){\n\treturn `<img class=\"webix_ssheet_cimage\" src=\"${webix.template.escape(url)}\">`;\n}\n\nexport function SPARKLINE(arr, type, color1, color2){\n\tvar i, config = { type: type, color: color1, negativeColor:color2  },\n\t\twidth =  type == \"pie\"? 60: 150;\n\tfor(i =0 ; i < arr.length; i++)\n\t\tarr[i] = arr[i]||0;\n\treturn webix.Sparklines.getTemplate(config)(arr, { width:width, height: 35 });\n}\n\nexport function HYPERLINK(url, text){\n\ttext = text || url;\n\treturn `<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"${webix.template.escape(url)}\">${webix.template.escape(text)}</a>`;\n}\n\nexport function IF(check, pos, neg){\n\tif (check)\n\t\treturn pos;\n\telse\n\t\treturn neg;\t\n}","import * as numbers from \"./methods/numbers\";\nimport * as strings from \"./methods/strings\";\nimport * as date from \"./methods/date\";\nimport * as other from \"./methods/other\";\n\nexport const methods = {};\n\nwebix.extend(methods, numbers);\nwebix.extend(methods, strings);\nwebix.extend(methods, date);\nwebix.extend(methods, other);\n\nexport function addMethod(name, handler){\n\tmethods[name] = handler;\n}","import {getFormatName, checkFormat, isDateInvalid} from \"./formats\";\nimport {getExcelDateFromJs} from \"../math/methods/helpers\";\nimport {getMathFormat} from \"../math/parser\";\n\nexport function init(view){\n\tview.attachEvent(\"onCellChange\", function(row, col, value, type){\n\t\tif(!this._setType){\n\t\t\tconst format = getFormatName(this, row, col);\n\t\t\tsetType(this, row, col, format, type);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onBeforeFormatChange\", function(row, col, format){\n\t\tif(!this._setType)\n\t\t\tsetType(this, row, col, format, null, true);\n\t});\n\n\tview.attachEvent(\"onAction\", function(action, values){\n\t\tif(action == \"dropdown\" && values.newValue && values.newValue.editor == \"excel_date\"){\n\t\t\tconst format = getFormatName(this, values.row, values.column);\n\t\t\tif(getFormatType(format) != \"date\")\n\t\t\t\tthis.setFormat(values.row, values.column, webix.i18n.spreadsheet.formats.dateFormat);\n\t\t}\n\t});\n}\n\nfunction getExpectType(view, row, col, value, parseDate, isFormula, formatType, style){\n\t//date based math\n\tlet type = \"string\";\n\tif(!webix.isUndefined(value)){\n\t\tif(isFormula){\n\t\t\ttype = \"number\";\n\n\t\t\tif(/^=(now|date|time)\\(/i.test(value))\n\t\t\t\ttype = \"date\";\n\t\t\telse if(/^=(sparkline|image)\\(/i.test(value))\n\t\t\t\ttype = \"string\";\n\t\t}\n\t\telse if(!isNaN(value))\n\t\t\ttype = \"number\";\n\t\telse if(formatType != \"string\" && parseDate){\n\t\t\t//if user types a date string, or it comes from Excel import\n\t\t\t//set date type and convert string to Excel date\n\t\t\tconst parser = webix.Date.strToDate( webix.i18n.spreadsheet.formats.parseDateTime );\n\t\t\tvalue  = parser(value);\n\t\t\tif(value != \"\" && !isNaN(value)){\n\t\t\t\t//change cell style - value changes once (some value -> 35767.5)\n\t\t\t\t//change cell value - value changes twice (some value -> \"12/03/97\" -> 35767.5)\n\t\t\t\t//so ignore undo for cell value change\n\t\t\t\tif(style)\n\t\t\t\t\tdateToExcel(view, row, col, value);\n\t\t\t\telse\n\t\t\t\t\tview.ignoreUndo(() => dateToExcel(view, row, col, value));\n\n\t\t\t\ttype = \"date\";\n\t\t\t}\n\t\t}\n\t}\n\treturn type;\n}\n\nfunction dateToExcel(view, row, col, value){\n\tvalue = getExcelDateFromJs(value);\n\tview.setCellValue(row, col, value);\n}\n\nfunction checkType(type, expectType, formatType, isFormula, value){\n\ttype = type || expectType;\n\n\t//strings will always have string type regardless of format\n\tif(expectType == \"string\")\n\t\ttype = \"string\";\n\telse if(formatType)\n\t\ttype = formatType;\n\n\tif(type == \"date\" && !isFormula && isDateInvalid(value))\n\t\ttype = \"number\";\n\n\treturn type;\n}\n\nfunction getFormatType(format){\n\tlet formatType = format ? \"number\" : null;\n\tif(checkFormat(format, \"string\"))\n\t\tformatType = \"string\";\n\telse if(checkFormat(format, \"date\"))\n\t\tformatType = \"date\";\n\treturn formatType;\n}\n\nexport function getType(view, row, column){\n\tconst types = view.getRow(row).$cellType;\n\tif (types && types[column])\n\t\treturn types[column];\n}\n\nfunction setType(view, row, col, format, type, style){\n\t//prevent type change during value or format change\n\tview._setType = true;\n\tlet value = view.getCellValue(row, col);\n\n\tconst isFormula = typeof value == \"string\" && value[0] == \"=\";\n\tconst parseDate = (!style || format == \"date\") && (!view._loading_data || type == \"date\");\n\n\tconst mathFormat = isFormula && !format ? getMathFormat(view, value) : null;\n\n\tconst formatType = getFormatType(format || mathFormat);\n\tconst expectType = getExpectType(view, row, col, value, parseDate, isFormula, formatType, style);\n\n\ttype = checkType(type, expectType, formatType, isFormula, value);\n\tupdateCell(view, row, col, type, expectType, formatType, mathFormat);\n\n\tconst item = view.getRow(row);\n\tif(!item.$cellType)\n\t\titem.$cellType = {};\n\titem.$cellType[col] = type;\n\n\tdelete view._setType;\n}\n\n\n\nfunction updateCell(view, row, col, type, expectType, formatType, mathFormat){\n\tlet value = view.getCellValue(row, col);\n\tconst isFormula = typeof value == \"string\" && value[0] == \"=\";\n\tconst cellEditor = view.getCellEditor(row, col);\n\n\tif(mathFormat)\n\t\tview.setFormat(row, col, mathFormat.fmt);\n\telse if(type == \"date\"){\n\t\t// add default date format\n\t\tif(formatType != \"date\"){\n\t\t\tconst isTime = isFormula && value.toUpperCase().indexOf(\"=TIME(\") == 0;\n\t\t\tconst locale = webix.i18n.spreadsheet.formats;\n\t\t\tconst format = isTime ? locale.timeFormat : locale.dateFormat;\n\t\t\tview.setFormat(row, col, format);\n\t\t}\n\n\t\t//set date editor for cells with date type\n\t\tif(!isFormula && !cellEditor)\n\t\t\tview.setCellEditor(row, col, {editor: \"excel_date\"});\n\t}\n\telse if(formatType != \"string\" && type == \"string\" && expectType != \"string\"){\n\t\t//force text format for numbers typed as strings\n\t\tview.setFormat(row, col, \"@\");\n\t}\n\n\t//remove date editor\n\tif((type != \"date\" || isFormula) && cellEditor && cellEditor.editor == \"excel_date\")\n\t\tview.setCellEditor(row, col, null);\n}\n","import * as methods from \"./math/methods\";\nimport {getJsDateFromExcel} from \"./math/methods/helpers\";\nimport {getDateEditFormat} from \"./operations/formats\";\nimport {getType} from \"./operations/types\";\n\nlet methodsName = [];\nfor(let i in methods.methods)\n\tif( i!=\"__esModule\") methodsName.push(i);\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\treturn {\n\t\tview:\"toolbar\",\n\t\tcss:\"webix_ssheet_toolbar\",\n\t\telements:[\n\t\t\t{\n\t\t\t\tview:\"label\",\n\t\t\t\tlabel:webix.i18n.spreadsheet.liveEditor[\"edit\"],\n\t\t\t\twidth:60\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"live-editor\",\n\t\t\t\tdisabled:true,\n\t\t\t\tid:\"liveEditor\",\n\t\t\t\tsuggestData: methodsName\n\t\t\t}\n\t\t]\n\t};\n}\n\nfunction ready(view){\n\tvar editor = view.$$(\"liveEditor\");\n\n\t//block native editor, and move focus to the custom input\n\t//edit by key press\n\tview._table.attachEvent(\"onBeforeEditStart\", function(cell){\n\t\tlet mode = view._table.$anyKey;\n\t\tview._table.$anyKey = false;\n\n\t\treturn startEdit(this, cell, mode);\n\t});\n\t//edit by enter key\n\tview._table.attachEvent(\"onBeforeLiveEditor\", function(cell){\n\t\treturn startEdit(this, cell, false);\n\t});\n\t//edit by dbl-click\n\tview._table.attachEvent(\"onItemDblClick\", function(id){\n\t\tif(view.getCellEditor(id.row, id.column))\n\t\t\tthis.edit(id);\n\t\teditor.focus();\n\t});\n\n\tview._table.attachEvent(\"onAfterScroll\", function(){\n\t\tif(editor.$view.contains(document.activeElement))\n\t\t\teditor.paintValue();\n\t});\n\n\tview.attachEvent(\"onCellChange\", (r,c,v) => {\n\t\tvar cell = editor.config.activeCell;\n\t\tif (cell && cell.row == r && cell.column == c)\n\t\t\teditor.setValue(v);\n\t});\n\n\tview.attachEvent(\"onAfterSelect\", (data) => {\n\t\tif (!view.$handleSelection){\n\t\t\tlet cell = data[0];\n\t\t\tfillEditor(cell);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onChange\", (mode) => {\n\t\tif (mode == \"update\" && editor.isEnabled()){\n\t\t\tconst cell = editor.config.activeCell;\n\t\t\tif(cell && editor.getValue() != view.getCellValue(cell.row, cell.column)){\n\t\t\t\tdelete editor._update_range;\n\t\t\t\teditor.showActiveSheet();\n\t\t\t\teditor.updateCellValue();\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onBeforeSheetShow\", (name)=> {\n\t\tconst cell = editor.config.activeCell;\n\t\tif(cell){\n\t\t\tconst cursor = editor.getInputNode().selectionStart;\n\t\t\tconst val = editor.getValue();\n\t\t\tif(view.getCellValue(cell.row, cell.column) != val){\n\t\t\t\tif(!editor._activeMath)\n\t\t\t\t\teditor._activeMath = view.getActiveSheet();\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tif(name == editor._activeMath){\n\t\t\t\t\t\tview.$handleSelection = null;\n\t\t\t\t\t\tconst cell = editor.config.activeCell;\n\t\t\t\t\t\tview._table.select(cell.row, cell.column);\n\t\t\t\t\t}\n\n\t\t\t\t\teditor.setValue(val);\n\t\t\t\t\t//update highlight\n\t\t\t\t\teditor.refresh();\n\n\t\t\t\t\teditor.focus();\n\t\t\t\t\teditor.getInputNode().setSelectionRange(cursor, cursor);\n\t\t\t\t\teditor.paintValue();\n\n\t\t\t\t\tview.$handleSelection = function(a,b,st,en){ return pasteRange(st, en, a); };\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t\tclearEditor();\n\t\t}\n\t});\n\n\tview.attachEvent(\"onReset\", () => view.$handleSelection = null);\n\n\tview.attachEvent(\"onAfterLoad\", () => clearEditor());\n\n\tview.attachEvent(\"onAction\", function(name, options){\n\t\tconst cell = editor.config.activeCell;\n\t\tconst isActiveCell = cell && cell.row == options.row && cell.column == options.column;\n\t\tif(isActiveCell && (name == \"lock\" || name == \"dropdown\"))\n\t\t\tdisableEditor(options.row, options.column);\n\t});\n\n\tview.attachEvent(\"onFormatChange\", (r, c) => updateEditor(r, c));\n\tview.attachEvent(\"onCellChange\", (r, c) => updateEditor(r, c));\n\n\tfunction updateEditor(row, column){\n\t\tconst activeCell = editor.config.activeCell;\n\t\tif(activeCell && activeCell.row == row && activeCell.column == column)\n\t\t\tfillEditor({row, column});\n\t}\n\n\tfunction startEdit(table, cell, clear){\n\t\t//do not interfere with custom editors\n\t\tif (!view.getCellEditor(cell.row, cell.column) && fillEditor(cell, clear)){\n\t\t\teditor.focus();\n\t\t\tif(!clear)\n\t\t\t\teditor.paintValue();\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction disableEditor(row,column){\n\t\tconst disabled = view.getCellEditor(row, column) || view.isCellLocked(row, column);\n\t\tif(disabled)\n\t\t\teditor.disable();\n\t\telse\n\t\t\teditor.enable();\n\t\treturn disabled;\n\t}\n\n\tfunction fillEditor(cell, clear){\n\t\tconst disabled = disableEditor(cell.row, cell.column);\n\t\teditor.config.activeCell = cell;\n\t\teditor.setValue( clear ? \"\" : getCellValue(cell.row, cell.column) );\n\n\t\tview.$handleSelection = disabled ? null : function(a,b,st,en){ return pasteRange(st, en, a); };\n\t\treturn !disabled;\n\t}\n\n\tfunction getCellValue(row, column){\n\t\tlet value = view.getCellValue(row, column);\n\t\tif(getType(view, row, column) == \"date\" && value[0] != \"=\"){\n\t\t\tconst format = getDateEditFormat(view.getRow(row), column);\n\t\t\tvalue = format(getJsDateFromExcel(value));\n\t\t}\n\t\treturn value;\n\t}\n\n\tfunction pasteRange(st, en, cell){\n\t\tlet cursor = editor.getInputNode().selectionStart;\n\n\t\tlet sheet = \"\";\n\t\tif(editor._activeMath){\n\t\t\tconst activeSheet = view.getActiveSheet();\n\t\t\tif(editor._activeMath != activeSheet)\n\t\t\t\tsheet = editor.prepareSheet(activeSheet);\n\t\t}\n\n\t\tconst range = st == en ? sheet+st : `${sheet+st}:${sheet+en}`;\n\t\tconst updateRange = editor._update_range;\n\n\t\tif(updateRange && updateRange.pos == cursor - updateRange.len){\n\t\t\teditor.setRange(range, true);\n\t\t\tcursor = editor._update_range.pos + range.length;\n\t\t}\n\t\telse if(editor.expectOperator()){\n\t\t\teditor.setRange(range);\n\t\t\tcursor += range.length;\n\t\t}\n\t\telse\n\t\t\treturn endEdit(cell);\n\n\t\teditor.focus();\n\t\teditor.getInputNode().setSelectionRange(cursor, cursor);\n\t\teditor.paintValue();\n\n\t\treturn false;\n\t}\n\n\tfunction endEdit(st){\n\t\tif (editor.isEnabled()){\n\t\t\teditor.showActiveSheet();\n\t\t\teditor.updateCellValue();\n\t\t\teditor.setValue(st ? view.getCellValue(st.row, st.column) : \"\");\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction clearEditor(){\n\t\teditor.define({activeCell:null});\n\t\teditor.setValue(\"\");\n\t\teditor.disable();\n\t}\n}\n","export function find(arr, func){\n\tvar result = findIndex(arr, func);\n\treturn arr[result];\n}\n\nexport function findIndex(arr, func){\n\tvar result = -1;\n\tfor(var i =0; result<0 && i < arr.length; i++){\n\t\tif(func(arr[i]))\n\t\t\tresult = i;\n\t}\n\treturn result;\n}\n\nexport function getDimension(data, spans, rows, cols){\n\tfor(let i=0; i<data.length; i++){\n\t\t// data[i] - [ row, column, value, style]\n\t\tlet line = data[i];\n\t\tif (line[0]>rows) rows=line[0];\n\t\tif (line[1]>cols) cols=line[1];\n\t}\n\n\tif(spans)\n\t\tfor(let i = 0; i < spans.length; i++){\n\t\t\t// spans[i] - [ row, column, colCount, rowCount ]\n\t\t\tconst spanEndRow = spans[i][0] + spans[i][3] - 1;\n\t\t\tconst spanEndCol = spans[i][1] + spans[i][2] - 1;\n\n\t\t\tif(spanEndRow > rows) rows = spanEndRow;\n\t\t\tif(spanEndCol > cols) cols = spanEndCol;\n\t\t}\n\n\treturn [rows*1, cols*1];\n}","import * as arr from \"./helpers/array\";\n\nconst options = [\n\t\"rename-sheet\",\n\t\"remove-sheet\"\n];\n\nconst actionMap = {\n\t\"remove-sheet\": function(view){\n\t\tview.confirm({\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"sheet-remove-confirm\"]\n\t\t}).then(()=>{\n\t\t\tremove(view, view._activeSheet);\n\t\t});\n\t},\n\t\"rename-sheet\": function(view){\n\t\tedit(view, view._activeSheet);\n\t},\n\t\"new-sheet\": function(view){\n\t\tadd(view);\n\t},\n\t\"copy-sheet\": function(view){\n\t\tcopy(view);\n\t}\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n}\n\nexport function defaultBottom(view){\n\tvar readonly = view.config.readonly;\n\tvar tabWidth = view.config.sheetTabWidth;\n\tvar toolbar =  {\n\t\tview: \"toolbar\",\n\t\tid: \"bottom-toolbar\",\n\t\tcss: \"webix_ssheet_bottom_toolbar webix_layout_toolbar\",\n\t\tpaddingY: 0,\n\t\theight: 34,\n\t\telements:[\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"add-sheet\",\n\t\t\t\tlabel: \"<span class='webix_ssheet_icon_add_sheet'></span>\",\n\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"add-sheet\"]||\"\", hidden:readonly\n\t\t\t},\n\t\t\t{\n\t\t\t\tid:\"sheets\",\n\t\t\t\tview:\"sheets\",\n\t\t\t\twidth: 5 * tabWidth,\n\t\t\t\teditable:!readonly,\n\t\t\t\teditaction: \"dblclick\",\n\t\t\t\teditor:\"text\",\n\t\t\t\teditValue:\"value\",\n\t\t\t\ttype:{\n\t\t\t\t\twidth: tabWidth,\n\t\t\t\t\theight: 32,\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\treturn \"<div>\"+obj.value+\"</div>\"+\n\t\t\t\t\t\t\t(!readonly?\"<div class='webix_input_icon wxi-menu-down webix_ssheet_sheet_arrow'></div>\":\"\");\n\t\t\t\t\t},\n\t\t\t\t\t//remove skin selection css on dnd\n\t\t\t\t\tcss:\"ssheet_order_sheets\"\n\t\t\t\t},\n\t\t\t\tonClick:{\n\t\t\t\t\twebix_ssheet_sheet_arrow: function(e, id){\n\t\t\t\t\t\tinitSheetMenu(view, e, id);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonItemClick: function(id){\n\t\t\t\t\t\tif(id != view._activeSheet)\n\t\t\t\t\t\t\tview.showSheet(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"prev-sheet\", disabled:true, hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-left'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, -1);}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"next-sheet\", hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-right'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, 1);}\n\t\t\t}\n\t\t]\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"bottom-toolbar\", toolbar]);\n\n\treturn toolbar;\n}\n\nfunction scrollSheets(view, direction){\n\tvar sheets = view.$$(\"sheets\");\n\tsheets.scrollTo(sheets.getScrollState().x+(direction*view.config.sheetTabWidth), 0);\n}\n\nfunction menuInit(view){\n\tvar data = [];\n\tfor(var i=0; i < options.length;i++)\n\t\tdata.push({id: options[i], value:webix.i18n.spreadsheet.menus[options[i]]||options[i]});\n\n\tvar menu =  {\n\t\tview: \"ssheet-suggest\",\n\t\tdata: data\n\t};\n\tview.callEvent(\"onViewInit\", [\"sheet-menu\", menu]);\n\treturn menu;\n}\n\nexport function reset(view, obj){\n\tlet tabs = view.$$(\"sheets\");\n\tif (tabs){\n\t\ttabs.clearAll();\n\t\tlet set = [];\n\t\tobj.sheets.forEach(function(sheet){\n\t\t\tset.push({id:sheet.name, value: sheet.name});\n\t\t});\n\t\ttabs.parse(set);\n\t}\n}\n\nfunction ready(view){\n\tprepare(view);\n\n\tif(view.$$(\"add-sheet\"))\n\t\tview.$$(\"add-sheet\").attachEvent(\"onItemClick\", function(){\n\t\t\tadd(view);\n\t\t});\n\n\tview.attachEvent(\"onAfterSheetShow\", (name) => selectSheet(view,name));\n\n\tview.attachEvent(\"onCommand\", function(command){\n\t\tif(actionMap[command.id])\n\t\t\tactionMap[command.id](this);\n\t});\n\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").data.attachEvent(\"onStoreUpdated\", () => changePagerVisability(view));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterScroll\", () => changePagerStatus(view));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterDrop\", (context) => dataOrder(view,context.start,context.index));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterEditStop\", (state) => rename(view,state.old,state.value));\n\t}\n}\n\nfunction initSheetMenu(view, e, id){\n\tif(!view.$sheetMenu){\n\t\tview.$sheetMenu = webix.ui(menuInit(view));\n\t\tview._destroy_with_me.push(view.$sheetMenu);\n\t\tview.$sheetMenu.attachEvent(\"onItemClick\", (id)=> callAction(view,id));\n\t}\n\n\tif(view.$sheetMenu.getItem(\"remove-sheet\"))\n\t\tif(view.$$(\"sheets\").count() == 1)\n\t\t\tview.$sheetMenu.disableItem(\"remove-sheet\");\n\t\telse\n\t\t\tview.$sheetMenu.enableItem(\"remove-sheet\");\n\tif(view.callEvent(\"onBeforeSheetMenu\", [id])){\n\t\tview.$sheetMenu.show(e);\n\t}\n}\n\nfunction changePagerStatus(view){\n\tconst sheets = view.$$(\"sheets\");\n\tconst scrollPos = sheets.getScrollState().x;\n\n\tif(scrollPos == 0){\n\t\tview.$$(\"prev-sheet\").disable();\n\t}\n\telse{\n\t\tview.$$(\"prev-sheet\").enable();\n\t\tvar tabWidth = view.config.sheetTabWidth;\n\t\tif(scrollPos == (sheets.count()-(sheets.config.width/tabWidth))*tabWidth){\n\t\t\tview.$$(\"next-sheet\").disable();\n\t\t\treturn;\n\t\t}\n\t}\n\tview.$$(\"next-sheet\").enable();\n}\n\nfunction changePagerVisability(view){\n\tvar toolbar = view.$$(\"bottom-toolbar\");\n\tvar sheets = view.$$(\"sheets\");\n\n\tif(sheets.count() <= (sheets.config.width/view.config.sheetTabWidth))\n\t\ttoolbar.showBatch(\"pager\", false);\n\telse\n\t\ttoolbar.showBatch(\"pager\");\n}\n\nfunction dataOrder(view, name, num){\n\tfor (let id in view._sheets) {\n\t\tif (view._sheets[id].name == name) {\n\t\t\tconst item = view._sheets.splice(id, 1);\n\t\t\tview._sheets.splice(num, 0, item[0]);\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\nexport function add(view, content){\n\tvar index, name, newIndex;\n\n\tindex = arr.findIndex(view._sheets, x => x.name == view._activeSheet);\n\tnewIndex = index>-1?index+1:view._sheets.length;\n\tname = getNewTitle(view);\n\tcontent = content || {data:[]};\n\tview._sheets.splice(newIndex, 0, {\n\t\tname: name,\n\t\tcontent: content\n\t});\n\tview.$$(\"sheets\").add({id: name, value: name},newIndex);\n\tview.showSheet(name);\n\tview.callEvent(\"onSheetAdd\", [name]);\n\treturn name;\n}\n\nfunction getNewTitle(view){\n\tvar index = view._sheets.length+1;\n\twhile(getSheet(view, (webix.i18n.spreadsheet.labels.sheet+index)))\n\t\tindex++;\n\tvar name = webix.i18n.spreadsheet.labels.sheet+index;\n\treturn name;\n}\n\nfunction selectSheet(view,name){\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").select(name);\n\t\tview.$$(\"sheets\").showItem(name);\n\t}\n}\n\nexport function edit(view,name){\n\tview.$$(\"sheets\").edit(name);\n}\n\nexport function remove(view,name){\n\tvar index, newSheet;\n\tif(view._sheets.length >1){\n\t\tindex = arr.findIndex(view._sheets,x => x.name == name);\n\t\tview._sheets.splice(index,1);\n\t\tif(!view._sheets[index])\n\t\t\tindex = 0;\n\t\tnewSheet = \tview._sheets[index];\n\t\tview._activeSheet = null;\n\t\tif(view.$$(\"sheets\")){\n\t\t\tview.$$(\"sheets\").remove(name);\n\t\t\tview.$$(\"sheets\").refresh();\n\t\t}\n\t\tview.showSheet(newSheet.name);\n\t\tview.callEvent(\"onSheetRemove\", [name]);\n\t}\n}\n\nexport function rename(view,name,newName){\n\tif (name == newName) return;\n\n\t//correct sheet name\n\tvar i = 1;\n\twhile (!newName || getSheet(view, newName)){\n\t\tnewName = webix.i18n.spreadsheet.labels.sheet + i;\n\t\ti++;\n\t}\n\tnewName = newName.replace(/[*?:[\\]\\\\/]/g,\"\").substring(0, 31);\n\n\tvar sheet = getSheet(view, name);\n\tvar sheets = view.$$(\"sheets\");\n\n\tsheet.name = newName;\n\tif(view._activeSheet == name)\n\t\tview._activeSheet = newName;\n\n\tif(sheets){\n\t\tlet item = sheets.getItem(name);\n\t\titem.value = newName;\n\t\tsheets.data.changeId(name,newName);\n\t\tsheets.refresh(newName);\n\t}\n\n\tview.callEvent(\"onSheetRename\", [name, newName]);\n}\n\nexport function serialize(view, obj){\n\tgetSheet(view, view._activeSheet).content = obj;\n\treturn view._sheets;\n}\n\nexport function load(view, obj){\n\tobj = webix.isArray(obj)?{sheets:obj}:obj;\n\t\n\tif((obj.excel || !obj.sheets) && view._activeSheet){\n\t\t//loading into active sheet\n\t\tvar name = view._activeSheet;\n\t\tgetSheet(view, name).content = obj;\n\t\trefresh(view, obj);\n\t} else {\n\t\t//creating new set of sheets\n\t\tprepare(view, obj);\n\t}\n}\n\nexport function prepare(view, obj){\n\tif(!obj) obj = {data:[]}; \n\tif(!obj.sheets)\n\t\tobj = newSheet(obj);\n\t\n\tvar name = obj.sheets[0].name;\n\tview._activeSheet = \"\";\n\tview._sheets = obj.sheets;\n\treset(view, obj);\n\tshow(view, name);\n}\n\nexport function newSheet(obj){\n\treturn {\n\t\tsheets:[{\n\t\t\tname: webix.i18n.spreadsheet.labels.sheet + 1,\n\t\t\tcontent: obj\n\t\t}]\n\t};\n}\n\nexport function show(view,name){\n\tif (name == view._activeSheet) return;\n\n\tif(view.callEvent(\"onBeforeSheetShow\", [name])){\n\t\tif (view._activeSheet)\n\t\t\tgetSheet(view, view._activeSheet).content = view.serialize();\n\n\t\tview._activeSheet = name;\n\t\tvar obj = getSheet(view, name).content;\n\t\trefresh(view, obj);\n\n\t\tview.callEvent(\"onAfterSheetShow\", [name]);\n\t}\n}\n\nexport function getSheet(view, name){\n\treturn arr.find(view._sheets, x => x.name == name);\n}\n\nexport function eachSheet(view, callback){\n\tfor (var i=0; i<view._sheets.length; i++)\n\t\tcallback(view._sheets[i].name);\n}\n\nexport function getActive(view){\n\treturn view._activeSheet;\n}\n\nfunction refresh(view, obj){\n\tlet [rows, cols] = arr.getDimension(obj.data, obj.spans, view.config.rowCount, view.config.columnCount);\n\tview.callEvent(\"onReset\", []);\n\tif (rows != view.config.rowCount || cols != view.config.columnCount){\n\t\tview.config.rowCount = rows;\n\t\tview.config.columnCount = cols;\n\t\tview._resetTable();\n\t}\n\n\tview._loading_data = true;\n\tview.callEvent(\"onDataParse\", [obj]);\n\tview._loading_data = false;\n\tview._table.refresh();\n\tif(view.config.bottombar)\n\t\tview.$$(\"sheets\").refresh();\n}\n\nfunction copy(view){\n\tadd(view, view.serialize());\n}\n\nfunction callAction(view, id){\n\tif(!view.$sheetMenu.data.getMark(id, \"webix_disabled\"))\n\t\tactionMap[id](view);\n}\n\n","import \"../views/formlate\";\n\nexport class Dialog{\n\tconstructor(view){\n\t\tthis.view = view;\n\t}\n\t$init(){}\n\t$show(){}\n\t$hide(){}\n\topen(){\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=> {\n\t\t\t\tthis.$hide();\n\t\t\t\twebix.UIManager.setFocus(this.view);\n\t\t\t});\n\t\t\tthis.$dialog.attachEvent(\"onShow\", ()=> {\n\t\t\t\twebix.UIManager.setFocus(this.$dialog);\n\t\t\t});\n\t\t}\n\n\t\tconst form = this.$dialog.getBody();\n\t\tthis.$dialog.show();\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\tclose(){\n\t\tthis.$dialog.hide();\n\t}\n}","export function image(url){\n\treturn `=IMAGE(\"${url}\")`;\n}\n\nexport function chart(config){\n\tlet result = `=SPARKLINE(${config.range},\"${config.type}\"`;\n\tif (config.type === \"bar\")\n\t\tresult += `,\"${config.color}\",\"${config.negativeColor}\"`;\n\telse if(config.color)\n\t\tresult += `,\"${config.color}\"`;\n\treturn result+\")\";\n\n}\n\nexport function parseImage(value){\n\tif (value && value.indexOf(\"=IMAGE(\") === 0)\n\t\treturn {\n\t\t\turl: unescape(value.substr(7, value.length-8))\n\t\t};\n}\n\nexport function parseChart(value){\n\tif (value && value.indexOf(\"=SPARKLINE(\") === 0){\n\t\tlet text = value.substr(11, value.length-12).split(\",\");\n\t\treturn {\n\t\t\trange: text[0],\n\t\t\ttype: unescape(text[1]),\n\t\t\tcolor: unescape(text[2]),\n\t\t\tnegativeColor: unescape(text[3])\n\t\t};\n\t}\n}\n\nfunction unescape(text){\n\tif (!text) return \"\";\n\n\ttext = text.trim();\n\tif (text[0] === \"\\\"\") \n\t\ttext = text.substr(1);\n\tif (text[text.length-1] === \"\\\"\")\n\t\ttext = text.substr(0, text.length-1);\n\treturn text;\n}","import {Dialog} from \"./common\";\nimport {parseImage} from \"../math/writer\";\n\nexport const action = \"add-image-cell\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tform.elements.preview.setHTML(\"\");\n\t\tform.elements.url.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseImage(value);\n\t\tif (data && data.url)\n\t\t\tform.elements.url.setValue(data.url);\n\n\t\tform.elements.url.focus();\n\t}\n\t$init(){\n\t\tconst save = this.view.config.save;\n\t\tconst server = (save && save.images) || null;\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"image-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"image-url\"], on:{\n\t\t\t\t\t\t\"onChange\":(image) => this.showPreview(image)\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"label\", label:webix.i18n.spreadsheet.labels[\"image-or\"], align: \"center\"},\n\t\t\t\t\t{ view:\"uploader\", label:webix.i18n.spreadsheet.labels[\"image-upload\"], upload:server, on:{\n\t\t\t\t\t\tonBeforeFileAdd: function(file){\n\t\t\t\t\t\t\tif (!this.config.upload){\n\t\t\t\t\t\t\t\tconst reader = new FileReader();\n\t\t\t\t\t\t\t\treader.onload = (e) => this.getFormView().elements.url.setValue(e.target.result);\n\t\t\t\t\t\t\t\treader.readAsDataURL(file.file);\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tthis.getFormView().elements.preview.setHTML(\"\");\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonFileUpload: function(item, response){\n\t\t\t\t\t\t\tthis.getFormView().elements.url.setValue(response.imageURL);\n\t\t\t\t\t\t}\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless: true, css: \"webix_ssheet_preview\", template:\"\", height:50 }\n\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tconst cell = this.cell;\n\t\tconst image = this.fillUrl(this.$dialog.getBody().elements.url.getValue());\n\t\tthis.view.addImage(cell.row, cell.column, image);\n\t\tthis.close();\n\t}\n\tfillUrl(url){\n\t\tif (!/^[/]|((https?:\\/|data:image)\\/)/i.test(url))\n\t\t\turl = \"http://\" + url;\n\t\treturn url;\n\t}\n\tshowPreview(image){\n\t\tif (image){\n\t\t\timage = webix.template.escape(this.fillUrl(image));\n\t\t\tthis.$dialog.queryView(\"form\").elements.preview.setHTML(\"<img class='webix_ssheet_cimage' src='\"+image+\"'></img>\");\n\t\t}\n\t}\n}","import * as box from \"./imagecell\";\n\nexport const action = \"add-image-top\";\n\nexport class DialogBox extends box.DialogBox{\n\topen(action){\n\t\tthis.config = action.config;\n\t\tthis.viewid = action.viewid;\n\n\t\tthis.view.callEvent(\"onUIEditStart\", [this.viewid, \"image\"]);\n\n\t\tbox.DialogBox.prototype.open.apply(this, arguments);\n\t}\n\t$hide(){\n\t\tthis.view.callEvent(\"onUIEditStop\", [this.viewid, \"image\"]);\n\t\tthis.config = this.viewid = null;\n\t}\n\t$init(){\n\t\tthis.view.attachEvent(\"onUIEditStart\", (id, type)=>{\n\t\t\tif(this.$dialog && this.$dialog.isVisible() && type != \"image\")\n\t\t\t\tthis.close();\n\t\t});\n\n\t\tthis.view.attachEvent(\"onCommand\", obj =>{\n\t\t\tif(obj.id == \"close-ui-editor\" && this.$dialog && this.$dialog.isVisible())\n\t\t\t\tthis.close();\n\t\t});\n\n\t\treturn box.DialogBox.prototype.$init.apply(this, arguments);\n\t}\n\t$show(box, form){\n\n\t\tform.elements.preview.setHTML(\"\");\n\t\tform.elements.url.setValue(\"\");\n\n\t\tif(this.config && this.config.data)\n\t\t\tform.elements.url.setValue(this.config.data);\n\n\t\tform.elements.url.focus();\n\t}\n\tokClick(){\n\t\tconst image = this.fillUrl(this.$dialog.getBody().elements.url.getValue());\n\t\tif(this.viewid)\n\t\t\tthis.view.views.update(this.viewid, image);\n\t\telse{\n\t\t\tconst id = this.view.views.add(null, null, \"image\", image);\n\t\t\tthis.view.views.highlight(id);\n\t\t}\n\t\tthis.close();\n\t}\n}","import * as parser \t\t\tfrom \"./parser\";\n\n//convert math string to the js function\nlet actives = {};\nlet passives = {};\nexport function _parse(value, core, passive){\n\tvar struct = parser.parse(value, core, passive);\n\tif(passive && !passives[passive])\n\t\tpassives[passive] = {};\n\tvar cache = passive ? passives[passive] : actives;\n\tstruct.handler = cache[value] = cache[value] || _build_function(struct.code);\n\treturn struct;\n}\n\nexport function clearMathCache(activeOnly){\n\tactives = {};\n\tif(!activeOnly)\n\t\tpassives = {};\n}\n\nfunction error_function(){\n\treturn webix.i18n.spreadsheet.table[\"math-error\"];\n}\nfunction _build_function(value){\n\ttry{\n\t\treturn new Function(value);\n\t} catch(e){\n\t\treturn error_function;\n\t}\n}","import * as nms from \"../helpers/column_names\";\nimport {split, position} from \"../math/parser\";\n\nexport function updateMath(formula, action, area){\n\tconst stack = split(formula, true);\n\tconst max = stack.length;\n\tconst start = area ? area.start : null;\n\tconst end = area ? area.end : null;\n\tconst {count, id} = action;\n\n\tfor (let i = 1; i < max; i+=2) {\n\t\t//do not update cells in other sheets\n\t\tif(webix.isArray(stack[i])){\n\t\t\tconst [sheet, cell, escaped] = stack[i];\n\t\t\tconst quot = escaped ? \"'\" : \"\";\n\t\t\tstack[i] = quot + sheet + quot + \"!\" + cell;\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet [row, column, flags] = position(stack[i]);\n\n\t\tconst isRowFix = flags & 1;\n\t\tconst isColumnFix = flags & 2;\n\t\tconst range = checkRange(stack, i);\n\n\t\t// for cut operations we need to check whether referenced values are inside cut block. if so - update them.\n\t\tif (id == \"move\" && (!action.cut || (row >= start.row && row <= end.row && column >= start.column && column <= end.column))){\n\t\t\tcolumn += isColumnFix ? 0 : action.column;\n\t\t\trow += isRowFix ? 0 : action.row;\n\t\t}\n\t\telse if(id == \"row\" || id == \"column\"){\n\t\t\tconst isRow = id == \"row\";\n\t\t\tlet val = isRow ? row : column;\n\t\t\tif(count < 0 && range == \"start\"){\n\t\t\t\tif(action.start <= val && position(stack[i+2])[isRow ? 0 : 1] < action.start + Math.abs(count)){\n\t\t\t\t\tstack[i] = stack[i+2] = \"#REF!\";\n\t\t\t\t\ti += 2;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(action.start <= val){\n\t\t\t\tlet updated;\n\t\t\t\tif(count < 0 && action.start + Math.abs(count) > val){\n\t\t\t\t\tif(range){\n\t\t\t\t\t\tval = action.start - (range == \"end\" ? 1 : 0);\n\t\t\t\t\t\tupdated = true;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tstack[i] = \"#REF!\";\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!updated)\n\t\t\t\t\tval += count;\n\n\t\t\t\tif(isRow)\n\t\t\t\t\trow = val;\n\t\t\t\telse\n\t\t\t\t\tcolumn = val;\n\t\t\t}\n\t\t}\n\n\t\tif (column <= 0 || row <= 0)\n\t\t\tstack[i] = \"#REF!\";\n\t\telse\n\t\t\tstack[i] = (isColumnFix?\"$\":\"\") + nms.encode[column] + (isRowFix?\"$\":\"\") + row;\n\t}\n\n\treturn stack.join(\"\");\n}\n\nfunction checkRange(stack, index){\n\tif(stack[index+1] == \":\" && stack[index+2])\n\t\treturn \"start\";\n\telse if(stack[index-1] == \":\" && stack[index-2])\n\t\treturn \"end\";\n}\n\nexport function updateSheetNames(formula, oldName, newName, extra){\n\tvar stack = split(formula, true);\n\tfor(var i = 0; i < stack.length; i++){\n\t\tif(webix.isArray(stack[i])){\n\t\t\tvar thisSheet = stack[i][0] === oldName;\n\t\t\tif(!extra.multiSheet && thisSheet)\n\t\t\t\textra.multiSheet = true;\n\t\t\tvar sheet = thisSheet ? newName : stack[i][0];\n\t\t\tstack[i] = \"'\"+sheet+\"'!\"+stack[i][1];\n\t\t}\n\t}\n\treturn stack.join(\"\");\n}","//TODO\n// ### column deleting | adding\n// recalculate positions\n\n// ### copy paste between sheets\n// force sheet name\n\n// ### triggers\n// a <- p <- a\n// register triggers from passive sheet\n\n// ### sheet renaming\n// adjust math on sheet rename\n// adjust ranges on sheet rename\n\nimport {getActive, getSheet} from \"../sheets\";\nimport {range, encode} from \"../helpers/column_names\";\nimport {clearMathCache} from \"./cache\";\nimport {updateSheetNames} from \"./updater\";\nimport {getDimension} from \"../helpers/array\";\n\nexport function init(view, core, helpers){\n\tview.attachEvent(\"onBeforeSheetShow\", function(){\n\t\tdelete view._mathSheetCache[getActive(view)];\n\t});\n\tview.attachEvent(\"onSheetRename\", function(name, newName){\n\t\tview._sheets.forEach((sheet)=>{\n\t\t\tlet extra = {multiSheet:false};\n\t\t\tconst edit = [\"data\", \"editors\", \"conditions\", \"ranges\"];\n\t\t\tedit.forEach((param)=>{\n\t\t\t\tif(sheet.content[param])\n\t\t\t\t\tsheet.content[param].forEach((value)=>{\n\t\t\t\t\t\tswitch (param) {\n\t\t\t\t\t\t\tcase \"data\":\n\t\t\t\t\t\t\t\tif(value[2][0] === \"=\")\n\t\t\t\t\t\t\t\t\tvalue[2] = updateSheetNames(value[2], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"editors\": {\n\t\t\t\t\t\t\t\tconst options = value[2].options;\n\t\t\t\t\t\t\t\tif(options){\n\t\t\t\t\t\t\t\t\tif(typeof options == \"string\")\n\t\t\t\t\t\t\t\t\t\tvalue[2].options = updateSheetNames(options, name, newName, extra);\n\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\tfor (let i = 0; i < options.length; i++){\n\t\t\t\t\t\t\t\t\t\t\tconst option = typeof options[i] == \"string\" ? options[i] : options[i].value;\n\t\t\t\t\t\t\t\t\t\t\toptions[i] = updateSheetNames(option, name, newName, extra);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcase \"conditions\":\n\t\t\t\t\t\t\t\tif(value[3][0] === \"=\")\n\t\t\t\t\t\t\t\t\tvalue[3] = updateSheetNames(value[3], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"ranges\":\n\t\t\t\t\t\t\t\tvalue[1] = updateSheetNames(value[1], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t});\n\t\t\tif(extra.multiSheet === true){\n\t\t\t\tdelete view._mathSheetCache[sheet.name];\n\t\t\t\tgetAccessor(view, sheet.name);\n\t\t\t\tclearMathCache();\n\t\t\t}\n\t\t});\n\t\tdelete view._mathSheetCache[name];\n\t});\n\tview.attachEvent(\"onSheetRemove\", function(name){\n\t\tdelete view._mathSheetCache[name];\n\t});\n\n\tview._mathSheetCore = core;\n\tview._mathSheetHelpers = helpers;\n}\n\nexport function getAccessor(view, name){\n\tconst cache = view._mathSheetCache;\n\n\tif (!cache[name]){\n\t\tconst helpers = (!name || name == getActive(view)) ? activeAccessor(view) : passiveAccessor(view, name);\n\n\t\t//invalid sheet name\n\t\tif(!helpers)\n\t\t\treturn;\n\n\t\tconst temp = cache[name] = SheetAccessor(helpers);\n\n\t\ttemp.init();\n\t}\n\treturn cache[name];\n}\n\nfunction SheetAccessor(helpers){\n\treturn {\n\t\tinit:function(){\n\t\t\thelpers.init();\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn helpers.getRangeCode(name);\n\t\t},\n\t\tgetItem:function(r){\n\t\t\treturn helpers.getRow(r);\n\t\t},\n\t\tgetValue(r,c){\n\t\t\tvar val = helpers.getCell(r,c);\n\t\t\tvar test = val*1;\n\t\t\tif (!isNaN(test) && val !== \"\") return test;\n\t\t\treturn val?val:\"\";\n\t\t},\n\t\tgetRangeValue(name){\n\t\t\tvar code = this.getRangeCode(name) || name;\n\t\t\tif (code.indexOf(\":\") == -1) return [];\n\t\t\tvar pos = range(code);\n\t\t\treturn this.getRange.apply(this, pos);\n\t\t},\n\t\tgetRange(r1,c1,r2,c2){\n\t\t\tconst set = helpers.getRange(r1,c1,r2,c2);\n\t\t\tfor (let i = set.length-1; i>=0; i--){\n\t\t\t\tlet val = set[i];\n\t\t\t\tlet test = val !== \"\" ? val * 1 : \"\";\n\t\t\t\tset[i] = isNaN(test) ? (val?val:\"\") : test;\n\t\t\t}\n\t\t\treturn set;\n\t\t},\n\t\tgetName: function(){\n\t\t\treturn helpers.getName();\n\t\t},\n\t\tgetRangeCols:function(){\n\t\t\treturn getRangeCols.apply(helpers, arguments);\n\t\t},\n\t\tgetRangeRows:function(){\n\t\t\treturn getRangeRows.apply(helpers, arguments);\n\t\t}\n\t};\n}\n\nfunction activeAccessor(view){\n\treturn {\n\t\tinit:function(){\n\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn view.ranges.getCode(name);\n\t\t},\n\t\tgetRow:function(r){\n\t\t\treturn view.getRow(r);\n\t\t},\n\t\tgetCell:function(r,c){\n\t\t\tif(c > view.config.columnCount)\n\t\t\t\tthrow \"olumn does not exist\";\n\t\t\treturn view.getRow(r)[c];\n\t\t},\n\t\tgetName: function(){\n\t\t\treturn \"\";\n\t\t},\n\t\tgetRange:function(r1,c1,r2,c2){\n\t\t\tvar set = [];\n\t\t\tfor (var i = r1; i <= r2; i++){\n\t\t\t\tvar item = view.getRow(i);\n\t\t\t\tfor (var j = c1; j <= c2; j++)\n\t\t\t\t\tset.push(item[j]);\n\t\t\t}\n\t\t\treturn set;\n\t\t}\n\t};\n}\n\nfunction passiveAccessor(view, name){\n\tconst sheet = getSheet(view, name);\n\tif(!sheet)\n\t\treturn;\n\n\tconst page = sheet.content;\n\tconst table = [];\n\tconst formulas = [];\n\n\tconst ranges = [];\n\n\treturn {\n\t\tinit:function(){\n\t\t\tif (page.ranges){\n\t\t\t\tfor (var i = 0; i < page.ranges.length; i++) {\n\t\t\t\t\tvar line = page.ranges[i];\n\t\t\t\t\tranges[line[0]] = line[1];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (page.data){\n\t\t\t\tfor (let i = 0; i < page.data.length; i++) {\n\t\t\t\t\t//expand data structure\n\t\t\t\t\tlet [row, column, value] = page.data[i];\n\t\t\t\t\tif (!table[row])\n\t\t\t\t\t\ttable[row] = [];\n\t\t\t\t\ttable[row][column] = value;\n\n\t\t\t\t\tif (value[0] === \"=\"){\n\t\t\t\t\t\t//for math cells, store the code\n\t\t\t\t\t\tlet math = view._mathSheetHelpers.parse(value, view._mathSheetCore, name);\n\t\t\t\t\t\ttable[row][column] = math.handler;\n\n\t\t\t\t\t\t//store list of cross-sheet formulas\n\t\t\t\t\t\tfor (var j=0; j<math.triggers.length; j++){\n\t\t\t\t\t\t\tif (math.triggers[j][5]){\n\t\t\t\t\t\t\t\tformulas.push(page.data[i]);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn ranges[name];\n\t\t},\n\t\tgetRow(i){\n\t\t\treturn table[i] || [];\n\t\t},\n\t\tgetCell(i, j){\n\t\t\tconst [,cols] = getDimension(page.data, page.spans, 0, view.config.columnCount);\n\n\t\t\tif(j > cols)\n\t\t\t\tthrow \"olumn does not exist\";\n\n\t\t\tconst value = this.getRow(i)[j];\n\t\t\tif (typeof value === \"function\")\n\t\t\t\treturn view._mathSheetHelpers.execute(value, view._mathSheetCore);\n\n\t\t\treturn value;\n\t\t},\n\t\tgetName:function(){\n\t\t\treturn name;\n\t\t},\n\t\tgetRange:function(r1,c1,r2,c2){\n\t\t\tvar set = [];\n\t\t\tfor (var i = r1; i <= r2; i++)\n\t\t\t\tfor (var j = c1; j <= c2; j++)\n\t\t\t\t\tset.push(this.getCell(i,j));\n\t\t\treturn set;\n\t\t}\n\t};\n}\n\nfunction getRangeCols(r1,c1,r2,c2,lastIndex){\n\tlastIndex = lastIndex || 0;\n\tconst data = [];\n\tconst rangeToData = {};\n\tfor (let i = r1, rind = 0; i <= r2; i++, rind++){\n\t\tdata[rind] = {};\n\t\tconst item = this.getRow(i);\n\t\tfor (let j = c1, cind = lastIndex; j <= c2; j++, cind++){\n\t\t\tif(i == r2){\n\t\t\t\tconst sheetName = this.getName();\n\t\t\t\trangeToData[`${sheetName ? sheetName+\"!\" : \"\"}${encode[j]}${r1}:${encode[j]}${r2}`] = `data${cind}`;\n\t\t\t\tlastIndex++;\n\t\t\t}\n\t\t\tdata[rind][`data${cind}`] = item[j];\n\t\t}\n\t}\n\treturn [data, rangeToData, lastIndex];\n}\n\nfunction getRangeRows(r1,c1,r2,c2,lastIndex){\n\tlastIndex = lastIndex || 0;\n\tconst data = [];\n\tconst rangeToData = {};\n\tfor (let i = c1, cind = 0; i <= c2; i++, cind++){\n\t\tdata[cind] = {};\n\t\tfor (let j = r1, rind = lastIndex; j <= r2; j++, rind++){\n\t\t\tconst item = this.getRow(j);\n\t\t\tif(i == c2){\n\t\t\t\tconst sheetName = this.getName();\n\t\t\t\trangeToData[`${sheetName ? sheetName+\"!\" : \"\"}${encode[c1]}${j}:${encode[c2]}${j}`] = `data${rind}`;\n\t\t\t\tlastIndex++;\n\t\t\t}\n\t\t\tdata[cind][`data${rind}`] = item[i];\n\t\t}\n\t}\n\treturn [data, rangeToData, lastIndex];\n}","import {range} from \"../helpers/column_names\";\nimport {getAccessor} from \"./sheet\";\nimport {cell_template} from \"../table\";\nimport {clearMathCache} from \"./cache\";\n\nfunction nullFilter(){ \n\tconst locale = webix.i18n.spreadsheet.labels;\n\treturn { id:\"$empty\", value:\"\", $value:\"<span class='webix_ssheet_empty'>\"+locale[\"dropdown-empty\"]+\"</span>\" };\n}\n\nfunction getRange(view, r1,c1,r2,c2,sheet){\n\tconst values = [];\n\tfor (let i=r1; i<=r2; i++){\n\t\tconst item = this.getItem(i);\n\t\tfor (let j=c1; j<=c2; j++){\n\t\t\tlet value = (item[j] || item[j] === 0) ? item[j] : \"\";\n\t\t\tvalue = { id:value, value:value };\n\n\t\t\tif (!sheet || sheet == view._activeSheet){\n\t\t\t\tvalue[\"$value\"] = cell_template(view, item, null, item[j], {id:j}, true);\n\t\t\t\tvalue[\"format\"] = item.$cellFormat && item.$cellFormat[j];\n\t\t\t}\n\t\t\tvalues.push(value);\n\t\t}\n\t}\n\treturn values;\n}\n\nexport function rangeOptions(view, text, extra){\n\tlet values = [];\n\tif (typeof text == \"string\"){\n\t\tconst pos = range(text, view);\n\t\tif (pos){\n\t\t\tconst page = getAccessor(view, pos[4]);\n\t\t\tvalues = page ? getRange.apply(page, [view, ...pos]) : [];\n\t\t}\n\t}\n\telse if (webix.isArray(text))\n\t\tfor (let i=0; i<text.length; i++){\n\t\t\tlet v = (text[i] || text[i] === 0) ? text[i] : \"\";\n\t\t\tv = (typeof v === \"object\") ? webix.copy(v) : { id:v, value:v };\n\t\t\tvalues.push(v);\n\t\t}\n\n\tif (extra){\n\t\tif (extra.unique){\n\t\t\tconst test = {};\n\t\t\tfor (let i=values.length-1; i>=0; i--){\n\t\t\t\tif (test[values[i].id])\n\t\t\t\t\tvalues.splice(i, 1);\n\t\t\t\telse\n\t\t\t\t\ttest[values[i].id] = true;\n\t\t\t}\n\t\t}\n\n\t\tlet empty = false;\n\t\tfor (let i=values.length-1; i>=0; i--){\n\t\t\tvalues[i].value = String(values[i].value);\n\t\t\tif (values[i].value === \"\"){\n\t\t\t\tvalues.splice(i, 1);\n\t\t\t\tempty = true;\n\t\t\t}\n\t\t}\n\n\t\tif (extra.order)\n\t\t\tvalues.sort(function(objA, objB){\n\t\t\t\tconst sorters = view.$$(\"cells\").data.sorting.as;\n\t\t\t\tconst a = objA.value;\n\t\t\t\tconst b = objB.value;\n\n\t\t\t\treturn webix.rules.isNumber(a) && webix.rules.isNumber(b) ? sorters.int(a, b) : sorters.string(a, b);\n\t\t\t});\n\n\t\tif (empty && extra.filter)\n\t\t\tvalues.unshift( nullFilter() );\n\n\t\tif (extra.empty)\n\t\t\tvalues.unshift({ id:\"$empty\", $empty:true, value:\"\" });\n\t}\n\treturn values;\n}\n\nexport function rangeValues(view, text){\n\tlet values = [];\n\tif (typeof text == \"string\"){\n\t\tconst pos = range(text, view);\n\t\tif (pos){\n\t\t\tconst page = getAccessor(view, pos[4]);\n\t\t\tvalues = page ? page.getRange.apply(page, pos) : [];\n\t\t}\n\t} else\n\t\tvalues = webix.copy(text);\n\n\treturn values;\n}\n\nexport class Ranges{\n\tconstructor(view){\n\t\tthis._master = view;\n\t\tthis._ranges = {};\n\t}\n\tclear(){\n\t\tthis._ranges = {};\n\t}\n\tadd(name, text){\n\t\tthis._master.callEvent(\"onAfterRangeSet\", [name, text]);\n\t\tthis._ranges[name] = text;\n\n\t\tclearMathCache(true);\n\t\tthis._master.callEvent(\"onMathRefresh\", []);\n\t}\n\tgetCode(name, sheet){\n\t\tif (sheet){\n\t\t\tconst accessor = getAccessor(this._master, sheet);\n\t\t\treturn accessor ? accessor.getRangeCode(name) : null;\n\t\t}\n\n\t\treturn this._ranges[name];\n\t}\n\tremove(name){\n\t\tdelete this._ranges[name];\n\n\t\tclearMathCache(true);\n\t\tthis._master.callEvent(\"onMathRefresh\", []);\n\t}\n\tgetRanges(){\n\t\tvar data = [];\n\t\tfor(var name in this._ranges)\n\t\t\tdata.push({ name, range:this._ranges[name] });\n\n\t\treturn data;\n\t}\n\tparse(data){\n\t\tif (!data) return;\n\n\t\tlet i = data.length;\n\t\twhile(i--){\n\t\t\tvar c = data[i];\n\t\t\tthis._ranges[c[0]] = c[1];\n\t\t}\n\t}\n\tserialize(){\n\t\tvar name, data = [];\n\t\tfor( name in this._ranges)\n\t\t\tdata.push([name,this._ranges[name]]);\n\t\treturn data;\n\t}\n}\n","import {Dialog} from \"./common\";\nimport {rangeValues} from \"../math/ranges\";\nimport {range} from \"../helpers/column_names\";\nimport {parseChart} from \"../math/writer\";\n\nexport const action = \"add-sparkline\";\n\nconst labels = webix.i18n.spreadsheet.labels;\n\nfunction getTypes(){\n\treturn  [\n\t\t{id:\"line\", value:labels[\"line-chart\"]},\n\t\t{id:\"spline\", value:labels[\"spline-chart\"]},\n\t\t{id:\"splineArea\", value:labels[\"splinearea-chart\"]},\n\t\t{id:\"area\", value:labels[\"area-chart\"]},\n\t\t{id:\"bar\", value:labels[\"bar-chart\"]},\n\t\t{id:\"pie\", value:labels[\"pie-chart\"]}\n\t];\n}\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tconst els = form.elements;\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tels.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tels.range.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseChart(value);\n\t\tif (data){\n\t\t\tform.blockEvent();\n\t\t\tels.type.setValue(data.type);\n\t\t\tels.range.setValue(data.range);\n\t\t\tif (data.color){\n\t\t\t\tels.color_def.setValue(data.color);\n\t\t\t\tels.color_pos.setValue(data.color);\t\t\n\t\t\t}\n\t\t\tif (data.negativeColor)\n\t\t\t\tels.color_neg.setValue(data.negativeColor);\n\t\t\tform.unblockEvent();\n\t\t\tthis.renderPreview();\n\t\t}\t\n\n\t\tels.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead:labels[\"sparkline-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\", visibleBatch:1, on:{ onChange : ()=> this.renderPreview() },  elements:[\n\t\t\t\t\t{view: \"richselect\", name:\"type\", label:labels[\"sparkline-type\"], value:\"line\", labelPosition:\"left\", suggest:{\n\t\t\t\t\t\tview:  \"ssheet-form-suggest\",\n\t\t\t\t\t\tdata:getTypes()\n\t\t\t\t\t}, on:{\n\t\t\t\t\t\tonChange: function(type){\n\t\t\t\t\t\t\tconst form = this.getFormView();\n\t\t\t\t\t\t\tswitch(type){\n\t\t\t\t\t\t\t\tcase \"pie\":\n\t\t\t\t\t\t\t\t\tform.showBatch(3);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase \"bar\":\n\t\t\t\t\t\t\t\t\tform.showBatch(2);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tform.showBatch(1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"text\", label:labels[\"sparkline-range\"], name:\"range\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"sparkline-color\"], name:\"color_def\", id:\"add_sparkline_color\", value:\"#6666FF\", batch:\"1\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"sparkline-positive\"], name:\"color_pos\", value:\"#6666FF\", batch:\"2\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"sparkline-negative\"], name:\"color_neg\", value:\"#FF6666\", batch:\"2\"},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless:true, css:\"webix_ssheet_preview\", height:50 }\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tcheckRange(text){\n\t\tif(text && range(text, this.view))\n\t\t\treturn true;\n\t\tthis.view.alert({text:labels[\"error-range\"]});\n\t}\n\tokClick(){\n\t\tconst form = this.$dialog.getBody();\n\t\tconst data = form.getValues();\n\t\tdata.range = data.range.toUpperCase();\n\n\t\tif (data.range && this.checkRange(data.range)){\n\t\t\tconst config = this.sparkConfig(data);\n\n\t\t\tthis.view.addSparkline(this.cell.row, this.cell.column, config);\n\t\t\tthis.close();\n\t\t}\n\t}\n\n\trenderPreview(){\n\t\tconst form = this.$dialog.getBody();\n\t\tconst data = form.getValues();\n\t\tdata.range = data.range.toUpperCase();\n\n\t\tif (data.range && this.checkRange(data.range)){\n\t\t\tlet i,\n\t\t\t\tvalues = rangeValues(this.view, data.range),\n\t\t\t\tconfig = this.sparkConfig();\n\t\t\tfor(i =0 ; i < values.length; i++)\n\t\t\t\tvalues[i] = values[i]||0;\n\t\t\tform.elements.preview.setValue(webix.Sparklines.getTemplate(config)(values, { width:200, height: 40 }));\n\t\t}\n\t\telse\n\t\t\tform.elements.preview.setValue(\"\");\n\t}\n\n\tsparkConfig(config){\n\t\tconst form = this.$dialog.getBody();\n\t\tconst data = form.getValues();\n\t\tconfig = config || { type: data.type  };\n\t\tif (data.type === \"bar\"){\n\t\t\tconfig.color = data.color_pos;\n\t\t\tconfig.negativeColor = data.color_neg;\n\t\t}\n\t\telse if(form.elements.color_def.isVisible())\n\t\t\tconfig.color = data.color_def;\n\n\t\treturn config;\n\t}\n}","import {Dialog} from \"./common\";\nimport {isRange, toSheetRange} from \"../helpers/column_names\";\n\nexport const action = \"add-range\";\n\nexport class DialogBox extends Dialog{\n\t$show(box){\n\t\tconst table = box.$$(\"table\");\n\t\tconst form = box.$$(\"form\");\n\t\tconst sheet = \"\";// this.view.getActiveSheet(); ranges are per-sheet by default\n\n\t\tform.clear();\n\t\tform.clearValidation();\n\t\tform.elements.name.focus();\n\t\tform.elements.range.setValue(this.view.getSelectedRange());\n\n\t\ttable.clearAll();\n\t\ttable.parse( this.view.ranges.getRanges() );\n\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tform.elements.range.setValue(toSheetRange(a,b,sheet));\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\tsaveClick(){\n\t\tconst form = this.$dialog.$$(\"form\");\n\t\tconst data = form.getValues();\n\n\t\tconst sheets = data.range.indexOf(\"!\");\n\t\tdata.range = data.range.substr(0, sheets+1)+data.range.substr(sheets+1).toUpperCase();\n\t\tdata.name = data.name.toUpperCase();\n\n\t\tform.setValues(data);\n\n\t\tif (form.validate()){\n\t\t\tlet table = this.$dialog.$$(\"table\");\n\n\t\t\tif (data.id && table.exists(data.id))\n\t\t\t\ttable.updateItem(data.id, data);\n\t\t\telse\n\t\t\t\ttable.add(data);\n\n\t\t\tthis.view.ranges.add(data.name, data.range);\n\t\t\tform.clear();\n\t\t}\n\t}\n\tremoveRange(id){\n\t\tthis.view.confirm({\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"range-remove-confirm\"]\n\t\t}).then(()=>{\n\t\t\tlet table = this.$dialog.$$(\"table\");\n\t\t\tthis.view.ranges.remove(table.getItem(id).name);\n\t\t\ttable.remove(id);\n\t\t});\n\t}\n\teditRange(id){\n\t\tconst form = this.$dialog.$$(\"form\");\n\t\tform.clearValidation();\n\t\tform.setValues(this.$dialog.$$(\"table\").getItem(id));\n\t}\n\t$init(){\n\t\tconst theform = {\n\t\t\tpadding:0,\n\t\t\ttype: \"clean\",\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-dialog-table\", id: \"table\", borderless:true, columns:[\n\t\t\t\t\t{ id:\"name\", header:webix.i18n.spreadsheet.labels[\"range-name\"], width: 120 },\n\t\t\t\t\t{ id:\"range\", header:webix.i18n.spreadsheet.labels[\"range-cells\"], width: 120 },\n\t\t\t\t\t{ template:\"<div class='webix_icon wxi-pencil'></div>\", width:44 },\n\t\t\t\t\t{ template:\"<div class='webix_icon wxi-trash'></div>\", width:44 }\n\t\t\t\t],\n\t\t\t\tautowidth:true, height: 150,\n\t\t\t\tonClick:{\n\t\t\t\t\t\"wxi-trash\":(ev, id) => this.removeRange(id),\n\t\t\t\t\t\"wxi-pencil\":(ev, id) => this.editRange(id)\n\t\t\t\t}},\n\t\t\t\t{ width: 250, view: \"form\", id:\"form\",\n\t\t\t\t\trules:{\n\t\t\t\t\t\tname:(value) => { \n\t\t\t\t\t\t\tlet correct = /^[A-Za-z]+$/.test(value);\n\t\t\t\t\t\t\tlet table = this.$dialog.$$(\"table\");\n\t\t\t\t\t\t\tlet data = this.$dialog.$$(\"form\").getValues();\n\n\t\t\t\t\t\t\tlet unique = true;\n\t\t\t\t\t\t\ttable.eachRow(function(id){\n\t\t\t\t\t\t\t\tlet obj = this.getItem(id);\n\t\t\t\t\t\t\t\tif (obj.name == value && obj.id != data.id)\n\t\t\t\t\t\t\t\t\tunique = false; \n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\treturn correct && unique; \n\t\t\t\t\t\t},\n\t\t\t\t\t\trange:isRange\n\t\t\t\t\t},\n\t\t\t\t\telementsConfig:{\n\t\t\t\t\t\tlabelWidth: 70\n\t\t\t\t\t},\n\t\t\t\t\telements:[\n\t\t\t\t\t\t{ view: \"text\", name:\"name\", gravity:1, label: webix.i18n.spreadsheet.labels[\"range-name\"]},\n\t\t\t\t\t\t{ view: \"text\", name:\"range\", gravity:1, label: webix.i18n.spreadsheet.labels[\"range-cells\"]}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tmove:true,\n\t\t\thead: webix.i18n.spreadsheet.labels[\"range-title\"],\n\t\t\tautoheight: true,\n\t\t\twidth: 610,\n\t\t\tposition: \"center\",\n\t\t\tbody: theform,\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.saveClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}","import {Dialog} from \"./common\";\nimport {range} from \"../helpers/column_names\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"add-dropdown\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tlet form = this.$dialog.$$(\"form\");\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tform.clear();\n\n\t\t//restore previosly selected range\n\t\tlet value = this.view.getCellEditor(this.cell[0].row, this.cell[0].column);\n\t\tif (value && value.options)\n\t\t\tform.elements.range.setValue(value.options);\n\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tform.elements.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\thead:webix.i18n.spreadsheet.labels[\"dropdown-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tpadding:0, view:\"form\", id:\"form\", rows:[\n\t\t\t\t\t{ view:\"text\", label:webix.i18n.spreadsheet.labels[\"dropdown-range\"], name:\"range\" }\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tconst values = this.$dialog.$$(\"form\").elements.range.getValue();\n\n\t\tif (values){\n\t\t\tif(!range(values, this.view))\n\t\t\t\tthis.view.alert({text:webix.i18n.spreadsheet.labels[\"error-range\"]});\n\t\t\telse{\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tfor (let i = 0; i < this.cell.length; i++)\n\t\t\t\t\t\tthis.view.setCellEditor(this.cell[i].row, this.cell[i].column, { editor:\"ss_richselect\", options:values});\n\t\t\t\t}, this);\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tthis.close();\n\t}\n}","import group from \"./undo_group\";\n\nexport const lockCss = \"webix_lock\";\n\nexport function init(view){\n\tview._locks = {};\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, mode) => {\n\t\tif (type === \"lock\") lockCell(view, row, column, !!mode, true);\n\t});\n\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"lock-cell\")\n\t\t\tlock(view);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._locks = {};\n}\n\nexport function lockCell(view, row, column, mode, silent){\n\tvar table = view.$$(\"cells\");\n\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\tgroup.set(function() {\n\t\t\t_mapCellsCalls(row, column, function(row, column){\n\t\t\t\tlockCell(view, row, column, mode, true);\n\t\t\t});\n\t\t});\n\t} else {\n\t\tmode = ((mode === false) ? false : true);\n\t\tvar objrow = view._locks[row] = view._locks[row] || {};\n\t\tobjrow[column] = mode;\n\t\tif (mode)\n\t\t\ttable.addCellCss(row, column, lockCss, true);\n\t\telse\n\t\t\ttable.removeCellCss(row, column, lockCss, true);\n\n\t\tview.callEvent(\"onAction\", [\"lock\", { row, column, value: !mode, newValue: mode }]);\n\t}\n\n\tif (!silent)\n\t\ttable.refresh();\n}\n\nfunction _mapCellsCalls(start, end, handler,master){\n\tfor (let x = start.row; x<=end.row; x++)\n\t\tfor (let y = start.column; y<=end.column; y++)\n\t\t\thandler.call(master||this, x, y);\n}\n\nexport function isCellLocked(view, row, column){\n\treturn view._locks[row]?view._locks[row][column]:false;\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\tlocked = [];\n\tfor(row in view._locks){\n\t\tfor(column in view._locks[row])\n\t\t\tif(view._locks[row][column])\n\t\t\t\tlocked.push([row,column]);\n\t}\n\tdata.locked = locked;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tlocked = data.locked;\n\n\tif(locked)\n\t\tfor(i = 0; i < locked.length; i++)\n\t\t\tlockCell(view, locked[i][0],locked[i][1],true, true);\n}\n\nfunction lock(view){\n\tvar block = view.$$(\"cells\").getSelectArea();\n\tif (block){\n\t\tvar mode = view.isCellLocked(block.start.row, block.start.column);\n\t\tview.lockCell(block.start, block.end, !mode);\n\t}\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet locked = data.locked,\n\t\ti = locked.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = locked[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tlocked.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tlocked[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tlocked.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tlocked[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}","import {lockCss} from \"./lock_cell\";\nimport {find, findIndex} from \"../helpers/array\";\nimport {save} from \"./save\";\n\nexport function init(view){\n\tview.attachEvent(\"onStyleChange\", (row, column, style) => {\n\t\tvar span = getSpan(view, row, column);\n\t\tif (span){\n\t\t\tvar extraCss = getExtraCss(view, row, column);\n\t\t\tspan[3] = (style ? style.id : \"\") + (extraCss ? (\" \" + extraCss) : \"\");\n\t\t}\n\t});\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tif (data.spans)\n\t\t\tfor (var i = 0; i < data.spans.length; i++) {\n\t\t\t\tvar span = data.spans[i];\n\t\t\t\taddSpan( view,\n\t\t\t\t\t{ row: span[0], column: span[1] },\n\t\t\t\t\tspan[2]*1,\n\t\t\t\t\tspan[3]*1,\n\t\t\t\t\ttrue \n\t\t\t\t);\n\t\t\t}\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tvar spans = [];\n\t\tvar pull = view.$$(\"cells\").getSpan();\n\t\tif (pull){\n\t\t\tfor (var rid in pull){\n\t\t\t\tvar row = pull[rid];\n\t\t\t\tfor (var cid in row){\n\t\t\t\t\tvar span = row[cid];\n\t\t\t\t\tspans.push([rid*1, cid*1, span[0], span[1]]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdata.spans = spans;\n\t\t}\n\t});\n\t\n\tview.attachEvent(\"onUndo\", (type, row, column, value, isUndo) => {\n\t\tif(type == \"span\" || type == \"split\"){\n\t\t\tif (type == \"span\") \n\t\t\t\tisUndo = !isUndo;\n\t\t\tundoSpan(view, row, column, value, isUndo);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (name, options) => {\n\t\tif(name == \"lock\")\n\t\t\tsetSpanCss(view, options.row, options.column, lockCss, options.newValue);\n\t\telse if(name == \"before-grid-change\")\n\t\t\tupdatePosition(options.name,options.inc,options.data, options.start);\n\t\telse if(name == \"check-borders\")\n\t\t\treturn checkSpanBorders(view, options.row, options.column, options.area, options.mode);\n\t});\n}\n\nfunction getSpan(view, row, column){\n\tvar item = view.$$(\"cells\").getSpan()[row];\n\tif (item)\n\t\treturn item[column];\n}\n\nexport function addSpan(view, cell, x, y, silent){\n\tif (x<2 && y<2) return;\n\n\tif(silent || view.callEvent(\"onBeforeSpan\", [cell.row, cell.column, [x, y]])){\n\t\tvar row = view.getRow(cell.row);\n\t\tvar css = row.$cellCss ? (row.$cellCss[cell.column] || \"\") : \"\";\n\t\tvar extraCss = getExtraCss(view, cell.row, cell.column);\n\t\tif (extraCss)\n\t\t\tcss += \" \" + extraCss;\n\n\t\tsetSpanValue(view, cell, x, y);\n\t\tview.$$(\"cells\").addSpan(cell.row, cell.column, x, y, null, css);\n\t\tif (!silent){\n\t\t\tview.callEvent(\"onAfterSpan\", [cell.row, cell.column, [x, y]]);\n\t\t\tsave(view, \"spans\", {\n\t\t\t\trow:cell.row, column: cell.column,\n\t\t\t\tx:x, y:y\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport function removeSpan(view, cell){\n\tvar span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\tif(span && view.callEvent(\"onBeforeSplit\", [ cell.row, cell.column, [span[2], span[3]] ])){\n\t\tview.$$(\"cells\").removeSpan(cell.row, cell.column);\n\t\tview.callEvent(\"onAfterSplit\", [ cell.row, cell.column, [span[2], span[3]] ]);\n\t\tsave(view, \"spans\", {\n\t\t\trow:cell.row, column: cell.column,\n\t\t\tx:0, y:0\n\t\t});\n\t}\n}\n\nexport function getRange(sel){\n\tvar lx, ly, rx, ry;\n\trx = ry = 0;\n\tlx = ly = Infinity;\n\n\tfor (var i=0; i<sel.length; i++){\n\t\tvar cx = sel[i].column*1;\n\t\tvar cy = sel[i].row*1;\n\n\t\tlx = Math.min(cx, lx);\n\t\trx = Math.max(cx, rx);\n\t\tly = Math.min(cy, ly);\n\t\try = Math.max(cy, ry);\n\t}\n\n\treturn {\n\t\tcell:{ row:ly, column:lx },\n\t\tx: rx-lx+1,\n\t\ty: ry-ly+1\n\t};\n}\n\nexport function setSpanCss(view, row, column, css, add){\n\tconst span = getSpan(view, row, column);\n\tif (span){\n\t\tif (add){\n\t\t\tif (span[3].indexOf(css) == -1)\n\t\t\t\tspan[3] += \" \" + css;\n\t\t} else {\n\t\t\tspan[3] = span[3].replace(\" \" + css, \"\");\n\t\t}\n\t}\n}\n\nfunction getExtraCss(view, row, column){\n\tlet extraCss = [];\n\tif(view.getCellEditor(row, column))\n\t\textraCss.push(\"ss_editor\");\n\tif(view.getCellFilter(row, column))\n\t\textraCss.push(\"ss_filter\");\n\treturn extraCss.join(\" \");\n}\n\nfunction undoSpan(view,row, column,value,isUndo){\n\tif(isUndo){\n\t\tremoveSpan(view,{row: row, column: column});\n\t}\n\telse{\n\t\taddSpan(view, {row: row, column: column}, value[0], value[1]);\n\t}\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet spans = data.spans;\n\tif(inc){\n\t\tfor(let i = spans.length-1;i >=0;i--){\n\t\t\tlet [row,column] = spans[i];\n\n\t\t\tif(inc < 0){//deleting\n\t\t\t\tif(name == \"row\" && row <= start.row-inc-1)\n\t\t\t\t\tinc = start.row - spans[i][0];\n\t\t\t\telse if (name == \"column\" && column <= start.column-inc-1)\n\t\t\t\t\tinc = start.column - spans[i][1];\n\t\t\t}\n\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tspans[i][0] =  name == \"row\"?row*1 + inc:row;\n\t\t\t\tspans[i][1] = name == \"column\"?column*1 + inc:column;\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar borderChecks = {\n\t\"border-right\":\t\tfunction(row, column, span, area){\n\t\treturn area.end.column == column+span[0]-1;\n\t},\n\t\"border-bottom\":\tfunction(row, column, span, area){\n\t\treturn area.end.row == row+span[1]-1;\n\t}\n};\n\nfunction checkSpanBorders(view, row, column, area, mode){\n\tvar span = getSpan(view, row, column);\n\treturn span&&borderChecks[mode]?borderChecks[mode](row, column, span, area):false;\n}\n\n// clear merged cells except the first one\nfunction setSpanValue(view, cell, x, y){\n\tvar i,j,value,\n\t\trow = cell.row*1,\n\t\tcolumn = cell.column*1,\n\t\tisEmpty = !view.getCellValue(row,column);\n\tfor(i = row; i < row+y; i++){\n\t\tfor(j = column; j < column+x; j++) {\n\t\t\tvalue = view.getCellValue(i,j);\n\t\t\tif(value!==\"\" && (j != column || i != row)){\n\t\t\t\tif(isEmpty){\n\t\t\t\t\tisEmpty = false;\n\t\t\t\t\tview.setCellValue(row,column,value);\n\t\t\t\t}\n\t\t\t\tview.setCellValue(i,j,\"\");\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function adjustSpan (span, action, start, end, data){\n\tvar length = action.group == \"row\" ? span[3] : span[2];\n\tvar checkSpan = action.group == \"row\" ? [span[0]*1, span[0]*1+span[3]-1] : [span[1]*1, span[1]*1+span[2]-1];\n\tvar selection = action.group == \"row\" ? [start.row, end.row] : [start.column, end.column];\n\n\t//if we add, the number of selected rows/cols is added to span, so we need original selection length\n\tvar inc = selection[1] - selection[0] + 1;\n\n\tselection[0] = Math.max(selection[0], checkSpan[0]);\n\tselection[1] = Math.min(selection[1], checkSpan[1]);\n\n\tvar isFirstCell = selection[0] == checkSpan[0];\n\n\tif(selection[0] <= selection[1]){ //selection is in span\n\t\tif(action.id == \"del\") //if we delete, only rows/cols included into span\n\t\t\tinc = (selection[1] - selection[0]+ 1) * -1;\n\t\t//delete smth which starts as span and less than it's length\n\t\tif(action.id == \"del\" && isFirstCell && length > -1*inc){\n\t\t\tvar value = find(data, function(value) {\n\t\t\t\treturn (value[0] == span[0] && value[1] == span[1]);\n\t\t\t});\n\n\t\t\tvalue[0] = action.group == \"row\" ? value[0] - inc : value[0];\n\t\t\tvalue[1] = action.group == \"column\" ? value[1] - inc : value[1];\n\n\t\t\tvar oldValue = findIndex(data, function(oldValue) {\n\t\t\t\treturn oldValue[0] == value[0] && oldValue[1] == value[1] && (oldValue[2] != value[2] || oldValue[3] != value[3]); \n\t\t\t});\n\n\t\t\tif(oldValue > -1) //remove another data at the same place\n\t\t\t\tdata.splice(oldValue,1);\n\t\t}\n\n\t\tif(!(isFirstCell && action.id == \"add\")){\n\t\t\tspan[2] = action.group == \"column\" ? span[2]+inc : span[2];\n\t\t\tspan[3] = action.group == \"row\" ? span[3]+inc : span[3];\n\t\t}\n\t}\n\treturn span;\n}\n\nexport function pasteSpan(view, extra, row, col, cutted, translate){\n\t//existing span\n\tvar s = view._table.getSpan(row, col);\n\tif(extra && extra.span){\n\t\tvar span = extra.span;\n\t\t//if we are on start position for the future span\n\t\tif(row == span[0]*1+translate.row && col == span[1]*1+translate.column){\n\t\t\t//delete spans in future paste zone \n\t\t\tview._table.mapCells(row, col, span[3], span[2], (value, rid, cid) => {\n\t\t\t\ts = view._table.getSpan(rid,cid);\n\t\t\t\tif(s) removeSpan(view, {row:s[0], column:s[1]});\n\t\t\t}, true);\n\t\t\taddSpan(view, {row:row, column:col}, span[2], span[3]);\n\t\t\tif(cutted === 1)\n\t\t\t\tremoveSpan(view, {row:extra.row, column:extra.col});\n\t\t}\n\t}\n\telse if(s)\n\t\tremoveSpan(view, {row:s[0], column:s[1]});\n}","import group from \"./undo_group\";\nimport {getType} from \"./types\";\nimport {setSpanCss} from \"./spans\";\nimport {isDateInvalid} from \"./formats\";\nimport {rangeOptions} from \"../math/ranges\";\nimport {changeRange, eachRange, toRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tconst table = view._table;\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\treset(view);\n\n\ttable.on_click.ssheet_filter_sign = (e, id) => {\n\t\tconst filter = table._ssFilters[id.row][id.column];\n\t\tconst mode = filter.mode || getFilterMode(view, id.row, id.column);\n\n\t\tlet options = [];\n\t\tif (filter.options){\n\t\t\tif (typeof filter.options == \"string\")\n\t\t\t\toptions = rangeOptions(view, filter.options, { unique:true, order:true, filter:true });\n\t\t\telse if (webix.isArray(filter.options))\n\t\t\t\toptions = rangeOptions(view, filter.options, { filter:true });\n\t\t}\n\t\tview.callEvent(\"onCommand\", [{id:\"start-filter\", cell:id, mode, options, filter}]);\n\t};\n\ttable.on_dblclick.ssheet_filter_sign = () => false;\n\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"create-filter\")\n\t\t\ttoggleFilters(view);\n\t});\n\n\tlet refilter = false;\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type == \"filter\"){\n\t\t\tvalue = (typeof value == \"object\") ? value : null;\n\t\t\tview.setCellFilter(row, column, value);\n\t\t\trefilter = true;\n\t\t}\n\t\telse if (type == \"apply-filter\"){\n\t\t\tconst filter = view.getCellFilter(row, column);\n\n\t\t\tfilter.value = value;\n\t\t\tdelete filter.handler;\n\t\t\tif (value && value.condition){\n\t\t\t\tconst mode = filter.mode || getFilterMode(view, row, column);\n\t\t\t\tfilter.handler = getFilterFunction(mode, filter.value);\n\t\t\t}\n\t\t\trefilter = true;\n\n\t\t\t// update css\n\t\t\tconst add = value && isValueActive(value);\n\t\t\ttable[add?\"addCellCss\":\"removeCellCss\"](row, column, \"ss_filter_active\");\n\t\t\tsetSpanCss(view, row, column, \"ss_filter_active\", add);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAfterUndo\", () => {\n\t\tif (refilter){\n\t\t\tview.filterSpreadSheet();\n\t\t\trefilter = false;\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif (action == \"filter\"){\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_filter\", p.newValue);\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_filter_active\", (p.newValue && p.newValue.value && isValueActive(p.newValue.value)));\n\t\t\tmarkBarFilter(view);\n\t\t}\n\t\telse if (action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name, p.inc, p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._table._ssFilters = {};\n\tmarkBarFilter(view);\n}\n\nexport function getFilters(table){\n\tconst filters = table._ssFilters;\n\tconst all = [];\n\tfor (let row in filters)\n\t\tfor (let column in filters[row])\n\t\t\tall.push(filters[row][column]);\n\treturn all;\n}\n\nexport function serialize(view,data){\n\tconst filters = getFilters(view._table);\n\tconst result = data.filters = [];\n\n\tfor (let i = 0; i<filters.length; i++){\n\t\tlet {row, column, options, mode, value} = filters[i];\n\t\tvalue = value && webix.copy(value);\n\t\tresult.push([row, column, {value, options, mode}]);\n\t}\n}\n\nexport function load(view,data){\n\tconst filters = data.filters;\n\n\tif (filters){\n\t\tfor (let i = 0; i < filters.length; i++){\n\t\t\tview.setCellFilter(filters[i][0], filters[i][1], (filters[i][2] || {options:\"\"}));\n\t\t}\n\t\tview.filterSpreadSheet();\n\t}\n}\n\nexport function clearFilters(view, range){\n\tlet refilter = false;\n\teachRange(range, view, function(view, cell){\n\t\tlet filter = view._table._ssFilters[cell.row];\n\t\tif (filter){\n\t\t\tif (filter[cell.column]){\n\t\t\t\trefilter = true;\n\t\t\t\tdelete filter[cell.column];\n\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_filter\");\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_filter_active\");\n\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_filter\", false);\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_filter_active\", false);\n\t\t\t}\n\t\t}\n\t});\n\n\tif (refilter)\n\t\tview.filterSpreadSheet();\n}\n\nexport function isFilter(view, row, column){\n\tconst filters = view._table._ssFilters;\n\treturn filters[row] && !!filters[row][column];\n}\n\nexport function calibrateRange(view, row, column, range){\n\tif(!range)\n\t\trange = {end:{row:row}};\n\n\tif (range.end){\n\t\tvar endRow = range.end.row;\n\t\trange = getFilterRange(view, row, column, endRow);\n\t}\n\treturn range;\n}\n\nexport function isValueActive(value){\n\treturn !!(value.includes || (value.condition && value.condition.filter));\n}\n\nfunction isFilterExists(view){\n\tconst filters = view._table._ssFilters;\n\tfor (let row in filters)\n\t\tfor (let column in filters[row])\n\t\t\tif (filters[row][column]) return true;\n\treturn false;\n}\n\nfunction markBarFilter(view){\n\tconst value = isFilterExists(view);\n\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"create-filter\", value}]);\n}\n\n\nfunction getFilterRange(view, row, column, endRow){\n\tif (row === endRow){\n\t\tfor (endRow = row; endRow < view.config.rowCount; endRow++){\n\t\t\tif(!view.getCellValue(endRow+1, column))\n\t\t\t\tbreak;\n\t\t}\n\t}\n\treturn toRange(row+1, column, endRow, column);\n}\n\nexport function getFilterMode(view, row, column){\n\tfor (let i=row; i<view.config.rowCount; i++){\n\t\tconst item = view.getRow(i+1);\n\t\tconst value = item[\"$\"+column] || item[column];\n\n\t\tif (value || value === 0){\n\t\t\tconst type = getType(view, i+1, column);\n\t\t\treturn (type == \"number\" || type == \"date\") ? type : \"text\";\n\t\t}\n\t\telse if (value !== \"\")\n\t\t\tbreak;\n\t}\n\treturn \"text\";\n}\n\nfunction toggleFilters(view){\n\tconst range = view._table.getSelectArea();\n\n\tif (isFilterExists(view)){\n\t\tgroup.set(function(){\n\t\t\tview.removeFilters();\n\t\t});\n\t\tif (range)\n\t\t\tview._table.addSelectArea(range.start, range.end);\n\t}\n\telse if (range)\n\t\tgroup.set(function(){\n\t\t\tlet row = range.start.row;\n\t\t\tfor (let i=range.start.column; i<=range.end.column; i++){\n\t\t\t\tview.setCellFilter(row, i, { options:range });\n\t\t\t}\n\t\t});\n\tmarkBarFilter(view);\n}\n\nfunction updatePosition(name, inc, data, start){\n\tconst filters = data.filters;\n\n\tif (inc){\n\t\tfor(let i=filters.length-1; i>=0; i--){\n\t\t\tlet [row,column,filter] = filters[i];\n\t\t\tif (name == \"row\" && row >= start.row || name == \"column\" && column >= start.column){\n\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc){\t//delete filter mark if row was deleted\n\t\t\t\t\t\tfilters.splice(i,1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tfilters[i][0] = row*1 + inc;\n\t\t\t\t}\n\t\t\t\telse if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tfilters.splice(i, 1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else \n\t\t\t\t\t\tfilters[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t\tfilter.options = changeRange(filter.options, name, inc, start);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function pasteFilter(view, extra, row, col, cutted, translate){\n\tconst filter = extra.filter;\n\n\tfilter.options = changeRange(filter.options, \"row\", translate.row, {column:extra.col, row:extra.row});\n\tfilter.options = changeRange(filter.options, \"column\", translate.column, {column:extra.col, row:extra.row});\n\n\tdelete filter.value; delete filter.handler;\n\tview.setCellFilter(row, col, filter);\n}\n\nexport function getSingleOption(mode, type){\n\tconst c = conditions[mode];\n\tfor (let i=0; i<c.length; i++)\n\t\tif (c[i].id == type) return c[i];\n}\n\nexport function getConditions(name){\n\treturn webix.copy( conditions[name] );\n}\n\nexport function getFilterFunction(mode, value){\n\tconst { includes, condition } = value;\n\tconst opt = getSingleOption(mode, condition.type);\n\tconst handler = opt ? opt.handler : function(){ return true; };\n\n\tif (includes){\n\t\tfor (let i=0; i<includes.length; i++)\n\t\t\tincludes[i] = String(includes[i]);\n\t}\n\n\treturn function(value){\n\t\tif (includes){\n\t\t\treturn includes.indexOf(value) !== -1;\n\t\t} else {\n\t\t\treturn condition.filter === \"\" || handler(value, condition.filter);\n\t\t}\n\t};\n}\n\nfunction isDate(value){\n\treturn value && !isNaN(value) && !isDateInvalid(value);\n}\n\nconst conditions = {\n\tnumber:[\n\t\t{ id:\"greater\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 > b*1);\n\t\t}},\n\t\t{ id:\"less\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 < b*1);\n\t\t}},\n\t\t{ id:\"greaterOrEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 >= b*1);\n\t\t}},\n\t\t{ id:\"lessOrEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 <= b*1);\n\t\t}},\n\t\t{ id:\"equal\", batch:\"text\", handler:function(a,b){ return a == b; }},\n\t\t{ id:\"notEqual\", batch:\"text\", handler:function(a,b){ return a != b; }},\n\t\t{ id:\"contains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase()) !== -1;\n\t\t}},\n\t\t{ id:\"notContains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase()) === -1;\n\t\t}}\n\t],\n\ttext: [\n\t\t{ id:\"contains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase()) !== -1;\n\t\t}},\n\t\t{ id:\"notContains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase()) === -1;\n\t\t}},\n\t\t{ id:\"equal\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase() === b.toLowerCase();\n\t\t}},\n\t\t{ id:\"notEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase() !== b.toLowerCase();\n\t\t}},\n\t\t{ id:\"beginsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().lastIndexOf(b.toLowerCase(), 0) === 0;\n\t\t}},\n\t\t{ id:\"notBeginsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().lastIndexOf(b.toLowerCase(), 0) !== 0;\n\t\t}},\n\t\t{ id:\"endsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase(), a.length - b.length) !== -1;\n\t\t}},\n\t\t{ id:\"notEndsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase(), a.length - b.length) === -1;\n\t\t}}\n\t],\n\tdate: [\n\t\t{ id:\"greater\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a > b;\n\t\t}},\n\t\t{ id:\"less\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a < b;\n\t\t}},\n\t\t{ id:\"greaterOrEqual\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a >= b;\n\t\t}},\n\t\t{ id:\"lessOrEqual\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a <= b;\n\t\t}},\n\t\t{ id:\"equal\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a == b;\n\t\t}},\n\t\t{ id:\"notEqual\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn !isDate(a) || a != b;\n\t\t}},\n\t\t{ id:\"between\", batch: \"daterangepicker\", handler: function(a, b){\n\t\t\tif (!isDate(a)) return false;\n\t\t\treturn (!b.start || a > b.start) && (!b.end || a < b.end);\n\t\t}},\n\t\t{ id:\"notBetween\", batch: \"daterangepicker\", handler: function(a, b){\n\t\t\tif (!isDate(a)) return false;\n\t\t\treturn (!b.start || a <= b.start) || (!b.end || a >= b.end);\n\t\t}}\n\t]\n};","import {Dialog} from \"./common\";\nimport * as flt from \"../operations/filter\";\n\nexport const action = \"start-filter\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\tthis.cell = action.cell;\n\t\tthis.$mode = action.mode;\n\t\tthis.$filter = action.filter;\n\n\t\t// cell not provided\n\t\tif (!this.cell || \n\t\t\t// cell is locked\n\t\t\t(this.view.isCellLocked(this.cell.row, this.cell.column))){\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.$dialog.attachEvent(\"onHide\", () => this.$hide());\n\n\t\t\tconst table = this.view.$$(\"cells\");\n\t\t\ttable.attachEvent(\"onScrollY\", () => this.syncScroll());\n\t\t\ttable.attachEvent(\"onScrollX\", () => this.syncScroll());\n\t\t}\n\n\t\tif (this.$show(this.$filter.value, action.options) === false)\n\t\t\treturn this.close();\n\t\tthis.$dialog.show( this._getTargetNode() );\n\t}\n\t_getTargetNode(){\n\t\tconst table = this.view.$$(\"cells\");\n\t\tconst span = table.getSpan(this.cell.row, this.cell.column);\n\t\treturn span ? table.getSpanNode(this.cell) : table.getItemNode(this.cell);\n\t}\n\t$show(value, options){\n\t\tconst list = this.getList();\n\t\tconst filter = this.getFilter();\n\n\t\tif (filter.config.mode !== this.$mode){\n\t\t\tfilter.define(\"conditions\", this.getConditions(this.$mode));\n\t\t\tfilter.define(\"mode\", this.$mode);\n\t\t}\n\n\t\t// if the filter mode for the current column has been changed - reset the value\n\t\tconst type = value && value.conditions && value.conditions.type;\n\t\tif (type && !flt.getSingleOption(this.$mode, type))\n\t\t\tvalue = \"\";\n\n\t\tlist.clearAll();\n\t\tlist.data.importData(options);\n\n\t\t// filter data has been changed - reset value\n\t\tfilter.config.value = \"\";\n\t\tfilter.setValue( webix.copy(value||{}) );\n\t}\n\t$init(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn {\n\t\t\tview:\"popup\",\n\t\t\tcss:\"ssheet_filter\",\n\t\t\tpadding:7,\n\t\t\trelative:\"right\",\n\t\t\tbody:{\n\t\t\t\tmargin:4,\n\t\t\t\trows:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"filter\",\n\t\t\t\t\t\tfield:\"value\",\n\t\t\t\t\t\tmode:\"text\",\n\t\t\t\t\t\tconditions:this.getConditions(\"text\"),\n\t\t\t\t\t\tinputs:[\n\t\t\t\t\t\t\t\"text\",\n\t\t\t\t\t\t\t{ view:\"ssheet-datepicker\", timepicker:true, batch:\"datepicker\", on:{\n\t\t\t\t\t\t\t\tonChange:() => this.getFilter().applyFilter()\n\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t{ view:\"ssheet-daterangepicker\", timepicker:true, batch:\"daterangepicker\", on:{\n\t\t\t\t\t\t\t\tonChange:() => this.getFilter().applyFilter()\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t],\n\t\t\t\t\t\ttemplate:function(obj){\n\t\t\t\t\t\t\treturn obj.$value || obj.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{ },\n\t\t\t\t\t\t{ view:\"button\", label:locale[\"cancel\"], autowidth:true, css:\"webix_transparent\", on:{\n\t\t\t\t\t\t\t\"onItemClick\": () => this.close()\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{ view:\"button\", label:locale[\"apply\"], autowidth:true, css:\"webix_secondary\", on:{\n\t\t\t\t\t\t\t\"onItemClick\": () => this.applyFilter()\n\t\t\t\t\t\t}},\n\t\t\t\t\t]}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\tapplyFilter(){\n\t\tconst filter = this.getFilter();\n\t\tconst oldValue = this.$filter.value;\n\t\tconst value = this.$filter.value = filter.getValue();\n\t\tthis.$filter.handler = flt.getFilterFunction(this.$mode, value);\n\n\t\tthis.view.filterSpreadSheet();\n\t\tthis.view.callEvent(\"onAction\", [\"apply-filter\", { row:this.cell.row, column:this.cell.column, value:oldValue, newValue:value }]);\n\t\tthis.setCellStyle(this.cell.row, this.cell.column, \"ss_filter_active\", flt.isValueActive(value));\n\n\t\tthis.close();\n\t}\n\tsetCellStyle(row, column, css, add){\n\t\tconst table = this.view.$$(\"cells\");\n\t\tconst span = this.getSpan(table, row, column);\n\n\t\tif (span){\n\t\t\tif (add){\n\t\t\t\tif (span[3].indexOf(css) == -1)\n\t\t\t\t\tspan[3] += \" \" + css;\n\t\t\t} else {\n\t\t\t\tspan[3] = span[3].replace(\" \" + css, \"\");\n\t\t\t}\n\t\t}\n\t\ttable[add?\"addCellCss\":\"removeCellCss\"](row, column, css);\n\t}\n\tgetSpan(table, row, column){\n\t\tlet item = table.getSpan()[row];\n\t\tif (item)\n\t\t\treturn item[column];\n\t}\n\tgetList(){\n\t\treturn this.getFilter().getChildViews()[2];\n\t}\n\tgetFilter(){\n\t\treturn this.$dialog.getBody().getChildViews()[0];\n\t}\n\tsyncScroll(){\n\t\tif (this.$dialog.isVisible()){\n\t\t\tconst node = this._getTargetNode();\n\t\t\tconst table = this.view.$$(\"cells\");\n\n\t\t\tlet isHidden = false;\n\t\t\tif (node){\n\t\t\t\tconst nodeOffset = webix.html.offset( node );\n\t\t\t\tconst tableOffset = webix.html.offset( table.$view.getElementsByClassName(\"webix_ss_body\")[0] );\n\t\t\t\tconst ydiff = nodeOffset.y - tableOffset.y;\n\t\t\t\tconst xdiff = nodeOffset.x - tableOffset.x + nodeOffset.width;\n\n\t\t\t\tisHidden = (ydiff < 0 || ydiff+nodeOffset.height > tableOffset.height || \n\t\t\t\t\txdiff < 0 || xdiff-nodeOffset.width > tableOffset.width - webix.env.scrollSize);\n\t\t\t}\n\t\t\tif (!node || isHidden)\n\t\t\t\tthis.$dialog.show({x:-9999, y:-9999});\n\t\t\telse \n\t\t\t\tthis.$dialog.show(node);\n\t\t}\n\t}\n\tgetConditions(name){\n\t\tconst locale = webix.i18n.filter;\n\t\tconst conditions = flt.getConditions(name);\n\n\t\tfor (let i=0; i<conditions.length; i++)\n\t\t\tif (conditions[i].id)\n\t\t\t\tconditions[i].value = locale[conditions[i].id];\n\n\t\treturn conditions;\n\t}\n}","import {Dialog} from \"./common\";\nimport * as fmt from \"../operations/formats\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"custom\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tthis.form = this.$dialog.$$(\"form\");\n\t\tthis.list = this.$dialog.$$(\"list\");\n\t\tthis.preview = this.$dialog.$$(\"preview\");\n\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tthis.fillForm(this.view);\n\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\tconst i18n = webix.i18n.spreadsheet;\n\t\tconst labelsLocale = i18n.labels;\n\t\tconst formatsLocale = i18n.formats;\n\n\t\tconst docsLink = \"https://webix-guides.gitbook.io/spreadsheet-user-guide/formatting_numbers#custom-number-format\";\n\t\tconst delimiters = fmt.getDelimiters(\"int\");\n\n\t\tconst commonConfig = [\n\t\t\t{\n\t\t\t\tname:\"zeros\",\n\t\t\t\tview:\"counter\",\n\t\t\t\tcss:\"webix_ssheet_counter\",\n\t\t\t\tlabel:labelsLocale[\"decimal-places\"],\n\t\t\t\tvalue:0,\n\t\t\t\tbatch:\"common\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"separator\",\n\t\t\t\tview:\"checkbox\",\n\t\t\t\tlabel:labelsLocale[\"separator\"],\n\t\t\t\tbatch:\"common\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"formlist\",\n\t\t\t\tlabel:labelsLocale[\"negative\"],\n\t\t\t\theight: 160,\n\t\t\t\tname:\"negative\",\n\t\t\t\tbatch:\"common\",\n\t\t\t\tcss:\"webix_ssheet_format_negative\",\n\t\t\t\ttemplate: obj => {\n\t\t\t\t\tif(this.list){\n\t\t\t\t\t\tlet format = this.getFormat(obj.id);\n\t\t\t\t\t\tformat = fmt.format2code(format.fmt, format.delimiters);\n\t\t\t\t\t\tconst style = {css:\"\"};\n\t\t\t\t\t\tconst value = format(-1234.56789, style);\n\n\t\t\t\t\t\treturn \"<span class='\"+style.css+\"'>\"+value+\"</span>\";\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdata:[{id:1}, {id:2}, {id:3}, {id:4}]\n\t\t\t}\n\t\t];\n\n\t\tconst customConfig = [\n\t\t\t{\n\t\t\t\tview:\"text\",\n\t\t\t\tlabel: labelsLocale[\"format-pattern\"],\n\t\t\t\tname:\"format\",\n\t\t\t\tlabelPosition:\"top\",\n\t\t\t\tbatch:\"custom\",\n\t\t\t\tplaceholder:\"[>100]0\"+delimiters.groupSign+\"000\"+delimiters.decimalSign+\"00;[>0]None\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"docs\",\n\t\t\t\ttemplate: \"<a href='\"+docsLink+\"' target='_blank' class = 'docs'>\"+labelsLocale[\"format-docs\"]+\"</a>\",\n\t\t\t\tborderless:true,\n\t\t\t\tbatch:\"custom\"\n\t\t\t}\n\t\t];\n\n\t\tconst dateConfig = [\n\t\t\t{\n\t\t\t\tname:\"date\",\n\t\t\t\tbatch:\"date\",\n\t\t\t\tview:\"formlist\",\n\t\t\t\tlabelWidth: 90,\n\t\t\t\theight: 160,\n\t\t\t\tlabel:labelsLocale[\"date-format\"],\n\t\t\t\tcss:\"webix_ssheet_format_date\",\n\t\t\t\ttemplate: obj => fmt.format2code(obj.value, delimiters)(45000),\n\t\t\t\tdata:[\n\t\t\t\t\tformatsLocale.dateFormat,\n\t\t\t\t\tformatsLocale.timeFormat,\n\t\t\t\t\tformatsLocale.fullDateFormat,\n\t\t\t\t\tformatsLocale.longDateFormat\n\t\t\t\t]\n\t\t\t}\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth:460,\n\t\t\thead: labelsLocale[\"format-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tpadding:0,\n\t\t\t\tcols:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"list\",\n\t\t\t\t\t\tid:\"list\",\n\t\t\t\t\t\tcss:\"webix_ssheet_format_type\",\n\t\t\t\t\t\twidth:120,\n\t\t\t\t\t\tscroll:false,\n\t\t\t\t\t\tdata:this.getFormats(),\n\t\t\t\t\t\tselect:true,\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonSelectChange: (id)=>{\n\t\t\t\t\t\t\t\tthis.updateForm();\n\t\t\t\t\t\t\t\tswitch(id[0]){\n\t\t\t\t\t\t\t\t\tcase \"custom\":\n\t\t\t\t\t\t\t\t\tcase \"date\":\n\t\t\t\t\t\t\t\t\t\tthis.form.showBatch(id[0]);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\tthis.form.showBatch(\"common\");\n\t\t\t\t\t\t\t\t\t\tthis.form.elements.separator.show();\n\t\t\t\t\t\t\t\t\t\tif(id[0] == \"percent\")\n\t\t\t\t\t\t\t\t\t\t\tthis.form.elements.separator.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"form\",\n\t\t\t\t\t\tid:\"form\",\n\t\t\t\t\t\theight:280,\n\t\t\t\t\t\tpaddingY:0,\n\t\t\t\t\t\tpaddingX:20,\n\t\t\t\t\t\telements:[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: \"preview\",\n\t\t\t\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\t\t\t\tif(obj.value == i18n.table[\"format-error\"])\n\t\t\t\t\t\t\t\t\t\treturn obj.value;\n\t\t\t\t\t\t\t\t\treturn \"<span class ='\"+obj.css+\"'>\"+obj.value+\"</span>\";\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcss: \"webix_ssheet_format_preview\",\n\t\t\t\t\t\t\t\tautoheight: true,\n\t\t\t\t\t\t\t\tborderless:true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t].concat(commonConfig, customConfig, dateConfig),\n\t\t\t\t\t\telementsConfig: {\n\t\t\t\t\t\t\tlabelWidth: 140\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: () => this.updateForm()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.closeWin()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tlet type = this.list.getSelectedId();\n\t\tlet values = (type == \"custom\")?{format:this.form.getValues().format}:this.form.getValues();\n\t\tvalues.type = type;\n\n\t\tgroup.set(()=>{\n\t\t\tfor (let i = 0; i < this.cell.length; i++)\n\t\t\t\tfmt.addFormat(this.view, this.cell[i].row, this.cell[i].column, values.format, values);\n\t\t});\n\n\t\tthis.view.$$(\"cells\").refresh();\n\t\tthis.closeWin();\n\t}\n\tcloseWin(){\n\t\tconst style = this.view.getStyle(this.cell[0].row, this.cell[0].column);\n\t\tconst name = style && style.props.format ? style.props.format : \"common\";\n\n\t\t//default format\n\t\tif(!fmt.isCustom(name))\n\t\t\tthis.view.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"format\", value:name}]);\n\t\tthis.close();\n\t}\n\tgetFormat(negative){\n\t\tconst type = this.list.getSelectedId();\n\t\tlet values = this.form.getValues();\n\n\t\tvalues.negative = negative || values.negative;\n\t\tif(type != \"custom\"){\n\t\t\tif(type != \"date\")\n\t\t\t\tvalues.date = \"\";\n\n\t\t\tvalues = fmt.formToValues(type, values);\n\t\t\treturn {\n\t\t\t\tfmt: fmt.serializeFormat(values),\n\t\t\t\tdelimiters:fmt.getDelimiters(type)\n\t\t\t};\n\t\t}\n\t\telse\n\t\t\treturn {\n\t\t\t\tfmt: values.format,\n\t\t\t\tdelimiters: fmt.getDelimiters(type)\n\t\t\t};\n\t}\n\tfillForm(view){\n\t\tconst locale = webix.i18n.spreadsheet;\n\t\tconst style = view.getStyle(this.cell[0].row, this.cell[0].column);\n\t\tlet values = { zeros:0, separator: 0, negative: 1, date: locale.formats.dateFormat, format: \"\"};\n\t\tlet type;\n\n\t\tlet name = style && style.props.format ? style.props.format : \"\";\n\n\t\tvalues.format = fmt.getFormatSource(name || \"price\");\n\n\t\tif(!name)\n\t\t\ttype = name = \"price\";\n\t\telse if(name == \"string\")\n\t\t\ttype = name = \"custom\";\n\t\telse\n\t\t\ttype = fmt.formatHelpers[name].values.type;\n\n\t\tif(type != \"custom\")\n\t\t\twebix.extend(values, fmt.formatHelpers[name].values, true);\n\n\t\tconst item = this.view.$$(\"cells\").getItem(this.cell[0].row);\n\t\tconst col = this.cell[0].column;\n\n\t\tthis.value = webix.isUndefined(item[col]) ? \"\" : item[col];\n\n\t\tthis.form.setValues(values);\n\t\tthis.list.select(type);\n\t\tthis.updateForm();\n\t}\n\tupdateForm(){\n\t\tconst form = this.form.elements;\n\t\tconst format = this.getFormat();\n\t\tlet value = this.value;\n\n\t\tconst isText = value === \"\" || isNaN(value);\n\n\t\tif(fmt.checkFormat(format, \"date\") && (isText || fmt.isDateInvalid(value)))\n\t\t\tvalue = 45000;\n\t\telse if(isText && !fmt.checkFormat(format, \"string\"))\n\t\t\tvalue = 1234.56789;\n\n\t\tlet style = {css:\"\"};\n\t\tvalue = fmt.format2code(format.fmt, format.delimiters)(value, style);\n\n\t\t//preview values\n\t\tthis.preview.parse({value:value, css:style.css});\n\t\tform.negative.refresh();\n\t\tform.date.refresh();\n\n\t\t//set new format string\n\t\tform.format.setValue(format.fmt);\n\t}\n\tgetFormats(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn [\n\t\t\t{id: \"price\", value: locale.currency},\n\t\t\t{id: \"int\", value: locale.number},\n\t\t\t{id: \"percent\", value: locale.percent},\n\t\t\t{id: \"date\", value: locale.date},\n\t\t\t{id: \"custom\", value: locale[\"custom-format\"]}\n\t\t];\n\t}\n}","import {Dialog} from \"./common\";\nimport {getJsDateFromExcel, getExcelDateFromJs} from \"../math/methods/helpers\";\nimport {isDateInvalid} from \"../operations/formats\";\nimport {getDateEditFormat} from \"../operations/formats\";\n\nexport const action = \"conditional-format\";\n\nconst condition = [\n\t{id: \">\",value: \">\" },\n\t{id: \"<\",value: \"<\"},\n\t{id: \"=\",value: \"=\"},\n\t{id: \"!=\",value: webix.i18n.spreadsheet.labels[\"conditional-not-equal\"]},\n\t{id: \"<>\",value: webix.i18n.spreadsheet.labels[\"conditional-between\"]}\n];\n\nfunction getConditionStyle(data){\n\treturn data.map(item => {\n\t\titem.id = item.css;\n\t\treturn item;\n\t});\n}\n\nexport class DialogBox extends Dialog{\n\t_getCondition() {\n\t\tlet view = this.view;\n\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews();\n\t\tlet data = [];\n\n\t\tforms.forEach(form => {\n\t\t\tif (!form.getValues) return;\n\t\t\tlet values = form.getValues();\n\t\t\tlet item = [];\n\t\t\titem.push(values.condition);\n\n\t\t\tif(values.condition !== \"<>\"){\n\t\t\t\titem.push(this._normalizeValue(values.value));\n\t\t\t} else {\n\t\t\t\titem.push([this._normalizeValue(values.value), this._normalizeValue(values.value2)]);\n\t\t\t}\n\t\t\titem.push(values.style);\n\t\t\tfor(let i=0; i < item.length; i++){\n\t\t\t\tif(item[i] === \"\" || (webix.isArray(item[i]) && item[i].indexOf(\"\") != -1))\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\tdata.push(item);\n\t\t});\n\n\t\tview.callEvent(\"onConditionSet\", [data]);\n\t}\n\t_safeInt(a){\n\t\tconst num = parseFloat(a);\n\t\tif (num == a) return num;\n\t\treturn a;\n\t}\n\t_setCondition() {\n\t\tconst view = this.view;\n\t\tconst collection = view.conditions.get(this.cell.row, this.cell.column);\n\n\t\tif(collection){\n\t\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews();\n\t\t\tcollection.forEach((item, i) => {\n\t\t\t\tconst values = {};\n\t\t\t\tvalues.condition = item[0];\n\t\t\t\tif(webix.isArray(item[1])){\n\t\t\t\t\tvalues.value = this._formatValue(item[1][0]);\n\t\t\t\t\tvalues.value2 = this._formatValue(item[1][1]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tvalues.value = this._formatValue(item[1]);\n\n\t\t\t\tvalues.style = item[2];\n\t\t\t\tforms[i+1].setValues(values);\n\t\t\t});\n\t\t}\n\t}\n\n\t_formatValue(value){\n\t\tif(this.editFormat && value !== \"\" && value[0] != \"=\"){\n\t\t\tvalue = getJsDateFromExcel(value);\n\t\t\treturn this.editFormat(value);\n\t\t}\n\t\treturn value.toString();\n\t}\n\n\t_normalizeValue(value){\n\t\tif(this.editFormat){\n\t\t\tif(isNaN(value)){\n\t\t\t\tif(value[0] != \"=\"){\n\t\t\t\t\tconst parser = webix.Date.strToDate( webix.i18n.spreadsheet.formats.parseDateTime );\n\t\t\t\t\tvalue = parser(value);\n\t\t\t\t\tvalue = isNaN(value) ? \"\" : getExcelDateFromJs(value);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t\tvalue = isDateInvalid(value) ? \"\" : value;\n\t\t}\n\t\telse\n\t\t\tvalue = this._safeInt(value, 10);\n\n\t\treturn value;\n\t}\n\n\tokClick(){\n\t\tthis._getCondition();\n\t\tthis.close();\n\t}\n\n\t_clean() {\n\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews();\n\t\tforms.forEach(form => {\n\t\t\tif (form.setValues) form.setValues({condition: \"\", value: \"\", value2: \"\", style: \"\"});\n\t\t});\n\t}\n\n\t$show(){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tconst item = this.view.getRow(this.cell.row);\n\t\tlet type = item.$cellType;\n\t\tif(type)\n\t\t\ttype = type[this.cell.column];\n\n\t\tif(type == \"date\")\n\t\t\tthis.editFormat = getDateEditFormat(item, this.cell.column);\n\n\t\tthis.$dialog.queryView(\"text\", \"all\").forEach(view => {\n\t\t\tview.define({placeholder: type == \"date\" ? this._formatValue(45000) : \"\"});\n\t\t\tview.refresh();\n\t\t});\n\n\t\tthis.view.$handleSelection = (st, end, a, b)=>{\n\t\t\tif (this.activeValue && a == b){\n\t\t\t\tthis.activeValue.setValue(\"=\"+a);\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tthis._setCondition();\n\t}\n\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t\tdelete this.editFormat;\n\t\tthis._clean();\n\t}\n\n\tgetRows(data, count){\n\t\tlet headers = {\n\t\t\theight: 36,\n\t\t\tpadding:{\n\t\t\t\tleft: 12\n\t\t\t},\n\t\t\tcols: [\n\t\t\t\t{ view:\"label\", width:131, label: webix.i18n.spreadsheet.labels.display },\n\t\t\t\t{ view:\"label\", width: 116, label: webix.i18n.spreadsheet.labels.condition },\n\t\t\t\t{ view:\"label\", label: webix.i18n.spreadsheet.labels.value }\n\t\t\t]\n\t\t};\n\t\tlet arr = [headers];\n\n\t\tlet item = {\n\t\t\tview: \"form\",\n\t\t\tpadding: 0,\n\t\t\tborderless: true,\n\t\t\tcss:\"webix_ssheet_cformats\",\n\t\t\telements: [{\n\t\t\t\tmargin: 10,\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\tname: \"style\",\n\t\t\t\t\t\twidth:120,\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-style\"],\n\t\t\t\t\t\tcss: \"webix_ssheet_cformat_select\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\tpadding:0,\n\t\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\t\tcss: \"webix_ssheet_cformat_list\",\n\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\ttemplate(obj) {\n\t\t\t\t\t\t\t\t\tconst css = \"webix_ssheet_cformat \"+obj.css;\n\t\t\t\t\t\t\t\t\treturn `<div class=\"${css}\">${obj.name}</div>`;\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\twidth: 105,\n\t\t\t\t\t\tname: \"condition\",\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-operator\"],\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: function(newv){\n\t\t\t\t\t\t\t\tif(newv === \"<>\"){\n\t\t\t\t\t\t\t\t\tthis.getFormView().elements.value2.show();\n\t\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\t\tthis.getFormView().elements.value2.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuggest:{\n\t\t\t\t\t\t\tview: \"ssheet-form-suggest\",\n\t\t\t\t\t\t\tbody:{\n\t\t\t\t\t\t\t\tdata: condition\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tonBlur: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tlet value = current_view.getValue();\n\t\t\t\t\t\t\t\t\t\tif(value !== \"\"){\n\t\t\t\t\t\t\t\t\t\t\tvalue = this._normalizeValue(value);\n\t\t\t\t\t\t\t\t\t\t\tcurrent_view.setValue(this._formatValue(value));\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tname: \"value\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\tname: \"value2\",\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tonBlur: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tlet value = current_view.getValue();\n\t\t\t\t\t\t\t\t\t\tif(value !== \"\"){\n\t\t\t\t\t\t\t\t\t\t\tvalue = this._normalizeValue(value);\n\t\t\t\t\t\t\t\t\t\t\tcurrent_view.setValue(this._formatValue(value));\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\thidden: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{ view:\"icon\", css:\"webix_ssheet_cformat_clear\", icon:\"wxi-trash\", click: function(){\n\t\t\t\t\t\tconst form = this.getFormView();\n\t\t\t\t\t\tform.clear();\n\t\t\t\t\t}}\n\t\t\t\t]}\n\t\t\t]};\n\n\t\twhile(count--){\n\t\t\tarr.push(item);\n\t\t}\n\t\treturn arr;\n\t}\n\n\t$init(){\n\t\tconst margin = webix.skin.$active.layoutMargin.form;\n\t\t//[IMPROVE] can be optimized by using datalayout instead of nested forms\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"conditional-format\"],\n\t\t\tposition:\"center\",\n\t\t\twidth: 670,\n\t\t\tmove: true,\n\t\t\tmargin,\n\t\t\tbody:{\n\t\t\t\tview: \"form\",\n\t\t\t\tpadding:0,\n\t\t\t\tborderless: true,\n\t\t\t\trows: this.getRows(getConditionStyle(this.view.config.conditionStyle), 3)\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}","import {Dialog} from \"./common\";\n\nexport const action = \"excel-export\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.sheets.setValue(this.getSheets());\n\t\tform.elements.filename.setValue(\"Data\");\n\t\tform.elements.filename.getInputNode().select();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"export-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"filename\",  placeholder:webix.i18n.spreadsheet.labels[\"export-name\"]},\n\t\t\t\t\t{ view:\"multicheckbox\", name:\"sheets\"}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tgetSheets(){\n\t\tconst view = this.view;\n\t\tconst sheets = view._sheets;\n\t\tlet value = [];\n\n\t\tfor(let i = 0; i < sheets.length; i++)\n\t\t\tvalue.push({\n\t\t\t\tname: sheets[i].name,\n\t\t\t\tactive: view._activeSheet === sheets[i].name ? 1 : 0\n\t\t\t});\n\n\t\treturn value;\n\t}\n\tokClick(){\n\t\tconst values = this.$dialog.getBody().getValues();\n\t\twebix.toExcel(this.view, values);\n\t\tthis.close();\n\t}\n}","import {Dialog} from \"./common\";\n\nexport const action = \"add-link\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tconst cell = this.view.getSelectedId();\n\t\tif(!cell)\n\t\t\treturn false;\n\t\tif (!this.restoreValue(form))\n\t\t\tform.clear();\n\t\tform.elements.name.focus();\n\t}\n\trestoreValue(form){\n\t\tconst cell = this.view.getSelectedId();\n\t\tif (cell){\n\t\t\tconst item = this.view.getRow(cell.row);\n\t\t\tconst value = item[\"$\"+cell.column] || item[cell.column];\n\t\t\tif (value && value.indexOf(\"=HYPERLINK\") === 0){\n\t\t\t\tconst parts = value.split(\"\\\"\");\n\t\t\t\tform.setValues({\n\t\t\t\t\tname: (parts[3] || \"\"),\n\t\t\t\t\turl: (parts[1] || \"\")\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"link-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"name\",  placeholder:webix.i18n.spreadsheet.labels[\"link-name\"]},\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"link-url\"]}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\n\tokClick(){\n\t\tconst cell = this.view.getSelectedId();\n\t\tconst data = this.$dialog.getBody().getValues();\n\n\t\tlet text = \"\";\n\t\tif (data.url){\n\t\t\tdata.name = data.name || data.url;\n\t\t\tif (!/^https?:\\/\\//i.test(data.url))\n\t\t\t\tdata.url = \"http://\" + data.url;\n\t\t\ttext = `=HYPERLINK(\"${data.url}\",\"${data.name}\")`;\n\t\t}\n\n\t\tthis.view.setCellValue(cell.row, cell.column, text);\n\t\tthis.view.refresh();\n\t\tthis.close();\n\t}\n}","import {Dialog} from \"./common\";\n\nexport const action = \"print\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tform.setValues({\n\t\t\tdata:\"current\",\n\t\t\tpaper:\"A4\",\n\t\t\tfit:\"page\",\n\t\t\tmode:\"landscape\",\n\t\t\tsheetnames:1,\n\t\t\tmargin:0\n\t\t});\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"print-title\"],\n\t\t\tmove: true,\n\t\t\tmodal:true,\n\t\t\twidth:530, height:520,\n\t\t\tposition: \"center\",\n\t\t\tbuttons:false,\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-settings\"]},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{ view:\"radio\", name:\"data\",vertical:true, options:[\n\t\t\t\t\t\t\t{ id:\"current\", value:webix.i18n.spreadsheet.labels[\"current-sheet\"]},\n\t\t\t\t\t\t\t{ id:\"all\", value:webix.i18n.spreadsheet.labels[\"all-sheets\"]},\n\t\t\t\t\t\t\t{ id:\"selection\", value:webix.i18n.spreadsheet.labels[\"selection\"]}\n\t\t\t\t\t\t], on:{\n\t\t\t\t\t\t\tonChange:function(newv){\n\t\t\t\t\t\t\t\tif(newv == \"all\"){\n\t\t\t\t\t\t\t\t\tconst form = this.getFormView();\n\t\t\t\t\t\t\t\t\tform.elements.sheetnames.setValue(1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{ rows:[\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"sheetnames\", labelRight:webix.i18n.spreadsheet.labels[\"sheet-names\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"borderless\", labelRight:webix.i18n.spreadsheet.labels[\"borderless\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"skiprows\", labelRight:webix.i18n.spreadsheet.labels[\"skip-rows\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"margin\", labelRight:webix.i18n.spreadsheet.labels[\"margin\"]}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-paper\"]},\n\t\t\t\t\t{ view:\"radio\", name:\"paper\", options:[\n\t\t\t\t\t\t{ id:\"letter\", value:webix.i18n.spreadsheet.labels[\"page-letter\"]},\n\t\t\t\t\t\t{ id:\"A4\", value:webix.i18n.spreadsheet.labels[\"page-a4\"]},\n\t\t\t\t\t\t{ id:\"A3\", value:webix.i18n.spreadsheet.labels[\"page-a3\"]}\n\t\t\t\t\t]},\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-layout\"]},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{view:\"radio\", name:\"fit\", options:[\n\t\t\t\t\t\t\t{ id:\"page\", value:webix.i18n.spreadsheet.labels[\"page-width\"]},\n\t\t\t\t\t\t\t{ id:\"data\", value:webix.i18n.spreadsheet.labels[\"page-actual\"]}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ width:25},\n\t\t\t\t\t\t{ view:\"radio\", width:220, name:\"mode\", options:[\n\t\t\t\t\t\t\t{ id:\"portrait\", value:webix.i18n.spreadsheet.labels[\"page-portrait\"]},\n\t\t\t\t\t\t\t{ id:\"landscape\", value:webix.i18n.spreadsheet.labels[\"page-landscape\"]}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t{ },\n\t\t\t\t\t\t\t{ view: \"button\", css:\"ssheet_cancel_button\", hotkey:\"esc\",\n\t\t\t\t\t\t\t\tvalue: webix.i18n.spreadsheet.labels.cancel, autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.close()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ view: \"button\", value: webix.i18n.spreadsheet.labels.print, hotkey:\"enter\", autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.okClick()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tconst data = this.$dialog.getBody().getValues();\n\t\tdata.margin = data.margin?0:{};\n\t\tthis.close();\n\t\twebix.print(this.view, data);\n\t}\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"add-comment\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\t//we get cell only on hover commented cell\n\t\tthis.cell = action.cell ? action.cell : this.view.getSelectedId();\n\n\t\t// cell not provided\n\t\tif (!this.cell || \n\t\t\t// cell is locked and in the edit mode\n\t\t\t(this.view.isCellLocked(this.cell.row, this.cell.column) && !action.viewonly) ||\n\t\t\t// action blocked by user's code\n\t\t\t!(this.view.callEvent(\"onBeforeCommentShow\", [this.cell.row, this.cell.column, !action.viewonly]))){\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.view.comments._activeComment = {editStatus: !action.viewonly, cell: this.cell};\n\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.view.comments.commentsView = this.$dialog;\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=>this.$hide());\n\t\t\tthis.view.attachEvent(\"onCommentHide\", ()=>this.$dialog.hide());\n\t\t}\n\n\t\tconst form = this.$dialog.getBody();\n\n\t\tconst span = this.view.$$(\"cells\").getSpan(this.cell.row, this.cell.column);\n\t\tconst item = span ? {row: this.cell.row, column:(span[1]*1+span[2]-1)} : this.cell;\n\n\t\twebix.delay(()=>{\n\t\t\tthis.$dialog.show(this.view.$$(\"cells\").getItemNode(item));\n\t\t\tthis._setComment();\n\t\t});\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\t$show(){\n\t\tthis.textarea = this.$dialog.queryView({view:\"textarea\"});\n\t\tthis.template = this.$dialog.queryView({view:\"template\"});\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tcss:\"ssheet_comments\",\n\t\t\tminWidth:250,\n\t\t\tminHeight:150,\n\t\t\trelative:\"right\",\n\t\t\tresize:true,\n\t\t\ton:{\n\t\t\t\tonViewResize:()=>{\n\t\t\t\t\tthis.$dialog.hide();\n\t\t\t\t\tthis.$dialog.show();\n\t\t\t\t\tif(this.textarea.isVisible())\n\t\t\t\t\t\tthis.textarea.focus();\n\t\t\t\t}\n\t\t\t},\n\t\t\tbody:{\n\t\t\t\tanimate:false,\n\t\t\t\tcells:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"template\",\n\t\t\t\t\t\tcss:\"ssheet_comment_view\",\n\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\tscroll:\"auto\",\n\t\t\t\t\t\tonClick:{\n\t\t\t\t\t\t\t\"ssheet_comment_view\":() => {\n\t\t\t\t\t\t\t\tif(!(this.view.config.readonly || this.view.isCellLocked(this.cell.row, this.cell.column)))\n\t\t\t\t\t\t\t\t\tthis.showInput(this.view.comments.get(this.cell.row, this.cell.column));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonChange:()=>{\n\t\t\t\t\t\t\t\tthis.addComment();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonFocus:()=>{\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {editStatus: true, cell: this.cell};\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonBlur:()=>{\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {};\n\t\t\t\t\t\t\t\tthis.$dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\t_setComment(){\n\t\tconst comment = this.view.comments.get(this.cell.row, this.cell.column);\n\t\tif(this.view.comments._activeComment.editStatus)\n\t\t\tthis.showInput(comment);\n\t\telse\n\t\t\tthis.showTemplate(comment);\n\t}\n\tshowTemplate(text){\n\t\tthis.template.show();\n\t\tthis.template.setHTML(text);\n\t}\n\tshowInput(text){\n\t\tthis.view.$$(\"cells\").select(this.cell.row, this.cell.column);\n\t\twebix.delay(()=>{\n\t\t\tthis.changeTextarea(text);\n\t\t\tthis.textarea.show();\n\t\t\tthis.textarea.focus();\n\t\t});\n\t}\n\taddComment(){\n\t\tthis.view.comments.add(this.cell.row, this.cell.column, this.textarea.getValue());\n\t}\n\tchangeTextarea(text){\n\t\tthis.textarea.blockEvent();\n\t\tthis.textarea.setValue(text||\"\");\n\t\tthis.textarea.unblockEvent();\n\t}\n}","import {Dialog} from \"./common\";\nexport const action = \"resize\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\tthis.group = action.group;\n\t\tthis.header = action.value;\n\t\tDialog.prototype.open.apply(this, arguments);\n\t}\n\t$show(){\n\t\tconst sel = this.view.getSelectedId();\n\t\tif(!sel)\n\t\t\treturn false;\n\t\tthis.view.$handleSelection = ()=>{\n\t\t\treturn false;\n\t\t};\n\n\t\tconst elements = this.$dialog.getBody().elements;\n\t\tthis.type = elements[\"type\"];\n\t\tthis.size = elements[\"size\"];\n\n\t\tthis.$dialog.getHead().getChildViews()[0].setHTML(this.header);\n\t\tconst grid = this.view.$$(\"cells\");\n\n\t\tlet value;\n\t\tif(this.group == \"row\")\n\t\t\tvalue = grid.getItem(sel.row).$height || grid.config.rowHeight;\n\t\telse\n\t\t\tvalue = grid.getColumnConfig(sel.column).width || grid.config.columnWidth;\n\n\t\tthis.type.getOption(1).value = webix.i18n.spreadsheet.labels[this.group == \"row\" ? \"height\" : \"width\"];\n\t\tthis.type.setValue(1);\n\t\tthis.type.refresh();\n\n\t\tthis.size.setValue(value);\n\t\tthis.size.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\tokClick(){\n\t\tconst type = this.type.getValue();\n\n\t\tlet size = \"auto\";\n\t\tif(type == 1)\n\t\t\tsize = this.size.getValue()*1;\n\t\telse if(type == 3)\n\t\t\tsize = this.view.$$(\"cells\").config[this.group == \"row\" ? \"rowHeight\" : \"columnWidth\"];\n\n\t\tif(this.group == \"row\")\n\t\t\tthis.view.setRowHeight(null, size);\n\t\telse\n\t\t\tthis.view.setColumnWidth(null, size);\n\n\t\tthis.close();\n\t}\n\t$init(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth: 300,\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tpadding:0,\n\t\t\t\tcols:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"radio\", name:\"type\", vertical:true, optionHeight:40,\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonChange: id => {\n\t\t\t\t\t\t\t\tif(id == 1)\n\t\t\t\t\t\t\t\t\tthis.size.enable();\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tthis.size.disable();\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\toptions:[\n\t\t\t\t\t\t\t{id:1, value: \"\"},\n\t\t\t\t\t\t\t{id:2, value: locale[\"fit-content\"]},\n\t\t\t\t\t\t\t{id:3, value: locale[\"default-size\"]},\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{rows: [\n\t\t\t\t\t\t{view:\"text\", name: \"size\", width:120},\n\t\t\t\t\t]}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}","import * as imc from \"./imagecell\";\nimport * as imt from \"./imagetop\";\nimport * as asw from \"./sparkline\";\nimport * as rgs from \"./ranges\";\nimport * as dpd from \"./dropdown\";\nimport * as flt from \"./filter\";\nimport * as fmt from \"./format\";\nimport * as cnd from \"./conditional\";\nimport * as exp from \"./export\";\nimport * as lnk from \"./link\";\nimport * as pnt from \"./print\";\nimport * as cmt from \"./comments\";\nimport * as siz from \"./sizing\";\n\nconst bases = [ imt, imc, asw, rgs, dpd, flt, fmt, cnd, exp, lnk, pnt, cmt, siz ];\n\nexport function init(view){\n\tconst dialogs = {};\n\tconst viewBases = view.config.readonly ? [cmt] : bases;\n\n\tfor (let i = 0; i < viewBases.length; i++)\n\t\tdialogs[viewBases[i].action] = new viewBases[i].DialogBox(view);\n\n\tview.attachEvent(\"onCommand\", function(action){\n\t\tconst box = dialogs[action.id];\n\t\tif (box) box.open(action);\n\t});\n\n\tview.attachEvent(\"onAction\", function(id, values){\n\t\t//hide win when the external ui is removed\n\t\tif(id == \"add-view\" && !values.newValue){\n\t\t\tconst box = dialogs[\"add-image-top\"];\n\t\t\tif(box && box.viewid == values.row){\n\t\t\t\tbox.close();\n\t\t\t}\n\t\t}\n\t});\n}","import {isCellLocked} from \"./lock_cell\";\nimport group from \"./undo_group\";\n\n\nvar ignoreUndoReset = false;\n\nexport function init(view){\n\treset(view);\n\tundoHandlers(view);\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\tview.attachEvent(\"onAfterSheetShow\", () => reset(view));\n\t// styles\n\tview.attachEvent(\"onBeforeStyleChange\", (row, column, nstyle, ostyle) =>{\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"style\", row:row, column: column, value: ostyle, newValue: nstyle, group: group.value});\n\t});\n\t// editing\n\tview.attachEvent(\"onBeforeValueChange\", (row, column, nvalue, ovalue) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"value\", row:row, column: column, value: ovalue, newValue: nvalue, group: group.value});\n\t});\n\t// merge cells\n\tview.attachEvent(\"onBeforeSpan\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"span\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// split cells\n\tview.attachEvent(\"onBeforeSplit\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"split\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// Any abstract undo actions\n\tview.attachEvent(\"onAction\", (action, obj) =>\n\t\taddToHistory(\n\t\t\tview,\n\t\t\t{\n\t\t\t\taction: action,\n\t\t\t\trow: obj.row || null,\n\t\t\t\tcolumn: obj.column || null,\n\t\t\t\tvalue: obj.value || null,\n\t\t\t\tnewValue: obj.newValue || null,\n\t\t\t\tgroup: group.value\n\t\t\t}\n\t\t)\n\t);\n\n\t// column resize\n\tview.$$(\"cells\").attachEvent(\"onColumnResize\", (column, nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"c-resize\", row:0, column:column, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\t// column hide\n\tview.attachEvent(\"onColumnOperation\", (action, start, end) => {\n\t\tif (action.id !== \"add\" && action.id !== \"del\")\n\t\t\taddToHistory(view, { action:action, row:0, column:{ start, end } });\n\t});\n\t// row hide\n\tview.attachEvent(\"onRowOperation\", (action, start, end) => {\n\t\tif (action.id !== \"add\" && action.id !== \"del\")\n\t\t\taddToHistory(view, { action:action, row:{ start, end }, column:0 });\n\t});\n\t// row resize\n\tview.$$(\"cells\").attachEvent(\"onRowResize\", (row,  nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"r-resize\", row: row, column:0, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\n\t// condition formats\n\tview.attachEvent(\"onBeforeConditionSet\", (row, column, value, nvalue) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\n\t\tvalue = value ? webix.copy(value) : null;\n\t\taddToHistory(view, {action: \"condition\", row: row, column: column, value: value, newValue: nvalue, group: group.value});\n\t});\n\tview.$skipHistory = 0;\n}\n\nexport function undo(view){\n\trestoreHistory(view,-1);\n}\n\nexport function redo(view){\n\trestoreHistory(view,1);\n}\n\nexport function reset(view){\n\tif(!ignoreUndoReset){\n\t\tview._ssUndoHistory = [];\n\t\tview._ssUndoCursor = -1;\n\t}\n}\n\nfunction addToHistory(view, data){\n\tif(!view.$skipHistory){\n\t\t// remove futher history\n\t\tview._ssUndoHistory.splice(view._ssUndoCursor+1);\n\t\t// add to an array and increase cursor\n\t\tview._ssUndoHistory.push(data);\n\t\tview._ssUndoCursor++;\n\t}\n}\n\nexport function ignoreUndo(func, view){\n\tview.$skipHistory++;\n\ttry{\n\t\tfunc.call(view);\n\t}\n\tfinally {\n\t\tview.$skipHistory--;\n\t}\n}\n\nexport function ignoreReset(func){\n\tignoreUndoReset = true;\n\tfunc();\n\tignoreUndoReset = false;\n}\n\nfunction restoreHistory(view, step){\n\tvar data = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\tif(data){\n\t\tvar value = step > 0 ? data.newValue : data.value;\n\t\tvar direction = step>0;\n\t\tvar params = [data.action, data.row, data.column, value, direction];\n\n\t\tview._ssUndoCursor += step;\n\n\t\t// group support\n\t\tvar group = data.group;\n\t\tvar prevData = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\n\t\tignoreUndo(function(){\n\t\t\tview.callEvent(\"onUndo\", params);\n\t\t\tif (!group || !(prevData && group == prevData.group)){\n\t\t\t\tview.refresh();\n\t\t\t\tview.callEvent(\"onAfterUndo\", []);\n\t\t\t}\n\t\t},view);\n\n\t\tif(prevData && group && group == prevData.group){\n\t\t\trestoreHistory(view, step);\n\t\t}\n\t}\n}\n\nfunction undoHandlers(view){\n\tview.attachEvent(\"onUndo\", function(type, row, column, value) {\n\t\tswitch (type) {\n\t\t\tcase \"freeze-row\":\n\t\t\t\tview.freezeRows(value);\n\t\t\t\tbreak;\n\t\t\tcase \"freeze-column\":\n\t\t\t\tview.freezeColumns(value);\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import {range, toRange, changeRange} from \"../helpers/column_names\";\nimport {getAccessor} from \"../math/sheet\";\nimport {ignoreUndo} from \"./undo\";\n\nexport function init(view){\n\tconst grid = view._table.$view.querySelector(\".webix_ss_center\");\n\n\tview.views = {\n\t\tregister:function(type, render, track){\n\t\t\tif(!this._types[type])\n\t\t\t\tthis._types[type] = { render:render, track:track };\n\t\t},\n\t\tmove: function(id, x, y){\n\t\t\tconst win = webix.$$(id);\n\t\t\tconst old = webix.copy(this._pull[id]);\n\t\t\tthis._pull[id].x = _correctPos(view, win, x, \"x\");\n\t\t\tthis._pull[id].y = _correctPos(view, win, y, \"y\");\n\t\t\tview.callEvent(\"onAction\", [\"move-view\", { row:id, newValue:webix.copy(this._pull[id]), value:old} ]);\n\t\t\t_showOne(view, win, this._pull[id]);\n\t\t},\n\t\tadd: function(x, y, type, data, config, id){\n\t\t\tconfig = config || {};\n\t\t\tif(type == \"chart\"){\n\t\t\t\tconfig = webix.extend(config, {\n\t\t\t\t\ttype: \"line\",\n\t\t\t\t\tdataSeries:\"columns\"\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst height =  config.height || 300;\n\t\t\tconst width = config.width || 500;\n\n\t\t\tconst win = webix.ui({ \n\t\t\t\tid:id || \"$ssheet-ui\"+webix.uid(), // fixed id is for undo only\n\t\t\t\tview: \"ssheet-ui\",\n\t\t\t\tcontainer:grid, master:view._table.config.id,\n\t\t\t\twidth:width, height:height\n\t\t\t});\n\n\t\t\twin.attachEvent(\"onViewMoveEnd\", (x, y) => {\n\t\t\t\tconst state = view._table.getScrollState();\n\t\t\t\tthis.move(id, x, y+state.y);\n\t\t\t});\n\t\t\twin.attachEvent(\"onViewResize\", () => {\n\t\t\t\tconst conf =  this._pull[id];\n\t\t\t\tconst old = webix.copy(conf);\n\n\t\t\t\tconf.config.height = win.$height;\n\t\t\t\tconf.config.width = win.$width;\n\t\t\t\tview.callEvent(\"onAction\", [\"resize-view\", { row:id, newValue:webix.copy(conf), value:old } ]);\n\t\t\t});\n\t\t\twin.attachEvent(\"onViewEdit\", () => {\n\t\t\t\tconst config = this._pull[id];\n\t\t\t\tconst command = this._commands[config.type] || config.type;\n\t\t\t\tview.callEvent(\"onCommand\", [{ id:command, viewid:id, config }]);\n\t\t\t});\n\t\t\twin.attachEvent(\"onViewRemove\", () => this.remove(id));\n\n\t\t\tid = win.config.id;\n\n\t\t\tx = _correctPos(view, win, x, \"x\");\n\t\t\ty = _correctPos(view, win, y, \"y\");\n\n\t\t\tthis._pull[id] = { x, y, type, data, config };\n\t\t\tthis.update(id, data, config, true);\n\t\t\t_showOne(view, win, this._pull[id]);\n\n\t\t\treturn id; \n\t\t},\n\t\tremove: function(id){\n\t\t\tconst old = this._pull[id];\n\t\t\twebix.$$(id).close();\n\t\t\tdelete this._pull[id];\n\n\t\t\tview.callEvent(\"onAction\", [\"add-view\", { row:id, newValue:null, value:old } ]);\n\t\t},\n\t\tget:function(id){\n\t\t\treturn webix.$$(id).getBody();\n\t\t},\n\t\tgetConfig:function(id){\n\t\t\treturn this._pull[id];\n\t\t},\n\t\tupdate:function(id, data, config, inner){\n\t\t\tconst old = inner ? null : webix.copy(this._pull[id]);\n\t\t\tconst conf = this._pull[id];\n\t\t\tconst actions = this._types[conf.type];\n\n\t\t\tdata = data || config.data || \"\";\n\t\t\tconfig = config || {};\n\n\t\t\tdelete config.data;\n\n\t\t\tif(conf.type == \"chart\"){\n\t\t\t\tconst type = config.type;\n\t\t\t\tif(type && !_isPie(type) && !config.series){\n\t\t\t\t\tconst xAxis = config.xAxis && config.xAxis.range;\n\t\t\t\t\tconst legend = config.legend && config.legend.range;\n\n\t\t\t\t\tconst oldXaxis = old && old.config && old.config.xAxis && old.config.xAxis.fromData;\n\n\t\t\t\t\tconfig.series = _getSeries(view, data, config.dataSeries, {xAxis, legend}, oldXaxis);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst win = webix.$$(id);\n\n\t\t\tconst height = config.height || 300;\n\t\t\tconst width = config.width || 500;\n\n\t\t\tif(win.$width != width && win.$height != height){\n\t\t\t\twin.define({width, height});\n\t\t\t\twin.resize();\n\t\t\t}\n\n\t\t\tconf.data = data;\n\t\t\tconf.config = config;\n\n\t\t\tlet node = this.get(id);\n\n\t\t\tdata = _fromRange(view, conf);\n\n\t\t\tif(actions.render){\n\t\t\t\tconst renderConfig = webix.copy(conf);\n\n\t\t\t\t//clear width and height for inner view resizing\n\t\t\t\trenderConfig.config.width = renderConfig.config.height = 0;\n\n\t\t\t\tnode = actions.render(node, renderConfig, data);\n\t\t\t\t_processTables(node);\n\t\t\t}\n\n\t\t\tif(actions.track)\n\t\t\t\t_trackOne(view, node, actions.track, conf);\n\n\t\t\tview.callEvent(\"onAction\", [\"add-view\", { row:id, newValue:webix.copy(this._pull[id]), value:old} ]);\n\t\t},\n\t\thighlight:function(id){\n\t\t\tconst win = webix.$$(id);\n\t\t\tconst css = \"webix_ssheet_ui_focused\";\n\n\t\t\tconst oldWin = webix.$$(this._activeWin);\n\t\t\tif(oldWin && !oldWin.$destructed)\n\t\t\t\twebix.html.removeCss(oldWin.$view, css);\n\n\t\t\tif(win){\n\t\t\t\tthis._activeWin = id;\n\t\t\t\twebix.html.addCss(win.$view, css);\n\t\t\t}\n\t\t\telse\n\t\t\t\tdelete this._activeWin;\n\t\t},\n\t\t_commands:{\n\t\t\t\"image\":\"add-image-top\",\n\t\t\t\"chart\":\"add-chart\"\n\t\t},\n\t\t_types:{},\n\t\t_pull:{}\n\t};\n\n\t// handle events\n\tview._table.attachEvent(\"onResize\", () => _showAll(view) );\n\tview._table.attachEvent(\"onScrollY\", () => _showAll(view) );\n\tview._table.attachEvent(\"onScrollX\", () => _showAll(view) );\n\n\tview.attachEvent(\"onReset\", () => _reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tconst move = type === \"move-view\";\n\t\tif (move || type == \"resize-view\" || type === \"add-view\")\n\t\t\t_undoUI(view, move, row, value);\n\t});\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif(action == \"header-hide\")\n\t\t\t_showAll(view);\n\t\telse if(action == \"before-grid-change\")\n\t\t\t_updateData(view, p.name, p.inc, p.data, p.start);\n\t});\n\tview.attachEvent(\"onColumnOperation\", () =>  _showAll(view, true));\n\tview.attachEvent(\"onRowOperation\", () => _showAll(view, true));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => _serialize(view, data, config));\n\tview.attachEvent(\"onCellChange\", () => _trackAll(view));\n\tview.attachEvent(\"onMathRefresh\", () => _trackAll(view));\n\n\tview.attachEvent(\"onDestruct\", () => {\n\t\tfor(let i in view.views._pull) webix.$$(i).destructor();\n\t});\n\n\tlet editUIType;\n\twebix.attachEvent(\"onClick\", function(ev){\n\t\tlet focus = webix.$$(ev);\n\t\tif(focus && focus.config.externalUI)\n\t\t\tfocus = webix.$$(focus.config.externalUI);\n\n\t\tconst ui = focus && (focus.queryView(\"ssheet-ui\",\"self\") || focus.queryView(\"ssheet-ui\",\"parent\"));\n\n\t\tif(ui){\n\t\t\tview.views.highlight(ui);\n\t\t\tconst id = ui.config.id;\n\n\t\t\tif(editUIType){\n\t\t\t\tif(view.views.getConfig(id).type == editUIType)\n\t\t\t\t\tui.callEvent(\"onViewEdit\", []); //start editing if any editor is open\n\t\t\t\telse\n\t\t\t\t\tview.callEvent(\"onCommand\", [{ id:\"close-ui-editor\" }]);\n\t\t\t}\n\t\t}\n\t\telse if(!editUIType)\n\t\t\tview.views.highlight();\n\t});\n\n\tview.attachEvent(\"onUIEditStart\", function(id, type){\n\t\tview.views.highlight(id);\n\t\teditUIType = type;\n\t});\n\n\tview.attachEvent(\"onUIEditStop\", function(id, type){\n\t\tif(editUIType == type)\n\t\t\twebix.delay(()=>{ // after onClick handler (to save focus)\n\t\t\t\teditUIType = null;\n\t\t\t});\n\t});\n\n\t// set default views\n\tview.views.register(\"chart\", (node, conf, data) => {\n\t\tconst dataRange = _getNames(view, conf);\n\t\tconst config = _genChartConfig(conf, data, dataRange);\n\t\treturn webix.ui(config, node);\n\t}, (view, data) => {\n\t\tview.clearAll();\n\t\tview.parse(data);\n\t});\n\n\tview.views.register(\"image\", (node, conf, data) => {\n\t\tconst config = webix.extend({ css:\"webix_ssheet_bgimage\", template:`<img src=\"${data}\"/>` }, conf.config||{}, true );\n\t\treturn webix.ui(config, node);\n\t});\n}\n\nfunction _parse(view, data){\n\tconst views = data.views;\n\tif(views){\n\t\tignoreUndo(function(){\n\t\t\tviews.forEach(obj => view.views.add.apply(view.views, obj));\n\t\t}, view);\n\t}\n}\n\nfunction _serialize(view, data, config){\n\tdata.views = [];\n\tfor(let i in view.views._pull){\n\t\tconst conf = view.views._pull[i];\n\t\tconst one = [conf.x, conf.y, conf.type, conf.data, conf.config];\n\t\tif(config && config.viewIds)\n\t\t\tone.push(i);\n\t\tdata.views.push(one);\n\t}\n}\n\nlet thread;\nfunction _trackAll(view){\n\tclearTimeout(thread);\n\tthread = webix.delay(() => {\n\t\tconst ui = view.views;\n\t\tfor(let id in ui._pull){\n\t\t\tconst conf = ui._pull[id];\n\n\t\t\tconst viewMethods = ui._types[conf.type];\n\t\t\tconst render = viewMethods.render;\n\t\t\tconst track = viewMethods.track;\n\n\t\t\tif(track)\n\t\t\t\t_trackOne(view, ui.get(id), track, conf, render);\n\t\t}\n\t});\n}\n\nfunction _trackOne(view, node, track, conf, render){\n\tconst data = _fromRange(view, conf);\n\n\tif(conf.type == \"chart\"){\n\t\tif(render)\n\t\t\tnode = render(node, conf, data, true);\n\n\t\tconst config = conf.config;\n\t\tif(config && !_isPie(config.type))\n\t\t\t_removeLegend(data, conf, view);\n\t}\n\n\ttrack(node, data);\n}\n\nfunction _updateData(view, name, inc, data, start){\n\tconst views = data.views;\n\tfor(let i = 0; i < views.length; i++){\n\t\tif(_isRange(views[i][3])){\n\t\t\tconst series = views[i][4].series;\n\t\t\tif(series){\n\t\t\t\tseries.forEach(obj => {\n\t\t\t\t\tobj.range = changeRange(obj.range, name, inc, start);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst legend = views[i][4].legend && views[i][4].legend.range;\n\t\t\tif(legend)\n\t\t\t\tviews[i][4].legend.range = _getDataParts(legend).map(range => changeRange(range, name, inc, start)).join(\",\");\n\t\t\t\n\t\t\tconst xAxis = views[i][4].xAxis && views[i][4].xAxis.range;\n\t\t\tif(xAxis)\n\t\t\t\tviews[i][4].xAxis.range = changeRange(xAxis, name, inc, start);\n\n\t\t\tviews[i][3] = _getDataParts(views[i][3]).map(range => changeRange(range, name, inc, start)).join(\",\");\n\t\t}\n\t}\n} \n\nfunction _showAll(view, pos){\n\t//close possibly open menus of embedded ui\n\twebix.callEvent(\"onClick\", []);\n\n\tfor(let id in view.views._pull){\n\t\tconst win = webix.$$(id);\n\t\tconst conf = view.views._pull[id];\n\t\tif(pos){\n\t\t\tconf.x = _correctPos(view, win, conf.x, \"x\");\n\t\t\tconf.y = _correctPos(view, win, conf.y, \"y\");\n\t\t}\n\t\t_showOne(view, win, conf);\n\t}\n}\n\nfunction _showOne(view, win, conf){\n\tconst state = view._table.getScrollState();\n\n\twin.show({\n\t\tx:conf.x,\n\t\ty:conf.y-state.y\n\t});\n}\n\nfunction _correctPos(view, win, v, type){\n\tif(!v && v !==0 )\n\t\tv = view._table.getScrollState()[type]+50;\n\telse{\n\t\tconst size = type == \"x\" ? _getWidth(view)-win.$width : _getHeight(view)-win.$height;\n\t\tv = Math.min(Math.max(v, 0), size);\n\t}\t\n\treturn v;\n}\n\nfunction _reset(view){\n\tignoreUndo(function(){\n\t\tfor(let id in view.views._pull)\n\t\t\tview.views.remove(id);\n\t}, view);\n}\n\nfunction _undoUI(view, move, id, value){\n\tif(value){\n\t\tconst {x, y, type, data, config} = value;\n\t\tif(view.views._pull[id]){\n\t\t\tif(move)\n\t\t\t\tview.views.move(id, x, y);\n\t\t\telse\n\t\t\t\tview.views.update(id, data, config);\n\t\t}\n\t\telse\n\t\t\tview.views.add(x, y, type, data, config, id);\n\n\t\tconst editor = view.$$(\"chartEditor\");\n\t\tif(editor && editor.viewId == id)\n\t\t\teditor.queryView(\"form\").setValues(config);\n\t}\n\telse\n\t\tview.views.remove(id);\n}\n\nfunction _getWidth(view){\n\tlet width = 0;\n\tview._table.eachColumn(function(id){\n\t\tif(id !== \"rowId\")\n\t\t\twidth += this.getColumnConfig(id).width;\n\t});\n\treturn width;\n}\n\nfunction _getHeight(view){\n\tlet height = 0;\n\tview._table.data.each(function(obj){\n\t\theight += obj.$height || webix.skin.$active.rowHeight;\n\t});\n\treturn height;\n}\n\n//disable datatables not to interfere with ss table events\nfunction _processTables(node){\n\tconst query = function(view){\n\t\treturn view.name == \"datatable\" || view.name == \"treetable\";\n\t};\n\tlet tables = node.queryView(query, \"self\");\n\tif(tables) tables = [tables];\n\telse tables = node.queryView(query, \"all\");\n\ttables.forEach((dt) => dt.disable());\n}\n\n/* chart-specific helpers */\n\nfunction _genChartConfig(conf, data, dataRange){\n\tconst htmlFilter = /<[^>]*>/gi;\n\tlet config = webix.copy(conf.config);\n\n\tconfig = _normalizeConfig(config);\n\n\tconst scale = config.scale.lines;\n\tconst scaleColor = config.scale.color || undefined;\n\n\tconst type = config.type;\n\n\tif(_isPie(type))\n\t\tdelete config.series;\n\n\tconst legendConfig = config.legend;\n\tlet legendRange = !legendConfig.fromData && legendConfig.range;\n\tif(legendRange){\n\t\tconst switchDirection =  config.dataSeries == \"rows\";\n\t\tlegendRange = _getParts(legendConfig.range, switchDirection, dataRange);\n\t}\n\n\tconst legend = {\n\t\talign: legendConfig.align || \"center\",\n\t\tvalign: legendConfig.valign || \"bottom\"\n\t};\n\n\tlegend.layout = legend.valign == \"middle\" ? \"y\" : \"x\";\n\n\tif(_isPie(type))\n\t\t_pieConfig(data, config, legend, legendRange);\n\telse if(config.series){\n\t\tlegend.values = [];\n\n\t\tconst lines = config.series;\n\t\tconfig.series = [];\n\n\t\tconst xAxis = config.xAxis;\n\t\tif(xAxis.fromData)\n\t\t\txAxis.range = legendRange ? Object.keys(data[0]).filter(line => legendRange.indexOf(line) == -1)[0] : \"data0\";\n\t\telse if(xAxis.range)\n\t\t\txAxis.range = dataRange[xAxis.range];\n\n\t\tfor(let i = 0; i < lines.length; i++){\n\t\t\tconst color = lines[i].color;\n\t\t\tconst item = dataRange[lines[i].range];\n\n\t\t\tif(item != xAxis.range){\n\t\t\t\tconst s = {\n\t\t\t\t\tvalue:`#${item}#`,\n\t\t\t\t\ttooltip:{\n\t\t\t\t\t\ttemplate: lines[i].tooltip ? `#${item}#` : \"\"\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tif(type == \"radar\" || type == \"line\" || type == \"spline\"){\n\t\t\t\t\ts.line = { color:color };\n\t\t\t\t\ts.item = { borderColor:color, type:lines[i].marker };\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\ts.color = color;\n\t\t\t\tif(type == \"area\" || type == \"splineArea\")\n\t\t\t\t\ts.alpha = 0.7;\n\n\t\t\t\tif(data[0] && (legendRange || legendConfig.fromData)){\n\t\t\t\t\tconst val = legendRange ? data[0][legendRange[i]] : data[0][item];\n\t\t\t\t\tconst text = (val || val === 0) ? (val+\"\").replace(htmlFilter, \"\") : \"\";\n\t\t\t\t\tlegend.values.push({text, color});\n\t\t\t\t}\n\n\t\t\t\tconfig.series.push(s);\n\t\t\t}\n\t\t}\n\n\t\tif(xAxis.range){\n\t\t\tconfig.xAxis = {\n\t\t\t\ttemplate: obj => {\n\t\t\t\t\tconst val = obj[xAxis.range];\n\t\t\t\t\treturn (val || val === 0) ? (val+\"\").replace(htmlFilter, \"\") : \"\";\n\t\t\t\t},\n\t\t\t\ttitle: config.xAxis.title,\n\t\t\t\tlineColor: scaleColor,\n\t\t\t\tcolor: scaleColor,\n\t\t\t\tlines: scale\n\t\t\t};\n\t\t}\n\t\telse\n\t\t\tdelete config.xAxis;\n\n\t\tif(legend.values.length)\n\t\t\tconfig.legend = legend;\n\t\telse\n\t\t\tdelete config.legend;\n\t}\n\n\tconfig.yAxis = webix.extend(config.yAxis||{}, {\n\t\tlineColor: scaleColor,\n\t\tcolor: scaleColor,\n\t\tlines: scale,\n\t\tlineShape: config.scale.circle ? \"arc\" : \"default\"\n\t});\n\n\treturn webix.extend({\n\t\tview:\"chart\"\n\t}, config, true);\n}\n\nfunction _pieConfig(data, config, legend, legendRange){\n\tconst htmlFilter = /<[^>]*>/gi;\n\tfor(var i in data[0]){\n\t\tif(config.legend.fromData){\n\t\t\tlegend.template = obj => {\n\t\t\t\tconst val = obj[i];\n\t\t\t\treturn (val || val === 0) ? (val+\"\").replace(htmlFilter, \"\") : \"\";\n\t\t\t}; //data0\n\t\t\tconfig.value = `#${i.replace(\"0\", \"1\")}#`; //data1\n\t\t}\n\t\telse{\n\t\t\tif(config.legend.range)\n\t\t\t\tlegend.template = obj => {\n\t\t\t\t\tconst val = obj[legendRange[0]];\n\t\t\t\t\treturn (val || val === 0) ? (val+\"\").replace(htmlFilter, \"\") : \"\";\n\t\t\t\t};\n\t\t\tconfig.value = `#${i}#`;\n\t\t}\n\t\tbreak; \n\t}\n\tif(legend.template)\n\t\tconfig.legend = legend;\n\telse\n\t\tdelete config.legend;\n\n\tif(config.pieInnerText)\n\t\tconfig.pieInnerText = config.value;\n}\n\nfunction _isRange(data){\n\treturn typeof data == \"string\" && data.indexOf(\"data:image\") === -1;\n}\n\nfunction _fromRange(view, conf){\n\tlet data = conf.data;\n\n\tif(/^(http|data:image|\\/)/i.test(data))\n\t\treturn data;\n\n\tconst arr = [];\n\tif(data){\n\t\tconst config = conf.config;\n\t\tconst switchDirection = config.dataSeries == \"rows\";\n\t\tlet lastIndex = 0;\n\n\t\tdata = _getDataParts(data);\n\t\tfor(let i = 0; i < data.length; i++){\n\t\t\tconst cells = _isRange(data[i]) ? range(data[i], view) : null;\n\t\t\tif(cells){\n\t\t\t\tconst page = getAccessor(view, cells[4]);\n\t\t\t\tcells[4] = lastIndex;\n\n\t\t\t\tconst subdata = page ? page[switchDirection ? \"getRangeRows\" : \"getRangeCols\"].apply(page, cells) : null;\n\t\t\t\tif(subdata){\n\t\t\t\t\tlastIndex += subdata[2];\n\t\t\t\t\tfor(let i = 0; i < subdata[0].length; i++){\n\t\t\t\t\t\tif(!arr[i])\n\t\t\t\t\t\t\tarr[i] = {};\n\t\t\t\t\t\twebix.extend(arr[i], subdata[0][i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn arr;\n}\n\nfunction _removeLegend(arr, conf, view){\n\tconst config = conf.config;\n\tif(typeof(config.legend) != \"object\")\n\t\tconfig.legend = {fromData: !!config.legend};\n\n\tconst legend = config.legend;\n\n\tif(legend.fromData)\n\t\tarr.shift();\n\telse if(legend.range){\n\t\tconst names = _getNames(view, conf);\n\t\tconst switchDirection = config.dataSeries == \"rows\";\n\t\tconst legendRange = _getParts(legend.range, switchDirection, names);\n\t\tfor (let i = 0; i < legendRange.length; i++){\n\t\t\tconst item = legendRange[i];\n\t\t\tdelete arr[0][item];\n\t\t}\n\t}\n}\n\nfunction _getNames(view, conf){\n\tlet data = conf.data;\n\n\tif(/^(http|data:image|\\/)/i.test(data))\n\t\treturn;\n\n\tlet names = {};\n\tif(data){\n\t\tconst config = conf.config;\n\t\tlet lastIndex = 0;\n\t\tdata = _getDataParts(data);\n\t\tfor(let i = 0; i < data.length; i++){\n\t\t\tconst cells = _isRange(data[i]) ? range(data[i], view) : null;\n\t\t\tif(cells){\n\t\t\t\tconst page = getAccessor(view, cells[4]);\n\t\t\t\tcells[4] = lastIndex;\n\n\t\t\t\tconst subdata = page ? page[config.dataSeries == \"rows\" ? \"getRangeRows\" : \"getRangeCols\"].apply(page, cells) : null;\n\t\t\t\tif(subdata){\n\t\t\t\t\tlastIndex += subdata[2];\n\t\t\t\t\twebix.extend(names, subdata[1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn names;\n}\n\nexport function _getDataParts(data){\n\treturn data.replace(/\\s/g, \"\").split(\",\");\n}\n\nexport function _isPie(type){\n\treturn /pie|donut/.test(type);\n}\n\nexport function _getSeries(view, data, dataSeries, active, oldXaxis){\n\tconst dir = dataSeries == \"rows\";\n\tlet vals = [];\n\n\tif(data){\n\t\tlet xAxis = [];\n\t\tlet legend = [];\n\t\tlet activeVals = [];\n\n\t\tif(active){\n\t\t\tif(active.legend)\n\t\t\t\tlegend = _getParts(active.legend, dir);\n\t\t\tif(active.xAxis)\n\t\t\t\txAxis = _getParts(active.xAxis, dir);\n\t\t\tif(active.series)\n\t\t\t\tactiveVals = active.series.filter(val => legend.indexOf(val.range) == -1 && xAxis.indexOf(val.range) == -1);\n\t\t}\n\n\t\tdata = _getDataParts(data);\n\t\tlet colorIndex = 0;\n\t\tlet firstRange = 1;\n\t\tdata.forEach(subdata => {\n\t\t\tconst series = range(subdata, view);\n\t\t\tif(series){\n\t\t\t\tconst start = dir ? series[0] : series[1];\n\t\t\t\tconst end = dir ? series[2] : series[3];\n\n\t\t\t\tlet inActiveSeries;\n\t\t\t\tfor(let i = start; i <= end; i++){\n\t\t\t\t\tconst range = dir ? toRange(i, series[1], i, series[3], series[4]) : toRange(series[0], i, series[2], i, series[4]);\n\t\t\t\t\tif(activeVals.filter(val => val.range == range && val.active == subdata).length)\n\t\t\t\t\t\tinActiveSeries = 1;\n\t\t\t\t}\n\n\t\t\t\tfor(let i = start; i <= end; i++){\n\t\t\t\t\tconst range = dir ? toRange(i, series[1], i, series[3], series[4]) : toRange(series[0], i, series[2], i, series[4]);\n\t\t\t\t\tif(legend.indexOf(range) != -1 || xAxis.indexOf(range) != -1)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tconst activeVal = activeVals.filter(val => val.range == range && val.active == subdata)[0];\n\n\t\t\t\t\tif(inActiveSeries && !activeVal && !(oldXaxis && firstRange && i == start))\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tvals.push(activeVal || {\n\t\t\t\t\t\tactive: subdata,\n\t\t\t\t\t\trange,\n\t\t\t\t\t\tmarker: \"square\",\n\t\t\t\t\t\ttooltip: 1,\n\t\t\t\t\t\tcolor: _getColor(colorIndex)\n\t\t\t\t\t});\n\n\t\t\t\t\tcolorIndex++;\n\t\t\t\t}\n\t\t\t\tfirstRange = 0;\n\t\t\t}\n\t\t});\n\t}\n\treturn vals;\n}\n\nexport function _getParts(ranges, dir, dataRange){\n\tconst parts = [];\n\n\tranges = _getDataParts(ranges);\n\tranges.forEach(subRange => {\n\t\tsubRange = range(subRange);\n\t\tconst start = dir ? subRange[0] : subRange[1];\n\t\tconst end = dir ? subRange[2] : subRange[3];\n\n\t\tfor(let i = start; i <= end; i++){\n\t\t\tconst range = dir ?\n\t\t\t\ttoRange(i, subRange[1], i, subRange[3], subRange[4]):\n\t\t\t\ttoRange(subRange[0], i, subRange[2], i, subRange[4]);\n\n\t\t\tparts.push(dataRange ? dataRange[range] : range);\n\t\t}\n\t});\n\n\treturn parts;\n}\n\nexport function _normalizeConfig(config){\n\tif(typeof(config.xAxis) != \"object\")\n\t\tconfig.xAxis = {fromData: !!config.xAxis};\n\n\tif(typeof(config.legend) != \"object\")\n\t\tconfig.legend = {fromData: !!config.legend};\n\n\tconfig.legend = webix.extend(config.legend, {\n\t\tlayout:\"x\",\n\t\talign:\"center\",\n\t\tvalign:\"bottom\"\n\t});\n\n\tif(!config.scale)\n\t\tconfig.scale = {\n\t\t\tlines:1\n\t\t};\n\n\treturn config;\n}\n\nfunction _getColor(index){\n\tconst colors = [\n\t\t\"#e06666\", \"#6aa84f\", \"#3c78d8\", \"#e69138\", \"#783f04\", \"#134f5c\", \"#674ea7\", \"#c27ba0\"\n\t];\n\treturn colors[index%colors.length];\n}","import {range, toRange} from \"./helpers/column_names\";\nimport {_getSeries, _isPie, _normalizeConfig, _getDataParts} from \"./operations/views\";\n\nconst labels = webix.i18n.spreadsheet.labels;\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\tconst activeSkin = webix.skin.$active;\n\tconst padding = activeSkin.dataPadding-2;\n\tconst margin = activeSkin.layoutMargin.form;\n\n\treturn {\n\t\twidth:420,\n\t\thidden: true,\n\t\tid:\"chartEditor\",\n\t\tcss:\"ssheet_chart\",\n\t\trows:[\n\t\t\t{\n\t\t\t\theight: activeSkin.barHeight,\n\t\t\t\tcss: \"ssheet_chart_wizard_head\",\n\t\t\t\tpadding:{ left: 2 },\n\t\t\t\tcols: [\n\t\t\t\t\t{ view: \"icon\", hotkey:\"esc\", icon:\"webix_ssheet_icon ssi-arrow-left\", click: () => closeEditor(view)  },\n\t\t\t\t\t{ type:\"header\", borderless:true, template: labels[\"chart-edit\"] }\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"form\",\n\t\t\t\tcomplexData:true,\n\t\t\t\tborderless: true,\n\t\t\t\tpadding:{\n\t\t\t\t\ttop: 0\n\t\t\t\t},\n\t\t\t\telementsConfig:{\n\t\t\t\t\tlabelWidth:180\n\t\t\t\t},\n\t\t\t\telements:[{\n\t\t\t\t\tview:\"tabview\",\n\t\t\t\t\tid:\"chartTabs\",\n\t\t\t\t\tcells:[\n\t\t\t\t\t\t{ id:\"common\", borderless:true, type:\"form\", paddingX:0, header:labels[\"chart-common\"], rows:[\n\t\t\t\t\t\t\t{view:\"scrollview\", body:{\n\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\taddRichselect(\"type\", \"chart-type\", getTypes()),\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"stacked-chart\"], name:\"stacked\", hidden:true},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-pie-3d\"], name:\"3D\", hidden:true},\n\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-range\"], name:\"range\"},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-col-xAxis\"], name:\"xAxis.fromData\", batch:\"axis\"},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-pie-text\"], name:\"pieInnerText\", hidden:true},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-row-legend\"], name:\"legend.fromData\"},\n\t\t\t\t\t\t\t\t\t{ view:\"radio\", label:labels[\"chart-data-from\"], name:\"dataSeries\", vertical:true, options:[\n\t\t\t\t\t\t\t\t\t\t{id:\"columns\", value:labels[\"chart-columns\"]},\n\t\t\t\t\t\t\t\t\t\t{id:\"rows\", value:labels[\"chart-rows\"]}\n\t\t\t\t\t\t\t\t\t]},\n\t\t\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ id:\"advanced\", borderless:true, type:\"form\", paddingX:0, padding:{bottom:0}, header:labels[\"chart-series\"], rows:[\n\t\t\t\t\t\t\t{ view: \"ssheet-series\", name:\"series\" },\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ id:\"extras\", borderless:true, type:\"form\", paddingX:0, header:labels[\"chart-extras\"], rows:[\n\t\t\t\t\t\t\t{view:\"scrollview\", body:{\n\t\t\t\t\t\t\t\tview: \"accordion\",\n\t\t\t\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\t\t\t\tcss: \"webix_ssheet_accordion\",\n\t\t\t\t\t\t\t\tmulti: true,\n\t\t\t\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t{ header:labels[\"chart-legend\"], body:{\n\t\t\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\t\t\tpadding,\n\t\t\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t\t\t{ view: \"text\", label:labels[\"chart-legend-range\"], name:\"legend.range\"},\n\t\t\t\t\t\t\t\t\t\t\taddRichselect(\"legend.align\", \"chart-legend-align\", getLegendAlign()),\n\t\t\t\t\t\t\t\t\t\t\taddRichselect(\"legend.valign\", \"chart-legend-valign\", getLegendValign())\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t\t\t{ header:labels[\"chart-axis\"], body:{\n\t\t\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\t\t\tpadding,\n\t\t\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-xAxis-range\"], name:\"xAxis.range\", range:true, batch:\"axis\" },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-xAxis-title\"], name:\"xAxis.title\", batch:\"axisTitle\" },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-yAxis-title\"], name:\"yAxis.title\", batch:\"axisTitle\" },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-scale\"], name:\"scale.lines\", batch:\"axis\"},\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-radar-circle\"], name:\"scale.circle\", hidden:true},\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"chart-scale-color\"], name:\"scale.color\", batch:\"axis\"}\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]\n\t\t\t\t}]\n\t\t\t}\n\t\t]\n\t};\n}\n\nfunction ready(view){\n\tconst chartEditor = view.$$(\"chartEditor\");\n\tconst form = chartEditor.queryView(\"form\");\n\tconst elements = form.elements;\n\n\tview.attachEvent(\"onCommand\", action => {\n\t\tif(action.id == \"add-chart\"){\n\t\t\tconst config = action.config;\n\t\t\tlet values = config && config.config || {};\n\n\t\t\tchartEditor.show();\n\n\t\t\tview.$handleSelection = function(st, end, a, b){\n\t\t\t\tconst focus = webix.UIManager.getFocus();\n\n\t\t\t\tif(chartEditor.queryView(view => view == focus)){\n\t\t\t\t\tif(focus == elements.range || focus == elements[\"legend.range\"]){\n\t\t\t\t\t\tlet val = focus.getValue();\n\t\t\t\t\t\tconst last = val.lastIndexOf(\",\");\n\n\t\t\t\t\t\tval = last == -1 ? \"\" : val.substring(0, last + 1);\n\t\t\t\t\t\tfocus.setValue(val + a+\":\"+b);\n\t\t\t\t\t}\n\t\t\t\t\telse if(focus.config.range)\n\t\t\t\t\t\tfocus.setValue(a+\":\"+b);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\tform.clear();\n\t\t\tview.$$(\"chartTabs\").setValue(\"common\");\n\n\t\t\tvalues = _normalizeConfig(values);\n\n\t\t\tvalues.range = config ? config.data : view.getSelectedRange();\n\t\t\tchartEditor.viewId = action.viewid ? action.viewid : view.views.add(null, null, \"chart\", values.range, values);\n\n\t\t\tview.callEvent(\"onUIEditStart\", [chartEditor.viewId, \"chart\"]);\n\n\t\t\tupdateValign(values.legend.align);\n\t\t\tupdateAlign(values.legend.valign);\n\t\t\tupdateType(values.type);\n\n\t\t\tform.setValues(inValues(values));\n\n\t\t\tif(values.legend.fromData)\n\t\t\t\tupdateLegendRange(values.legend.fromData);\n\t\t\tif(values.xAxis.fromData)\n\t\t\t\tupdateXaxisRange(values.xAxis.fromData);\n\n\t\t\tupdateSeries();\n\n\t\t\tform.queryView(\"accordionitem\", \"all\").forEach(view => view.expand());\n\n\t\t\telements.range.focus();\n\t\t}\n\t});\n\n\tview.attachEvent(\"onUIEditStart\", (id, type)=>{\n\t\tif(chartEditor.isVisible() && type != \"chart\")\n\t\t\tcloseEditor(view);\n\t});\n\n\tview.attachEvent(\"onCommand\", obj =>{\n\t\tif(obj.id == \"close-ui-editor\" && chartEditor.isVisible())\n\t\t\tcloseEditor(view);\n\t});\n\n\tview.attachEvent(\"onAction\", (id, values) => {\n\t\tif(id == \"add-view\" && !values.newValue){\n\t\t\tif(chartEditor.isVisible() && chartEditor.viewId == values.row)\n\t\t\t\tcloseEditor(view);\n\t\t}\n\t});\n\n\tform.attachEvent(\"onChange\", function(val, oldVal){\n\t\tconst source = this.$eventSource;\n\n\t\t//upper case ranges\n\t\tif(source === elements.range || source === elements[\"xAxis.range\"] || source === elements[\"legend.range\"]){\n\t\t\tconst upper = val.toUpperCase();\n\t\t\tif(val != upper){\n\t\t\t\tval = upper;\n\t\t\t\tsetSilentValue(source, upper);\n\t\t\t}\n\t\t}\n\n\t\tswitch (source){\n\t\t\tcase elements.type:\n\t\t\t\tupdateType(val);\n\t\t\t\tbreak;\n\t\t\tcase elements.range:\n\t\t\tcase elements.dataSeries:\n\t\t\t\tif(this.$eventSource == elements.dataSeries)\n\t\t\t\t\tswitchRowsCols();\n\t\t\t\tif(elements[\"legend.fromData\"].getValue())\n\t\t\t\t\thandlePieLegend();\n\t\t\t\tif(elements[\"xAxis.fromData\"].getValue())\n\t\t\t\t\tsetSilentValue(elements[\"xAxis.range\"], getLeftColumn());\n\t\t\t\tupdateSeries();\n\t\t\t\tbreak;\n\t\t\tcase elements[\"xAxis.fromData\"]:\n\t\t\t\tupdateXaxisRange(val);\n\t\t\t\tupdateSeries(oldVal);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.fromData\"]:\n\t\t\t\tupdateLegendRange(val);\n\t\t\t\tupdateSeries();\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.align\"]:\n\t\t\t\tupdateValign(val);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.valign\"]:\n\t\t\t\tupdateAlign(val);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"xAxis.range\"]:\n\t\t\t\tif(elements[\"xAxis.fromData\"].getValue())\n\t\t\t\t\tsetSilentValue(elements[\"xAxis.fromData\"]);\n\t\t\t\tupdateRange(val, oldVal);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.range\"]:\n\t\t\t\tif(elements[\"legend.fromData\"].getValue())\n\t\t\t\t\tsetSilentValue(elements[\"legend.fromData\"]);\n\t\t\t\tupdateRange(val, oldVal);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tconst config = outValues(form.getValues());\n\t\tview.views.update(chartEditor.viewId, config.range, config);\n\t});\n\n\telements.series.attachEvent(\"onRangeChange\", updateRange);\n\n\tfunction handlePieLegend(){\n\t\tif(elements[\"legend.fromData\"].getValue()){\n\t\t\tconst handler = _isPie(elements.type.getValue()) ? getLeftColumn : getTopRow;\n\t\t\tsetSilentValue(elements[\"legend.range\"], handler());\n\t\t}\n\t}\n\n\tfunction updateLegendRange(val){\n\t\tif(val){\n\t\t\tconst legendRange = elements[\"legend.range\"].getValue();\n\t\t\tupdateRange(\"\", legendRange);\n\t\t}\n\n\t\tconst handler = _isPie(elements.type.getValue()) ? getLeftColumn : getTopRow;\n\t\tval = val ? handler() : \"\";\n\n\t\tsetSilentValue(elements[\"legend.range\"], val);\n\t}\n\n\tfunction updateXaxisRange(val){\n\t\tif(val){\n\t\t\tconst xAxisRange = elements[\"xAxis.range\"].getValue();\n\t\t\tupdateRange(\"\", xAxisRange);\n\t\t}\n\n\t\tval = val ? getLeftColumn() : \"\";\n\n\t\tsetSilentValue(elements[\"xAxis.range\"], val);\n\t}\n\n\tfunction setSilentValue(element, val){\n\t\telement.blockEvent();\n\t\telement.setValue(val);\n\t\telement.unblockEvent();\n\t}\n\n\tfunction getLeftColumn(){\n\t\tconst data = elements.range.getValue();\n\t\tconst dataSeries = elements.dataSeries.getValue();\n\t\tconst legendRange = elements[\"legend.range\"].getValue();\n\t\tlet leftColumn = \"\";\n\n\t\tconst series = _getSeries(view, data, dataSeries, {legend: legendRange || \"\"});\n\n\t\tif(series.length)\n\t\t\tleftColumn = series[0].range;\n\n\t\treturn leftColumn;\n\t}\n\n\tfunction getTopRow(){\n\t\tconst data = _getDataParts(elements.range.getValue());\n\t\tconst dir = elements.dataSeries.getValue() == \"rows\";\n\t\tconst xAxisRange = _getDataParts(elements[\"xAxis.range\"].getValue());\n\t\tlet topRow = [];\n\n\t\tdata.forEach(subdata => {\n\t\t\tif(xAxisRange.indexOf(subdata) == -1){\n\t\t\t\tconst part = range(subdata, view);\n\t\t\t\tif(part){\n\t\t\t\t\tconst range = dir ?\n\t\t\t\t\t\ttoRange(part[0], part[1], part[2], part[1], part[4]) :\n\t\t\t\t\t\ttoRange(part[0], part[1], part[0], part[3], part[4]);\n\n\t\t\t\t\tif(data.indexOf(range) == -1)\n\t\t\t\t\t\ttopRow.push(range);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn topRow.join(\",\");\n\t}\n\n\tfunction updateRange(val, oldVal){\n\t\tlet data = elements.range.getValue();\n\n\t\tconst legend = elements[\"legend.range\"].getValue();\n\t\tconst xAxis = elements[\"xAxis.range\"].getValue();\n\t\tconst dataSeries = elements.dataSeries.getValue();\n\n\t\tconst series = _getSeries(view, data, dataSeries, {legend, xAxis});\n\n\t\toldVal = _getDataParts(oldVal);\n\n\t\tdata = _getDataParts(data).filter(val => oldVal.indexOf(val) == -1);\n\n\t\tif(val){\n\t\t\tval = _getDataParts(val);\n\t\t\tval.forEach(range => {\n\t\t\t\tconst exist = series.filter(obj => obj.range == range);\n\t\t\t\tif(!exist.length)\n\t\t\t\t\tdata.push(range);\n\t\t\t});\n\t\t}\n\n\t\tsetSilentValue(elements.range, data.join(\",\"));\n\t}\n\n\tfunction updateAlign(val){\n\t\tconst align = elements[\"legend.align\"];\n\t\tconst list = align.getList();\n\n\t\tif(val == \"middle\"){\n\t\t\tif(list.exists(\"center\"))\n\t\t\t\tlist.remove(\"center\");\n\t\t}\n\t\telse if(!list.exists(\"center\"))\n\t\t\tlist.add({id:\"center\", value:labels[\"chart-legend-center\"]}, 1);\n\t}\n\n\tfunction updateValign(val){\n\t\tconst align = elements[\"legend.valign\"];\n\t\tconst list = align.getList();\n\n\t\tif(val == \"center\"){\n\t\t\tif(list.exists(\"middle\"))\n\t\t\t\tlist.remove(\"middle\");\n\t\t}\n\t\telse if(!list.exists(\"middle\"))\n\t\t\tlist.add({id:\"middle\", value:labels[\"chart-legend-middle\"]}, 1);\n\t}\n\n\tfunction updateType(val){\n\t\tconst tabs = view.$$(\"chartTabs\").getTabbar();\n\t\tswitchRowsCols();\n\t\thandlePieLegend();\n\n\t\telements.series.hideMarkers(val == \"radar\" || val == \"line\" || val == \"spline\");\n\n\t\tif(val == \"area\" || val == \"bar\") elements.stacked.show();\n\t\telse hideField(elements.stacked);\n\n\t\tif(val == \"radar\")\n\t\t\telements[\"scale.circle\"].show();\n\t\telse\n\t\t\thideField(elements[\"scale.circle\"]);\n\n\t\tif(val == \"pie\")\n\t\t\telements[\"3D\"].show();\n\t\telse\n\t\t\thideField(elements[\"3D\"]);\n\n\t\tif(_isPie(val)){\n\t\t\thideBatch(\"axis\");\n\t\t\telements.pieInnerText.show();\n\t\t\ttabs.hideOption(\"advanced\");\n\t\t}\n\t\telse{\n\t\t\thideBatch(\"axis\", true);\n\t\t\thideField(elements.pieInnerText);\n\t\t\ttabs.showOption(\"advanced\");\n\t\t}\n\n\t\tif(_isPie(val) || val == \"radar\")\n\t\t\thideBatch(\"axisTitle\");\n\t\telse\n\t\t\thideBatch(\"axisTitle\", true);\n\t}\n\n\tfunction updateSeries(oldXaxis){\n\t\tlet data = elements.range.getValue();\n\n\t\tlet series = elements.series.getValue();\n\t\tconst legend = elements[\"legend.range\"].getValue();\n\t\tconst xAxis = elements[\"xAxis.range\"].getValue();\n\t\tconst dataSeries = elements.dataSeries.getValue();\n\n\t\tseries = _getSeries(view, data, dataSeries, {series, legend, xAxis}, oldXaxis);\n\n\t\telements.series.setValue(series);\n\t}\n\n\tfunction switchRowsCols(){\n\t\tconst dir = elements.dataSeries.getValue() == \"rows\";\n\t\tconst pie = _isPie(elements.type.getValue());\n\t\tif((!pie && dir) || (!dir && pie)){\n\t\t\telements[\"legend.fromData\"].define(\"label\", labels[\"chart-col-legend\"]);\n\t\t\telements[\"xAxis.fromData\"].define(\"label\", labels[\"chart-row-xAxis\"]);\n\t\t}\n\t\telse{\n\t\t\telements[\"legend.fromData\"].define(\"label\", labels[\"chart-row-legend\"]);\n\t\t\telements[\"xAxis.fromData\"].define(\"label\", labels[\"chart-col-xAxis\"]);\n\t\t}\n\t\telements[\"legend.fromData\"].refresh();\n\t\telements[\"xAxis.fromData\"].refresh();\n\t}\n\n\tfunction hideField(field){\n\t\tif(field.setValue)\n\t\t\tsetSilentValue(field);\n\t\tfield.hide();\n\t}\n\n\tfunction hideBatch(batch, visible){\n\t\tform.queryView({batch:batch}, \"all\").forEach(field => {\n\t\t\tif(visible)\n\t\t\t\tfield.show();\n\t\t\telse\n\t\t\t\thideField(field);\n\t\t});\n\t}\n\n\tfunction inValues(values){\n\t\tif(/stacked|3D/.test(values.type))\n\t\t\tvalues.type = values.type.replace(/stacked|3D/, \"\").toLowerCase();\n\t\treturn values;\n\t}\n\n\tfunction outValues(values){\n\t\tif(values.stacked)\n\t\t\tvalues.type = \"stacked\"+values.type.charAt(0).toUpperCase()+values.type.substr(1);\n\t\telse if(values[\"3D\"])\n\t\t\tvalues.type += \"3D\";\n\n\t\treturn values;\n\t}\n}\n\nfunction closeEditor(view){\n\tconst chartEditor = view.$$(\"chartEditor\");\n\tview.callEvent(\"onUIEditStop\", [chartEditor.viewId, \"chart\"]);\n\tchartEditor.viewId = null;\n\tview.$handleSelection = null;\n\tchartEditor.hide();\n}\n\nfunction addRichselect(name, label, data){\n\treturn { view: \"richselect\", name:name, label:labels[label], suggest:{\n\t\tview: \"ssheet-form-suggest\",\n\t\tdata: data\n\t}};\n}\n\nfunction getTypes(){\n\treturn [\n\t\t{id:\"line\", value:labels[\"line-chart\"]},\n\t\t{id:\"spline\", value:labels[\"spline-chart\"]},\n\t\t{id:\"splineArea\", value:labels[\"splinearea-chart\"]},\n\t\t{id:\"area\", value:labels[\"area-chart\"]},\n\t\t{id:\"bar\", value:labels[\"bar-chart\"]},\n\t\t{id:\"radar\", value:labels[\"radar-chart\"]},\n\t\t{id:\"pie\", value:labels[\"pie-chart\"]},\n\t\t{id:\"donut\", value:labels[\"donut-chart\"]}\n\t];\n}\n\nfunction getLegendAlign(){\n\treturn [\n\t\t{id:\"left\", value:labels[\"chart-legend-left\"]},\n\t\t{id:\"center\", value:labels[\"chart-legend-center\"]},\n\t\t{id:\"right\", value:labels[\"chart-legend-right\"]}\n\t];\n}\n\nfunction getLegendValign(){\n\treturn [\n\t\t{id:\"top\", value:labels[\"chart-legend-top\"]},\n\t\t{id:\"middle\", value:labels[\"chart-legend-middle\"]},\n\t\t{id:\"bottom\", value:labels[\"chart-legend-bottom\"]}\n\t];\n}","import {updateMath}  from \"../math/updater\";\nimport {clearMathCache} from \"../math/cache\";\nimport {ignoreReset, ignoreUndo}  from \"../operations/undo\";\nimport group  from \"../operations/undo_group\";\nimport {adjustSpan}  from \"../operations/spans\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action, start, end) => {\n\t\tif (action.id == \"add\" || action.id == \"del\"){\n\t\t\tvar area = view._table.getSelectArea();\n\t\t\tif(area && !(start && end)){\n\t\t\t\tstart = area.start;\n\t\t\t\tend = area.end;\n\t\t\t}\n\n\t\t\tif (start && end){\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tprocess(action, start, end, view);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif(action == \"grid-change\"){\n\t\t\tclearMathCache(true);\n\t\t\tloadChangedData(view,value);\n\t\t}\n\t});\n}\n\nexport function process(action, start, end, view, e, r) {\n\tvar data, i, newData, oldData, values,\n\t\tcount=0, origin=0;\n\n\tvar select = view._table.getSelectArea();\n\tvar state = view._table.getScrollState();\n\n\tnewData = view.serialize({\n\t\tmath: true, viewIds:true\n\t});\n\n\toldData = webix.copy(newData);\n\n\tvar spans = newData.spans;\n\tfor (var s in spans){\n\t\tvar span = spans[s];\n\t\tspan = adjustSpan(span, action, start, end, newData.data);\n\t\tif(span[2] <= 0 || span[3] <= 0){\n\t\t\tspans.splice(s, 1);\n\t\t}\n\t}\n\n\tvalues = getUpdateValues(action, start, end);\n\n\tview.$handleSelection = null;\t\n\n\tif(!e)\n\t\tignoreUndo(function(){\n\t\t\tview.callEvent(\"onAction\", [\"before-grid-change\", {\n\t\t\t\tname: values.name,\n\t\t\t\tinc: values.inc,\n\t\t\t\tdata:newData,\n\t\t\t\tstart: start\n\t\t\t}]);\n\t\t},view);\n\n\tdata = newData.data;\n\n\tif (action.group == \"column\") {\n\t\tcount = end.column - start.column + 1;\n\t\torigin = start.column;\n\n\t\tif (action.id == \"add\")\n\t\t\t_addColumn(action, start, end, view, e, r, data);\n\t\telse if (action.id == \"del\"){\n\t\t\t_delColumn(action, start, end, view, e, r, data);\n\t\t\tcount = -count;\n\t\t}\n\t} else if (action.group == \"row\") {\n\t\tcount = end.row - start.row + 1;\n\t\torigin = start.row;\n\n\t\tif (action.id == \"add\")\n\t\t\t_addRow(action, start, end, view, e, r, data);\n\t\telse if (action.id == \"del\"){\n\t\t\t_delRow(action, start, end, view, e, r, data);\n\t\t\tcount = -count;\n\t\t}\n\t}\n\n\t//update formulas\n\tvar update = { id:action.group, start:origin, count:count };\n\ti = data.length;\n\twhile (i--) {\n\t\tif (data[i][2] && typeof data[i][2] === \"string\" && data[i][2].substr(0, 1) == \"=\")\n\t\t\tdata[i][2] = updateMath(data[i][2], update);\n\t}\n\n\tview.callEvent(\"onAction\", [\"grid-change\",{value: oldData, newValue: newData} ]);\n\n\tignoreUndo(function() {\n\t\tloadChangedData(view, newData);\n\t\tview._table.scrollTo(state.x, state.y);\n\t},view);\n\n\tif (select){\n\t\tvar grid = view.$$(\"cells\");\n\t\tselect = fixSelectArea(select, grid);\n\t\tif (select)\n\t\t\tgrid.addSelectArea(select.start, select.end);\n\t}\n}\n\nfunction fixSelectArea(select, grid){\n\tvar rows = grid.count();\n\tvar cols = grid.config.columns.length;\n\tif (select.start.row*1 > rows) return null;\n\tif (select.end.row*1 > rows) return null;\n\tif (select.start.column*1 > cols) return null;\n\tif (select.end.column*1 > cols) return null;\n\t\n\treturn select;\n}\n\nfunction loadChangedData(view, data){\n\t// data loading resets undo history, and\n\t// we need to preserve it\n\tignoreReset(function(){\n\t\tview.$handleSelection = null;\n\t\tview.parse(data);\n\t});\n}\n\nfunction getUpdateValues( action, start, end){\n\tvar name = action.group,\n\t\tinc = action.id==\"add\"?1:(action.id==\"del\"?-1:0);\n\n\tif(inc) {\n\t\t// span support\n\t\tif (name == \"row\")\n\t\t\tinc += inc * (end.row - start.row);\n\t\tif (name == \"column\")\n\t\t\tinc += inc * (end.column - start.column);\n\t}\n\treturn {name: name, inc: inc};\n}\n\nfunction _addColumn(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet add_column_count = end.column - start.column + 1;\n\tview.config.columnCount += add_column_count;\n\tview.reset();\n\n\twhile (i--)\n\t\tif (data[i][1] >= start.column)\n\t\t\tdata[i][1] += add_column_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, null]); //add item to history\n\telse\n\t\tdata.push(...value); //recovering value which has been deleted\n}\n\nfunction _delColumn(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet del_column_count = end.column - start.column + 1;\n\n\tif (view.config.columnCount === del_column_count){\n\t\tif (start.column == end.column)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.column--;\n\t\tdel_column_count--;\n\t}\n\n\tview.config.columnCount -= del_column_count;\n\n\n\tview.reset();\n\tlet deleted = []; // for history\n\n\twhile (i--)\n\t\tif (data[i][1] >= start.column && data[i][1] <= end.column)\n\t\t\tdeleted.push(data.splice(i, 1)[0]);\n\t\telse if (data[i][1] > end.column)\n\t\t\tdata[i][1] -= del_column_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, deleted]);\n}\n\nfunction _addRow(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet add_row_count = end.row - start.row + 1;\n\tview.config.rowCount += add_row_count;\n\n\tview.reset();\n\n\twhile (i--)\n\t\tif (data[i][0] >= start.row)\n\t\t\tdata[i][0] += add_row_count;\n\n\tif (!silent) {\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, null]);\n\t} else {\n\t\tdata.push(...value);\n\t}\n}\n\nfunction _delRow(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet del_row_count = end.row - start.row + 1;\n\n\tif (view.config.rowCount === del_row_count){\n\t\tif (start.row == end.row)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.row--;\n\t\tdel_row_count--;\n\t}\n\n\tview.config.rowCount -= del_row_count;\n\n\tview.reset();\n\n\tlet deleted = [];\n\twhile (i--)\n\t\tif (data[i][0] >= start.row && data[i][0] <= end.row)\n\t\t\tdeleted.push(data.splice(i, 1)[0]);\n\t\telse if (data[i][0] > end.row)\n\t\t\tdata[i][0] -= del_row_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, deleted]);\n}","import {methods} from \"./methods\";\nimport * as rgs from \"./ranges\";\nimport * as psh from \"./placeholder\";\nimport {changeRange} from \"../helpers/column_names\";\nimport * as sheets from \"./sheet\";\nimport {_parse, clearMathCache} from \"./cache\";\n\nexport function init(view){\n\tvar triggers = [];\n\tvar backtrak = [];\n\tvar skip_math = false;\n\n\tview._mathSheetCache = {};\n\n\t//math operations object\n\tvar core = get_core(view);\n\n\t//init named ranges\n\tview.ranges = core.ranges = new rgs.Ranges(view);\n\t//init placeholders\n\tcore.p = psh.init(view);\n\n\tview.attachEvent(\"onReset\", () => {\n\t\ttriggers = [];\n\t\tbacktrak = [];\n\t\tskip_math = true;\t// will be reset in onDataParse\n\t\tview.ranges.clear();\n\t});\n\n\tview.attachEvent(\"onCellChange\", updateCell);\n\tview.attachEvent(\"onMathRefresh\", () => {\n\t\trecalckAll();\n\t\tview.$$(\"cells\").refresh();\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tview.ranges.parse(data.ranges);\n\t\tskip_math = false;\n\t\trecalckAll();\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\"){\n\t\t\tclearMathCache(true);\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t\t}\n\t});\n\n\tvar solvedMath;\n\tvar solvedCounter;\n\t//execute math handler\n\tfunction applyMath(r, c, handler){\n\t\tconst row = view.getRow(r);\n\t\tconst value = _execute(handler, core);\n\t\trow[c] = value;\n\n\t\tconst tkey = c*100000000+r;\n\t\tconst count = solvedCounter[tkey] = (solvedCounter[tkey] || 0) + 1;\n\n\t\tif (solvedMath[tkey] === value || count > 1000){\n\t\t\t//prevent infinity loops\n\t\t\t//if cell was already calculated with the same value, do not recaculate dependent cells\n\t\t\t//in some cases we have have non-stable loop, where value of math is different each time\n\t\t\t//counter limits calculation for 1000 itterations per cell\n\t\t\treturn;\n\t\t}\n\n\t\tsolvedMath[tkey] = value;\n\t\t//check if we have related cells, process their math as well\n\t\tcheck_trigger(r, c);\n\t}\n\n\t//check and run triggers\n\tfunction check_trigger(srow, scolumn){\n\t\t//triggers is a matrix[row][column]\n\t\t//store array of coordinates of related cells\n\n\t\tconst line = triggers[srow];\n\t\tif (line){\n\t\t\tconst block = line[scolumn];\n\t\t\tif (block){\n\t\t\t\tfor (var i = 0; i < block.length; i++){\n\t\t\t\t\tconst {row, column, handler} = block[i];\n\t\t\t\t\tif (row != srow || column != scolumn){\n\t\t\t\t\t\tapplyMath(row, column, handler);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction recalckAll(){\n\t\ttriggers = [];\n\t\tbacktrak = [];\n\n\t\tvar grid = view.$$(\"cells\");\n\t\tvar state = grid.getState();\n\t\tvar columns = state.ids.concat(state.hidden);\n\n\t\tgrid.eachRow(function(obj){\n\t\t\tvar item = this.getItem(obj);\n\t\t\tfor (var i=1; i<columns.length; i++){\n\t\t\t\tvar key = columns[i];\n\t\t\t\tvar value = item[\"$\"+key];\n\t\t\t\tif (value)\n\t\t\t\t\trecalckCell(obj, key, value);\n\t\t\t}\n\t\t}, true);\n\t}\n\n\tfunction updateCell(r, c){\n\t\t//cell value can be updated in types module on cell change, so use getCellValue instead of value argument\n\t\trecalckCell(r, c, view.getCellValue(r, c));\n\t}\n\n\tfunction recalckCell(r,c,value){\n\t\t// shortcut processing during data loading\n\t\tif (skip_math && value && typeof value === \"string\" && value.indexOf(\"=\") === 0){\n\t\t\tview.getRow(r)[\"$\"+c] = value;\n\t\t\treturn;\n\t\t}\n\n\t\t//check if changed cell was a math cell, based on some other cells\n\t\t//clean triggers in such case\n\t\tvar line = backtrak[r];\n\t\tif (line && line[c])\n\t\t\tremove_triggers(triggers, backtrak, c, r);\n\n\t\t//if new value is a math, calculate it and store triggers\n\t\tif (value){\n\t\t\tvalue = value.toString();\n\t\t\tif(value.length > 1 && value.indexOf(\"=\") === 0){\n\t\t\t\tvar formula = _parse(value, core, \"\");\n\t\t\t\tvar row = view.getRow(r);\n\t\t\t\trow[c] = _execute(formula.handler, core);\n\t\t\t\trow[\"$\"+c] = formula.text;\n\n\t\t\t\tif (formula.triggers.length){\n\t\t\t\t\tadd_triggers(triggers, backtrak, formula.triggers, \n\t\t\t\t\t\t{ row: r, column: c, handler: formula.handler }, view.getActiveSheet());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t//check if we have some other cells, related to the changed one\n\t\tsolvedMath = {};\n\t\tsolvedCounter = {};\n\t\tcheck_trigger(r, c);\n\t}\n\n\tsheets.init(view, core, { parse: _parse, execute: _execute });\n}\n\nexport function calculate(view, value){\n\tvar core = get_core(view);\n\tvar formula = _parse(value, core, \"\");\n\tvalue = _execute(formula.handler, core);\n\treturn value;\n}\n\n//add new triggers\nfunction add_triggers(trs, back, adds, cell, active){\n\t//trs - matrix of triggers\n\t//back - matrix of backlinks\n\t//adds - list of triggers\n\tvar blist = [];\n\tfor (var i = 0; i < adds.length; i++){\n\t\tvar line = adds[i];\n\t\t//line = [start_row, start_column, end_row, end_column, sheet]\n\n\t\t//ignore triggers from passive cells\n\t\tif (line[4] !== \"\" && line[4] !== active)\n\t\t\tcontinue;\n\n\t\tfor (var j = line[0]; j<=line[2]; j++){\n\t\t\tvar step = trs[j];\n\t\t\tif (!step) step = trs[j]=[];\n\t\t\tfor (var k = line[1]; k <= line[3]; k++){\n\t\t\t\tvar block = step[k];\n\t\t\t\tif (!block)\n\t\t\t\t\tblock = step[k] = [];\n\n\t\t\t\tblist.push([j, k]);\n\t\t\t\tblock.push(cell);\n\t\t\t}\n\t\t}\n\t}\n\n\t//store back-relations, for easy trigger removing \n\tadd_backtrack(back, cell.row, cell.column, blist);\n}\n\n//store backtrack relations as a matrix\nfunction add_backtrack(back, row, column, adds){\n\tvar line = back[row];\n\tif (!line)\n\t\tline = back[row] = [];\n\tline[column] = adds;\n}\n\n//remove unused triggers\nfunction remove_triggers(trs, back, c, r){\n\t//get list of triggers from backtrack structure\n\tvar adds = back[r][c];\n\tback[r][c] = null;\n\n\t//delete triggers\n\tfor (var i = adds.length - 1; i >= 0; i--) {\n\t\tvar cell = adds[i];\n\t\tvar block = trs[cell[0]][cell[1]];\n\n\t\tfor (var j = block.length-1; j >= 0; j--){\n\t\t\tvar bcell = block[j];\n\t\t\tif (bcell.row == r && bcell.column == c)\n\t\t\t\tblock.splice(j,1);\n\t\t}\n\t}\n}\n\n//run math function\nfunction _execute(formula, core){\n\tvar value;\n\tvar error = webix.i18n.spreadsheet.table[\"math-error\"];\n\ttry {\n\t\tvalue = formula.call(core);\t\n\t} catch(e){\n\t\t//some error in the math code\n\t\treturn error;\n\t}\n\n\tif (typeof value === \"number\"){\n\t\tif(!isFinite(value)) return error;\n\t\t//round values to fix math precision issue in JS\n\t\treturn Math.round(value*100000)/100000;\n\t} else if (typeof value !== \"string\"){\n\t\treturn value ? value.toString() : error;\n\t} else\n\t\treturn value;\n}\n\n//converts cell references to code\nfunction get_core(view){\n\tvar active = sheets.getAccessor(view);\n\n\treturn {\n\t\trs:function(sheet, r1, c1, r2, c2){\n\t\t\treturn sheets.getAccessor(view, sheet).getRange(r1,c1,r2,c2);\n\t\t},\n\t\tr:active.getRange,\n\t\tvs:function(sheet, r, c){\n\t\t\treturn sheets.getAccessor(view, sheet).getValue(r,c);\n\t\t},\n\t\tv:active.getValue,\n\t\tm:methods,\n\t\tp:{},\n\t\te:function(e){throw e;}\n\t};\n}\n\nfunction _serialize(view, obj){\n\tobj.ranges = view.ranges.serialize();\n}\n\nfunction updatePosition(name, inc, data, start){\n\tvar ranges = data.ranges;\n\tfor(let i=0; i < ranges.length; i++)\n\t\tranges[i][1] = changeRange(ranges[i][1],name,inc, start);\n}","export function init(view){\n\tvar holders = {};\n\n\tview.setPlaceholder = function(obj, value){\n\t\tif (typeof obj === \"object\")\n\t\t\tfor (var key in obj)\n\t\t\t\tholders[key.toLowerCase()] = obj[key];\n\t\telse\n\t\t\tholders[obj.toString().toLowerCase()] = value;\n\n\t\tview.callEvent(\"onMathRefresh\",[]);\n\t};\n\n\treturn holders;\n}","import group from \"./undo_group\";\nimport {calculate} from \"../math/math\";\nimport {eachRange} from \"../helpers/column_names\";\nimport {setSpanCss} from \"./spans\";\n\nexport function init(view){\n\tview.conditions = {\n\t\t_empty:true,\n\t\t_pull: {},\n\t\thandlers: {\n\t\t\t\">\": function(a,b){\n\t\t\t\treturn a > getCellValue(view, b);\n\t\t\t},\n\t\t\t\"<\": function(a,b){\n\t\t\t\treturn a < getCellValue(view, b);\n\t\t\t},\n\t\t\t\"=\": function(a,b){\n\t\t\t\treturn a == getCellValue(view, b);\n\t\t\t},\n\t\t\t\"!=\": function(a,b){\n\t\t\t\treturn a != getCellValue(view, b);\n\t\t\t},\n\t\t\t\"<>\": function(a,b){\n\t\t\t\treturn webix.isArray(b) && a < getCellValue(view, b[1]) && a > getCellValue(view, b[0]);\n\t\t\t}\n\t\t},\n\t\tadd: add,\n\t\tremove: remove,\n\t\tupdate: update,\n\t\tget: get,\n\t\tparse: parse,\n\t\tserialize: serialize,\n\t\tclear: clear\n\t};\n\n\tview.attachEvent(\"onConditionSet\", (data) => _setCondition(view, data));\n\n\tview.attachEvent(\"onUndo\", (type_action, row, column, value) => {\n\t\tif(type_action == \"condition\")\n\t\t\t_undoCondition(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\n\tview.attachEvent(\"onColumnInit\", (column) => _setCssFormat(view, column));\n\n\tview.attachEvent(\"onReset\", () => view.conditions.clear() );\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n\n\treset(view);\n}\n\nfunction getCellValue(view, value){\n\tif(isNaN(value*1)){\n\t\tif (value.charAt(0) == \"=\"){\n\t\t\tvalue = calculate(view, value);\n\t\t}\n\t}\n\telse {\n\t\tvalue = value*1;\n\t}\n\treturn value;\n}\n\nfunction reset(view){\n\tview.conditions.clear();\n}\n\nfunction _setCondition(view, data){\n\tgroup.set(function(){\n\t\tview.eachSelectedCell((cell) => {\n\t\t\tconst collection = view.conditions.get(cell.row, cell.column);\n\t\t\tif(collection)\n\t\t\t\tfor (let i = 0; i < collection.length; i++)\n\t\t\t\t\tsetSpanCss(view, cell.row, cell.column, collection[i][2], false);\n\t\t\t_changeCondition(\"update\", cell.row, cell.column, (collection||null), data, view);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _undoCondition(view, row, column, value){\n\tif(view.conditions.get(row, column))\n\t\tview.conditions.remove(row, column);\n\tif(value)\n\t\tview.conditions.update(row, column, value);\n}\n\nfunction _serialize(view, obj){\n\tobj.conditions = view.conditions.serialize();\n}\n\nfunction _parse(view, obj){\n\tview.conditions.parse(obj.conditions);\n}\n\nfunction _setCssFormat(view,column){\n\tcolumn.cssFormat = function (value, obj, row, column){\n\t\treturn getConditionCss(view, row, column);\n\t};\n}\n\nexport function getConditionCss(view, row, column){\n\tlet css = \"\";\n\n\tif (!view.conditions._empty){\n\t\tconst collection = view.conditions.get(row, column);\n\t\tif(collection){\n\t\t\tconst span = view.$$(\"cells\").getSpan(row, column);\n\t\t\tlet value = view.getRow(row)[column];\n\t\t\tif(!value && value !== 0)\n\t\t\t\tvalue = \"\";\n\n\t\t\tfor (let i = collection.length - 1; i >= 0; i--){\n\t\t\t\tconst handler = view.conditions.handlers[collection[i][0]];\n\n\t\t\t\tif(!css && handler && handler(value, collection[i][1])){\n\t\t\t\t\tcss = collection[i][2];\n\t\t\t\t\tif(!span)\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tsetSpanCss(view, row, column, collection[i][2], true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tsetSpanCss(view, row, column, collection[i][2], false);\n\t\t\t}\n\t\t}\n\t}\n\treturn css;\n}\n\n\nfunction addEmptyCollection(pull, row, column, state){\n\tstate._empty = false;\n\tif(!pull[row])\n\t\tpull[row] = {};\n\tif(!pull[row][column])\n\t\tpull[row][column] = [];\n\treturn pull[row][column];\n}\n\n\nfunction parse(data){\n\tthis._empty = true;\n\tif (!data) return;\n\n\tlet i = data.length;\n\twhile(i--){\n\t\tvar c = data[i];\n\t\tvar collection = addEmptyCollection(this._pull,c[0],c[1],this);\n\t\tcollection.push([c[2],c[3],c[4]]);\n\t}\n}\n\nfunction clear(){\n\tthis._pull = {};\n}\n\nfunction update(row, column, newData){\n\tvar collection = this.get(row, column);\n\tif(!collection)\n\t\taddEmptyCollection(this._pull, row, column, this);\n\tthis._pull[row][column] = newData;\n}\n\nfunction get(rowId, columnId){\n\tif(!rowId)\n\t\treturn this._pull;\n\tif(!columnId)\n\t\treturn this._pull[rowId];\n\treturn this._pull[rowId]?this._pull[rowId][columnId]:null;\n}\n\nfunction add(rowId, columnId, condition, value, style){\n\tvar collection = addEmptyCollection(this._pull, rowId, columnId, this);\n\tcollection.push([condition, value, style]);\n}\n\nfunction remove(rowId, columnId){\n\tvar collection = this.get(rowId, columnId);\n\tif(collection)\n\t\tdelete this._pull[rowId][columnId];\n}\n\nfunction serialize(){\n\tvar column, condition, i, row,\n\t\tdata = [];\n\n\tfor( row in this._pull)\n\t\tfor( column in this._pull[row])\n\t\t\tfor(i=0; i < this._pull[row][column].length; i++){\n\t\t\t\tcondition = this._pull[row][column][i];\n\t\t\t\tdata.push([row,column, condition[0],condition[1],condition[2]]);\n\t\t\t}\n\n\treturn data;\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet conditions = data.conditions,\n\t\ti = conditions.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = conditions[i];\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tconditions.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tconditions[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tconditions.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tconditions[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function clearConditionalFormats(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tvar condition = view.conditions.get(cell.row, cell.column);\n\t\t\tif(condition)\n\t\t\t\t_changeCondition(\"remove\", cell.row, cell.column, condition, null, view);\t\t\t\t\n\t\t});\n\t\tview.refresh();\n\t});\n}\n\nexport function pasteCondition(view, extra, row, col, cutted){\n\tvar condition = extra.condition;\n\tvar collection = view.conditions.get(row,col);\n\t_changeCondition(\"update\", row, col, (collection||null), condition, view);\n\tif(cutted === 1)\n\t\t_changeCondition(\"remove\", extra.row, extra.col, condition, null, view);\t\n\t\t\t\n}\n\nexport function _changeCondition(name, row, column, oldCondition, newCondition, view){\n\tif (view.callEvent(\"onBeforeConditionSet\", [row, column, oldCondition, newCondition])){\n\t\tview.conditions[name].apply(view.conditions, [row, column, newCondition]);\n\t\tview.callEvent(\"onAfterConditionSet\", [row, column, oldCondition, newCondition]);\n\t}\n}\n","import group from \"./undo_group\";\nimport {setSpanCss} from \"./spans\";\nimport {rangeOptions} from \"../math/ranges\";\nimport * as fmt from \"../operations/formats\";\nimport {changeRange, eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tconst table = view._table;\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\treset(view);\n\n\ttable.attachEvent(\"onBeforeEditStart\", function(id){\n\t\tlet col = this.getColumnConfig(id.column);\n\t\tif (this._ssEditors[id.row]){\n\t\t\tlet ed = this._ssEditors[id.row][id.column];\n\t\t\tif (ed){\n\t\t\t\twebix.extend(col, ed, true);\n\t\t\t\twebix.extend(col, {row: view.getRow(id.row)}, true);\n\t\t\t\tif (ed.options){\n\t\t\t\t\tif (typeof ed.options == \"string\")\n\t\t\t\t\t\tcol.options = rangeOptions(view, ed.options, { unique:true, order:true, empty:true });\n\t\t\t\t\telse if (webix.isArray(ed.options))\n\t\t\t\t\t\tcol.options = rangeOptions(view, ed.options, { empty:true });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// update format if editor supports this feature\n\ttable.attachEvent(\"onBeforeEditStop\", function(state, editor, ignore){\n\t\tif (!ignore && editor.getFormat){\n\t\t\tconst value = editor.getValue();\n\t\t\tlet format = editor.getFormat(value);\n\n\t\t\tgroup.set(function(){\n\t\t\t\tview.setCellValue(editor.row, editor.column, value);\n\t\t\t\tif (format){\n\t\t\t\t\tfmt.addFormat(view, editor.row, editor.column, fmt.getFormatSource(format));\n\t\t\t\t} else\n\t\t\t\t\tfmt.removeFormat(view, editor.row, editor.column);\n\t\t\t});\n\n\t\t\tconst cell = view.getSelectedId();\n\t\t\tif (cell && cell.row == editor.row && cell.column == editor.column){\n\t\t\t\tformat = format || \"common\";\n\t\t\t\tformat = fmt.isCustom(format) ? \"custom\" : format;\n\t\t\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"format\", value:format}]);\n\t\t\t}\n\t\t}\n\t});\n\n\ttable.attachEvent(\"onAfterEditStop\", function(state, editor){\n\t\tconst col = this.getColumnConfig(editor.column);\n\n\t\tcol.editor = \"text\";\n\t\tdelete col.popup; delete col.$popup; delete col.row;\n\t});\n\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type == \"dropdown\")\n\t\t\tview.setCellEditor(row, column, value);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif (action == \"dropdown\"){\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_editor\", p.newValue);\n\t\t}\n\t\telse if (action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._table._ssEditors = {};\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\ttblEditors = view._table._ssEditors,\n\t\teditors = [];\n\n\tfor (row in tblEditors){\n\t\tfor (column in tblEditors[row])\n\t\t\teditors.push([row, column, tblEditors[row][column]]);\n\t}\n\tdata.editors = editors;\n}\n\nexport function load(view,data){\n\tconst editors = data.editors;\n\n\tif (editors)\n\t\tfor (let i=0; i<editors.length; i++)\n\t\t\tview.setCellEditor.apply(view, editors[i]);\n}\n\nexport function clearEditors(view, range){\n\tview._table.editStop();\n\teachRange(range, view, function(view, cell){\n\t\tlet editor = view._table._ssEditors[cell.row];\n\t\tif (editor){\n\t\t\tif (editor[cell.column]){\n\t\t\t\tdelete editor[cell.column];\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_editor\");\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_editor\", false);\n\t\t\t}\n\t\t}\n\t});\n}\n\nexport function isEditor(view, row, column){\n\tconst editor = view._table._ssEditors;\n\treturn editor[row] && !!editor[row][column];\n}\n\n// called on column/row add, delete, hide,show\nfunction updatePosition(name, inc, data, start){\n\tconst editors = data.editors;\n\n\tif (inc){\n\t\t// create new editors\n\t\tfor(let i=editors.length-1; i>=0; i--){\n\t\t\tlet [row,column,editor] = editors[i];\n\t\t\tif (name == \"row\" && row >= start.row || name == \"column\" && column >= start.column){\n\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc){\t//delete editor mark if row was deleted\n\t\t\t\t\t\teditors.splice(i,1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\teditors[i][0] = row*1 + inc;\n\t\t\t\t}\n\t\t\t\telse if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\teditors.splice(i, 1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else \n\t\t\t\t\t\teditors[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t\teditor.options = changeRange(editor.options, name, inc, start);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function pasteDropdown(view, extra, row, col, cutted){\n\tconst editor = extra.dropdown;\n\n\tview.setCellEditor(row, col, editor);\n\tif (cutted === 1)\n\t\tview.setCellEditor(extra.row, extra.col, {});\n}","import group from \"./undo_group\";\nimport {updateMath} from \"../math/updater\";\nimport {pasteCondition} from \"../operations/conditional_formats\";\nimport {pasteDropdown} from \"../operations/dropdown\";\nimport {pasteFilter} from \"../operations/filter\";\nimport {pasteSpan} from \"../operations/spans\";\n\nvar styledata, clipdata, origin, cutted, updateFilters;\n\nexport function init(view){\n\tconst keyC = 67; //keyboard 'c' code\n\tconst keyX = 88; //keyboard 'x' code\n\tvar grid = view.$$(\"cells\");\n\t\n\tgrid.attachEvent(\"onKeyPress\", (code, e) => {\n\t\tif((code === keyC || code === keyX) && (e.ctrlKey || e.metaKey) && grid.getSelectedId()){\n\t\t\tstyledata = _get_sel_style(view, grid);\n\t\t\tclipdata = document.getElementsByClassName(\"webix_clipbuffer\")[0].value;\n\t\t\torigin = grid.getSelectArea();\n\t\t\tcutted = (code === keyX)*1;\n\t\t\tif(cutted && Object.keys(view._table._ssFilters).length !== 0)\n\t\t\t\tupdateFilters = allFiltersInZone(view._table._ssFilters, origin, view.config.columnCount);\n\t\t}\n\t});\n\n\tif (!view.config.readonly) {\n\t\tgrid.attachEvent(\"onPaste\", (text) => {\n\t\t\t_clip_to_sel(view, grid, text);\n\t\t});\n\t}\n}\n\nfunction _clip_to_sel(view, grid, text){\n\tvar leftTop = grid.getSelectArea();\n\tif (!leftTop) return;\n\tvar start = leftTop.start;\n\tvar fromSheet = text === clipdata;\n\n\tvar data = fromSheet ? styledata : webix.csv.parse(text, grid.config.delimiter);\n\tif(!fromSheet && view.config.clipboardDecimalDelimiter)\n\t\tdata = _changeDelimiter(data, view.config.clipboardDecimalDelimiter);\n\n\tvar translate = { id:\"move\", column:0, row: 0, cut:cutted };\n\tif (fromSheet){\n\t\ttranslate.column = start.column - origin.start.column;\n\t\ttranslate.row = start.row - origin.start.row;\n\t} else {\n\t\tcutted = 0;\n\t}\n\n\tgroup.set(function(){\n\t\tif (updateFilters)\n\t\t\tview.removeFilters();\n\n\t\t_add_row_col(view, start, data);\n\n\t\tif (cutted === 1) {\n\t\t\tfor (let row = origin.start.row; row <= origin.end.row; row++) {\n\t\t\t\tfor (let column = origin.start.column; column <= origin.end.column; column++) {\n\t\t\t\t\tview.setCellValue(row, column, null);\n\t\t\t\t\tview.setStyle(row, column, null);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (data.length == 1 && data[0].length == 1 && !updateFilters) {\n\t\t\tview.eachSelectedCell(function(cell) {\n\t\t\t\tvar subtrans = {\n\t\t\t\t\tid: \"move\",\n\t\t\t\t\tcolumn: translate.column + cell.column * 1 - start.column,\n\t\t\t\t\trow: translate.row + cell.row * 1 - start.row,\n\t\t\t\t\tcut:cutted\n\t\t\t\t};\n\t\t\t\t_clipboardToTable(view, cell.row, cell.column, data[0][0], fromSheet, subtrans);\n\t\t\t});\n\t\t} else {\n\t\t\tgrid.mapCells(\n\t\t\t\tstart.row,\n\t\t\t\tstart.column,\n\t\t\t\tdata.length,\n\t\t\t\tnull,\n\t\t\t\tfunction(value, row, col, row_ind, col_ind) {\n\t\t\t\t\tif (data[row_ind] && data[row_ind].length > col_ind) {\n\t\t\t\t\t\tvar cdata = data[row_ind][col_ind];\n\t\t\t\t\t\t_clipboardToTable(view, row, col, cdata, fromSheet, translate);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\n\t\tif (cutted === 1){\n\t\t\t//cut and cleared\n\t\t\tcutted = 2;\n\t\t\tupdateFilters = false;\n\t\t}\n\t});\n\t\n\tview.refresh();\n}\n\nfunction _clipboardToTable(view, row, col, cdata, fromSheet, translate){\n\tvar newValue = cdata;\n\n\tif (typeof cdata === \"object\"){\n\t\tif (cdata.math)\n\t\t\tnewValue = updateMath(cdata.math, translate, origin);\n\t\telse \n\t\t\tnewValue = cdata.text;\n\n\t\tif(cdata.style && cdata.style.props){\n\t\t\tconst style = view.addStyle(cdata.style.props);\n\t\t\tview.setStyle(row, col, style);\n\t\t}\n\n\t\tvar extra = cdata.extra;\n\t\tif(extra){\n\t\t\tif(extra.condition)\n\t\t\t\tpasteCondition(view, extra, row, col, cutted);\n\t\t\tif(extra.dropdown)\n\t\t\t\tpasteDropdown(view, extra, row, col, cutted, translate);\n\t\t\tif(extra.filter && updateFilters)\n\t\t\t\tpasteFilter(view, extra, row, col, cutted, translate);\n\t\t}\n\t\tpasteSpan(view, extra, row, col, cutted, translate);\n\t}\n\n\tview.setCellValue(row, col, newValue);\n}\n\nfunction _get_sel_style(view, grid){\n\tvar data = [];\n\tvar row, last;\n\n\tgrid.mapSelection(function(value, id, col) {\n\t\tif (id != last){\n\t\t\trow = []; data.push(row);\n\t\t\tlast = id;\n\t\t}\n\n\t\tvar item = grid.getItem(id);\n\t\tvar math = item[\"$\"+col];\n\t\tvar obj = { text:value, math:math, style:view.getStyle(id, col) };\n\n\t\tvar condition = view.conditions.get(id,col);\n\t\tvar editor = view.getCellEditor(id, col);\n\t\tvar filter = view.getCellFilter(id, col);\n\t\tvar span = view._table.getSpan(id, col);\n\n\t\tif (editor || filter || condition || span){\n\t\t\tvar extra = { row:id, col:col };\n\t\t\tif (condition) extra.condition = condition;\n\t\t\tif (editor) extra.dropdown = editor;\n\t\t\tif (filter) extra.filter = filter;\n\t\t\tif (span) extra.span = span;\n\t\t\tobj.extra = extra;\n\t\t}\n\t\t\n\t\trow.push(obj);\n\t\treturn value;\n\t});\n\n\treturn data;\n}\n\nfunction allFiltersInZone(extra, origin, columnCount){\n\tvar filters = Object.keys(extra);\n\tvar startRow = Math.min.apply(null, filters);\n\tvar endRow = Math.max.apply(null, filters);\n\tvar startCol = columnCount;\n\tvar endCol = 1;\n\n\tfor (var i = startRow; i <= endRow; i++){\n\t\tif(extra[i]){\n\t\t\tvar columns = Object.keys(extra[i]);\n\t\t\tstartCol = Math.min(startCol, Math.min.apply(null, columns));\n\t\t\tendCol = Math.max(endCol, Math.max.apply(null, columns));\n\t\t}\n\t}\n\n\tif(origin.start.row <= startRow && origin.end.row >= endRow && origin.start.column <= startCol && origin.end.column >= endCol)\n\t\treturn true;\n\telse\n\t\treturn false;\n}\n//dynamically increase rows and columns according to pasted data size\nfunction _add_row_col(view, start, data){\n\tvar maxRow = start.row + data.length - 1;\n\tvar maxCol = start.column + data[0].length - 1;\n\n\tif(maxRow > view.config.rowCount || maxCol > view.config.columnCount){\n\t\tvar action = { id:\"add\" };\n\t\tif (maxRow > view.config.rowCount) {\n\t\t\taction.group = \"row\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ row: view.config.rowCount + 1 }, \n\t\t\t\t{ row: maxRow }\n\t\t\t]);\n\t\t}\n\t\tif (maxCol > view.config.columnCount) {\n\t\t\taction.group = \"column\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ column: view.config.columnCount + 1 },\n\t\t\t\t{ column: maxCol }\n\t\t\t]);\n\t\t}\n\t}\n}\n\nfunction _changeDelimiter(data, clipboardDecimalDelimiter){\n\tfor(var i = 0; i < data.length; i++)\n\t\tfor(var k = 0; k < data[i].length; k++){\n\t\t\tvar record = data[i][k].toString().replace(clipboardDecimalDelimiter, \".\");\n\t\t\tif(webix.rules.isNumber(record))\n\t\t\t\tdata[i][k] = record;\n\t\t}\n\treturn data;\n}","import {getType} from \"./types\";\n\nexport function init(view){\n\t//parsing initial data\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => _serialize(view, data, config));\n\n\t// undo\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif(type == \"value\")\n\t\t\t_undoValue(view, row, column, value);\n\t});\n}\n\nfunction _serialize(view, obj, config){\n\tvar math = !config || config.math!==false;\n\tvar data = [];\n\tvar grid = view.$$(\"cells\");\n\tvar state = grid.getState();\n\tvar columns = state.ids.concat(state.hidden);\n\n\t// remove \"rowId\" column\n\tcolumns.splice(columns.indexOf(\"rowId\"), 1);\n\n\tgrid.eachRow(function(row){\n\t\tconst item = this.getItem(row);\n\t\tfor (var i=0; i<columns.length; i++){\n\t\t\tconst key = columns[i];\n\t\t\tlet value = item[key];\n\t\t\tconst css = item.$cellCss ? (item.$cellCss[key] || \"\") : \"\";\n\n\t\t\t//serialize instead of value if defined\n\t\t\tif (math && item[\"$\"+key])\n\t\t\t\tvalue = item[\"$\"+key];\n\n\t\t\t//put not empty values in serialization\n\t\t\tconst hasValue = value || value === 0;\n\t\t\tif (hasValue || css) {\n\t\t\t\tconst type = getType(view, row, key);\n\t\t\t\tdata.push([row*1, key*1, (hasValue ? value : \"\"), css, type]);\n\t\t\t}\n\t\t}\n\t}, true);\n\n\tobj.table = {\n\t\tfrozenColumns : (view._frozenColumns || 0),\n\t\tfrozenRows : (view._frozenRows || 0)\n\t};\n\n\tobj.data = data;\n}\n\nfunction _parse(view, obj){\n\tvar grid = view.$$(\"cells\");\n\n\tvar tconfig = obj.table || { frozenColumns : 0, frozenRows : 0 };\n\tview._frozenColumns = view._frozenRows = 0;\n\tif (tconfig){\n\t\tif (!webix.isUndefined(tconfig.frozenColumns))\n\t\t\tview.freezeColumns(tconfig.frozenColumns);\n\t\tif (!webix.isUndefined(tconfig.frozenRows))\n\t\t\tview.freezeRows(tconfig.frozenRows);\n\t}\n\n\tif(obj.sizes)\n\t\tgrid.define(\"fixedRowHeight\", false);\n\n\tfor (var i = 0; i < obj.data.length; i++){\n\t\tvar [ row, column, value, , type ] = obj.data[i];\n\n\t\tif(typeof value == \"string\")\n\t\t\tvalue = value.replace(/^=link\\(/i, \"=HYPERLINK(\"); // LINK is deprecated\n\n\t\tvar item = grid.getItem(row);\n\t\titem[column] = value;\n\n\t\t//cell value can be updated via types module\n\t\tview.ignoreUndo(()=>{\n\t\t\tview.callEvent(\"onCellChange\", [row, column, value, type]);\n\t\t});\n\t}\n}\n\nfunction _undoValue(view, row, column, value){\n\tview.setCellValue(row, column, value);\n}","export function init(view) {\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tif (action.id == \"show\" || action.id == \"hide\"){\n\t\t\tconst sel = view._table.getSelectArea();\n\t\t\tif (sel)\n\t\t\t\tprocess(action, webix.copy(sel.start), webix.copy(sel.end), view);\n\t\t}\n\t});\n\treset(view);\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value, direction) => {\n\t\tif ((action.id == \"hide\" || action.id == \"show\") && (action.group == \"column\" || action.group == \"row\")){\n\t\t\tlet type = action.id;\n\t\t\tif (!direction)\n\t\t\t\ttype = type == \"hide\" ? \"show\" : \"hide\";\n\t\t\tconst obj = (row || column);\n\t\t\tprocess({ id: type, group: action.group }, obj.start, obj.end, view, true);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\t_updatePosition(view, p.name,p.inc,p.data, p.start);\n\t});\n}\n\nexport function reset(view, mode) {\n\tif(mode) view[\"_hidden_\"+mode+\"_hash\"] = {};\n\telse{\n\t\tview._hidden_cols_hash = {};\n\t\tview._hidden_rows_hash = {};\n\t\tview.filterSpreadSheet();\n\t}\n}\n\nfunction getIds(id){\n\treturn webix.isArray(id) ? id : [id, id];\n}\n\nexport function isColumnVisible(view, column){\n\treturn !view._hidden_cols_hash[column];\n}\n\nexport function setState(view, indexes, state, type){\n\t// hide\n\tif(!indexes){\n\t\tconst sel = view.getSelectedId(true);\n\t\tconst action = {\n\t\t\tid: state === false ? \"show\" : \"hide\",\n\t\t\tgroup: type\n\t\t};\n\n\t\tif(sel.length)\n\t\t\tview.callEvent(\"onCommand\", [action, sel[0], sel[sel.length-1]]);\n\t}\n\telse {\n\t\tconst ids = getIds(indexes);\n\t\tconst hidden = type == \"row\" ? view._hidden_rows_hash : view._hidden_cols_hash;\n\n\t\tif (!hidden[ids[0]] && (webix.isUndefined(state) || state)){\n\t\t\t(type == \"row\" ? _hideRow : _hideColumn)({id: \"hide\", group: type}, {[type]: ids[0]}, {[type]: ids[1]}, view);\n\t\t}\n\t\t// show\n\t\telse if (hidden[ids[0]] && (webix.isUndefined(state) || !state)) {\n\t\t\tconst inc = ids[0] > 1 ? 1 : -1;\n\t\t\t(type == \"row\" ? _showRow : _showColumn)({id: \"hide\", group: type}, {[type]: ids[0] + inc}, {[type]: ids[1] + inc}, view);\n\t\t}\n\t}\n}\n\nexport function isRowVisible(view, row){\n\treturn !view._hidden_rows_hash[row];\n}\n\nexport function serialize(view, data){\n\tlet hrows  = []; let hcols = [];\n\tfor(let r in view._hidden_rows_hash) hrows.push(r);\n\tfor(let c in view._hidden_cols_hash) hcols.push(c);\n\n\tif(hrows.length || hcols.length)\t\n\t\tdata.table.hidden = {};\n\tif(hrows.length)\n\t\tdata.table.hidden.row = hrows;\n\tif(hcols.length)\n\t\tdata.table.hidden.column = hcols;\n}\n\nexport function load(view, data){\n\treset(view);\n\t\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.hidden)){\n\t\tconst hidden = data.table.hidden;\n\n\t\tif(hidden.row && hidden.row.length){\n\t\t\tfor(let r = 0; r < hidden.row.length; r++)\n\t\t\t\t_hideRow({id:\"hide\", group:\"row\"}, {row:hidden.row[r]}, {row:hidden.row[r]}, view, true);\n\t\t}\n\n\t\tif(hidden.column && hidden.column.length){\n\t\t\tfor(let c = 0; c < hidden.column.length; c++)\n\t\t\t\t_hideColumn({id:\"hide\", group:\"column\"}, {column:hidden.column[c]}, {column:hidden.column[c]}, view, true);\n\t\t}\n\t}\n}\n\nfunction process(action) {\n\tif (action.group == \"column\"){\n\t\tif (action.id == \"show\")\n\t\t\t_showColumn.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideColumn.apply(this, arguments);\n\t} else if (action.group == \"row\") {\n\t\tif (action.id == \"show\")\n\t\t\t_showRow.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideRow.apply(this, arguments);\n\t}\n}\n\nfunction _showColumn(action, start, end, view, silent) {\n\tlet i = end.column;\n\tconst grid = view.$$(\"cells\");\n\n\twhile (i >= start.column) {\n\t\tlet id = i;\n\t\tif (!silent)\n\t\t\tid = view._hidden_cols_hash[i*1-1] || view._hidden_cols_hash[i*1+1] || false;\n\n\t\tif (id !== false) {\n\t\t\tdelete view._hidden_cols_hash[id];\n\t\t\tlet cell = grid.getColumnConfig(id - 1 || \"rowId\").header[0];\n\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_column\", \"\");\n\t\t\tgrid.showColumn(id);\n\t\t\tstart.column = start.column < id ? start.column : id;\n\t\t\tend.column = end.column > id ? end.column : id;\n\n\t\t\tif (!silent)\n\t\t\t\tview.callEvent(\"onColumnOperation\", [action, { column: id }, { column:id }, null]);\n\t\t}\n\t\ti--;\n\t}\n\n\tconst split = view._frozenColumns;\n\tif(split && split >= start.column && split <= end.column){\n\t\tview.freezeColumns(0); // remove freeze (split is equal with current frozen col)\n\t\tview.freezeColumns(split); // if col was freezed on hidden column - move it\n\t}\n}\n\nfunction _showRow(action, start, end, view, silent) {\n\tlet i = end.row;\n\tconst grid = view.$$(\"cells\");\n\n\tconst split = view._frozenRows;\n\tif(split){\n\t\t//Frozen rows ignore filtering applied to the datatable\n\t\tview.freezeRows(0);\n\t}\n\n\twhile (i >= start.row) {\n\t\tlet id = i;\n\t\tif (!silent)\n\t\t\tid = view._hidden_rows_hash[i*1-1] || view._hidden_rows_hash[i*1+1] || false;\n\n\t\tif (id !== false) {\n\t\t\tdelete view._hidden_rows_hash[id];\n\t\t\tif (id - 1 === 0) {\n\t\t\t\tlet cell = grid.getColumnConfig(\"rowId\").header[0];\n\t\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_row\", \"\");\n\t\t\t\tgrid.refreshColumns();\n\t\t\t} else {\n\t\t\t\tgrid.removeCellCss(id - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\t\t\t}\n\t\t\tif (!silent)\n\t\t\t\tview.callEvent(\"onRowOperation\", [action, { row: id }, { row: id }, null]);\n\t\t}\n\t\ti--;\n\t}\n\n\tview.filterSpreadSheet();\n\n\tif(split)\n\t\tview.freezeRows(split);\n}\n\nfunction _hideColumn(action, start, end, view, silent) {\n\tconst grid = view.$$(\"cells\");\n\tlet i = end.column;\n\tview.$handleSelection = null;\n\tgrid.unselect();\n\n\tif (end.column<1 || start.column<1){\n\t\tdelete view._hidden_cols_hash[start.column];\n\t\treturn;\n\t}\n\twhile (i >= start.column) {\n\t\tif(grid.getColumnIndex(i) != -1){\n\t\t\tview._hidden_cols_hash[i] = i;\n\n\t\t\tlet cell = grid.getColumnConfig(i - 1 || \"rowId\").header[0];\n\t\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_column\";\n\n\t\t\tgrid.hideColumn(i);\n\t\t}\n\t\ti--;\n\t}\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, null]);\n}\n\nfunction _hideRow(action, start, end, view, silent) {\n\tif (end.row<1 || start.row<1){\n\t\tdelete view._hidden_rows_hash[start.row];\n\t\treturn;\n\t}\n\n\tconst split = view._frozenRows;\n\tif(split){\n\t\t//Frozen rows ignore filtering applied to the datatable\n\t\tview.freezeRows(0);\n\t}\n\n\tconst grid = view.$$(\"cells\");\n\tlet i = end.row;\n\n\twhile (i >= start.row) {\n\t\tview._hidden_rows_hash[i] = i;\n\n\t\tif (i - 1 === 0) {\n\t\t\tlet cell = grid.getColumnConfig(\"rowId\").header[0];\n\t\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_row\";\n\t\t\tgrid.refreshColumns();\n\t\t}\n\t\telse\n\t\t\tgrid.addCellCss(i - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\n\t\ti--;\n\t}\n\n\tview.filterSpreadSheet();\n\n\tif(split)\n\t\tview.freezeRows(split);\n\n\tif (!silent)\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, null]);\n}\n\nfunction _updatePosition(view, name, inc, data, start){\n\tif(data.table && data.table.hidden && data.table.hidden[name] && data.table.hidden[name].length){\n\t\tif(name ===\"column\") reset(view, \"cols\");\n\t\tif(name === \"row\") reset(view, \"rows\");\n\n\t\tlet s = start[name], e = s + inc;\n\t\tif(s > e) [s, e] = [e, s];\n\n\t\tfor(let i = s; i < e; i++){\n\t\t\tfor(let h = 0; h < data.table.hidden[name].length; h++){\n\t\t\t\tif(data.table.hidden[name][h] >= i)\n\t\t\t\t\tdata.table.hidden[name][h] = data.table.hidden[name][h]*1+(inc>0 ? 1: -1);\n\t\t\t}\n\t\t}\n\t}\n}","import {getStyle, getTextSize} from \"./styles\";\nimport {save} from \"./save\";\n\nexport function init(view){\n\n\tif (view.config.resizeCell){\n\t\tvar grid = view.$$(\"cells\");\n\t\tgrid.define(\"resizeRow\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"resizeColumn\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"fixedRowHeight\", false);\n\n\t\tgrid.attachEvent(\"onRowResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: id, column: 0, size: view.getRow(id).$height });\n\t\t});\n\t\tgrid.attachEvent(\"onColumnResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: 0, column: id, size: view.getColumn(id).width });\n\t\t});\n\n\t\t// undo\n\t\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\t\tif(type == \"c-resize\" || type == \"r-resize\")\n\t\t\t\t_undoResize(view, row, column, value);\n\t\t});\n\t}\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tif (data.sizes){\n\t\t\tfor (var i=0; i<data.sizes.length; i++){\n\t\t\t\tvar size = data.sizes[i];\n\t\t\t\tif (size[0]*1 !== 0){\n\t\t\t\t\tvar row = view.getRow(size[0]);\n\t\t\t\t\tif(row) row.$height = size[2]*1;\n\t\t\t\t} else {\n\t\t\t\t\tvar col = view.getColumn(size[1]);\n\t\t\t\t\tif(col) col.width = size[2]*1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (data.sizes.length)\n\t\t\t\tview.refresh(true);\n\t\t}\n\t});\n\n\t\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tvar sizes = [];\n\t\tvar grid = view.$$(\"cells\");\n\t\tvar columns = grid.getState().order;\n\t\tvar order = grid.data.order;\n\n\t\tvar defWidth = grid.config.columnWidth;\n\t\tvar defHeight = grid.config.rowHeight;\n\n\t\tfor (let i = 1; i < columns.length; i++){\n\t\t\tvar width = grid.getColumnConfig(columns[i]).width;\n\t\t\tif (width && width != defWidth)\n\t\t\t\tsizes.push([0, i, width]);\n\t\t}\n\n\t\tfor (let i = 0; i < order.length; i++){\n\t\t\tvar height = grid.getItem(order[i]).$height;\n\t\t\tif (height && height != defHeight)\n\t\t\t\tsizes.push([order[i]*1, 0, height]);\n\t\t}\n\t\t\n\t\tdata.sizes = sizes;\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n\n\tview.attachEvent(\"onBeforeStyleChange\", function(row, column, n, o){\n\t\tif (o && o.props.wrap === \"wrap\" && (!n || n.props.wrap != o.props.wrap)){\n\t\t\tdelete view._table.getItem(row).$height;\n\t\t}\n\t});\n\tview.attachEvent(\"onStyleChange\", _adjustRowHeight);\n\tview.attachEvent(\"onCellChange\",  _adjustRowHeight);\n}\n\nfunction _undoResize(view, row, column, value){\n\tif(row){\n\t\tview.$$(\"cells\").getItem(row).$height = value;\n\t\tsave(view, \"sizes\", { row:row, column: 0, size: value });\n\t}\n\telse{\n\t\tview._table.setColumnWidth(column, value);\n\t}\n\t// update area selection\n\tview._table.refreshSelectArea();\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet i,\n\t\tsizes = data.sizes,\n\t\tnsizes = [];\n\n\tif(inc){\n\t\tfor(i = sizes.length-1;i >=0;i--){\n\t\t\tlet [row,column,size] = sizes[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\t//moving row|column index\n\t\t\t\trow =  name == \"row\"?row*1 + inc:row;\n\t\t\t\tcolumn = name == \"column\"?column*1 + inc:column;\n\t\t\t\tif((name == \"row\" && row>0) || (name == \"column\" && column >0))\n\t\t\t\t\tnsizes.push([row, column, size]);\n\t\t\t} else //row, column not affected by resize\n\t\t\t\tnsizes.push(sizes[i]);\n\t\t}\n\t\tdata.sizes = nsizes;\n\t}\n}\n\nfunction _adjustRowHeight(row, column){\n\tconst view = this;\n\tlet style = getStyle(view, {row:row, column:column});\n\n\t//changing styles or content of wrapped cell -> resize the related row\n\tif (style && style.props.wrap){\n\t\tlet item = view._table.getItem(row);\n\t\tlet height = item.$height || view._table.config.rowHeight;\n\n\t\tview._table.eachColumn(function(col, config){\n\t\t\tlet style = getStyle(view, {row:row, column:col});\n\t\t\t//include only cells with active wrap into calculation \n\t\t\tif(style && style.props && style.props.wrap === \"wrap\"){\n\t\t\t\tlet text = this.getText(row, col);\n\t\t\t\tlet baseWidth = config.width;\n\n\t\t\t\tconst span = view._table.getSpan(row, col);\n\t\t\t\tif(span)\n\t\t\t\t\tbaseWidth = view._table.getSpanNode({row:span[0], column:span[1]}).offsetWidth;\n\n\t\t\t\tif(view.getCellEditor(row, col) || view.getCellFilter(row, col))\n\t\t\t\t\tbaseWidth += 20;\n\n\t\t\t\theight = Math.max(height, getTextSize(view, text, style.id, baseWidth).height);\n\t\t\t}\n\t\t});\n\n\t\titem.$height  = height;\n\t}\n}\n","import {encode} from \"../helpers/column_names\";\n\nexport function init(view){\n\tvar table = view._table;\n\n\tvar bs = 0;\n\ttable.attachEvent(\"onAreaDrag\", () => bs = new Date());\n\ttable.attachEvent(\"onBeforeAreaRemove\", function(){\n\t\t//[FIXME] currently we don't have enough info to know\n\t\t//is user selects new area, and removing need to be blocked\n\t\t//or is it some API which attempts to remove the area\n\t\tif (view.$handleSelection && (new Date() - bs)<500) return false;\n\t});\n\n\ttable.attachEvent(\"onBeforeAreaAdd\", (area) => {\n\t\t//[FIXME] \n\t\t//block selection of row-id column\n\t\t//temporary fix, we need to fire onBeforeBlockSelect when selection moves\n\t\t//so the common onBeforeBlockSelect handler will block rowId selection\n\t\tif (area.start.column == \"rowId\") return false;\n\n\t\t//if we have an active editor, we need to close it on block selection\n\t\t//ignore, when selecting the editor's cell\n\t\tvar editor = table.getEditor();\n\t\tif (editor && (\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ||\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ))\n\t\t\ttable.editStop();\n\n\t\tif (!view.$handleSelection) return true;\n\t\t\n\n\t\tlet blockStart = encode[area.start.column] + area.start.row;\n\t\tlet blockEnd = encode[area.end.column] + area.end.row;\n\n\t\tvar res = view.$handleSelection(area.start, area.end, blockStart, blockEnd);\n\n\t\tif (res !== false){\n\t\t\tview.$handleSelection = null;\n\t\t\ttable.removeSelectArea();\n\t\t}\n\n\t\treturn res;\n\t});\n\n\twebix.event(table.$view, \"mousedown\", function(e){\n\t\tif (view.$handleSelection)\n\t\t\treturn webix.html.preventEvent(e);\n\t});\n}\n","export function expandSelection(r, view){\n\tlet maxY = view.config.rowCount;\n\tlet maxX = view.config.columnCount;\n\tlet table = view._table;\n\n\tlet nr1 = r.start.row, nr2 = r.end.row, nc1 = r.start.column, nc2 = r.end.column;\n\n\tfor (let i=nr1-1; i>0; i--){\n\t\tif (getValue(i, r.start.column, table))\n\t\t\tnr1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nr2+1; i<maxY; i++){\n\t\tif (getValue(i, r.end.column, table))\n\t\t\tnr2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc1-1; i>0; i--){\n\t\tif (getValue(r.start.row, i, table))\n\t\t\tnc1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc2+1; i<maxX; i++){\n\t\tif (getValue(r.end.row, i, table))\n\t\t\tnc2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tlet newrange = { start:{ row:nr1, column:nc1 } , end:{ row: nr2, column: nc2 }};\n\tif (nr1 != r.start.row || nr2 != r.end.row || nc1 != r.start.column || nc2 != r.end.column){\n\t\tview._table.addSelectArea(newrange.start, newrange.end);\n\t}\n\n\treturn newrange;\n}\n\nfunction getValue(r,c, table){\n\tvar value = table.getItem(r)[c];\n\tif(value === undefined || value === \"\"){\n\t\treturn false;\n\t} else {\n\t\treturn true;\n\t}\n}","import {expandSelection} from \"../helpers/expand_selection\";\nimport {updateMath} from \"../math/updater\";\nimport {rangeObj} from \"../helpers/column_names\";\nimport group from \"./undo_group\";\nimport {_changeCondition} from \"./conditional_formats\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"sort-asc\" || cm.id === \"sort-desc\")\n\t\t\tsortRange(view, null, cm.id.replace(\"sort-\",\"\"));\n\t});\n}\n\nconst sorters = {\n\t\"int\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tlet c = parseFloat(a[key]) || -Infinity;\n\t\t\tlet d = parseFloat(b[key]) || -Infinity;\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;\n\t\t};\n\t},\n\t\"str\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tlet c = (a[key] || \"\").toString().toLowerCase();\n\t\t\tlet d = (b[key] || \"\").toString().toLowerCase();\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;  \n\t\t};\n\t}\n};\n\nexport function sortRange(view, range, dir, type){\n\trange = range || view._table.getSelectArea();\n\n\tif (range){\n\t\trange = rangeObj(range, view);\n\t\tlet fullrange = range;\n\t\tif (range.start.row === range.end.row)\n\t\t\tfullrange = expandSelection(range, view);\n\n\t\tlet key = view.getRow(range.start.row)[range.start.column];\n\t\ttype = type || (isNaN(parseFloat(key)) ? \"str\" : \"int\");\n\t\tdir = (!dir || dir === \"asc\") ? 1 : -1;\n\t\tgroup.set(()=>\n\t\t\tsort(fullrange, range.start.column, type, dir, view)\n\t\t);\n\t}\n}\n\nfunction sort(range, by, type, dir, view){\n\tfor (let column = range.start.column; column <= range.end.column; column++){\n\t\t//get all selected column values\n\t\tconst values = [];\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst fullRow = view.getRow(row);\n\t\t\t\tlet value = fullRow[column];\n\t\t\t\tlet style = view.getStyle(row, column);\n\t\t\t\tlet math = fullRow[\"$\"+column];\n\t\t\t\tlet conditions = view.conditions.get(row,column);\n\t\t\t\tif(conditions)\n\t\t\t\t\t_changeCondition(\"remove\", row, column, conditions, null, view);\n\n\t\t\t\tvalues.push({\n\t\t\t\t\tvalue: value,\n\t\t\t\t\tstyle: style,\n\t\t\t\t\tmath: math,\n\t\t\t\t\trow: row,\n\t\t\t\t\tconditions: conditions\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t//sort them\n\t\tvalues.sort(sorters[type](dir, \"value\"));\n\n\t\t//set new values to original column\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst element = values.shift();\n\t\t\t\t\n\t\t\t\tview.setStyle(row, column, (element.style || null));\n\t\t\t\tif(element.conditions)\n\t\t\t\t\t_changeCondition(\"update\", row, column, null, element.conditions, view);\n\n\t\t\t\tif (!element.math) view.setCellValue(row, column, element.value);\n\t\t\t\telse {\n\t\t\t\t\tconst translate = {\n\t\t\t\t\t\tid: \"move\",\n\t\t\t\t\t\trow: row - element.row,\n\t\t\t\t\t\tcolumn: 0\n\t\t\t\t\t};\n\t\t\t\t\tconst newMath = updateMath(element.math, translate);\n\n\t\t\t\t\tview.setCellValue(row, column, newMath);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tview.refresh();\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"gridlines-hide\"){\n\t\t\thideGridlines(view, value);\n\t\t}\n\t});\n}\n\nexport function hideGridlines(view, state = true){\n\tvar grid = view.$$(\"cells\");\n\tvar borderless = grid.$view.className.indexOf(\"webix_borderless\") !=-1;\n\tif (state === \"toggle\")\n\t\tstate = !borderless;\n\n\tif(!borderless && state){\n\t\twebix.html.addCss( grid.$view, \"webix_borderless\", true);\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-gridlines\", value:true}]);\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:true, value: false}]);\n\t}\n\telse if(borderless && !state){\n\t\twebix.html.removeCss( grid.$view, \"webix_borderless\");\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-gridlines\", value:false}]);\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:false, value: true}]);\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.gridlines = view.$$(\"cells\").$view.className.indexOf(\"webix_borderless\") !=-1?0:1;\n}\n\nexport function load(view, data){\n\tvar mode = false;\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.gridlines))\n\t\tmode = !data.table.gridlines;\n\thideGridlines(view, mode);\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"header-hide\"){\n\t\t\thideHeaders(view, value);\n\t\t}\n\t});\n}\n\nexport function hideHeaders(view, state = true){\n\tvar grid = view.$$(\"cells\");\n\tif (state === \"toggle\")\n\t\tstate = grid.config.header;\n\n\tif(grid.config.header && state){\n\t\tgrid.config.header = false;\n\t\tif (grid.isColumnVisible(\"rowId\"))\n\t\t\tgrid.hideColumn(\"rowId\", {}, true, true);\n\t\tgrid.refreshColumns();\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-headers\", value:true}]);\n\t\tview.callEvent(\"onAction\", [\"header-hide\", {newValue:true, value:false}]);\n\t}\n\telse if(!grid.config.header && !state){\n\t\tgrid.config.header = true;\n\t\tif (!grid.isColumnVisible(\"rowId\"))\n\t\t\tgrid.showColumn(\"rowId\", {}, true);\n\t\tgrid.refreshColumns();\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-headers\", value:false}]);\n\t\tview.callEvent(\"onAction\", [\"header-hide\", {newValue:false, value:true}]);\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.headers = view.$$(\"cells\").config.header?1:0;\n}\n\nexport function load(view, data){\n\tvar mode = false;\n\tif(data.table && !webix.isUndefined(data.table.headers))\n\t\tmode = !data.table.headers;\n\thideHeaders(view, mode);\n}","import group from \"./undo_group\";\nimport {eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tview.comments = {\n\t\tget: function(row, column){\n\t\t\treturn getComment(view, row, column);\n\t\t},\n\t\tadd: function(row, column, comment){\n\t\t\tcommentCell(view, row, column, comment);\n\t\t},\n\t\tremove: function(row, column){\n\t\t\tremoveComment(view, row, column);\n\t\t},\n\t\t_activeComment: {},\n\t\t_pull:{}\n\t};\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type === \"comment\")\n\t\t\t_undoComment(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction _undoComment(view, row, column, value){\n\tif(getComment(view, row, column))\n\t\tremoveComment(view, row, column, true);\n\tif(value)\n\t\tcommentCell(view, row, column, value, true);\n}\n\nfunction reset(view){\n\tview.comments._pull = {};\n}\n\nfunction removeComment(view, row, column, silent){\n\tif(getComment(view, row, column)){\n\t\tif (!silent)\n\t\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue: null, value: view.comments._pull[row][column]}]);\n\t\tdelete view.comments._pull[row][column];\n\t}\n\tview.$$(\"cells\").updateItem(row,column);\n}\n\nexport function removeCommentsRange(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tif(getComment(view, cell.row, cell.column))\n\t\t\t\tremoveComment(view, cell.row, cell.column);\n\t\t});\n\t\tview.$$(\"cells\").refresh();\n\t});\n}\n\nfunction commentCell(view, row, column, comment, silent){\n\tvar oldValue = getComment(view, row, column) ? view.comments._pull[row][column] : null;\n\tvar table = view.$$(\"cells\");\n\n\tif(typeof comment == \"string\")\n\t\tcomment = comment.trim() ? comment : \"\";\n\tview.comments._pull[row] = view.comments._pull[row] ? view.comments._pull[row] : {};\n\tview.comments._pull[row][column] = comment;\n\n\ttable.addCellCss(row, column, \"ssheet_commented_cell\");\n\n\tif (!silent)\n\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue:comment, value:oldValue}]);\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\tcomments = [];\n\tfor(row in view.comments._pull){\n\t\tfor(column in view.comments._pull[row])\n\t\t\tif(view.comments._pull[row][column])\n\t\t\t\tcomments.push([row, column, view.comments._pull[row][column]]);\n\t}\n\tdata.comments = comments;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tcomments = data.comments;\n\n\tif(comments)\n\t\tfor(i = 0; i < comments.length; i++)\n\t\t\tcommentCell(view, comments[i][0], comments[i][1], comments[i][2], true);\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet comments = data.comments,\n\t\ti = comments.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = comments[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete comment if row was deleted\n\t\t\t\t\t\tcomments.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tcomments[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tcomments.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tcomments[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction getComment(view, row, column){\n\treturn view.comments._pull[row] && view.comments._pull[row][column] ? view.comments._pull[row][column] : \"\";\n}","import * as m1  from \"./hide_gridlines\";\nimport * as m2  from \"./hide_headers\";\nimport * as m3  from \"./lock_cell\";\nimport * as m4  from \"./dropdown\";\nimport * as m5  from \"./filter\";\nimport * as m6  from \"./hide_row_col\";\nimport * as m7  from \"./comments\";\n\nexport function init(view){\n\tvar modules = [m1,m2,m3,m4,m5,m6,m7];\n\tview.attachEvent(\"onDataSerialize\", function(data){\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].serialize)\n\t\t\t\tmodules[i].serialize(view,data);\n\t\t}\n\n\t});\n\tview.attachEvent(\"onDataParse\", function(data){\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].load)\n\t\t\t\tmodules[i].load(view,data);\n\t\t}\n\t});\n}","const types = [\".xls\",\".xlt\",\".xla\",\".xlsx\",\".xlsm\",\".xltx\",\".xltm\",\".xlam\",\".xlsb\"];\n\nexport function init(view){\n\tlet uploader;\n\tif (window.XMLHttpRequest && (new XMLHttpRequest()).upload){\n\t\tuploader = webix.ui({\n\t\t\tview:\"uploader\",\n\t\t\tapiOnly:true,\n\t\t\taccept: types.join()\n\t\t});\n\n\t\tuploader.attachEvent(\"onBeforeFileAdd\",webix.bind(function(upload){\n\t\t\tif(types.indexOf(\".\"+upload.type.toLowerCase())>-1){\n\t\t\t\tview.reset();\n\t\t\t\tview.parse(upload.file, \"excel\");\n\t\t\t}\n\t\t\treturn false;\n\t\t},this));\n\n\t\tview._destroy_with_me.push(uploader);\n\t}\n\n\tview.attachEvent(\"onCommand\", (obj) => {\n\t\tif (obj.id === \"excel-import\")\n\t\t\tstartImport(view, uploader);\n\t});\n}\n\nfunction startImport(view, uploader){\n\tif (!uploader)\n\t\tview.alert(webix.i18n.spreadsheet.labels[\"import-not-support\"]);\n\telse\n\t\twebix.delay(() => uploader.fileDialog());\n}","export function print(view, options){\n\tlet active = view._activeSheet;\n\n\tlet html = _buildHtml(view, options, active);\n\twebix.html.insertBefore(html, options.docFooter, document.body);\n\twindow.print();\n\t_cleanHtml(view, html);\n\n\tview.showSheet(active);\n}\n\nexport function init(view){\n\tview.$customPrint = function(options){\n\t\tprint(view, options);\n\t};\n}\n\nfunction _cleanHtml(view, html){\n\twebix.html.remove(html);\n\n\tview._sheets.forEach((sheet, i) => {\n\t\twebix.html.removeStyle(\".wss_\"+view.$index+\"_\"+i);\n\t});\n}\nfunction _buildHtml(view, options, active){\n\tlet doc = webix.html.create(\"div\", { \"class\":\"webix_ssheet_print\"});\n\n\toptions.xCorrection = 1;\n\toptions.header = options.header || false;\n\toptions.trim = webix.isUndefined(options.trim) ? true : options.trim;\n\toptions.sheetnames = webix.isUndefined(options.sheetnames) ? true : options.sheetnames;\n\tconst baseIndex = view.$index;\n\n\tview._sheets.forEach((sheet, i) => {\n\t\tview.$index = baseIndex+\"_\"+i;\n\t\tif(options.data ===\"all\" || (options.data !== \"all\" && sheet.name === active)){\n\t\t\tview.showSheet(sheet.name);\n\t\t\tlet prefix = \"wss_\"+view.$index;\n\n\t\t\tif(options.sheetnames){\n\t\t\t\tlet sheetname = webix.html.create(\"div\", { \"class\":\"webix_view webix_ssheet_sheetname\"}, sheet.name+\":\");\n\t\t\t\tdoc.appendChild(sheetname);\n\t\t\t}\n\n\t\t\tview._print = true;\n\t\t\tlet table = view._table.$customPrint(options, true);\n\t\t\tdelete view._print;\n\n\t\t\t//for empty sheet we don't have any HTML\n\t\t\tif (table.firstChild)\n\t\t\t\ttable.firstChild.className += \" \"+prefix;\n\t\t\tdoc.appendChild(table);\n\n\t\t\tif(options.data == \"all\" && i+1 < view._sheets.length){\n\t\t\t\tvar br = webix.html.create(\"DIV\", {\"class\":\"webix_print_pagebreak\"});\n\t\t\t\tdoc.appendChild(br);\n\t\t\t}\n\t\t}\n\t});\n\tview.$index = baseIndex;\n\n\treturn doc;\n}","import { style_names } from \"../operations/styles\";\nimport { getType } from \"../operations/types\";\nimport { defaultStyles} from \"../toolbar/defaults\";\nimport { getFormatSource } from \"../operations/formats\";\nimport { getDimension } from \"../helpers/array\";\nimport { getConditionCss } from \"../operations/conditional_formats\";\n\nexport function init(view){\n\tview.$exportView = function(options){\n\t\tconst pdf = options.export_mode == \"pdf\";\n\t\tconst defaultOptions = {\n\t\t\theader: false,\n\t\t\tfooter:false,\n\t\t\theights:true,\n\t\t\trawValues:true,\n\t\t\tspans: true,\n\t\t\tstyles:true,\n\t\t\tmath: !pdf,\n\t\t\txCorrection:1,\n\t\t\tignore:{rowId:true},\n\t\t\tconditions:true\n\t\t};\n\n\t\twebix.extend(options, defaultOptions);\n\n\t\tif(options.export_mode == \"excel\" || pdf)\n\t\t\treturn _exportView(view, options);\n\t\telse\n\t\t\treturn view._table;\n\t};\n}\n\nfunction _exportView(view, options){\n\tconst excel = options.export_mode == \"excel\";\n\n\tif(options.sheets === true) \n\t\toptions.sheets = view._sheets.map(function(s){ return s.name;});\n\telse if(!options.sheets || !options.sheets.length)\n\t\toptions.sheets = [view._activeSheet];\n\telse if(typeof options.sheets == \"string\")\n\t\toptions.sheets = [options.sheets];\n\n\toptions.dataOnly = true;\n\n\tlet data = [];\n\tlet active = view._activeSheet;\n\n\tfor(let i = 0; i<options.sheets.length; i++){\n\t\tconst sheet = options.sheets[i];\n\t\tconst id = sheet.id || sheet;\n\n\t\tview.showSheet(id);\n\t\toptions.xCorrection = view.$$(\"cells\").config.header ? 1 : 0;\n\n\t\tconst sheetOptions = sheet.options ? webix.extend(sheet.options, options) : webix.copy(options);\n\t\tif(id != active)\n\t\t\tsheetOptions._hidden = true;\n\t\tif(!sheetOptions.name)\n\t\t\tsheetOptions.name = id;\n\n\t\tconst pdfTable = !excel && sheetOptions.display != \"image\";\n\n\t\tconst serialized = view.serialize();\n\t\tconst [rows, cols] = getDimension(serialized.data, serialized.spans, 0, 0);\n\n\t\tif(!excel){\n\t\t\tif(webix.isUndefined(sheetOptions.textBefore))\n\t\t\t\tsheetOptions.textBefore = sheetOptions.name;\n\t\t\tif(pdfTable){\n\t\t\t\tsheetOptions.ignore = sheetOptions.ignore || {};\n\t\t\t\tfor(let i = cols+1; i <= view.config.columnCount; i++){\n\t\t\t\t\tsheetOptions.ignore[i] = true;\n\t\t\t\t}\n\n\t\t\t\tconst filter = sheetOptions.filter || (()=>true);\n\t\t\t\tsheetOptions.filter = obj =>{\n\t\t\t\t\treturn obj.id <= rows && filter.apply(this, arguments);\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tconst sheetData = webix[excel ? \"toExcel\" : \"toPDF\"](view._table, sheetOptions);\n\t\tif(pdfTable && sheetData[0].scheme.length == 0)\n\t\t\tcontinue;\n\n\t\tif((excel || pdfTable) && sheetOptions.styles){\n\t\t\tconst styles = sheetData[0].styles = _getStyles(view, sheetOptions, excel, rows, cols);\n\n\t\t\tif(pdfTable)\n\t\t\t\t_updatePdfData(styles, sheetData, sheetOptions, view, serialized);\n\t\t}\n\n\t\tdata = data.concat(sheetData);\n\n\t\tif(excel){\n\t\t\tdata[i].ranges = [];\n\n\t\t\tlet ranges = view.ranges.getRanges();\n\t\t\tfor(let r = 0; r<ranges.length; r++){\n\t\t\t\tdata[i].ranges.push({\n\t\t\t\t\tSheet:i,\n\t\t\t\t\tName:ranges[r].name,\n\t\t\t\t\tRef:sheetOptions.name+\"!\"+ranges[r].range.replace(/(\\w)/gi, function(match){ return \"$\"+match; })\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tif(options.autowidth)\n\t\t\t\tgetAutowidth(sheetOptions, options);\n\t\t}\n\t}\n\tview.showSheet(active);\n\tdelete options.dataOnly;\n\treturn data;\n}\n\nfunction _updatePdfData(styles, sheetData, sheetOptions, view, serialized){\n\tconst header = sheetOptions.header ? 1 : 0;\n\n\tif (sheetOptions.spans) {\n\t\tfor (let idx in serialized.spans) {\n\t\t\tif (serialized.spans[idx][2] > 1) {\n\t\t\t\tlet row = serialized.spans[idx][0] - 1 + header, // zero-based row position\n\t\t\t\t\tcol = serialized.spans[idx][1] - 1, // zero-based col position\n\t\t\t\t\tcols = serialized.spans[idx][2];\n\t\t\t\tif (styles[row] && styles[row][col]) {\n\t\t\t\t\tstyles[row][col].colspan = cols;\n\t\t\t\t\t// if colspan, then remove merged cells (else PDFJS will shift columns)\n\t\t\t\t\tconst rowData = sheetData[0].exportData[row - header];\n\t\t\t\t\tif (rowData){\n\t\t\t\t\t\t// remove merged cell values\n\t\t\t\t\t\trowData.splice(col + 1, cols - 1);\n\t\t\t\t\t}\n\t\t\t\t\tlet style = Object.values(styles[row]);\n\t\t\t\t\tstyle.splice(col + 1, cols - 1); // remove merged cell styles\n\t\t\t\t\tstyles[row] = style;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tconst data = sheetData[0].exportData;\n\tfor(let r = 0; r < data.length; r++){\n\t\tfor (let c = 0; c < data[r].length; c++) {\n\t\t\tlet height = view.$$(\"cells\").config.rowHeight;\n\n\t\t\tif(sheetOptions.heights && serialized.sizes.length){\n\t\t\t\tfor(let s = 0; s < serialized.sizes.length; s++){\n\t\t\t\t\tconst rowSize = serialized.sizes[s][0];\n\t\t\t\t\tif(rowSize && rowSize == r+1){\n\t\t\t\t\t\theight = serialized.sizes[s][2];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst cellStyle = styles[r + header][c];\n\t\t\tconst align = cellStyle.vertAlign;\n\t\t\tconst pad = height*0.75 - cellStyle.fontSize; // available px for padding in top & bottom\n\t\t\tcellStyle.paddingTop = (align == \"top\" ? 0 : (align == \"bottom\" ? pad : pad / 2));\n\t\t\tcellStyle.paddingBottom = (align == \"bottom\" ? 0 : (align == \"top\" ? pad : pad / 2));\n\t\t}\n\t}\n}\n\nfunction getAutowidth(view, options){\n\tconst prop = options.orientation && options.orientation == \"landscape\" ? \"height\" : \"width\";\n\tlet width;\n\n\tif(view.$width)\n\t\twidth = view.$width;\n\telse //'view' can be local settings and we need to compare them with common ones\n\t\twidth = view[prop];\n\n\toptions[prop] = Math.max(options[prop] || 0, width || 0);\n}\n\nfunction _safeColor(str){\n\tstr = str.substring(1);\n\tif(str.length === 3) str = str+str;\n\treturn str;\n}\n\nfunction _getDefaults(options){\n\tlet d = defaultStyles;\n\tif(options.export_mode == \"excel\")\n\t\treturn {\n\t\t\tfont:{\n\t\t\t\tsz:d[\"font-size\"].replace(\"px\", \"\")*0.75,\n\t\t\t\tname:d[\"font-family\"].replace(/'|,.*$/g, \"\"),\n\t\t\t\t//we do not export default color, but it is the right place to do it\n\t\t\t},\n\t\t\talignment:{\n\t\t\t\thorizontal:d[\"text-align\"],\n\t\t\t\tvertical:d[\"vertical-align\"]==\"middle\"?\"center\":d[\"vertical-align\"],\n\t\t\t\twrapText:d[\"white-space\"]!=\"nowrap\"\n\t\t\t}\n\t\t};\n\telse\n\t\treturn {\n\t\t\tfontSize: d[\"font-size\"].replace(\"px\", \"\")*0.75,\n\t\t\t//we do not export default color, but it is the right place to do it\n\t\t\ttextAlign: d[\"text-align\"],\n\t\t\twhiteSpace: (d[\"white-space\"]!=\"nowrap\")\n\t\t};\n}\n\nfunction _getStyles(view, options, excel, rows, cols){\n\n\tview.compactStyles();\n\n\tlet result = [];\n\tconst cached = {};\n\tconst cachedConditions = {};\n\tconst defaults = _getDefaults(options);\n\n\tif(excel && options.docHeader) result  = result.concat([{0:_getDocStyle(options.docHeader.css, defaults)}, {}]);\n\tif(options.header) result.push({});\n\n\tconst delta = result.length;\n\n\tconst grid = view.$$(\"cells\");\n\tconst columns = grid.config.columns;\n\n\tlet rIndex = delta;\n\tgrid.eachRow((row) =>{\n\t\tif(row > rows)\n\t\t\treturn;\n\n\t\tfor (let cIndex = options.xCorrection; cIndex < columns.length && cIndex <= cols; cIndex++){\n\t\t\tconst css = view.getStyle(row, columns[cIndex].id);\n\t\t\tconst index = cIndex - options.xCorrection;\n\n\t\t\tresult[rIndex] = result[rIndex] || {};\n\n\t\t\tlet styles;\n\t\t\tif(css){\n\t\t\t\tif(cached[css.id])\n\t\t\t\t\tstyles = webix.copy(cached[css.id]);\n\t\t\t\telse{\n\t\t\t\t\tstyles = _getCellStyle(css.text, excel);\n\n\t\t\t\t\tfor(let name in defaults){\n\t\t\t\t\t\tif(excel)\n\t\t\t\t\t\t\twebix.extend(styles[name], defaults[name]);\n\t\t\t\t\t\telse if (!styles[name])\n\t\t\t\t\t\t\tstyles[name] = defaults[name];\n\t\t\t\t\t}\n\n\t\t\t\t\tcached[css.id] = webix.copy(styles);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t\tstyles = webix.copy(defaults);\n\n\t\t\tif(options.conditions){\n\t\t\t\t//not real excel condition, save only bg and color (sheetJS doesn't support)\n\t\t\t\tconst condition = _getCellConditions(view, row, cIndex, cachedConditions);\n\t\t\t\tif(condition)\n\t\t\t\t\t_updateStyleCondition(styles, condition, excel);\n\t\t\t}\n\n\t\t\tresult[rIndex][index] = styles;\n\t\t\tresult[rIndex][index].type = getType(view, row, columns[cIndex].id);\n\t\t}\n\t\trIndex++;\n\t});\n\n\tif(excel && options.docFooter) result  = result.concat([{},{0:_getDocStyle(options.docFooter.css, defaults)}]);\n\n\treturn result;\n}\n\nfunction _getCellStyle(styles, excel){\n\tlet str = styles.split(\";\");\n\tlet stl = {};\n\tif(excel)\n\t\tstl = { font:{}, alignment:{}, border:{}};\n\n\tfor(let s = 0; s<str.length; s++){\n\t\tif(str[s]){\n\t\t\tif(excel)\n\t\t\t\t_getExcelCellStyle(stl, str, s);\n\t\t\telse\n\t\t\t\t_getPdfCellStyle(stl, str, s);\n\t\t}\n\t}\n\n\treturn stl;\n}\n\nfunction _getCellConditions(view, r, c, cached){\n\tconst css = getConditionCss(view, r, c);\n\tif(css){\n\t\tif(cached[css])\n\t\t\treturn cached[css];\n\t\tconst el = webix.html.create(\"div\", {\"class\":css});\n\t\tdocument.body.appendChild(el);\n\n\t\tconst computed = window.getComputedStyle(el);\n\t\tconst bg = computed.backgroundColor;\n\t\tconst color = computed.color;\n\n\t\tdocument.body.removeChild(el);\n\n\t\tcached[css] = [bg, color];\n\t\treturn cached[css];\n\t}\n}\n\nfunction _updateStyleCondition(stl, condition, excel){\n\tlet [bg, color] = condition.map(val => webix.color.rgbToHex(val));\n\tif(excel){\n\t\tstl.fill = {fgColor:{rgb:bg}};\n\t\tstl.font.color = {rgb:color};\n\t}\n\telse{\n\t\tstl.backgroundColor = bg;\n\t\tstl.color = color;\n\t}\n}\n\nfunction _getExcelCellStyle(stl, str, s){\n\tswitch (style_names[s]){\n\t\tcase \"color\":\n\t\t\tstl.font.color = {rgb:_safeColor(str[s])};\n\t\t\tbreak;\n\t\tcase \"background\":{\n\t\t\tconst fill = _safeColor(str[s]);\n\t\t\tif(fill && fill.toLowerCase() !== \"ffffff\")\n\t\t\t\tstl.fill = { fgColor:{ rgb:fill}};\n\t\t\tbreak;\n\t\t}\t\n\t\tcase \"text-align\":\n\t\t\tstl.alignment.horizontal = str[s];\n\t\t\tbreak;\n\t\tcase \"font-family\":\n\t\t\tstl.font.name = str[s].replace(/'|,.*$/g, \"\"); // cut off fallback font\n\t\t\tbreak;\n\t\tcase \"font-size\":\n\t\t\tstl.font.sz = str[s].replace(\"px\", \"\")*0.75; //px to pt conversion\n\t\t\tbreak;\n\t\tcase \"font-style\":\n\t\t\tstl.font.italic = str[s] == \"italic\";\n\t\t\tbreak;\n\t\tcase \"text-decoration\":\n\t\t\tstl.font.underline = str[s] == \"underline\";\n\t\t\tbreak;\n\t\tcase \"font-weight\":\n\t\t\tstl.font.bold = str[s] == \"bold\";\n\t\t\tbreak;\n\t\tcase \"vertical-align\":\n\t\t\tstl.alignment.vertical = str[s] == \"middle\"?\"center\":str[s];\n\t\t\tbreak;\n\t\tcase \"wrap\":\n\t\t\tstl.alignment.wrapText = str[s] == \"wrap\";\n\t\t\tbreak;\n\t\tcase \"borders\":\n\t\t\tbreak;\n\t\tcase \"format\":\n\t\t\tstl.format = getFormatSource(str[s], true) || \"\";\n\t\t\tbreak;\n\t\tcase \"border-right\":\n\t\tcase \"border-bottom\":\n\t\tcase \"border-left\":\n\t\tcase \"border-top\":\n\t\t\tstl.border[ style_names[s].split(\"-\")[1] ] = getBorderStyles(str[s], true);\n\t\t\tbreak;\n\t}\n}\n\nfunction _getPdfCellStyle(stl, str, s){\n\tswitch (style_names[s]) {\n\t\tcase \"color\":\n\t\t\tstl.color = _safeColor(str[s]);\n\t\t\tbreak;\n\t\tcase \"background\":\n\t\t\tstl.backgroundColor = _safeColor(str[s]);\n\t\t\tbreak;\n\t\tcase \"text-align\":\n\t\t\tstl.textAlign = str[s];\n\t\t\tbreak;\n\t\tcase \"font-family\":\n\t\t\tbreak;\n\t\tcase \"font-size\":\n\t\t\tstl.fontSize = str[s].replace(\"px\", \"\")*0.75;\n\t\t\tbreak;\n\t\tcase \"font-style\":\n\t\t\tstl.italic = str[s] == \"italic\";\n\t\t\tbreak;\n\t\tcase \"text-decoration\":\n\t\t\tstl.underline = str[s] == \"underline\";\n\t\t\tbreak;\n\t\tcase \"font-weight\":\n\t\t\tstl.bold = str[s] == \"bold\";\n\t\t\tbreak;\n\t\tcase \"vertical-align\":\n\t\t\tstl.vertAlign = str[s]; // not supported in PDFJS, so simulate with lineHeight and paddingTop\n\t\t\tbreak;\n\t\tcase \"wrap\":\n\t\t\tstl.whiteSpace = (str[s] != \"nowrap\");\n\t\t\tbreak;\n\t\tcase \"borders\":\n\t\t\tbreak;\n\t\tcase \"format\":\n\t\t\tbreak;\n\t\tcase \"border-right\":\n\t\tcase \"border-bottom\":\n\t\tcase \"border-left\":\n\t\tcase \"border-top\":{\n\t\t\tconst pos = style_names[s].split(\"-\")[1];\n\t\t\tstl[`border${pos[0].toUpperCase() + pos.substring(1)}Color`] = getBorderStyles(str[s]);\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\nfunction getBorderStyles(val, excel){\n\tconst [color, type] = val.split(\",\");\n\n\tif(excel)\n\t\treturn { color:{ rgb:_safeColor(color)}, style:type};\n\telse\n\t\treturn _safeColor(color);\n}\n\nfunction _getDocStyle(css){\n\tif(!css) return {};\n\tvar str = [];\n\tfor(let i =0; i<style_names.length; i++)\n\t\tstr.push(css[style_names[i]]||\"\");\n\treturn _getCellStyle(str.join(\";\"), true);\n}","import { style_names } from \"../operations/styles\";\nimport { fontFamily} from \"../toolbar/buttons\";\nimport { defaultStyles} from \"../toolbar/defaults\";\n\nexport function init(view){\n\tview._parseExcel = function(obj, driver){\n\t\tvar options = obj.options || {};\n\t\toptions.math = view.config.math;\n\n\t\tvar full = { sheets:[]};\n\t\tfor(let i  = 0; i< obj.names.length; i++){\n\t\t\toptions.name = obj.names[i];\n\t\t\tfull.sheets.push({\n\t\t\t\tname:options.name,\n\t\t\t\tcontent:_excel_to_data(driver.getSheet(obj, options), obj.ranges, i)\n\t\t\t});\n\t\t}\n\t\treturn full;\n\t};\n\tview._parseCsv = function(obj, driver){\n\t\tobj = driver.getRecords(obj);\n\n\t\tvar dataObj = webix.copy(obj);\n\t\tvar data = [];\n\n\t\tfor(let i = 0; i<dataObj.length; i++){\n\t\t\tlet item = dataObj[i].split(driver.cell);\n\t\t\tfor(let c  = 0; c<item.length; c++){\n\t\t\t\tvar row = i+1, column = c+1;\n\t\t\t\tdata.push([row, column, item[c]]);\n\t\t\t}\n\t\t}\n\t\treturn { data:data };\n\t};\n}\n\n\nfunction _excel_to_data(obj, ranges, index){\n\tvar dataObj = webix.copy(obj.data);\n\tvar data =  [];\n\n\tfor (let i = 0; i < dataObj.length; i++){\n\t\tfor(let c = 0; c<dataObj[0].length; c++){\n\t\t\tvar row = i+1, column = c+1;\n\t\t\tdata.push([row, column, dataObj[i][c]]);\n\t\t}\n\t}\n\tobj.data = data;\n\n\t//merged cells\n\tif(obj.spans){\n\t\tfor(let i = 0; i<obj.spans.length; i++){\n\t\t\tobj.spans[i][0]++;\n\t\t\tobj.spans[i][1]++;\n\t\t}\n\t}\n\n\t//named ranges\n\tif(ranges){\n\t\tfor(let r = 0; r<ranges.length; r++){\n\t\t\t//we don't support global named ranges, so import only sheet-based :(\n\t\t\tif(ranges[r].Sheet === index){\n\t\t\t\tobj.ranges = obj.ranges || [];\n\t\t\t\tobj.ranges.push([ranges[r].Name.toUpperCase(), ranges[r].Ref.substring(ranges[r].Ref.indexOf(\"!\")+1).replace(/\\$/g, \"\")]);\n\t\t\t}\n\t\t}\n\t}\n\n\t//cell styles\n\tif(obj.styles)\n\t\t_getStyles(obj);\n\n\tif(obj.types)\n\t\t_getTypes(obj);\n\n\t//column width and row height\n\tif(obj.sizes){\n\t\tfor(let i = 0; i<obj.sizes.length; i++){\n\t\t\tif(obj.sizes[i][0] == \"column\")\n\t\t\t\tobj.sizes[i] = [0, obj.sizes[i][1]+1, obj.sizes[i][2]];\n\t\t\telse\n\t\t\t\tobj.sizes[i] = [obj.sizes[i][1]+1, 0, obj.sizes[i][2]];\n\t\t}\n\t}\n\n\treturn obj; \n}\n\n//ARGB conversion\nfunction _safeColor(str){\n\tstr = str || \"000000\";\n\tif(str.length === 8) str = str.substring(2);\n\treturn \"#\"+str;\n}\n\n//only fonts that we support can be imported\nfunction _safeFont(str){\n\tlet safe = defaultStyles[\"font-family\"];\n\tfor(let i = 0; i<fontFamily.length; i++){\n\t\tif(fontFamily[i].value == str) { safe = fontFamily[i].id; break; }\n\t}\n\treturn safe;\n}\n\nfunction _getTypes(obj){\n\tobj.types.forEach(type => {\n\t\tfor(let i = 0; i < obj.data.length; i++){\n\t\t\tif(obj.data[i][0] === type[0]+1 && obj.data[i][1] === type[1]+1){\n\t\t\t\tobj.data[i][4] = type[2];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction _getBorderStyles(pos, stl){\n\tpos = pos.replace(\"border-\", \"\");\n\tif(stl.border && stl.border[pos]){\n\t\tconst border = stl.border[pos];\n\t\tconst color = _safeColor(border.color.rgb) || \"\";\n\t\tconst type = border.style || \"\";\n\t\treturn `${color},${type}`;\n\t}\n\treturn \"\";\n}\n\nfunction _getStyles(obj){\n\tlet styleshash = {}, styles = [], stylescount = 1;\n\tfor(let i = 0; i<obj.styles.length; i++){\n\t\tlet str = [], stl = obj.styles[i][2], css;\n\n\t\tfor(let s  = 0; s<style_names.length; s++){\n\t\t\tswitch (style_names[s]){\n\t\t\t\tcase \"color\": \n\t\t\t\t\tstr[s] = stl.font && stl.font.color?(_safeColor(stl.font.color.rgb)||\"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"background\":\n\t\t\t\t\tstr[s] = stl.fill && stl.fill.fgColor?(_safeColor(stl.fill.fgColor.rgb) ||\"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-align\":\n\t\t\t\t\tstr[s] = (stl.alignment ?stl.alignment.horizontal:\"\") || defaultStyles[\"text-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-family\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.name?_safeFont(stl.font.name):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-size\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.sz?((stl.font.sz/0.75)+\"px\" ||\"\"):\"\"; //pt to px conversion\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-style\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.italic?\"italic\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-decoration\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.underline?\"underline\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-weight\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.bold?\"bold\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"vertical-align\":\n\t\t\t\t\tvar va = stl.alignment ? (stl.alignment.vertical || \"\"):\"\";\n\t\t\t\t\tstr[s] = (va ==\"center\"?\"middle\":va) || defaultStyles[\"vertical-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"wrap\":\n\t\t\t\t\tstr[s] = stl.alignment && stl.alignment.wrapText?\"wrap\":\"nowrap\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"borders\":\n\t\t\t\t\tstr[s] = \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"format\":\n\t\t\t\t\tstr[s] = \"\"; //stl.numFmt\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-right\":\n\t\t\t\tcase \"border-bottom\":\n\t\t\t\tcase \"border-left\":\n\t\t\t\tcase \"border-top\":\n\t\t\t\t\tstr[s] = _getBorderStyles(style_names[s], stl);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tstr = str.join(\";\");\n\t\tcss = styleshash[str] || \"wss\"+stylescount;\n\n\t\tfor(let d = 0; d<obj.data.length; d++){\n\t\t\tif(obj.data[d][0] === obj.styles[i][0]+1 && obj.data[d][1] === obj.styles[i][1]+1){\n\t\t\t\tobj.data[d][3] = css;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(!styleshash[str]){\n\t\t\tstyles.push([css, str]);\n\t\t\tstyleshash[str] = css;\n\t\t\tstylescount++;\n\t\t}\n\t}\n\tobj.styles = styles;\n}","import group from \"../operations/undo_group\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tswitch (action.id) {\n\t\t\tcase \"clear-value\":\n\t\t\t\tview.clearRange(null,{values: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-style\":\n\t\t\t\tview.clearRange(null,{styles: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-conditional-formats\":\n\t\t\t\tview.clearRange(null,{conditions: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-dropdown-editors\":\n\t\t\t\tview.clearRange(null,{editors: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-all\":\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tview.clearRange(null,null);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-comments\":\n\t\t\t\tview.clearRange(null,{comments: true});\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import group from \"../operations/undo_group\";\nimport {adjustRow, adjustColumn} from \"../operations/column_operations\";\n\n/* row operations */\n\nexport function insertRow(row){\n\tcallCommand(this, \"add\", \"row\", row);\n}\n\nexport function deleteRow(row){\n\tcallCommand(this, \"del\", \"row\", row);\n}\n\nexport function setRowHeight(row, height){\n\tsetSize(this, \"row\", row, height);\n}\n\n/* col operations */\n\nexport function insertColumn(column){\n\tcallCommand(this, \"add\", \"column\", column);\n}\n\nexport function deleteColumn(column){\n\tcallCommand(this, \"del\", \"column\", column);\n}\n\nexport function setColumnWidth(column, width){\n\tsetSize(this, \"column\", column, width);\n}\n\n/* helpers */\n\nfunction getCells(view, id, group){\n\tif(!id){\n\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\tif(area)\n\t\t\tid = [area.start[group],area.end[group]];\n\t}\n\telse if(!webix.isArray(id)){\n\t\tid =  [id,id];\n\t}\n\treturn id;\n}\n\nfunction callCommand(view, name, group, id){\n\tlet start = {}, end = {};\n\tid = getCells(view, id, group);\n\tif(!id)\n\t\treturn;\n\tstart[group] = id[0];\n\tend[group] = id[1];\n\tview.callEvent(\"onCommand\", [{id:name,  group:group}, start, end]);\n}\n\nfunction setSize(view, type, id, size){\n\tid = getCells(view, id, type);\n\tif(!id)\n\t\treturn;\n\tgroup.set(()=>{\n\t\tfor (let i = id[0]; i <= id[1]; i++){\n\t\t\tif(size != \"auto\")\n\t\t\t\tview.$$(\"cells\")[type == \"row\" ? \"setRowHeight\" : \"setColumnWidth\"](i, size);\n\t\t\telse\n\t\t\t\t(type == \"row\" ? adjustRow : adjustColumn)(i, view);\n\t\t}\n\t});\n}","import * as lock from \"../operations/lock_cell\";\n\nexport function lockCell(row, column, state){\n\tlock.lockCell(this, row, column, state);\n}\n\nexport function isCellLocked(row, column){\n\treturn lock.isCellLocked(this, row, column);\n}","import group from \"../operations/undo_group\";\n\nexport function freezeColumns(column){\n\tconst grid = this.$$(\"cells\");\n\n\tif( webix.isUndefined(column) ){\n\t\tlet sel = this.getSelectedId(true);\n\t\tcolumn = sel.length?sel[0].column:0;\n\t}\n\n\tconst base = grid.config.columns[0].id == \"rowId\" ? 1 : 0;\n\tlet index = base;\n\tif (column && column != this._frozenColumns){\n\t\tfor (let i = column; i > 0; i--) {\n\t\t\tindex = grid.getColumnIndex(i)+1;\n\t\t\tif(index)\n\t\t\t\tbreak;\n\t\t}\n\t\tif (!index) index = base;\n\t}\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"column\", column);\n\t\tgrid.unselect();\n\t\tgrid.define(\"leftSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-column\", { value: (this._frozenColumns || 0), newValue: column}]);\n\t\tthis._frozenColumns = column || 0;\n\t},this);\n}\n\nexport function freezeRows(row){\n\tconst grid = this.$$(\"cells\");\n\n\tif( webix.isUndefined(row) ){\n\t\tlet sel = this.getSelectedId(true);\n\t\trow = sel.length?sel[0].row:0;\n\t}\n\n\tlet index = 0;\n\tif (row && row != this._frozenRows){\n\t\tfor (let i = row; i > 0; i--) {\n\t\t\tindex = grid.getIndexById(i)+1;\n\t\t\tif(index)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"row\", row);\n\t\tgrid.unselect();\n\t\tgrid.define(\"topSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-row\", { value: this._frozenRows, newValue: row}]);\n\t\tthis._frozenRows = row || 0;\n\t},this);\n}\n\nfunction checkSpans(view, type, num){\n\tconst grid = view.$$(\"cells\");\n\n\tif(type == \"row\"){\n\t\tlet start = 1;\n\t\tlet end = view.config.columnCount;\n\t\tfor(let i = start; i <= end; i++){\n\t\t\tconst span = grid.getSpan(num, i);\n\t\t\tif(span){\n\t\t\t\tconst spanSize = (span[0]*1) + span[3] - 1;\n\t\t\t\tif(spanSize>num)\n\t\t\t\t\tchangeSpan(view, span, span[2], span[3] - (spanSize - num));\n\t\t\t}\n\t\t}\n\t}\n\telse{//column\n\t\tlet start = grid.data.order[0];\n\t\tlet end = grid.data.order.length;\n\t\tfor(let i = start; i <= end; i++){\n\t\t\tconst span = grid.getSpan(i, num);\n\t\t\tif(span){\n\t\t\t\tconst spanSize = (span[1]*1) + span[2] - 1;\n\t\t\t\tif(spanSize>num)\n\t\t\t\t\tchangeSpan(view, span, span[2] - (spanSize - num), span[3]);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction changeSpan(view, span, x, y){\n\tview.splitCell(span[0], span[1]);\n\tview.combineCells({\n\t\tcell:{\n\t\t\trow:span[0],\n\t\t\tcolumn:span[1]\n\t\t},\n\t\tx:x,\n\t\ty:y\n\t});\n}","import * as gridlines from \"../operations/hide_gridlines\";\n\nexport function hideGridlines(state){\n\tgridlines.hideGridlines(this,state);\n}","import * as headers from \"../operations/hide_headers\";\n\nexport function hideHeaders(state){\n\theaders.hideHeaders(this,state);\n}","import * as hrows from \"../operations/hide_row_col\";\n\nexport function hideColumn(column,state){\n\throws.setState(this, column, state, \"column\");\n}\nexport function isColumnVisible(column){\n\treturn hrows.isColumnVisible(this, column);\n}\nexport function hideRow(row,state){\n\throws.setState(this, row, state, \"row\");\n}\nexport function isRowVisible(row){\n\treturn hrows.isRowVisible(this, row);\n}","import {addMethod} from \"../math/methods\";\nimport {image, chart} from \"../math/writer\";\nimport {getAccessor} from \"../math/sheet\";\n\nexport function addImage(row, column, url){\n\tthis.setCellValue(row, column, image(url));\n\tthis.refresh();\n}\n\nexport function addSparkline(row, column, config){\n\tlet value = chart(config);\n\tthis.setCellValue(row, column, value);\n\tthis.refresh();\n}\n\nexport function getSheetData(name){\n\treturn getAccessor(this, name);\n}\n\nexport function recalculate(){\n\tthis.callEvent(\"onMathRefresh\",[]);\n}\n\nexport function registerMathMethod(name, handler){\n\tname = name.toUpperCase();\n\taddMethod(name, handler);\n\tif(this.$$(\"liveEditor\")){\n\t\tconst sid = this.$$(\"liveEditor\").config.suggest;\n\t\tconst list = webix.$$(sid).getList();\n\t\tif(!list.exists(name))\n\t\t\tlist.add({id:name, value:name});\n\t}\n}","import * as sheets from \"../sheets\";\nimport * as spn from \"../operations/spans\";\nimport * as und from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\nimport * as stl from \"../operations/styles\";\nimport * as srt from \"../operations/sorting\";\nimport {removeCommentsRange} from \"../operations/comments\";\nimport {clearConditionalFormats} from \"../operations/conditional_formats\";\nimport {clearEditors} from \"../operations/dropdown\";\nimport {clearFilters} from \"../operations/filter\";\n\n//spans\nexport function combineCells(range){\n\tif(!range){\n\t\tvar sel = this.getSelectedId(true);\n\t\tif (sel.length>1){\n\t\t\trange = spn.getRange(sel);\n\t\t}\n\t}\n\tgroup.set(()=> {\n\t\tif (range)\n\t\t\tspn.addSpan(this, range.cell, range.x, range.y);\n\t});\n\tthis.refresh();\n}\n\nexport function splitCell(row, column){\n\tif (row && column) {\n\t\tspn.removeSpan(this, {row: row, column: column});\n\t}\n\telse{\n\t\tgroup.set(function(){\n\t\t\tthis.eachSelectedCell(function(cell){\n\t\t\t\tspn.removeSpan(this, cell);\n\t\t\t});\n\t\t},this);\n\n\t}\n\n\tthis.refresh();\n}\n\n//styles\nexport function addStyle(prop, origin){\n\treturn stl.addStyle(this, prop, origin);\n}\n\nexport function getStyle(row, column){\n\treturn stl.getStyle(this, {row:row, column:column});\n}\n\nexport function setStyle(row, column, style){\n\treturn stl.setStyle(this, {row: row, column: column}, style);\n}\n\nexport function setRangeStyle(rangeStr, style){\n\tgroup.set(function() {\n\t\tstl.setRangeStyle(this, rangeStr, style);\n\t},this);\n}\n\nexport function clearRange(rangeStr, type) {\n\tif (!rangeStr){\n\t\trangeStr = this._table.getSelectArea();\n\t\tif (!rangeStr) return;\n\t}\n\n\tif (!type) type = {styles: true, values: true, editors:true, conditions:true, comments:true };\n\t\n\tif (type.styles)\n\t\tstl.clearRangeStyle(this,rangeStr);\n\n\tif (type.conditions)\n\t\tclearConditionalFormats(this,rangeStr);\n\t\n\tif (type.values)\n\t\tthis.setRangeValue(rangeStr, null);\n\n\tif (type.editors){\n\t\tclearEditors(this, rangeStr);\n\t\tclearFilters(this, rangeStr);\n\t}\n\n\tif (type.comments)\n\t\tremoveCommentsRange(this, rangeStr);\n\n\tthis.refresh();\n}\n\nexport function compactStyles(){\n\treturn stl.compactStyles(this);\n}\n\n// serialize\nexport function serialize(config){\n\tvar obj = {};\n\tthis.callEvent(\"onDataSerialize\",[obj, config]);\n\n\tif (config && config.sheets)\n\t\treturn sheets.serialize(this, obj);\n\treturn obj;\n}\n\n//sheets\nexport function showSheet(name){\n\tsheets.show(this,name);\n}\nexport function getActiveSheet(){\n\treturn this._activeSheet;\n}\nexport function addSheet(content){\n\tsheets.add(this, content);\n}\nexport function clearSheet(){\n\tthis.reset();\n}\nexport function renameSheet(name,newName){\n\tsheets.rename(this,name,newName);\n}\nexport function editSheet(name){\n\tsheets.edit(this,name);\n}\nexport function removeSheet(name){\n\tsheets.remove(this,name);\n}\n\n\n//undo\nexport function undo(){\n\tund.undo(this);\n}\nexport function redo(){\n\tund.redo(this);\n}\n\n// sort\nexport function sortRange(range, dir){\n\tsrt.sortRange(this, range, dir);\n}","import {toRange,rangeObj} from \"../helpers/column_names\";\nimport * as tbl from \"../table\";\nimport group from \"../operations/undo_group\";\nimport {newSheet} from \"../sheets\";\n\nexport function refresh(all){\n\tif (all)\n\t\tthis._table.refreshColumns();\n\telse\n\t\tthis._table.refresh();\n}\nexport function eachSelectedCell(cb){\n\tvar cells = this.getSelectedId(true);\n\tfor (var i=0; i<cells.length; i++)\n\t\tcb.call(this, cells[i]);\n}\nexport function getSelectedRange(sheet){\n\tvar area = this._table.getSelectArea();\n\tif (area){\n\t\tif (sheet)\n\t\t\tsheet = this.getActiveSheet();\n\t\treturn toRange(area.start.row,area.start.column,area.end.row,area.end.column,sheet);\n\t}\n\treturn \"\";\n}\nexport function getSelectedId(all){\n\tvar area = this._table.getSelectArea();\n\tif(!all)\n\t\treturn area && area.start.row ? area.start : null;\n\n\tvar selection = [];\n\tif(area){\n\t\tvar c0 = area.start;\n\t\tvar c1 = area.end;\n\n\t\tfor(var i = c0.row; i<= c1.row; i++){\n\t\t\tfor(var j = c0.column; j <= c1.column; j++){\n\t\t\t\tselection.push({row: i,column:j});\n\t\t\t}\n\t\t}\n\t}\n\n\treturn selection;\n\t//return this._table.getSelectedId(all)\n}\nexport function getCellValue(row, column){\n\tvar item = this.getRow(row);\n\tvar value = item[\"$\"+column] || item[column];\n\t\n\tif (typeof value === \"undefined\") return \"\";\n\treturn value;\n}\nexport function setCellValue(row, column, value){\n\tif(this.getCellValue(row, column) !== value){\n\t\tvar item = this.getRow(row);\n\t\tvar old = item[\"$\"+column]||item[column];\n\n\t\t//onCellChange can change item (via types module)\n\t\tgroup.set(()=>{\n\t\t\tif (this.callEvent(\"onBeforeValueChange\",[row, column, value, old])){\n\t\t\t\titem[column] = value;\n\t\t\t\tdelete item[\"$\"+column];\n\n\t\t\t\tthis.callEvent(\"onCellChange\", [row, column, value]);\n\t\t\t\tthis.saveCell(row, column);\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport function setRangeValue(range, value){\n\tgroup.set(function(){\n\t\tvar pos = rangeObj(range, this);\n\t\tfor (let row = pos.start.row; row <= pos.end.row; row++) {\n\t\t\tfor (let column = pos.start.column; column <=  pos.end.column; column++) {\n\t\t\t\tthis.setCellValue(row, column, value);\n\t\t\t}\n\t\t}\n\t},this);\n\n}\n\nexport function getRow(id){\n\treturn this._table.getItem(id);\n}\nexport function getColumn(id){\n\treturn this._table.getColumnConfig(id);\n}\nexport function reset(mode){\n\tvar obj = { data:[] };\n\tif (mode && mode.sheets){\n\t\tobj = newSheet(obj);\n\t}\n\t\n\tthis.parse(obj);\n}\n\nexport function _resetTable(){\n\ttbl.reset(this);\n}\n","import {save} from \"../operations/save\";\n\nexport function saveCell(row, column){\n\tvar style = this.getStyle(row, column);\n\n\tsave(this, \"data\", {\n\t\trow: row,\n\t\tcolumn: column,\n\t\tvalue: this.getCellValue(row, column),\n\t\tstyle: (style ? style.id : \"\")\n\t});\n}","export function getRow(id){\n\treturn this._table.getItem(id);\n}\n\nexport function setCellEditor(row, column, editor) {\n\tconst line = this._table._ssEditors[row] = this._table._ssEditors[row] || {};\n\tconst value = line[column] || this.getRow(row)[column];\n\tline[column] = editor;\n\n\tif (editor && editor.editor){\n\t\tthis._table.addCellCss(row,column, \"ss_editor\");\n\t} else {\n\t\tdelete this._table._ssEditors[row][column];\n\t\tthis._table.removeCellCss(row,column, \"ss_editor\");\n\t}\n\tthis.callEvent(\"onAction\", [\"dropdown\", { row, column, value, newValue:editor }]);\n}\n\nexport function getCellEditor(row, column){\n\tlet line = this._table._ssEditors[row] || {};\n\treturn line[column] || null;\n}","import * as flt from \"../operations/filter\";\n\nexport function setCellFilter(row, column, filter){\n\tconst line = this._table._ssFilters[row] = this._table._ssFilters[row] || {};\n\tconst value = line[column] || this.getRow(row)[column];\n\n\tif (filter && (webix.isArray(filter) || typeof filter == \"string\"))\n\t\tfilter = { options:filter };\n\tline[column] = filter;\n\n\tif (filter && typeof filter == \"object\"){\n\t\tthis._table.addCellCss(row,column, \"ss_filter\");\n\t\tif (filter.value && flt.isValueActive(filter.value))\n\t\t\tthis._table.addCellCss(row,column, \"ss_filter_active\");\n\n\t\twebix.extend(filter, {row, column}, true);\n\t\tfilter.options = flt.calibrateRange(this, row, column, filter.options);\n\n\t\tif (!filter.handler && filter.value && filter.value.condition){\n\t\t\tconst mode = filter.mode || flt.getFilterMode(this, row, column);\n\t\t\tfilter.handler = flt.getFilterFunction(mode, filter.value);\n\t\t}\n\t} else {\n\t\tdelete this._table._ssFilters[row][column];\n\t\tthis._table.removeCellCss(row,column, \"ss_filter\");\n\t\tthis._table.removeCellCss(row,column, \"ss_filter_active\");\n\t}\n\tthis.callEvent(\"onAction\", [\"filter\", { row, column, value, newValue:filter }]);\n}\n\nexport function getCellFilter(row, column){\n\tlet line = this._table._ssFilters[row] || {};\n\treturn line[column] || null;\n}\n\nexport function removeFilters(){\n\tconst filters = flt.getFilters(this._table);\n\n\tfor\t(let i=0; i<filters.length; i++){\n\t\tconst {row, column} = filters[i];\n\t\tthis.setCellFilter(row, column, null);\n\t}\n\n\tthis._table._ssFilters = {};\n\tthis._table.data.filter((obj) => {\n\t\treturn this.isRowVisible(obj.id);\n\t});\n}\n\n\nexport function filterSpreadSheet(){\n\tthis._table.data.silent(function(){\n\t\tconst filters = flt.getFilters(this._table);\n\n\t\t// hidden rows\n\t\tthis._table.data.filter((obj) => {\n\t\t\treturn this.isRowVisible(obj.id);\n\t\t});\n\n\t\tfor (let i=0; i<filters.length; i++){\n\t\t\tconst {row, column, handler} = filters[i];\n\n\t\t\tlet all = false;\n\t\t\tthis._table.data.filter(function(obj){\n\t\t\t\tif (all || obj.id*1 <= row*1) return true;\n\t\t\t\tif (!obj[column] && obj[column] !== \"\") return all = true;\n\t\t\t\treturn (typeof handler == \"function\") ? handler( String(obj[column]) ) : true;\n\t\t\t}, 1, true);\n\t\t}\n\t}, this);\n\n\tthis._table.callEvent(\"onAfterFilter\", []);\n\tthis._table.refresh();\n}\n","export function confirm(config){\n\treturn webix.confirm({\n\t\tcss:\"webix_ssheet_confirm\",\n\t\ttext:config.text,\n\t\tok: webix.i18n.spreadsheet.labels.ok,\n\t\tcancel: webix.i18n.spreadsheet.labels.cancel\n\t});\n}\n\nexport function alert(config){\n\treturn webix.alert({\n\t\tcss: \"webix_ssheet_alert\",\n\t\ttext:config.text,\n\t\tok: webix.i18n.spreadsheet.labels.ok\n\t});\n}","import * as undo from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\n\nexport function resetUndo(){\n\tundo.reset(this);\n}\n\nexport function groupUndo(func){\n\tgroup.set(func, this);\n}\n\nexport function ignoreUndo(func){\n\tundo.ignoreUndo(func, this);\n}","import * as fmt from \"../operations/formats\";\n\nexport function setFormat(row, column, format){\n\tfmt.addFormat(this, row, column, format);\n}\n\nexport function changeDecimals(row, column, inc){\n\t//row and column may be obj\n\tfmt.changeAreaDecimals(this, inc, row, column);\n}","const defaultMenu = [\n\t{ id:\"file\", submenu:[\n\t\t{id: \"sheet\", submenu: [\n\t\t\t{id: \"new-sheet\"},\n\t\t\t{id: \"copy-sheet\"},\n\t\t\t{id: \"remove-sheet\"}\n\t\t]},\n\t\t{id: \"excel-import\"},\n\t\t{id: \"excel-export\"}\n\t]},\n\t{ id:\"edit\", submenu:[\n\t\t{id: \"add-range\"},\n\t\t{id: \"add-dropdown\"},\n\t\t{id: \"add-link\"},\n\t\t{id: \"lock-cell\"},\n\t\t{id: \"conditional-format\"},\n\t\t{id: \"clear\", submenu:[\n\t\t\t{id: \"clear-value\"},\n\t\t\t{id: \"clear-style\"},\n\t\t\t{id: \"clear-conditional-formats\"},\n\t\t\t{id: \"clear-dropdown-editors\"},\n\t\t\t{id: \"clear-comments\"},\n\t\t\t{ $template:\"Separator\" },\n\t\t\t{id: \"clear-all\"}\n\t\t]}\n\t]},\n\t{ id:\"insert\", submenu:[\n\t\t{id: \"image\", submenu:[\n\t\t\t{ id: \"add-image-cell\"},\n\t\t\t{ id: \"add-image-top\"}\n\t\t]},\n\t\t{id: \"graph\", submenu:[\n\t\t\t{ id: \"add-sparkline\"},\n\t\t\t{ id: \"add-chart\"}\n\t\t]},\n\t\t{id: \"add-comment\"}\n\t]},\n\t{ id:\"data\", submenu:[\n\t\t{id: \"sort\", submenu: [\n\t\t\t{id: \"sort-asc\"},\n\t\t\t{id: \"sort-desc\"}\n\t\t]},\n\t\t{id: \"create-filter\"}\n\t]},\n\t{ id: \"view\", submenu:[\n\t\t{id: \"columns\", submenu: [\n\t\t\t{id: \"insert-column\"},\n\t\t\t{id: \"delete-column\"},\n\t\t\t{id: \"show-column\"},\n\t\t\t{id: \"hide-column\"},\n\t\t\t{id: \"resize-column\"}\n\t\t]},\n\t\t{id: \"rows\", submenu: [\n\t\t\t{id: \"insert-row\"},\n\t\t\t{id: \"delete-row\"},\n\t\t\t{id: \"show-row\"},\n\t\t\t{id: \"hide-row\"},\n\t\t\t{id: \"resize-row\"}\n\t\t]},\n\t\t{ $template:\"Separator\" },\n\t\t{id: \"freeze-columns\"},\n\t\t{id: \"freeze-rows\"},\n\t\t{id: \"hide-gridlines\"},\n\t\t{id: \"hide-headers\"}\n\t]}\n];\n\nconst ui = {\n\tgetMenuData: function(menu, config){\n\t\tvar i;\n\t\tfor(i=0; i < menu.length; i++){\n\t\t\tif(typeof menu[i] == \"string\")\n\t\t\t\tmenu[i] = {id: menu[i]};\n\t\t\tif((menu[i].id == \"resize-column\" || menu[i].id == \"resize-row\") && !config.resizeCell){\n\t\t\t\tmenu.splice(i,1);\n\t\t\t\ti--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(!menu[i].value)\n\t\t\t\tmenu[i].value = webix.i18n.spreadsheet.menus[menu[i].id];\n\t\t\tif(menu[i].submenu)\n\t\t\t\tmenu[i].submenu = this.getMenuData(menu[i].submenu, config);\n\t\t}\n\n\t\treturn menu;\n\t}\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tvar config = view.config,\n\t\tmenu = {\n\t\t\tview: \"menu\",\n\t\t\tborderless: true,\n\t\t\tcss: \"webix_ssheet_menu\",\n\t\t\tid: \"menu\",\n\t\t\tautowidth: true,\n\t\t\ttype:{\n\t\t\t\theight: 40\n\t\t\t},\n\t\t\tdata: ui.getMenuData(webix.isArray(config.menu)?config.menu : webix.copy(defaultMenu), view.config)\n\t\t};\n\n\tview.callEvent(\"onViewInit\", [\"menu\", menu]);\n\treturn menu;\n}\n\n\nfunction ready(view){\n\tif(view.$$(\"menu\"))\n\t\tview.$$(\"menu\").attachEvent(\"onMenuItemClick\",(id) => callAction(view,id));\n}\n\nconst actionMap = {\n\t\"undo\": function (view) {\n\t\tview.undo();\n\t},\n\t\"redo\": function (view) {\n\t\tview.redo();\n\t},\n\t\"insert-column\": function (view) {\n\t\tview.insertColumn();\n\t},\n\t\"delete-column\": function (view) {\n\t\tview.deleteColumn();\n\t},\n\t\"show-column\": function (view) {\n\t\tview.hideColumn(null,false);\n\t},\n\t\"hide-column\": function (view) {\n\t\tview.hideColumn(null,true);\n\t},\n\t\"resize-column\": function (view) {\n\t\t//like we are calling from the toolbar\n\t\tview.callEvent(\"onCommand\",[{id: \"resize\", group: \"column\", value: webix.i18n.spreadsheet.menus[\"resize-column\"]}]);\n\t},\n\t\"insert-row\": function (view) {\n\t\tview.insertRow();\n\t},\n\t\"delete-row\": function (view) {\n\t\tview.deleteRow();\n\t},\n\t\"show-row\": function (view) {\n\t\tview.hideRow(null,false);\n\t},\n\t\"hide-row\": function (view) {\n\t\tview.hideRow(null,true);\n\t},\n\t\"resize-row\": function (view) {\n\t\t//like we are calling from the toolbar\n\t\tview.callEvent(\"onCommand\",[{id: \"resize\", group: \"row\", value: webix.i18n.spreadsheet.menus[\"resize-row\"]}]);\n\t},\n\t\"freeze-columns\": function(view){\n\t\tview.freezeColumns();\n\t},\n\t\"hide-gridlines\": function(view){\n\t\tview.hideGridlines(\"toggle\");\n\t},\n\t\"hide-headers\": function(view){\n\t\tview.hideHeaders(\"toggle\");\n\t}\n};\n\nfunction callAction(view,id){\n\tif(view.callEvent(\"onMenuItemClick\",[id])){\n\t\tif(actionMap[id])\n\t\t\tactionMap[id](view);\n\t\telse\n\t\t\tview.callEvent(\"onCommand\",[{id: id}]);\n\t}\n}","function getText(text){\n\tvar locale = webix.i18n.spreadsheet.labels;\n\treturn locale[text] || text;\n}\nexport function getDefaultStyles(){\n\treturn [\n\t\t{name: getText(\"normal\"), css: \"webix_ssheet_condition_regular\"},\n\t\t{name: getText(\"neutral\"), css: \"webix_ssheet_condition_neutral\"},\n\t\t{name: getText(\"bad\"), css: \"webix_ssheet_condition_bad\"},\n\t\t{name: getText(\"good\"), css: \"webix_ssheet_condition_good\"}\n\t];\n}","//global definitions\nimport \"./locale\";\nimport \"./views/index\";\n\n//special content for non-production builds\nimport \"./init\";\n\nimport \"./editors/index\";\n\n//modules\nimport * as bar from \"./toolbar\";\nimport * as tbl from \"./table\";\nimport * as key from \"./hotkeys\";\nimport * as editor from \"./editor\";\nimport * as sheets from \"./sheets\";\nimport * as dialogs from \"./dialogs/index\";\nimport * as context from \"./context\";\nimport * as chart from \"./chart\";\n\nimport {setDefaultFormats} from \"./operations/formats\";\nimport {operations} from \"./operations/index\";\nimport {api} from \"./api/index\";\n\n//styling\nimport * as menu from \"./menu\";\nimport {getDefaultStyles} from \"./helpers/conditional\";\nimport {setSkinDefaults} from \"./toolbar/defaults\";\n\n\nvar component = {\n\tname:\"spreadsheet\",\n\t_base_index:{ count:1 },\n\tdefaults:{\n\t\tspans: true,\n\t\tliveEditor: true,\n\t\trowCount:50,\n\t\tmath:true,\n\t\tcolumnCount:20,\n\t\tresizeCell: true,\n\t\tsheetTabWidth: 90,\n\t\tconditionStyle: getDefaultStyles()\n\t},\n\t$init:function(){\n\t\tthis.$index = (this._base_index.count++);\n\t\tthis.$view.className += \" webix_ssheet\";\n\n\t\tthis.$ready.unshift(this._sub_init);\n\t\tthis.$ready.unshift(setDefaultFormats);\n\t\tthis.$ready.push(this._set_handlers);\n\n\t\tthis._destroy_with_me = [];\n\t\tthis.attachEvent(\"onDestruct\", () => {\n\t\t\tthis._destroy_with_me.forEach(view => view.destructor());\n\t\t});\n\t},\n\t$skin:function(){\n\t\tsetSkinDefaults();\n\t},\n\t_sub_init:function(){\n\t\tconst obj = this.config;\n\t\tconst rows = [];\n\n\t\t//toolbars\n\t\tif(!obj.readonly && obj.menu)\n\t\t\trows.push(menu.init(this));\n\t\tif(!obj.readonly && obj.toolbar !== false)\n\t\t\trows.push(bar.init(this));\n\t\tif (obj.subbar)\n\t\t\trows.push(obj.subbar);\n\t\tif(!obj.readonly && obj.liveEditor)\n\t\t\trows.push(editor.init(this));\n\n\t\t//data part\n\t\tconst tblObj = {\n\t\t\teditable : !obj.readonly,\n\t\t\tclipboard : obj.clipboard,\n\t\t\tliveEditor: obj.liveEditor,\n\t\t\tclipboardDecimalDelimiter : obj.clipboardDecimalDelimiter\n\t\t};\n\t\tif(obj.rowHeight)\n\t\t\ttblObj.rowHeight = obj.rowHeight;\n\t\tif(obj.columnWidth)\n\t\t\ttblObj.columnWidth = obj.columnWidth;\n\n\t\tif(obj.readonly)\n\t\t\trows.push(tbl.init(this, tblObj));\n\t\telse\n\t\t\trows.push({cols:[tbl.init(this, tblObj), chart.init(this)]});\n\n\t\tconst bottom = obj.bottombar === true ? sheets.defaultBottom(this) : obj.bottombar;\n\t\tif (bottom)\n\t\t\trows.push(bottom);\n\n\t\tsheets.init(this);\n\n\t\tif(!obj.readonly)\n\t\t\tcontext.init(this);\n\n\t\tdialogs.init(this);\n\n\t\tthis.rows_setter(rows);\n\t},\n\t_set_handlers:function(){\n\t\t//prevent double init\n\t\tif (this._table) return;\n\t\tthis._table = this.$$(\"cells\");\n\n\t\t//init all sub modules\n\t\toperations(this);\n\n\t\t//set sizes for the table\n\t\ttbl.reset(this, this.config.columnCount, this.config.rowCount);\n\t\tkey.init(this); //keyboard shortcuts\n\t\t\n\t\tthis._table.attachEvent(\"onAfterAreaAdd\", () =>\n\t\t\tthis.callEvent(\"onAfterSelect\", [ this.getSelectedId(true) ]));\n\n\t\tthis.callEvent(\"onComponentInit\", []);\n\t},\n\t$onLoad:function(obj, driver){\n\t\t//when loading data by data:, we can get $onLoad before _set_handlers call\n\t\tthis._set_handlers();\n\n\t\tif (obj.excel)\n\t\t\tobj = this._parseExcel(obj, driver);\n\t\telse if(!obj.data && typeof obj == \"string\" && (driver.cell || driver.row))\n\t\t\tobj = this._parseCsv(obj, driver);\n\n\t\tsheets.load(this, obj);\n\t}\n};\napi(component);\nwebix.protoUI(component, webix.AtomDataLoader, webix.IdSpace, webix.ui.layout);\n","import {isCellSelected, isColSelected,isRowSelected,selectRow,selectColumn} from \"./operations/column_operations\";\nimport {getColumnOperation, getRowOperation, getClearOperation} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => view.$$(\"context\").attachTo(view._table.$view));\n\n\tvar locale = webix.i18n.spreadsheet.menus;\n\tconst lists = {\n\t\tdata:[\n\t\t\t{ id:\"clear\",\t\tvalue: locale[\"clear\"], submenu: getClearOperation()},\n\t\t\t{ id:\"lock-cell\",\t\tvalue: locale[\"lock-cell\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"sort\",\tvalue: locale.sort, submenu:[\n\t\t\t\t{id: \"sort-asc\", value: locale[\"sort-asc\"]},\n\t\t\t\t{id: \"sort-desc\", value: locale[\"sort-desc\"]}\n\t\t\t]},\n\t\t\t{id:\"create-filter\",\t\tvalue: locale[\"create-filter\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"add-range\",\t\tvalue: locale[\"add-range\"]},\n\t\t\t{ id:\"add-link\",\t\tvalue: locale[\"add-link\"]},\n\t\t\t{ id:\"add-comment\",\t\tvalue: locale[\"add-comment\"]}\n\t\t],\n\t\tcolumn: getColumnOperation(view),\n\t\trow: getRowOperation(view)\n\t};\n\n\n\tvar context = {\n\t\tview: \"contextmenu\",\n\t\tid: \"context\",\n\t\tpadding:0,\n\t\tsubmenuConfig:{\n\t\t\tpadding:0,\n\t\t\ton:{\n\t\t\t\tonBeforeShow:function(){\n\t\t\t\t\tthis.sizeToContent();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdata:[],\n\t\ton:{\n\t\t\tonMenuItemClick(id) {\n\t\t\t\tview.callEvent(\"onCommand\", [this.getMenuItem(id)]);\n\t\t\t},\n\t\t\tonBeforeShow(pos) {\n\t\t\t\twebix.callEvent(\"onClick\", []);\n\t\t\t\tvar mode, trg;\n\n\t\t\t\ttrg = view._table.locate(pos);\n\t\t\t\tif (!trg) return false;\n\n\t\t\t\tmode = \"\";\n\t\t\t\tif (trg.header && trg.column !== \"rowId\"){\n\t\t\t\t\tif (!isColSelected(trg.column, view))\n\t\t\t\t\t\tselectColumn(trg.column, view);\n\t\t\t\t\tmode = \"column\";\n\t\t\t\t} else if (trg.row){\n\t\t\t\t\tif (trg.column === \"rowId\"){\n\t\t\t\t\t\tif (!isRowSelected(trg.row, view))\n\t\t\t\t\t\t\tselectRow(trg.row, view);\n\t\t\t\t\t\tmode = \"row\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!isCellSelected(trg.row, trg.column, view))\n\t\t\t\t\t\t\tview._table.addSelectArea(trg, trg);\n\t\t\t\t\t\tmode = \"data\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (mode){\n\t\t\t\t\tvar data = getMenuData(view, mode, lists[mode]);\n\t\t\t\t\tif (data){\n\t\t\t\t\t\tthis.clearAll();\n\t\t\t\t\t\tthis.parse(data);\n\t\t\t\t\t\tthis.sizeToContent();\n\t\t\t\t\t\twebix.html.preventEvent(pos);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"context\", context]);\n\tconst contextMenu = view.ui(context);\n\n\tview._destroy_with_me.push(contextMenu);\n}\n\nexport function getMenuData(view, name, data){\n\tvar ev = { area:name, data:data };\n\tif (view.callEvent(\"onContextMenuConfig\", [ev]))\n\t\treturn ev && ev.data;\n\treturn null;\n}","import * as m1  from \"./add_row_col\";\nimport * as m6  from \"./clipboard\";\nimport * as m12 from \"./column_operations\";\nimport * as m2  from \"./conditional_formats\";\nimport * as m4 from \"./types\";\nimport * as m8 from \"./formats\";\nimport * as m16a from \"../math/math\";\nimport * as m17 from \"./data\";\nimport * as m18 from \"./dropdown\";\nimport * as m7  from \"./formats\";\nimport * as m13 from \"./hide_row_col\";\nimport * as m14 from \"./lock_cell\";\nimport * as m3  from \"./resize\";\nimport * as m9  from \"./selection\";\nimport * as m10 from \"./sorting\";\nimport * as m16 from \"./spans\";\nimport * as m19 from \"./states\";\nimport * as m5  from \"./styles\";\nimport * as m11 from \"./undo\";\nimport * as m20 from \"./import\";\nimport * as m21 from \"./filter\";\nimport * as m22 from \"./print\";\nimport * as m23 from \"./export\";\nimport * as m24 from \"./load\";\nimport * as m25 from \"./clear_styles\";\nimport * as m26 from \"./comments\";\nimport * as m27 from \"./save\";\nimport * as m28 from \"./hide_headers\";\nimport * as m29 from \"./hide_gridlines\";\nimport * as m30 from \"./views\";\n\nexport function operations(view){\n\t//order in some cases does matter\n\t//resize must be applied after math, to size data by the result of math calculation\n\t//types must be applied after state and data \n\tvar all = [m1,m2,m5,m6,m7,m9,m10,m11,m12,m13,m14,m16,m3,m8,m17,m16a,m18,m19,m4,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29,m30];\n\tfor (var i = 0; i < all.length; i++){\n\t\tif (all[i].init)\n\t\t\tall[i].init(view);\n\t}\n}","import * as rco from \"./row_col_operations\";\nimport * as lcl from \"./lock_cell\";\nimport * as fcl from \"./freeze\";\nimport * as hbr from \"./hide_gridlines\";\nimport * as hhd from \"./hide_headers\";\nimport * as hrc from \"./hide_rows\";\nimport * as mat from \"./math\";\nimport * as ops from \"./operations\";\nimport * as cor from \"./core\";\nimport * as sav from \"./save\";\nimport * as dpd from \"./dropdown\";\nimport * as flt from \"./filter\";\nimport * as cfm from \"./confirm\";\nimport * as und from \"./undo\";\nimport * as fmt from \"./number_formats\";\n\nexport function api(view){\n\tvar all = [rco, lcl, fcl, hbr, hhd, hrc, mat, ops, cor, sav, dpd, flt, cfm, und, fmt];\n\tfor (var i = 0; i < all.length; i++)\n\t\twebix.extend(view, all[i]);\n}"],"names":["dayOfTheYear","date","start","Date","getFullYear","diff","getTimezoneOffset","Math","floor","getJsDateFromExcel","excelDate","round","getTime","getExcelDateFromJs","jsDate","toString","_to_number","v","isNaN","_combine","data","arr","i","length","concat","getJsDate","value","getExcelDate","webix","i18n","spreadsheet","labels","tooltips","menus","table","liveEditor","formats","protoUI","name","$cssName","$init","config","options","view","body","tooltip","template","xCount","yCount","ui","richselect","defaults","width","margin","cols","scroll","select","obj","id","on","onAfterSelect","this","getParentView","updateMasterValue","rows","css","skin","$name","title","onChange","suggest","fitMaster","hide","getValue","$$","master","setValue","getList","getColorView","getTypeView","getSelectedId","getBody","getChildViews","getItemText","$ready","push","bind","getPopup","isArray","callEvent","join","height","type","palette","attachEvent","setMasterValue","colorboard","icon","borderless","$view","className","$renderInput","divStart","color","renderColor","call","replace","match","p1","p2","p3","colorpicker","prototype","$setValue","popup","getColorNode","style","backgroundColor","firstChild","childNodes","$renderIcon","text","apply","arguments","datepicker","$prepareValue","copy","end","daterangepicker","buttons","close","getBodyConfig","content","elements","getFormElements","padding","$active","layoutPadding","form","label","cancel","autowidth","click","getTopParentView","save","hotkey","body_setter","_typeof","isUndefined","window","move","head","autofocus","IdSpace","headerRowHeight","datatable","a","setHTML","dataview","contextmenu","filter","item","editor","cursor","getInputNode","selectionStart","val","charAt","str1","substring","str2","search","toLowerCase","indexOf","node","tagName","_this","sizes","html","offset","textWidth","getTextSize","y","x","show","refresh","setValueHere","$enterKey","isVisible","group","set","method","uid","url","all","serialize","sheets","proxy","$parse","$proxy","ajax","headers","post","init","thread","events","handler","newName","params","_loading_data","getActiveSheet","clearTimeout","delay","decode","encode","alpha","prefixIndex","parseInt","str","adress","size","charCodeAt","col","substr","range","nind","sheet","parts","split","ranges","getCode","d1","d2","notAlphaNum","escapeSheet","test","toRange","x2","y2","rangeObj","row","column","eachRange","callback","rangeTest","isRange","changeRange","inc","updated","r1","c1","r2","c2","toolbarSizes","paddingY","sectorPadding","sectorMargin","defaultStyles","style_names","_style_map","left","center","right","top","middle","bottom","wrap","getBorderCss","pos","border","sizeEl","border_checks","cell","area","mode","_style_handlers","getSelectArea","lineStyle","modes","_updateStyle","reset","_styles","_styles_cache","_styles_max","prefix","$index","removeStyle","getStyle","styles","getRow","$cellCss","span","getSpan","spanStyles","spanStyle","styleid","addStyle","props","origin","_styleFromText","key","_styleToText","cache","_addStyle","_parse","styleObj","update_style_data","nstyle","$cellFormat","format","setStyle","_setStyle","setRangeStyle","baseWidth","innerHTML","_table","appendChild","max","offsetWidth","offsetHeight","removeChild","old","oldFormat","formatChanged","saveCell","silent","_buildCssString","clearRangeStyle","compactStyles","used","newStyles","_applyStyles","eachSelectedCell","_applyCellStyles","ostyle","_serialize","_undoStyle","create","formatsCount","formatSources","formatCache","formatHelpers","setDefaultFormats","formatsLocale","price","getFormat","extra","priceFormat","values","extend","zeros","priceSettings","decimalSize","symbol","separator","negative","getDelimiters","numberFormat","percent","format2code","dateFormat","string","serializeFormat","formToValues","groupSign","groupDelimiter","decimalSign","decimalDelimiter","getFormatSource","toexcel","parseFormat","createFormatName","addFormat","nev","removeFormat","splitFormat","conditional","delimiters","errorMessage","code","separated","separateFmt","genCode","condition","fmt","Function","check","line","ind","isAbs","genFormatCode","isQuote","comma","numberPlaceholder","textPlaceholder","multiply","lastDateType","betweenPlaceholders","placeholder","datePart","excelDateToWebix","undefined","map","decimal","getParts","reverse","lzeros","lfills","rzeros","rfills","rmax","dateTypes","timeTypes","dateOrder","Object","keys","sort","b","timeOrder","typesOrder","order","types","j","changeAreaDecimals","cells","getCells","r","c","getItem","firstValue","firstStyle","rules","isNumber","changeCellDecimals","isCustom","updateDecimals","parsed","decimals","placeholders","Array","slice","withoutText","withoutPlaceholders","hasOwnProperty","formValues","toExcel","leftPlaceholders","fmtParts","sepFmtParts","getFmtPartValues","leftText","rightText","fmtPart","firstPlaceholder","index","Infinity","k","checkFormat","checkTime","quot","getFormatName","isDateInvalid","getDateEditFormat","formatName","locale","isTime","dateToStr","load","defaultFormats","isChar","char","getWord","formula","passive","quotes","operand","isPosition","position","word","sum","flags","chars","errorCode","e","namedRangeCode","deps","sheetInd","rangeCode","t","crosssheet","lines","ph","escaped","next","pushLine","getPopupConfig","onItemClick","button","suggestData","highlight","_highlightedCells","_update_range","_last_value_set","showActiveSheet","updateCellValue","moveSelection","preventEvent","eventRemove","keydownEv","event","_this2","endEdit","escapeText","escape","changeCellCss","_ranges","colorIndex","crossheet","cellSheet","prepareSheet","activeMath","_activeMath","activeSheet","cellText","rangeName","repeatedColor","nextCell","nextCellText","setColor","document","activeElement","paintValue","activeCell","define","showSheet","_this3","remove","which","keyCode","dir","getItemNode","newv","getCellValue","setCellValue","$handleSelection","$setValueHere","setSelectionRange","expectRange","trim","expectOperator","setRange","len","lastPos","prepareArea","first","second","min","row1","col1","row2","col2","coloredArea","texthighlight","layout","drag","dragscroll","EditAbility","list","toggle","onValue","offValue","common","inp","awidth","aheight","$allowsClear","blockEvent","unblockEvent","arrow","elementsConfig","labelWidth","_initOnChange","$eventSource","_getCheckboxes","count","$all","_count","base","forEach","labelRight","active","baseHeight","inputHeight","checkboxes","output","scrollview","queryView","onSelectChange","focus","resize","toFront","minWidth","minHeight","escHide","autofit","setAttribute","UIManager","addHotKey","_removeView","getMenu","_clickEv","_menu","destructor","move_setter","DragControl","addDrag","$dragPos","$dragCreate","object","trg","target","getAttribute","elOffset","elPos","pOffset","parentNode","state","getScrollState","toNode","$dragDestroy","submenu","readonly","submenuConfig","externalUI","onMenuItemClick","_menuActions","onBeforeShow","_toggleExcel","dots","toPDF","display","toPNG","header","pull","showItem","hideItem","layoutMargin","multi","getSectionConfig","onAfterScroll","addSection","trashIcon","dataPadding","oldVal","upper","toUpperCase","hidden","markersVisible","onClick","removeView","childs","getLayout","lastIndex","layoutId","addView","setValues","setSubValue","sub","hideMarkers","marker","child","getValues","editors","excel_date","createPopup","icons","timepicker","_last_input_target","onEnter","render","showPopup","input","updateCalendar","calendar","afterRender","ss_richselect","exists","popupInit","$value","actions","isMerged","c0","splitCell","confirm","then","combineCells","undo","redo","hideGridlines","hideHeaders","freezeColumns","freezeRows","fontFamily","getColumnOperation","colOperations","resizeCell","getRowOperation","rowOperations","getClearOperation","getLocaleClear","$template","borders","styleFormats","colorButton","toggleButton","iconButton","btn","segmented","popupWidth","popupTemplate","popupEvents","titleHeight","align","condFormat","buttonsMap","getFontSize","numbers","fontSize","px","getCellFormats","currency","example","number","getText","getAllElements","calcButtons","groups","result","$button","insert","ready","selected","barStyles","getBarStyles","dropdowns","getCellStyles","cellStyle","property","splice","action","updateValue","element","toolbar","allElements","elm","bottombar","toolbarButtons","structure","checkButtons","getButtons","columns","block","blockColumns","bar","source","viewId","innerId","selectRow","endRow","last","_selectRange","selectAll","firstColumn","selectColumn","endColumn","isColSelected","selectedArea","isCellSelected","isRowSelected","selectColumns","addSelectArea","adjustColumn","columnWidth","getColumnConfig","eachRow","getCellEditor","getCellFilter","setColumnWidth","adjustRow","eachColumn","getSpanNode","setRowHeight","highlightColRow","sr","er","sc","ec","removeCellCss","addCellCss","getHeaderNode","removeCss","addCss","dragStartColumn","dragEndColumn","grid","showCommentHandler","comments","_activeComment","editStatus","locate","visible","commentsView","get","viewonly","contains","math","editMath","highlightHeaders","ids","cop","st","ed","ev","getEditor","isCellLocked","finalStep","resizeColumn","cind","dx","posRelative","columnId","selectColumnHandler","lastHeaderClick","headerClick","dblClick","shiftKey","lastClickedRow","editStop","getFocus","need_focus","setFocus","setDefaultCss","spans","leftSplit","areaselect","minColumnWidth","editable","editaction","minRowHeight","navigation","clipboard","clipboardDecimalDelimiter","templateCopy","cell_template","valueOnly","invalidDate","helper","newValue","_print","clearAll","columnCount","rowCount","el","nms","refreshColumns","parse","env","isMac","sel","$anyKey","edit","del","styleHotKey","ctrlU","ctrlP","attr","elementOn","SUM","AVERAGE","COUNT","COUNTA","COUNTBLANK","MAX","MIN","PRODUCT","product","SUMPRODUCT","sets","sp","s","SUMSQ","sq","pow","VARP","avg","STDEVP","sqrt","POWER","num","n","p","QUOTIENT","div","d","SQRT","ABS","abs","RAND","random","PI","INT","ROUND","digits","parseFloat","toFixed","ROUNDDOWN","ROUNDUP","ceil","TRUNC","EVEN","ODD","CONCATENATE","LEFT","MID","RIGHT","LOWER","UPPER","PROPER","temp","idx","TRIM","LEN","DATE","year","month","day","TIME","hour","minute","DAY","getDate","MONTH","getMonth","YEAR","NOW","DATEDIF","unit","startDateDays","months","IMAGE","SPARKLINE","color1","color2","negativeColor","Sparklines","getTemplate","HYPERLINK","IF","neg","methods","dateToExcel","getFormatType","formatType","getType","$cellType","setType","_setType","isFormula","parseDate","mathFormat","getMathFormat","blockLevel","level","part","expectType","getExpectType","parser","strToDate","parseDateTime","ignoreUndo","updateCell","cellEditor","setFormat","timeFormat","setCellEditor","checkType","strings","other","methodsName","updateEditor","fillEditor","startEdit","clear","disableEditor","disabled","disable","enable","en","pasteRange","updateRange","isEnabled","clearEditor","isActiveCell","find","func","findIndex","getDimension","spanEndRow","spanEndCol","actionMap","_activeSheet","add","prepare","selectSheet","command","changePagerVisability","sheetTabWidth","showBatch","changePagerStatus","scrollPos","tabWidth","context","dataOrder","_sheets","rename","defaultBottom","editValue","webix_ssheet_sheet_arrow","initSheetMenu","$sheetMenu","menuInit","menu","_destroy_with_me","callAction","getMark","disableItem","enableItem","batch","scrollSheets","direction","scrollTo","newIndex","getNewTitle","getSheet","newSheet","changeId","tabs","getActive","_resetTable","Dialog","$dialog","$hide","$show","unescape","DialogBox","box","preview","parseImage","server","images","image","showPreview","upload","onBeforeFileAdd","file","reader","FileReader","onload","getFormView","readAsDataURL","onFileUpload","response","imageURL","onSaveClick","okClick","onCancelClick","fillUrl","addImage","viewid","open","views","update","actives","passives","core","struct","pair","pairsheet","rawword","triggers","_build_function","error_function","clearMathCache","activeOnly","updateMath","stack","isRowFix","isColumnFix","checkRange","cut","isRow","updateSheetNames","oldName","thisSheet","multiSheet","getAccessor","_mathSheetCache","helpers","passiveAccessor","page","formulas","_mathSheetHelpers","_mathSheetCore","getRangeCode","getCell","execute","getName","getRange","activeAccessor","SheetAccessor","getRangeValue","getRangeCols","rangeToData","rind","sheetName","getRangeRows","rangeOptions","unique","empty","String","objA","objB","sorters","sorting","as","int","unshift","nullFilter","$empty","Ranges","_master","accessor","els","parseChart","color_def","color_pos","color_neg","renderPreview","visibleBatch","labelPosition","getTypes","alert","sparkConfig","addSparkline","rangeValues","clearValidation","getSelectedRange","getRanges","toSheetRange","validate","updateItem","theform","removeRange","editRange","correct","gravity","autoheight","saveClick","lockCss","lockCell","_mapCellsCalls","_locks","cm","lock","updatePosition","locked","addSpan","extraCss","getExtraCss","setSpanValue","isEmpty","removeSpan","lx","ly","rx","ry","cx","cy","setSpanCss","borderChecks","adjustSpan","checkSpan","selection","isFirstCell","oldValue","pasteSpan","cutted","translate","mapCells","rid","cid","isUndo","undoSpan","checkSpanBorders","_ssFilters","markBarFilter","getFilters","filters","clearFilters","refilter","filterSpreadSheet","calibrateRange","getFilterRange","isValueActive","includes","isFilterExists","getFilterMode","pasteFilter","setCellFilter","getSingleOption","conditions","getConditions","getFilterFunction","opt","isDate","lastIndexOf","on_click","ssheet_filter_sign","on_dblclick","toggleFilters","removeFilters","isFilter","$mode","$filter","syncScroll","_getTargetNode","getFilter","flt","importData","relative","field","inputs","applyFilter","setCellStyle","isHidden","nodeOffset","tableOffset","getElementsByClassName","ydiff","xdiff","scrollSize","fillForm","labelsLocale","commonConfig","customConfig","dateConfig","fullDateFormat","longDateFormat","getFormats","updateForm","paddingX","closeWin","isText","forms","_normalizeValue","value2","collection","_formatValue","editFormat","_safeInt","_getCondition","activeValue","_setCondition","_clean","onFocus","current_view","_this4","onBlur","getRows","getConditionStyle","conditionStyle","_this5","getSheets","filename","restoreValue","paper","fit","sheetnames","modal","vertical","print","_setComment","textarea","onViewResize","animate","showInput","addComment","comment","showTemplate","changeTextarea","getHead","$height","rowHeight","getOption","optionHeight","bases","imt","imc","asw","rgs","dpd","cnd","exp","lnk","pnt","cmt","ignoreUndoReset","restoreHistory","_ssUndoHistory","_ssUndoCursor","addToHistory","$skipHistory","ignoreReset","step","prevData","undoHandlers","nvalue","ovalue","_trackAll","_pull","conf","viewMethods","_types","track","_trackOne","_fromRange","_isPie","_removeLegend","legend","fromData","shift","names","_getNames","switchDirection","dataSeries","legendRange","_getParts","_showAll","win","_correctPos","_showOne","_getWidth","$width","_getHeight","each","_isRange","_getDataParts","subdata","_getSeries","oldXaxis","vals","xAxis","activeVals","series","firstRange","inActiveSeries","activeVal","_getColor","colors","dataRange","subRange","_normalizeConfig","valign","scale","editUIType","querySelector","register","container","_commands","getConfig","inner","renderConfig","_processTables","query","tables","dt","oldWin","_activeWin","$destructed","_reset","_undoUI","_updateData","one","viewIds","_genChartConfig","htmlFilter","scaleColor","legendConfig","_pieConfig","pieInnerText","borderColor","lineColor","yAxis","lineShape","circle","chartEditor","handlePieLegend","getLeftColumn","getTopRow","setSilentValue","updateLegendRange","updateXaxisRange","xAxisRange","leftColumn","topRow","exist","updateAlign","updateValign","updateType","getTabbar","switchRowsCols","stacked","hideField","hideBatch","hideOption","showOption","updateSeries","pie","inValues","expand","closeEditor","outValues","activeSkin","barHeight","complexData","addRichselect","getLegendAlign","getLegendValign","process","newData","oldData","getUpdateValues","_addColumn","add_column_count","_delColumn","del_column_count","deleted","_addRow","add_row_count","_delRow","del_row_count","loadChangedData","fixSelectArea","calculate","get_core","_execute","error","isFinite","rs","vs","m","backtrak","skip_math","solvedMath","solvedCounter","applyMath","tkey","check_trigger","srow","scolumn","recalckAll","getState","recalckCell","remove_triggers","trs","back","adds","bcell","add_triggers","blist","add_backtrack","holders","setPlaceholder","psh","param","option","getConditionCss","_empty","handlers","addEmptyCollection","rowId","clearConditionalFormats","_changeCondition","pasteCondition","oldCondition","newCondition","type_action","_undoCondition","_setCssFormat","cssFormat","_ssEditors","clearEditors","pasteDropdown","dropdown","styledata","clipdata","updateFilters","ignore","$popup","tblEditors","isEditor","_clipboardToTable","cdata","fromSheet","ctrlKey","metaKey","_get_sel_style","mapSelection","allFiltersInZone","startRow","startCol","endCol","_clip_to_sel","leftTop","csv","delimiter","_changeDelimiter","record","_add_row_col","maxRow","maxCol","row_ind","col_ind","subtrans","tconfig","frozenColumns","frozenRows","_frozenColumns","_frozenRows","hasValue","_undoValue","_hidden_cols_hash","_hidden_rows_hash","isColumnVisible","setState","indexes","getIds","_showRow","_showColumn","_hideRow","_hideColumn","isRowVisible","showColumn","unselect","getColumnIndex","hideColumn","_updatePosition","h","hrows","hcols","_adjustRowHeight","headerOnly","refreshSelectArea","getColumn","_undoResize","defWidth","defHeight","nsizes","o","bs","blockStart","blockEnd","res","removeSelectArea","sortRange","fullrange","expandSelection","maxY","maxX","nr1","nr2","nc1","nc2","newrange","by","fullRow","newMath","gridlines","removeComment","getComment","removeCommentsRange","commentCell","_undoComment","modules","m1","m2","m3","m4","m5","m6","m7","uploader","XMLHttpRequest","apiOnly","accept","startImport","fileDialog","_buildHtml","doc","xCorrection","baseIndex","sheetname","$customPrint","br","insertBefore","docFooter","_cleanHtml","_safeColor","_getCellStyle","excel","stl","font","alignment","_getExcelCellStyle","_getPdfCellStyle","_getCellConditions","cached","computed","getComputedStyle","bg","rgb","fill","fgColor","horizontal","sz","italic","underline","bold","wrapText","getBorderStyles","textAlign","vertAlign","whiteSpace","_getDocStyle","$exportView","pdf","export_mode","defaultOptions","footer","heights","rawValues","_exportView","dataOnly","sheetOptions","_hidden","pdfTable","serialized","textBefore","sheetData","scheme","_getStyles","cachedConditions","_getDefaults","docHeader","delta","rIndex","cIndex","rgbToHex","_updatePdfData","colspan","rowData","exportData","rowSize","pad","paddingTop","paddingBottom","Sheet","Name","Ref","getAutowidth","prop","orientation","_excel_to_data","dataObj","styleshash","stylescount","_safeFont","va","_getBorderStyles","_getTypes","safe","_parseExcel","driver","full","_parseCsv","getRecords","clearRange","callCommand","setSize","insertRow","deleteRow","insertColumn","deleteColumn","checkSpans","spanSize","changeSpan","getIndexById","hideRow","chart","getSheetData","recalculate","registerMathMethod","addMethod","sid","spn","rangeStr","setRangeValue","addSheet","clearSheet","renameSheet","editSheet","removeSheet","und","srt","cb","tbl","ok","resetUndo","groupUndo","changeDecimals","defaultMenu","getMenuData","component","_base_index","getDefaultStyles","_sub_init","_set_handlers","$skin","setSkinDefaults","material","background","subbar","tblObj","attachTo","lists","sizeToContent","getMenuItem","contextMenu","dialogs","viewBases","rows_setter","operations","m9","m10","m11","m12","m13","m14","m16","m8","m17","m16a","m18","m19","m20","m21","m22","m23","m24","m25","m26","m27","m28","m29","m30","$onLoad","api","rco","lcl","fcl","hbr","hhd","hrc","mat","ops","cor","sav","cfm","AtomDataLoader"],"mappings":";;;;;;;;uJAAO,SAASA,EAAaC,OACtBC,EAAQ,IAAIC,KAAKF,EAAKG,cAAe,EAAG,GACxCC,EAAQJ,EAAOC,EAAmE,IAAxDA,EAAMI,oBAAsBL,EAAKK,qBAA4B,WACtFC,KAAKC,MAAMH,SAGZ,SAASI,EAAmBC,OAC5BT,EAAO,IAAIE,KAAKI,KAAKI,MAA4B,OAArBD,EAAY,OAAiB,aACxD,IAAIP,KAAKF,EAAKW,UAAuC,IAA3BX,EAAKK,qBAGhC,SAASO,EAAmBC,UACX,OAAUA,EAAOF,UAA0C,IAA7BE,EAAOR,4BACtCS,WAGhB,SAASC,EAAWC,YACvBA,GAAW,IAANA,IACPA,GAAM,EACFC,MAAMD,MAAWA,EAKhB,SAASE,EAASC,WACpBC,EAAM,GACDC,EAAI,EAAGA,EAAIF,EAAKG,OAAQD,IAChCD,EAAMA,EAAIG,OAAOJ,EAAKE,WAEhBD,EC3BR,SAASI,EAAUC,UACbA,GAAmB,IAAVA,GAAkBA,aAAiBvB,MAAUe,MAAMQ,KAChEA,EAAQjB,EAAmBiB,IAErBA,EAGR,SAASC,EAAaD,UACjBA,GAASA,aAAiBvB,OAC7BuB,EAAQb,EAAmBa,IAErBA,6hECZRE,MAAMC,KAAKC,YCDI,CACdC,OAAO,QAEI,kBACE,kBACF,iBACC,eACH,cACE,uBACO,0BACA,2BACL,2BACD,gCACG,4BACA,qCAED,iBACL,YACA,YACA,aACC,eACC,gBACA,iBACC,aACL,WACG,eAEC,cACF,aAEC,6BAEa,+BACT,gCACQ,+BACG,iCACF,kCACE,kBAEf,sBACM,4BACD,qBACC,mBAEH,mBACG,2BACC,qCACH,wCAEM,iCACD,yBACC,0BACA,6BACG,gCACA,0BAEN,8BACE,kCAEA,+BACA,gCACA,WAEZ,oBAEU;qBACM,6DACN,uBACD,wCACK,iCAEN,uBACD,kBACD,YAEH,yBACQ,8BACD,wBAEP,wBACO,0BACJ,0BAEA,gBACF,+BAEc,gFACA,8EACH,6EACN,gCAEP,sBACM,sCACG,iCACH,4BACC,yBACC,6BACH,uBACD,4BACC,+BACC,+BACF,yBACH,6BACK,mBACJ,2BACA,8BACG,2BACC,8BACE,4BACC,oBAEP,gBAEF,eACC,uBACM,gCACA,+BAEH,qBACE,sBACD,4BAEE,wBACA,wBACA,uBAED,6BACI,iCACA,gCACE,0BAEP,oBACA,mBACD,oBACE,oBACF,oBACE,uBACC,4BACI,2BAEN,qBACC,4BACM,kCACA,mCACA,iCACF,6CACA,2CACE,6BAEL,4BACI,2CACA,iDACE,oCACA,4BACD,4BACC,8BACC,+BACA,oCACH,4BACG,+BACA,sBAET,uBACG,wBACF,6BACO,mBACV,wBACE,uBACG,6BAEE,mCACF,uBACH,uBAEG,iCACO,kCACE,mCACD,gCACF,yBAEL,oCACF,0BAEM,iBAEtBC,SAAU,OACA,wBACK,iCACC,0BACF,yBACC,oCACI,yBACP,uBACG,+BACE,4BACD,6BACE,gCACC,8BACH,8BACE,qCACK,yCACL,4BACH,4BACE,6BACD,0BACF,2BACG,8BACA,oBACR,aACA,iBACA,YACA,cACE,oCACU,8CACA,wCACL,oBACD,2BACK,6BACD,qCACF,oCACC,yCACE,sCACN,8CACE,qCACF;YACA,yBACJ,mBACG,eACL,cACG,gBACD,oBACI,wBACI,sBACF,WAEhBC,MAAM,gBACW,8BACA,oBACR,aACD,kBACM,2BACG,mCACA,wBACP,sBACK,yBACN,YACA,YACA,eACG,0BACM,gCACA,8BACF,4BACA,8BACE,qBACT,oBACM,0BACA,wBACF,sBACA,wBACE,oBACJ,8BACY,2BACb,sBACK,uBACA,qCACc,+CACH,yCACR,uBACL,YACH,yBACQ,8BACD,wBACP,wBACO,0BACJ,uBACJ,kBACI,uBACC,oBACL,kBACI,0BACC,mBACL,wBACU,wCACH,wCACG,qCACF,oCACC,uCACD,2BACH,yBACJ,sBACK,WAEfC,MAAM,cACQ,uBACE,oBAEhBC,WAAW,MACH,SAERC,QAAQ,YACO,wBACA,6BACI,8BACA,uCACD,8BACJ,aCjTfR,MAAMS,QAAQ,CACbC,KAAM,eACNC,SAAS,aACTC,MAAO,SAASC,GACfA,EAAOC,QAAW,CACjBC,KAAK,cACLC,KAAK,CACJD,KAAM,eACNE,QAAS,CACRC,SAAS,aAEVC,OAAO,EAAGC,OAAO,GAElB5B,KAAMqB,EAAOrB,QAGdQ,MAAMqB,GAAGC,YChBXtB,MAAMS,QAAQ,CACbC,KAAM,yBACNa,SAAS,CACRC,MAAO,KAERZ,MAAO,SAASC,GACfA,EAAOG,KAAO,CACbS,OAAQ,EACRC,KAAK,CACJ,CAAEX,KAAM,eAAgBY,QAAQ,EAAOC,QAAQ,EAC9CT,OAAQ,EACRC,OAAQ,EACRH,QAAS,CACRC,SAAU,SAASW,UACX7B,MAAMC,KAAKC,YAAYE,SAAS,WAAWyB,EAAIC,MAGxDC,GAAG,CACFC,cAAe,WACAC,KAAKC,gBAAgBA,gBAC3BC,mBAAkB,KAG5BjB,SAAU,SAASW,SAEX,iBADG,0DAA0DA,EAAI/B,OAC7C,aAE5BN,KAAMqB,EAAOrB,MAEd,CAAEuB,KAAM,oBACR,CACCqB,KAAK,CACJ,CAAErB,KAAM,eAAgBsB,IAAKxB,EAAOwB,IAAK3B,KAAMG,EAAOH,KAAMc,MAAO,GAClE1B,MAA2B,YAApBE,MAAMsC,KAAKC,MAAsB,UAAY,UACpDtB,QAASjB,MAAMC,KAAKC,YAAYE,SAAS,iBACzCoC,MAAO,8CACPT,GAAG,CACFU,SAAU,WACKR,KAAKC,gBAAgBA,gBAAgBA,gBAC3CC,mBAAkB,MAI7B,CACCpB,KAAM,aAAcsB,IAAI,2BAA4BvC,MAAM,OAAQ4C,QAAQ,CACzEC,WAAU,EACVnB,MAAM,IACNa,IAAK,uBACLrB,KAAM,CACLE,SAAS,oEAEV1B,KAAK,CACJ,CAAEsC,GAAG,QACL,CAAEA,GAAG,UACL,CAAEA,GAAG,SACL,CAAEA,GAAG,UACL,CAAEA,GAAG,UACL,CAAEA,GAAG,aAIR,QAOLK,kBAAmB,SAASS,OACvB9C,EAAQmC,KAAKY,WACJ7C,MAAM8C,GAAGb,KAAKpB,OAAOkC,QAC3BC,SAASlD,GACb8C,GACFX,KAAKW,QAEPI,SAAU,SAASlD,GACfA,EAAM,IACRmC,KAAKgB,UAAUrB,OAAO9B,EAAM,IAC1BA,EAAM,IACRmC,KAAKiB,eAAeF,SAASlD,EAAM,IACjCA,EAAM,IACRmC,KAAKkB,cAAcH,SAASlD,EAAM,KAEpC+C,SAAU,iBACF,CAACZ,KAAKgB,UAAUG,gBAAiBnB,KAAKiB,eAAeL,YAAY,GAAIZ,KAAKkB,cAAcN,YAAY,KAE5GI,QAAS,kBACDhB,KAAKoB,UAAUC,gBAAgB,IAEvCJ,aAAc,kBACNjB,KAAKoB,UAAUC,gBAAgB,GAAGA,gBAAgB,IAE1DH,YAAa,kBACLlB,KAAKoB,UAAUC,gBAAgB,GAAGA,gBAAgB,IAE1DC,YAAY,iBACJ,8EAEPvD,MAAMqB,GAAGqB,SAEX1C,MAAMS,QAAQ,CACbC,KAAM,iBACNC,SAAU,aACVC,MAAO,SAASC,GACfA,EAAOC,QAAU,CAChBC,KAAM,yBACN4B,WAAW,EACXnD,KAAMqB,EAAOrB;KAGTgE,OAAOC,KAAKzD,MAAM0D,KAAK,gBACtBC,WAAW9C,OAAOkC,OAASd,KAAKpB,OAAOiB,IAC3CG,QAGHe,SAAU,SAASlD,UACfE,MAAM4D,QAAQ9D,KACZmC,KAAKpB,OAAOf,OAASA,EAAM,IAAOmC,KAAKpB,OAAOf,MAAM,IAAMA,EAAM,IAAOmC,KAAKpB,OAAOf,MAAM,SACvF6D,WAAWX,SAASlD,SAErBe,OAAOf,MAAQA,GACV,IACTmC,KAAK4B,UAAU,aAEV/D,GAER+C,SAAU,kBACDZ,KAAK0B,WAAWd,WAAWiB,KAAK,MAEzCb,QAAS,kBACDhB,KAAK0B,WAAWN,UAAUC,gBAAgB,IAElDJ,aAAc,kBACNjB,KAAK0B,WAAWN,UAAUC,gBAAgB,GAAGA,gBAAgB,KAEpEtD,MAAMqB,GAAGC,YCtIXtB,MAAMS,QAAQ,CACbE,SAAU,aACVD,KAAM,oBACNa,SAAS,CACRwC,OAAO,IACPvC,MAAM,IACNa,IAAK,0BACL2B,KAAK,UACLC,QAAS,CACR,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WACpG,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WACpG,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WACpG,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WACpG,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WACpG,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WACpG,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WACpG,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,aAGtGrD,MAAM,gBACAsD,YAAY,WAAY,SAASpE,QAChCoC,gBAAgBiC,eAAe,CAAErE,MAAMA,QAG5CE,MAAMqB,GAAG+C,YAEZpE,MAAMS,QAAQ,CACbE,SAAU,aACVD,KAAM,eACNa,SAAS,CACRc,IAAK,qBACLgC,KAAM,gBACN3B,QAAQ,CACP4B,YAAY,EACZtD,KAAK,CACJD,KAAM,uBAITH,MAAO,gBACD2D,MAAMC,WAAa,uBAEzBC,aAAc,SAAS5D,EAAQ6D,EAAU5C,OACpC6C,EAAS1C,KAAK2C,YAAYC,KAAK5C,aACnCyC,EAAWA,EAASI,QAAQ,sBAAuB,SAASC,EAAOC,EAAIC,EAAIC,UACnEF,EAAGnE,EAAO2B,MAAOmC,EAAMO,IAGxBlF,MAAMqB,GAAG8D,YAAYC,UAAUX,aAAaI,KAAK5C,KAAKpB,EAAQ6D,EAAU5C,IAEhFuD,UAAW,SAASvF,GAGnBA,EAAQA,GAAS,GAFJE,MAAM8C,GAAGb,KAAKpB,OAAOyE,MAAMnG,YACjBkE,UAEZL,SAASlD,QACfe,OAAOf,MAAQA,OACfyF,eAAeC,MAAMC,gBAAkB3F,GAE7C8E,YAAa,iBACL,8DAA8D3C,KAAKpB,OAAOf,MAAM,cAExFyF,aAAc,kBACNtD,KAAKsC,MAAMmB,WAAWA,WAAWC,WAAW,IAEpDC,YAAY,kBACJ5F,MAAMqB,GAAGwE,KAAKT,UAAUQ,YAAYE,MAAM7D,KAAK8D,aAEtD/F,MAAMqB,GAAG8D,aLpDXnF,MAAMS,QAAQ,CACbE,SAAU,aACVD,KAAM,oBACNmC,SAAS,kBAED9C,EADOC,MAAMqB,GAAG2E,WAAWZ,UAAUvC,SAASiD,MAAM7D,QAC7B,IAE/BgE,cAAc,SAASnG,UACtBA,EAAQD,EAAUC,GACXE,MAAMqB,GAAG2E,WAAWZ,UAAUa,cAAcH,MAAM7D,KAAM,CAACnC,MAE/DE,MAAMqB,GAAG2E,YAEZhG,MAAMS,QAAQ,CACbE,SAAU,kBACVD,KAAM,yBACNmC,SAAS,eACJ/C,EAAQE,MAAMqB,GAAG2E,WAAWZ,UAAUvC,SAASiD,MAAM7D,aACrDnC,KACHA,EAAQE,MAAMkG,KAAKpG,IACbxB,MAAQyB,EAAaD,EAAMxB,OACjCwB,EAAMqG,IAAMpG,EAAaD,EAAMqG,MAEzBrG,GAAS,IAEjBmG,cAAc,SAASnG,UACjBA,EAGKA,EAAMxB,OAAUwB,EAAMqG,MAC/BrG,EAAQ,CAAExB,MAAMwB,IAHhBA,EAAQ,CAAExB,MAAM,KAAM6H,IAAI,MAK3BrG,EAAMxB,MAAQuB,EAAUC,EAAMxB,OAC9BwB,EAAMqG,IAAMtG,EAAUC,EAAMqG,KAErBnG,MAAMqB,GAAG+E,gBAAgBhB,UAAUa,cAAcH,MAAM7D,KAAM,CAACnC,MAEpEE,MAAMqB,GAAG+E,uBMrDN3F,QAAQ,CACbE,SAAU,SACVD,KAAM,gBACNE,MAAO,SAASC,QACV0D,MAAMC,WAAa,4BACnB3D,OAAOwF,QAAUxF,EAAOwF,aACxBxF,OAAOyF,OAAQ,GAErBC,cAAe,SAASC,GACvBA,EAAQlC,YAAa,MACjBmC,EAAWxE,KAAKyE,gBAAgBF,SACvB,CACZzF,KAAM,OACNsB,IAAK,oBACLsE,QAAS3G,MAAMsC,KAAKsE,QAAQC,cAAcC,KAC1CL,SAAUA,IAIZC,gBAAiB,SAASF,OACrBC,SACDzG,MAAM4D,QAAQ4C,GAChBC,EAAUD,GAEVC,EAAW,IACFhD,KAAK+C,GAEZvE,KAAKpB,OAAOwF,UACdI,EAAShD,KAAK,CAACM,OAAO,IACtB0C,EAAShD,KAAM,CACdhC,OAAQ,GACRC,KAAK,CACJ,GACA,CAACX,KAAM,SAAUsB,IAAK,uBAAwB0E,MAAO/G,MAAMC,KAAKC,YAAYC,OAAO6G,OAAQC,WAAU,EAAMC,MAAO,WAChGjF,KAAKkF,mBACXtD,UAAU,gBAAgB,MAEtC,CAAC9C,KAAM,SAAUgG,MAAO/G,MAAMC,KAAKC,YAAYC,OAAOiH,KAAMC,OAAQ,QAASJ,WAAU,EAAMC,MAAO,WAClFjF,KAAKkF,mBACXtD,UAAU,cAAc,UAKhC4C;AAERa,YAAa,SAASxH,SACF,UAAhByH,EAAOzH,KACNE,MAAMwH,YAAY1H,EAAM6G,WAC1B7G,EAAM6G,QAAU3G,MAAMsC,KAAKsE,QAAQC,cAAcC,MACjC,QAAdhH,EAAMiB,MAAkBjB,EAAM2G,UAChC3G,EAAM2G,SAAWxE,KAAKyE,gBAAgB5G,EAAM2G,UACxC3G,EAAMuC,MACTvC,EAAMuC,IAAM,sBAGbvC,EAAQmC,KAAKsE,cAAczG,IAGtBE,MAAMqB,GAAGoG,OAAOrC,UAAUkC,YAAYzC,KAAK5C,KAAKnC,IAExDyB,SAAS,CACRmG,MAAK,EACLC,KAAM,SACNtB,SAAS,EACTC,OAAM,EAENsB,WAAU,EACVpG,MAAO,MAENxB,MAAMqB,GAAGoG,OAAQzH,MAAM6H,SAI1B7H,MAAMS,QAAQ,CACbE,SAAU,YACVD,KAAM,sBACNE,MAAO,SAASC,GACXA,EAAOiH,kBACVjH,EAAOiH,gBAAkB,SACrBvD,MAAMC,WAAa,+BAExBxE,MAAMqB,GAAG0G,WClFX/H,MAAMS,QAAQ,CACbC,KAAM,oBACNa,SAAS,CACRoF,QAAQ,EACRrC,YAAY,GAEb1D,MAAO,gBACD2D,MAAMC,WAAa,uBAEvBxE,MAAMqB,GAAGqB,SAEZ1C,MAAMS,QAAQ,CACbC,KAAM,sBACNa,SAAS,CACRoF,QAAQ,EACRrC,YAAY,GAEb1D,MAAO,gBACD2D,MAAMC,WAAa,0BAEvBxE,MAAMqB,GAAGqB,SAEZ1C,MAAMS,QAAQ,CACbE,SAAU,cACVD,KAAM,qBACNE,MAAO,gBACD2D,MAAMC,WAAa,6BAEzBjD,SAAS,CACRmB,QAAQ,CACP4B,YAAY,EACZtD,KAAK,CACJD,KAAM,wBAIPf,MAAMqB,GAAG8D,aCpCZnF,MAAMS,QAAQ,CACbC,KAAK,WACLsC,SAAS,SAASgF,UAAW/F,KAAKgG,QAAQD,IAC1CnF,SAAS,iBAAmB,KAC1B7C,MAAMqB,GAAGH,UCJZlB,MAAMS,QAAQ,CACbC,KAAK,eACLC,SAAU,WACVC,MAAO,gBACD2D,MAAMC,WAAa,0BAEzBjD,SAAS,CACR+C,YAAY,EACZpD,SAAU,wDACV8C,KAAK,CACJxC,MAAO,GACPuC,OAAQ,MAGT/D,MAAMqB,GAAG6G,UCdXlI,MAAMS,QAAQ,CACbC,KAAM,iBACNa,SAAS,CACRoF,QAAQ,EACRtE,IAAK,yBAELrC,MAAMqB,GAAG8G,aCNXnI,MAAMS,QAAQ,CACbC,KAAM,kBACNa,SAAU,CACToB,WAAW,EACXnB,MAAO,IACP4G,gBAAOC,EAAMvI,OACNwI,EAAStI,MAAM8C,GAAGb,KAAKpB,OAAOkC,QAC9BwF,EAASD,EAAOE,eAAeC,eAC/BC,EAAMJ,EAAOzF,cAEE,MAAlB6F,EAAIC,OAAO,QAEVC,EAAOF,EAAIG,UAAU,EAAGN,GAAQxD,MAAM,gBACtC+D,EAAOJ,EAAIC,OAAOJ,GAAQQ,OAAO,uBAElCH,GAASL,IAAWG,EAAI/I,QAAmB,IAATmJ,IACpChJ,EAAQ8I,EAAK,IAE8D,IAArEP,EAAKvI,MAAMX,WAAW6J,cAAcC,QAAQnJ,EAAMkJ,kBAG3DpI,iCACMsD,YAAY,eAAgB,SAACgF,MAC9BA,EAAKC,QAAQ,KACTb,EAAStI,MAAM8C,GAAGsG,EAAKvI,OAAOkC,QAC9B8C,EAAOyC,EAAOzF,eAGhBgD,GAA2B,MAAnBA,EAAK8C,OAAO,GAAY,OAAO,MAErCU,EAAQrJ,MAAMsJ,KAAKC,OAAOL,GAE1BT,EAAiBH,EAAOE,eAAeC,eACvCe,EAAYxJ,MAAMsJ,KAAKG,YAAY5D,EAAKgD,UAAU,EAAGJ,GAAiB,wBAAwBjH,MAE9FkI,EAAIL,EAAMK,EAAIL,EAAMtF,OACpB4F,EAAIN,EAAMM,EAAIH,SAEpBxJ,MAAMqB,GAAGiE,MAAMF,UAAUwE,KAAK9D,MAAMsD,EAAM,CAAC,CAACO,EAAAA,EAAGD,EAAAA,MACxC,MAIVvF,wBAAe3E,EAAMqK,OACdhE,EAAOrG,EAAKsC,GAAKG,KAAKsB,YAAY/D,EAAKsC,IAAOtC,EAAKqG,MAAMrG,EAAKM,MACpEE,MAAM8C,GAAGb,KAAKpB,OAAOkC,QAAQ+G,aAAajE,GAErCgE,GACJ5H,KAAKW,MAAK,QAENiB,UAAU,iBAAkB,CAACrE,EAAMqG,KAEzCkE,UAAW,cACN9H,KAAK+H,YACR,OAAOhK,MAAMqB,GAAGqB,QAAQ0C,UAAU2E,UAAUjE,MAAM7D,KAAM8D,aAExD/F,MAAMqB,GAAGqB,SCxDZ,IAAMuH,EAAQ,CACbnK,MAAO,KACPoK,IAAK,SAASC,EAAQpH,GACjBd,KAAKnC,MAMRqK,EAAOtF,KAAK9B,SALPzE,QACL6L,EAAOtF,KAAK9B,QACPoD,QAKP7H,sBACMwB,MAAQE,MAAMoK,OAEpBjE,oBACMrG,MAAQ,OC0BR,SAASsH,EAAKrG,EAAML,EAAMlB,OAE5B6K,EADAjD,EAAOrG,EAAKF,OAAOuG,QAElBA,MAEM,OAAR1G,EAAc,KACZ0G,EAAKkD,IACR,OACD9K,EAAO,CAAEA,KAAMuB,EAAKwJ,UAAU,CAAEC,QAAQ,KACxCH,EAAMjD,EAAKkD,SAGXD,EAAsB,iBAATjD,EAAoBA,EAAO,IAAM1G,EAAO0G,EAAK1G,MAG3D2J,EAAMrK,MAAMyK,MAAMC,OAAOL,GAElB,IACa,mBAARA,EACV,OAAOA,EAAI3J,EAAMlB,MAEd6K,EAAIM,QAAUN,EAAIjD,KACrB,OAAOiD,EAAIjD,KAAKrG,EAAMvB,EAAM,KAAM,UAE/BoL,EAAO5K,MAAM4K,OACJ,QAATlK,GACHkK,EAAKC,QAAQ,gBAAmB,qBACjCD,EAAKE,KAAKT,EAAK7K,KChEjB,8BDJO,SAASuL,GAAKhK,WAmBhBiK,EAlBEC,EAAS,CACd,CAACvK,KAAK,aAAcsD,KAAK,UACzB,CAACtD,KAAK,gBAAiBsD,KAAK,UAC5B,CAACtD,KAAK,gBAAiBsD,KAAK,UAC5B,CAACtD,KAAK,gBACN,CAACA,KAAK,iBACN,CAACA,KAAK,YACN,CAACA,KAAK,kBACN,CAACA,KAAK,qBACN,CAACA,KAAK,uBACN,CAACA,KAAK,mBACN,CAACA,KAAK,eACN,CAACA,KAAK,gBACN,CAACA,KAAK,gBAAiBK,KAAM,SAC7B,CAACL,KAAK,cAAeK,KAAM,SAC3B,CAACL,KAAK,iBAAkBK,KAAM,qBAItBrB,OACFwL,EAAUD,EAAOvL,IACtBwL,EAAQnK,KAAOA,EAAK+B,GAAGoI,EAAQnK,MAAQA,GAAMmD,YAAYgH,EAAQxK,KAAM,SAASA,EAAMyK,OAGlFC,EAFArK,EAAKsK,gBAIRD,EADEF,EAAQlH,KACe,UAAhBkH,EAAQlH,KAAmB,CAACkH,EAAQlH,KAAMmH,EAASzK,GAAQ,CAACwK,EAAQlH,KAAMtD,GAE1E,CAAC,SAAUK,EAAKuK,kBAE1BC,aAAaP,GACbA,EAAShL,MAAMwL,MAAM,kBAAMzK,EAAK8C,UAAU,WAAYuH,SAZ/C1L,EAAI,EAAGA,EAAIuL,EAAOtL,OAAQD,MAA1BA,GAgBTqB,EAAKmD,YAAY,WAAY,WAC5BkD,EAAKrG,EAAM,mBCrCA0K,EAAS;AACTC,EAAS,GAEhBC,EAAQ,6BACLjM,EAAE,EAAGA,EAAE,IAAMA,IAAI,KACrBkM,EAAcC,UAAUnM,EAAE,GAAGiM,EAAMhM,QACnCmM,GAAOF,EAAYD,EAAMC,EAAY,GAAG,IAAID,GAAOjM,EAAE,GAAIiM,EAAMhM,QAEnE8L,EAAOK,GAAOpM,EACdgM,EAAOhM,GAAKoM,EAMN,SAASC,EAAOlG,OAClBmG,EAAQnG,EAAKoG,WAAW,GAAK,GAAM,EAAI,EACvCC,EAAMrG,EAAKsG,OAAO,EAAGH,SAGlB,CAAK,EAFFnG,EAAKsG,OAAOH,GAEPP,EAAOS,IAGhB,SAASE,EAAMvG,EAAM9E,OACvBsL,EAAOxG,EAAKoD,QAAQ,KACpBqD,EAAQ,IAGE,IAAVD,IAEc,OADjBC,EAAQzG,EAAKsG,OAAO,EAAGE,IACb,KACTC,EAAQA,EAAMH,OAAO,EAAGG,EAAM3M,OAAO,IACtCkG,EAAOA,EAAKsG,OAAOE,EAAK,QAGrBE,EAAQ1G,EAAK2G,MAAM,QACH,GAAhBD,EAAM5M,QAAeoB,EAAK,MAC7B8E,EAAO9E,EAAK0L,OAAOC,QAAQ7G,EAAMyG,IACtB,OAAO,KAClBC,EAAQ1G,EAAK2G,MAAM,SAGhBG,EAAKZ,EAAOQ,EAAM,IAClBK,EAAKb,EAAOQ,EAAM,UACf,CAACI,EAAG,GAAIA,EAAG,GAAIC,EAAG,GAAIA,EAAG,GAAIN,GAhCrCZ,EAAO,GAAGA,EAAO,GAoCjB,IAAImB,EAAc,eAClB,SAASC,EAAYjH,UAChBgH,EAAYE,KAAKlH,cACTA,OACLA,EAGD,SAASmH,EAAQrD,EAAED,EAAEuD,EAAGC,EAAGZ,UACzBA,EAAOQ,EAAYR,GAAO,IAAK,IAAIZ,EAAOhC,GAAGC,EAAE,IAAI+B,EAAOwB,GAAID,EAMhE,SAASE,EAAStH,EAAM9E,MACV,WAAhBwG,EAAO1B,GAAmB,OAAOA,MACjCmC,EAAIoE,EAAMvG,EAAM9E,SACb,CAAEzC,MAAM,CAAE8O,IAAIpF,EAAE,GAAIqF,OAAOrF,EAAE,IAAK7B,IAAI,CAAEiH,IAAIpF,EAAE,GAAIqF,OAAOrF,EAAE,IAAMsE,MAAOtE,EAAE,IAG3E,SAASsF,EAAUzH,EAAM9E,EAAMwM,EAAU/N,WAC3C4M,EAAQe,EAAStH,GACZuH,EAAMhB,EAAM9N,MAAM8O,IAAKA,GAAOhB,EAAMjG,IAAIiH,IAAKA,QAChD,IAAIC,EAASjB,EAAM9N,MAAM+O,OAAQA,GAAWjB,EAAMjG,IAAIkH,OAAQA,IAClEE,EAASxM,EAAM,CAACqM,IAAKA,EAAKC,OAAQA,GAAS7N,GAK9C,IAAIgO,EAAY,sDACT,SAASC,EAAQ5H,UAChB2H,EAAUT,KAAKlH,GAGhB,SAAS6H,EAAY7H,EAAKnF,EAAKiN,EAAIrP,OACrCsP,GAAU,KAEXH,EAAQ5H,GAAM,SACUuG,EAAMvG,MAA3BgI,OAAGC,OAAGC,OAAGC,OAAG1B,UAGTyB,EAALF,SACS,CAACE,EAAIF,GAAfA,OAAIE,UACEC,EAALF,SACS,CAACE,EAAIF,GAAfA,OAAIE,UAEO,QAATtN,GAAkBpC,EAAM8O,KAAOW,EAAG,KACjCJ,EAAM,GAAKrP,EAAM8O,IAAMS,GAAc,EAANF,GAAWrP,EAAM8O,KAAOS,KAC1DA,GAAMF,IACPI,GAAMJ,GAEAE,EACL,MAAO,GAERD,GAAU,OAEN,GAAa,WAATlN,GAAqBpC,EAAM+O,QAAUW,EAAG,KAC5CL,EAAM,GAAKrP,EAAM+O,OAASS,GAAc,EAANH,GAAWrP,EAAM+O,QAAUS,KAChEA,GAAMH,IACPK,GAAML,GAEAG,EACL,MAAO,GAERF,GAAU,EAERA,IACF/H,EAAOmH,EAAQa,EAAGC,EAAGC,EAAGC,EAAG1B,WAGtBzG,MCtHKoI,EAAe,CAC3BzM,MAAM,GACNC,OAAQ,EACRyM,SAAU,EACVC,cAAe,EACfC,aAAc,GAIFC,EAAgB,OACV,qBACA,wBACA,gCACJ,oBACA,wBACI,uBACH,gBACL,UCVJ,IAAMC,EAAc,CAC1B,QAAQ,aAAa,aACrB,cAAc,YACd,aAAa,kBAAkB,cAC/B,iBAAkB,OAAQ,UAAW,SACrC,eAAgB,gBAAgB,cAAe,cAG1CC,EAAa,cACJ,CACbC,KAAM,iBAAM,+BACZC,OAAQ,iBAAM,2BACdC,MAAO,iBAAM,+CAEI,CACjBC,IAAK,iBAAM,2BACXC,OAAQ,iBAAM,uBACdC,OAAQ,iBAAM,0BAEfC,KAAM,CACLA,KAAM,iBACE,kDAGM,SAAAjN,UACPkN,EAAa,cAAelN,iBAEtB,SAAAA,UACNkN,EAAa,aAAclN,mBAEnB,SAAAA,UACRkN,EAAa,eAAgBlN,oBAEpB,SAAAA,UACTkN,EAAa,gBAAiBlN,kBAEvB,SAAAA,SAEW,QAAtBA,EAAI,eAIA,GAFC,gBAA4B,yBADpBA,EAAI,gBAAkBwM,EAAc,gBACS,IAAM,KAAO,MAM5E,SAASU,EAAaC,EAAKnN,OACtBoN,EAASpN,EAAImN,MACdC,EAAO,SACWA,EAAOzC,MAAM,QAA5B7H,OAAOX,OAGRgI,EAAO,YACA,WAFXhI,EAAOA,GAAQ,QAGdgI,EAAO,MACQ,SAARhI,GAA2B,UAARA,IAC1BgI,EAAO,QAEyC,GAA9C,CAAC,OAAQ,SAAU,SAAS/C,QAAQjF,KACtCA,EAAO,mBAEEgL,eAAQhD,cAAQhI,cAAQW,wBAE5B,GAGR,IAmCIuK,EAnCEC,EAAgB,eACL,SAASC,EAAMC,EAAMC,UAAcF,EAAK/B,QAAUgC,EAAK/Q,MAAM+O,QAAiB,MAAPiC,kBACtE,SAASF,EAAMC,EAAMC,UAAcF,EAAK/B,QAAUgC,EAAKlJ,IAAIkH,QAAkB,OAARiC,GAAwB,MAAPA,gBACxF,SAASF,EAAMC,EAAOC,UAAcF,EAAKhC,KAAOiC,EAAK/Q,MAAM8O,KAAc,MAAPkC,mBAChE,SAASF,EAAMC,EAAMC,UAAcF,EAAKhC,KAAOiC,EAAKlJ,IAAIiH,KAAe,OAARkC,GAAuB,MAAPA,IAG3FC,EAAkB,SACZ,SAASxO,EAAMyE,EAAO1F,EAAOsP,OACjCC,EAAOtO,EAAK+B,GAAG,SAAS0M,gBAExBxL,GADNlE,EAAQA,EAAM0M,MAAM,MACD,GACf7H,EAAQ7E,EAAM,GACd2P,EAAY3P,EAAM,GAElB4P,EAAQ,CAAC,cAAe,eAAgB,gBAAiB,cAElD,cAAR1L,EACF0L,EAAQ,CAAC,aAAa,iBAEN,MAAR1L,GAAwB,OAARA,GAAyB,SAARA,IACzC0L,EAAQ,CAAC,UAAU1L,QAEf,IAAItE,EAAI,EAAGA,EAAIgQ,EAAM/P,OAAQD,IAAI,KACjC4P,EAAOI,EAAMhQ,OAEF,IADFqB,EAAK8C,UAAU,WAAY,CAAC,gBAAiB,CAACuJ,IAAIgC,EAAKhC,IAAKC,OAAO+B,EAAK/B,OAAQgC,KAAAA,EAAMrL,KAAAA,EAAMsL,KAAAA,MAClFH,EAAcG,GAAMF,EAAMC,EAAMrL,GAEtDwB,EAAQmK,EAAa5O,EAAMyE,EAAO8J,EADX,MAARtL,EAAe,aAAQW,cAAS8K,GACCL,UAG3C5J,IAqBT,SAASoK,EAAM7O,GACdA,EAAK8O,QAAU,GACf9O,EAAK+O,cAAgB,GACrB/O,EAAKgP,YAAc,MAEfC,EAAS,QAAQjP,EAAKkP,OAC1BjQ,MAAMsJ,KAAK4G,YAAYF,GAGjB,SAASG,EAASpP,EAAMqO,OACxBgB,EAASrP,EAAKsP,OAAOjB,EAAKhC,KAAKkD,SAC/BC,EAAOxP,EAAK+B,GAAG,SAAS0N,QAAQpB,EAAKhC,IAAKgC,EAAK/B,WAElDkD,UACIE,EAAaF,EAAK,GAAG/D,MAAM,KACxB9M,EAAI,EAAGA,EAAI+Q,EAAW9Q,OAAQD,IAAI,KACpCgR,EAAY3P,EAAK8O,QAAQY,EAAW/Q,OACvCgR,EACF,OAAOA,KAINN,EAAO,KACJO,EAAUP,EAAOhB,EAAK/B,WACxBsD,EACH,OAAO5P,EAAK8O,QAAQc,UAEf,KAkBD,SAASC,EAAS7P,EAAM8P,EAAOC,OACjCtL,EAAQ,CACXqL,MAAME,GAAe,uBAGlBD,EACH,IAAK,IAAIE,KAAOF,EAAOD;CACtBrL,EAAMqL,MAAMG,GAAOF,EAAOD,MAAMG,OAE7B,IAAKA,KAAOH,EAChBrL,EAAMqL,MAAMG,GAAOH,EAAMG,GAG1BxL,EAAMK,KAAOoL,GAAazL,OACtB0L,EAAQnQ,EAAK+O,cAActK,EAAMK,aACjCqL,IAGJC,GAAUpQ,EAAMyE,GAETA,GAGR,SAAS4L,EAAOrQ,EAAMc,MACjBA,EAAIuO,OACP,IAAK,IAAI1Q,EAAE,EAAGA,EAAImC,EAAIuO,OAAOzQ,OAAQD,IAAI,KACpC2R,EAAWxP,EAAIuO,OAAO1Q,GAO1ByR,GAAUpQ,EANE,CACXe,GAAIuP,EAAS,GACbxL,KAAKwL,EAAS,GACdR,MAAOE,GAAeM,EAAS,MAGT,OAGpB,IAAI3R,EAAI,EAAGA,EAAImC,EAAIrC,KAAKG,OAAQD,IAAI,SACbmC,EAAIrC,KAAKE,MAA/B0N,OAAKC,OAAUhL,OAEhBA,GACHiP,EAAkBvQ,EAAMqM,EAAKC,EAAQtM,EAAK8O,QAAQxN,KAsBrD,SAASsN,EAAa5O,EAAMyE,EAAO9E,EAAMZ,EAAOsP,MAE5CG,EAAgB7O,UACX6O,EAAgB7O,GAAMK,EAAMyE,EAAO1F,EAAOsP,MAG9C5J,GAASA,EAAMqL,MAAMnQ,IAASZ,EAAO,OAAO0F,MAE5C+L,EAAS,CAAE1L,KAAK,GAAI/D,GAAG,EAAG+O,MAAQrL,EAAMxF,MAAMkG,KAAKV,EAAMqL,OAAO,IACpEU,EAAOV,MAAMnQ,GAAQZ,EACrByR,EAAO1L,KAAOoL,GAAaM,OAEvBL,EAAQnQ,EAAK+O,cAAcyB,EAAO1L,aAClCqL,IAGJC,GAAUpQ,EAAKwQ,GAERA,GAGR,SAASD,EAAkBvQ,EAAMqM,EAAKC,EAAQ7H,OACvC6C,EAAOtH,EAAKsP,OAAOjD,GAEzB/E,EAAKiI,SAAWjI,EAAKiI,UAAY,GACjCjI,EAAKmJ,YAAcnJ,EAAKmJ,aAAe,GAEpChM,GACF6C,EAAKiI,SAASjD,GAAU7H,EAAM1D,GAC9BuG,EAAKmJ,YAAYnE,GAAU7H,EAAMqL,MAAMY,QAAU,cAE1CpJ,EAAKiI,SAASjD,UACdhF,EAAKmJ,YAAYnE,IAInB,SAASqE,EAAS3Q,EAAMqO,EAAM5J,UAE7BmM,GAAU5Q,EAAMqO,EAAM5J,EADnB2K,EAASpP,EAAMqO,IAInB,SAASwC,EAAc7Q,EAAMqL,EAAO5G,GAC1C8H,EAAUlB,EAAOrL,EAAM4Q,GAAWnM,GAG5B,SAASiE,EAAY1I,EAAM8E,EAAMxD,EAAKwP,GAC5C3C,EAAO4C,UAAYjM,EACnBqJ,EAAO1J,MAAMhE,MAAQqQ,EAAYA,EAAU,KAAO,OAElD3C,EAAO1K,UAAY,+BAA+BnC,EAClDtB,EAAKgR,OAAOxN,MAAMyN,YAAY9C,OAExB1N,EAAQ7C,KAAKsT,IAAI,EAAG/C,EAAOgD,YAAY,GACvCnO,EAASpF,KAAKsT,IAAI,EAAG/C,EAAOiD,aAAa,UAE/CpR,EAAKgR,OAAOxN,MAAM6N,YAAYlD,GAC9BA,EAAO4C,UAAY,GAEZ,CAAEtQ,MAAAA,EAAOuC,OAAAA,GAGjB,SAAS4N,GAAU5Q,EAAMqO,EAAM5J,EAAO6M,GACrCpI,EAAMC,IAAI,cACNnJ,EAAK8C,UAAU,sBAAuB,CAACuL,EAAKhC,IAAKgC,EAAK/B,OAAQ7H,EAAO6M,IAAM,KACvEZ,EAASjM,GAASA,EAAMqL,MAAMY,QAAU,KACxCa,EAAYD,GAAOA,EAAIxB,MAAMY,QAAU,KACvCc,EAAgBd,GAAUa,IAC5BC,GAAiBA,GAAiBxR,EAAK8C,UAAU,uBAAwB,CAACuL,EAAKhC,IAAKgC,EAAK/B,OAAQoE,EAAQa,OAC5GhB,EAAkBvQ,EAAMqO,EAAKhC,IAAKgC,EAAK/B,OAAQ7H,GAC/CzE,EAAK8C,UAAU,gBAAiB,CAACuL,EAAKhC,IAAKgC,EAAK/B,OAAQ7H,EAAO6M,IAE5DE,GACFxR,EAAK8C,UAAU,iBAAkB,CAACuL,EAAKhC,IAAKgC,EAAK/B,OAAQoE,EAAQa,IAElEvR,EAAKyR,SAASpD,EAAKhC,IAAIgC,EAAK/B,YAyBhC,SAAS8D,GAAUpQ,EAAMyE,EAAOiN,OAC/B1R,EAAK+O,cAActK,EAAMK,MAAQL,GAEzBA,EAAM1D,IAAMf,EAAK8O,QAAQrK,EAAM1D,KACtC0D,EAAM1D,GAAK,MAAOf,EAAKgP,kBAGlB1N,EA1BP,SAASqQ,EAAgBlN,OACpBnD,EAAM,OAEL,IAAI2O,KAAOxL,EACXA,EAAMwL,KACLzC,EAAWyC,GACXzC,EAAWyC,GAAKxL,EAAMwL,IACxB3O,GAAOkM,EAAWyC,GAAKxL,EAAMwL,IAAMxL,GACD,mBAAnB+I,EAAWyC,KAC1B3O,GAAOkM,EAAWyC,GAAKxL,IAGxBnD,GAAM2O,EAAI,IAAIxL,EAAMwL,GAAK,YAIrB3O,EAUKqQ,EAFZ3R,EAAK8O,QAAQrK,EAAM1D,IAAM0D,GAESqL,OAC9Bb,EAAS,QAAQjP,EAAKkP,OAC1BjQ,MAAMsJ,KAAKsH,SAASZ,EAAO,KAAKxK,EAAM1D,GAAG,IAAIO,EAAI,IAAK2N,GAEjDyC,GACJrL,EAAKrG,EAAM,SAAU,CAAEL,KAAK8E,EAAM1D,GAAI+D,KAAML,EAAMK,OAGpD,SAASoL,GAAazL,WACjB1D,EAAK,GACApC,EAAE,EAAGA,EAAE4O,EAAY3O,OAAQD,IACnCoC,EAAG2B,KAAK+B,EAAMqL,MAAMvC,EAAY5O,YAC1BoC,EAAGgC,KAAK,KAGhB,SAASiN,GAAelL,WACnB0G,EAAQ1G,EAAK2G,MAAM,KACnBqE,EAAQ,GACHnR,EAAE,EAAGA,EAAE4O,EAAY3O,OAAQD,IACnCmR,EAAMvC,EAAY5O,IAAM6M,EAAM7M,UACxBmR,EAKD,SAAS8B,GAAgB5R,EAAMqL,GACrCnC,EAAMC,IAAI,WACToD,EAAUlB,EAAOrL,EAAM,SAASA,EAAMqO,GACzBe,EAASpP,EAAKqO,IAEzBsC,EAAS3Q,EAAMqO,EAAM,UAKlB,SAASwD,GAAc7R,WACzBqK,EAAUrK,EAAKwJ,YAEf/K,EAAO4L,EAAO5L,KACd4Q,EAAShF,EAAOgF,OAEhByC,EAAO,GACFnT,EAAE,EAAGA,EAAEF,EAAKG,OAAQD,IAAI,KAC5BgB,EAAOlB,EAAKE,GAAG,GACfgB,IACHmS,EAAKnS,GAAQ,WAGXoS,EAAY,GACRpT,EAAI,EAAGA,EAAE0Q,EAAOzQ,OAAQD,IAAI,CAE/BmT,EADOzC,EAAO1Q,GAAG,KAEpBoT,EAAUrP,KAAK2M,EAAO1Q,IAGxB0L,EAAOgF,OAAS0C,EAChBlD,EAAM7O,GACNqQ,EAAOrQ,EAAMqK,4CA9RP,SAASL,GAAKhK,GACpBA,EAAKmD,YAAY,aAAc,SAACxD,EAAMZ,UAwGvC,SAASiT,EAAahS,EAAML,EAAMZ,GAEjCmK,EAAMC,IAAI,WACTnJ,EAAKiS,iBAAiB,SAAS5D,IAOjC,SAAS6D,EAAiBlS,EAAMqO,EAAM1O,EAAMZ,OACvCoT,EAAS/C,EAASpP,EAAMqO,GACxBmC,EAAS5B,EAAa5O,EAAMmS,EAAQxS,EAAMZ,EAAOsP,GAEjDmC,GAAUA,GAAU2B,GACvBvB,GAAU5Q,EAAMqO,EAAMmC,EAAQ2B,GAX7BD,CAAiBlS,EAAMqO,EAAM1O,EAAMZ,OAGrCiB,EAAK8I,UA/G2CkJ,CAAahS,EAAML,EAAMZ,KACzEiB,EAAKmD,YAAY,cAAe,SAAC1E,UAAS4R,EAAOrQ,EAAMvB,KACvDuB,EAAKmD,YAAY,kBAAmB,SAAC1E,UAiDtC,SAAS2T,EAAWpS,EAAMc,OACrBuO,EAAS,OAER,IAAIY,KAAOjQ,EAAK+O,cACpBM,EAAO3M,KAAK,CAAC1C,EAAK+O,cAAckB,GAAKlP,GAAIkP,IAE1CnP,EAAIuO,OAASA,EAvDiC+C,CAAWpS,EAAMvB,KAC/DuB,EAAKmD,YAAY,UAAW,kBAAM0L,EAAM7O,KACxCA,EAAKmD,YAAY,SAAU,SAACF,EAAMoJ,EAAKC,EAAQ7H,GACnC,SAARxB,GAyCL,SAASoP,EAAWrS,EAAMqM,EAAKC,EAAQ7H,GAEtCkM,EAAS3Q,EADE,CAACqM,IAAKA,EAAKC,OAAQA,GACT7H,GA1CnB4N,CAAWrS,EAAMqM,EAAKC,EAAQ7H,KAGhCoK,EAAM7O,GAEDmO,IACJA,EAASlP,MAAMsJ,KAAK+J,OAAO,MAAO,CAAE7N,MAAM,yEAA0E,2GCjH/G,IAEHhF,GACA8S,GACAC,GACAC,GALOC,GAAgB,GAOpB,SAASC,SACTC,EAAgB3T,MAAMC,KAAKC,YAAYM,YAoDzC,IAAId,KAnDRc,GAAU,GACV8S,GAAe,EACfC,GAAgB,GAChBC,GAAc,GACdC,GAAgB,CACfG,MAAQ,CACPC,UAAY,SAAS/T,EAAOgU,UAC3BA,EAAMzR,IAAM,4BACLrC,MAAMC,KAAK8T,YAAYjU,IAE/BkU,OAAOhU,MAAMiU,OAAO,CACnBC,MAAOlU,MAAMC,KAAKkU,cAAcC,YAChCC,OAAQrU,MAAMC,KAAK8T,YAAY,IAC/BO,UAAW,EAAGC,SAAS,EAAGvQ,KAAM,SAC9BwQ,GAAc,iBAEV,CACPX,UAAY,SAAS/T,EAAOgU,UAC3BA,EAAMzR,IAAM,0BACLrC,MAAMC,KAAKwU,aAAa3U,IAEhCkU,OAAOhU,MAAMiU,OAAO,CACnBC,MAAOlU,MAAMC,KAAKmU,YAClBE,UAAW,EAAGC,SAAS,EAAGvQ,KAAM,OAC9BwQ,GAAc,SAElBE,QAAU,CACTb,UAAY,SAAS/T,EAAOgU,UAC3BA,EAAMzR,IAAM,8BACL1D,KAAKI,MAAY,IAANe,GAAW,KAE9BkU,OAAOhU,MAAMiU,OAAO,CACnBC,MAAO,EAAGI,UAAW,EAAGC,SAAS,EAAGvQ,KAAM,WACxCwQ,GAAc,aAElBnW,KAAO,CACNwV,UAAY,SAAS/T,EAAOgU,UAC3BA,EAAMzR,IAAM,2BACLsS,GAAYhB,EAAciB,WAAYJ,GAAc,QAApDG,CAA6D7U,IAErEkU,OAAQ,CAAEhQ,KAAK,OAAQ3F,KAAKsV,EAAciB,aAE3CC,OAAS,CACRhB,UAAY,SAAS/T;AAAOgU,UAC3BA,EAAMzR,IAAM,2BACLvC,GAERkU,OAAQ,CAAEhQ,KAAK,YAKhBuP,GAAc7T,GAAKoV,GAAgBC,GAAarV,EAAG+T,GAAc/T,GAAGsU,SACpER,GAAYD,GAAc7T,IAAMA,EAI3B,SAAS8U,GAAcxQ,SAClB,SAARA,EACK,CAAEgR,UAAUhV,MAAMC,KAAKkU,cAAcc,eAAgBC,YAAYlV,MAAMC,KAAKkU,cAAcgB,kBAE1F,CAAEH,UAAUhV,MAAMC,KAAKgV,eAAgBC,YAAYlV,MAAMC,KAAKkV,kBAuBhE,SAAStB,GAAUnT,UAClB+S,GAAc/S,GAAQ+S,GAAc/S,GAAMmT,UAAYJ,GAAc/S,GAGrE,SAAS0U,GAAgB1U,EAAM2U,UAClCA,EAEKP,GADMQ,GAAY,CAACtB,OAAQP,GAAc/S,GAAMsT,OAAQvC,OAAQ8B,GAAc7S,MACrD,GAGxB6S,GAAc7S,GAGvB,SAAS6U,GAAiBzJ,EAAKkI,MAC1BR,GAAY1H,GAAM,OAAO0H,GAAY1H,OAErCpL,EAAyB,UAAlB6G,EAAOyM,GAAsB,MAAOV,GAAgBU,SAC/DV,KAEA9S,GAAQE,GAAQoL,EAEhBkI,EAAShU,MAAMiU,OACI,UAAlB1M,EAAOyM,GAAsBA,EAAS,CAAEvC,OAAO3F,EAAK9H,KAAK,UACzDwQ,GAAc,WAGff,GAAc/S,GAAQ,CACrBmT,UAAUc,GAAY7I,EAAK,CAACoJ,YAAalB,EAAOkB,YAAaF,UAAWhB,EAAOgB,YAC/EhB,OAAQA,GAGTT,GAAc7S,GAAQoL,EACtB0H,GAAY1H,GAAOpL,EAKb,SAAS8U,GAAUzU,EAAMqM,EAAKC,EAAQoE,EAAQzN,GAChDA,IACHA,EAAO,CAACyN,OAAOA,EAAQzN,KAAM,eACxBqO,EAAMtR,EAAKoP,SAAS/C,EAAKC,GACzBoI,EAAM7E,EAAS7P,EAAM,CAAE0Q,OAAO8D,GAAiB9D,EAAQzN,IAASqO,GACtEtR,EAAK2Q,SAAStE,EAAKC,EAAQoI,GAGrB,SAASC,GAAa3U,EAAMqM,EAAKC,OAEjCoI,EAAM7E,EAAS7P,EAAM,CAAE0Q,OAAO,IADxB1Q,EAAKoP,SAAS/C,EAAKC,IAE/BtM,EAAK2Q,SAAStE,EAAKC,EAAQoI,GAG5B,SAASE,GAAY7J,OAChB8J,EAAc9J,EAAI/G,MAAM,gBACxBwH,EAAQT,EAAIU,MAAM,YACjBoJ,GACe,EAAfrJ,EAAM5M,SACT4M,EAAM,IAAqB,EAAfA,EAAM5M,OAAa,OAAS,SAAS4M,EAAM,GACvDA,EAAM,GAAK,OAAOA,EAAM,GACpBA,EAAM,KACTA,EAAM,GAAK,OAAOA,EAAM,KAGpBA,EAGD,SAASoI,GAAY7I,EAAK+J,WAC1BC,EAAe9V,MAAMC,KAAKC,YAAYI,MAAM,gBAC9CiM,EAAQoJ,GAAY7J,GACpBiK,EAAO,CAAC,4FACHrW,EAAE,EAAGA,EAAE6M,EAAM5M,OAAQD,IAAI,KAC7BsW,EAAYC,GAAY1J,EAAM7M,IAClCqW,EAAKtS,KAAKyS,GAAQF,EAAUG,UAAWH,EAAUrR,MAAMqE,cAAegN,EAAUI,IAAK1W,EAAkB,EAAf6M,EAAM5M,OAAYkW,WAGpG,IAAIQ,SAAS,MAAM,uBAAiBN,EAAKjS,KAAK,qDAA4CgS,WAGlG,SAASI,GAAQI,EAAO3R,EAAO4R,EAAMC,EAAKC,EAAOZ,OAC5C/J,EAAM,UACNwK,IACuBxK,GAArB0K,EAA0B,UAAhB,KACE,MAAbF,EAAM,KAAYA,EAAQ,IAAIA,GAClCxK,GAAK,OAAOwK,EAAM,KACdG,IAAO3K,GAAK,yBAEbnH,IACHmH,GAAK,oCAAqCnH,EAAM,OAEjDmH,GAuDD,SAAS4K,EAAcH,EAAMV,OACvBU,EACJ,MAAO,sBAIJI,EAGAC,EAAOC,EAAmBC,EAL1BhL,EAAM,YAGNsK,EAAM,GACNW,EAAW,EAEX1Y,EAAO,GACP2Y,EAAe,OAEVtX,EAAE,EAAGA,EAAE6W,EAAK5W,OAAQD,IAAI,KAC5BuX,EAAsBC,GAAYX,EAAK7W,EAAE,KAAKwX,GAAYX,EAAK7W,EAAE,OACtD,KAAX6W,EAAK7W,OASJM,MAAMwH,YAAYmP,MAET,KAAXJ,EAAK7W,KACPqX,GAAoB,KAElB,WAAWhK,KAAKwJ,EAAK7W,IAAI,KACrByX,EAAWC,GAAiBb,EAAKpK,OAAOzM,GAAIsX,MAC/CG,EAAS,IACRN,GAAqBC,EACvB,MAAO,yCACRzY,EAAKoF,KAAK0T,EAAS1F,QACnB3F,GAAO,WACPkL,EAAeG,EAASnT,KACxBtE,GAAKyX,EAASxX,OAAO,WAIrBmM,eAAYyK,EAAK7W,aAEd,GAAI6W,EAAK7W,KAAOmW,EAAWX,aAAe+B,EAC9Cb,GAAMP,EAAWX,iBAEb,GAAY,KAATqB,EAAK7W,GAAQ,IACjBmX,GAAqBxY,EAAKsB,OAC5B,MAAO,yCACJmX,IACHhL,GAAK,OACLgL,GAAkB,GAEnBV,GAAKG,EAAK7W,QAEN,GAAIwX,GAAYX,EAAK7W,IAAI,IAC1BoX,GAAmBzY,EAAKsB,OAC1B,MAAO,uCACHkX,IACJ/K,GAAK,OACL+K,GAAkB,GAEnBT,GAAKG,EAAK7W,QAEF6W,EAAK7W,KAAOmW,EAAWb,WAAaiC,EAC5CL,GAAQ,EAER9K,eAAYyK,EAAK7W,aAlDhBiX,EADE3W,MAAMwH,YAAYmP,GACVjX,GAEVoM,eAAYyK,EAAKpK,OAAOwK,EAAQ,EAAGjX,EAAEiX,EAAQ,QACnCU,cAkDVhZ,EAAKsB,OAAO,EAEY,GAAvBtB,EAAK4K,QAAQ,QACf5K,EAAOA,EAAKiZ,IAAI,SAAAH,UACRA,OACD,WAAa,SACb,WAAa,oBACFA,UAIf,IAAIzX,EAAI,EAAGA,EAAIrB,EAAKsB,OAAQD,IAC/BoM,EAAMA,EAAIhH,QAAQ,gCAA0BpF,8BAI3CrB,EAAKsB,wBAAmBd,2DAAmER,EAAKyF,KAAK,4BAA4B,oBACjIsS,YAIJ,SAAS3B,EAAa2B,EAAKQ,EAAOf,EAAYkB,OACzCjL,4BAAyBsK,+CACzBmB,EAAU1B,EAAWX,gBACLsC,GAASpB,EAAKmB,MAA7B/I,OAAME,OACXA,GAASA,GAAS,IAAIlC,MAAM,IAAIiL,UAAU3T,KAAK,QAG3C4T,EAASlJ,EAAKvF,QAAQ,KAAkB,GAARyO,IAAWA,EAASlJ,EAAK7O,OAAS+X,OAClEC,EAASnJ,EAAKvF,QAAQ,KAAkB,GAAR0O,IAAWA,EAASnJ,EAAK7O,OAASgY,OAClEC,EAASlJ,EAAMzF,QAAQ,KAAkB,GAAR2O,IAAWA,EAASlJ,EAAM/O,OAASiY,OACpEC,EAASnJ,EAAMzF,QAAQ,KAAkB,GAAR4O,IAAWA,EAASnJ,EAAM/O,OAASkY,OACpEC,EAAOpJ,EAAM/O,cAEjBmM,2BACYiL,0CACce,oIAINJ,6CAAyCA,wDACzCC,0CAAsCA,2CACpDf,2TAUwBf,EAAWb,qGAIrB4C;yMAUEC,oDACWA,sEAGRN,uBAGd,MAxDC9C,CAAa2B,EAAKQ,EAAOf,EAAYkB,QAAe,oBAC7DjL,OA/II4K,CAAcH,EAAMV,KAEfS,EAAM,IAAI,IAGvB,IAAMyB,GAAY,IACX,UACE,OACH,QACC,SACC,UACC,WACA,OACH,QACC,SACC,UACC,MAGHC,GAAY,GACZ,QACC,OACD,QACC,OACD,QACC,aACG,MAGJC,GAAYC,OAAOC,KAAKJ,IAAWK,KAAK,SAACpQ,EAAGqQ,UAAMA,EAAE1Y,OAASqI,EAAErI,SAC/D2Y,GAAYJ,OAAOC,KAAKH,IAAWI,KAAK,SAACpQ,EAAGqQ,UAAMA,EAAE1Y,OAASqI,EAAErI,SAErE,SAASyX,GAAiBvR,EAAMmR,OACzBuB,EAAa,CAClB,CAAC7X,KAAK,OAAQ8X,MAAMP,GAAWQ,MAAMV,IACrC,CAACrX,KAAK,OAAQ8X,MAAMF,GAAWG,MAAMT,KAIlB,eAAejL,KAAKlH,IACN,QAAhBmR,GACjBuB,EAAWd,cAER,IAAI/X,EAAI,EAAGA,EAAI6Y,EAAW5Y,OAAQD,YAC/BsE,EAAOuU,EAAW7Y,GAChBgZ,EAAI,EAAGA,EAAI1U,EAAKwU,MAAM7Y,OAAQ+Y,OACH,GAA/B7S,EAAKoD,QAAQjF,EAAKwU,MAAME,IAC1B,MAAO,CACNjH,OAAQzN,EAAKyU,MAAMzU,EAAKwU,MAAME,IAC9B/Y,OAAQqE,EAAKwU,MAAME,GAAG/Y,OACtBqE,KAAMA,EAAKtD,MAqLT,SAASiY,GAAmB5X,EAAM4M,EAAKP,EAAKC,OAC9CuL,EAiNL,SAASC,EAAS9X,EAAMqM,EAAKC,OACzBD,GAAOC,EAAO,IACG,WAAf9F,EAAO6F,IAAsC,WAAlB7F,EAAO8F,GAQrC,MAAO,CAAC,CAACD,IAAKA,EAAKC,OAAQA,YAPvBuL,EAAQ,GACHE,EAAI1L,EAAIA,IAAK0L,GAAGzL,EAAOD,IAAK0L,QAC/B,IAAIC,EAAI3L,EAAIC,OAAQ0L,GAAG1L,EAAOA,OAAQ0L,IAC1CH,EAAMnV,KAAK,CAAC2J,IAAK0L,EAAGzL,OAAQ0L,WACvBH,EAMR,OAAO7X,EAAKqC,eAAc,IA9NfyV,CAAS9X,EAAMqM,EAAKC,MACb,GAAhBuL,EAAMjZ,YAGH0I,EAAOtH,EAAK+B,GAAG,SAASkW,QAAQJ,EAAM,GAAGxL,KAAKwL,EAAM,GAAGvL,QACvD4L,EAAa5Q,EAAOA,EAAKlJ,WAAakJ,EACtC6Q,EAAanY,EAAKoP,SAASyI,EAAM,GAAGxL,IAAKwL,EAAM,GAAGvL,WAErDrN,MAAMmZ,MAAMC,SAASH,IAAgBC,GAAcA,EAAWrI,MAAMY,OAAQ,CAC9ExH,EAAMC,IAAI,eACL,IAAIxK,EAAI,EAAGA,EAAIkZ,EAAMjZ,OAAQD,IAChC2Z,GAAmBtY,EAAM4M,EAAKiL,EAAMlZ,MAEtCqB,EAAK8I,cAED4H,EAAS1Q,EAAKoP,SAASyI,EAAM,GAAGxL,IAAKwL,EAAM,GAAGvL,QAAQwD,MAAMY,QAAU,SAC1EA,EAAS6H,GAAS7H,GAAU,SAAWA,EACvC1Q,EAAK8C,UAAU,YAAa,CAAC,CAAC/B,GAAG,iBAAkBpB,KAAK,SAAUZ,MAAM2R,OAInE,SAAS4H,GAAmBtY,EAAM4M,EAAKyB,OACzCqC,EACEjM,EAAQzE,EAAKoP,SAASf,EAAKhC,IAAKgC,EAAK/B,QACvCvN,EAAQiB,EAAK+B,GAAG,SAASkW,QAAQ5J,EAAKhC,KAAKgC,EAAK/B,WACpDvN,EAAQA,EAAQA,EAAMX,WAAa,GAEhCqG,GAASA,EAAMqL,MAAMY,OAAO,KACxB/Q,EAAO8E,EAAMqL,MAAMY,QACzBA,EAASzR,MAAMkG,KAAK,CAAC8N,OAAOP,GAAc/S,GAAMsT,OAAQvC,OAAO2D,GAAgB1U,MACxE+Q,OA7DT,SAAS8H,EAAenD,EAAKzI,EAAKjF,WAC7B8Q,EAASlE,GAAYc,GACjB1W,EAAI,EAAGA,EAAI8Z,EAAO7Z,OAAQD,IAAI,IAClC8Z,EAAO9Z,GAAG+Z,SACL,EAAJ9L,EACF6L,EAAO9Z,GAAGgP,MAAMgL,cAAgBC,MAAMhM,EAAI,GAAG7J,KAAK,KAElD0V,EAAO9Z,GAAGgP,MAAMgL,aAAeF,EAAO9Z,GAAGgP,MAAMgL,aAAaE,MAAM,EAAGjM,OAEnE,KACGkM,GAAeL,EAAO9Z,GAAG8O,KAAK3I,OAAS2T,EAAO9Z,GAAGgP,MAAM7I,KACvDiU,GAAuBN,EAAO9Z,GAAG8O,KAAKkL,eAAiBF,EAAO9Z,GAAGgP,MAAMgL,aAE1E/L,EAAM,GAAKkM,GAAeC,GAAuB9Z,MAAMmZ,MAAMC,SAAS1Q,KAA4B,EAApBA,EAAIO,QAAQ,MAC5FuQ,EAAO9Z,GAAG8O,KAAKkL,aAAe,IAC9BF,EAAO9Z,GAAGgP,MAAMgL,aAAeC,MAAMjR,EAAI8D,MAAM,KAAK,GAAG7M,QAAQmE,KAAK6V,MAAMhM,EAAI,GAAG7J,KAAK,OAGzE,EAAN6J,IAAY6L,EAAO9Z,GAAG8O,KAAKkL,cAAgBG,KAClDL,EAAO9Z,GAAG8O,KAAKkL,aAAeF,EAAO9Z,GAAG8O,KAAKkL,cAAgB,IAC7DF,EAAO9Z,GAAGgP,MAAMgL,aAAeC,MAAMhM,EAAI,GAAG7J,KAAK,KACjD0V,EAAO9Z,GAAG+Z,UAAW,GAGvBD,EAAO9Z,GAAG+Z,SAAiD,EAAtCD,EAAO9Z,GAAGgP,MAAMgL,aAAa/Z,cAG5CmV,GAAgB0E,GAkCND,CAAe9H,EAAQ9D,EAAK7N,GAEzC2R,EAAOuC,QAAUvC,EAAOuC,OAAO+F,eAAe,WAChDtI,EAAOuC,OAAOE,MAAQvV,KAAKsT,IAAIR,EAAOuC,OAAOE,MAAMvG,EAAK,QAGtD,EAGH8D,EAAS,CAACuC,OAAO,CAACO,SAAS,EAAGL,MAFhBlU,MAAMmZ,MAAMC,SAAStZ,IAAUA,EAAM0M,MAAM,KAAK,GAAK7N,KAAKsT,IAAInS,EAAM0M,MAAM,KAAK,GAAG7M,OAAOgO,EAAK,GAAKhP,KAAKsT,IAAItE,EAAK,GAEpF2G,UAAU,EAAGtQ,KAAK,SACtDyN,OAASqD,GAAgBC,GAAatD,EAAOuC,OAAOhQ,KAAMyN,EAAOuC,SAEzEwB,GAAUzU,EAAMqO,EAAKhC,IAAKgC,EAAK/B,OAAQoE,EAAOA,OAAQA,EAAOuC,QAGvD,SAASsF,GAAS5Y,SACT,UAARA,KAA6C,GAAxBA,EAAKuI,QAAQ,QAAmD,UAAnCwK,GAAc/S,GAAMsT,OAAOhQ,MAG9E,SAAS+Q,GAAa/Q,EAAMgW,MACvB,UAARhW,EACF,MAAO,CAAC,CAACwK,KAAK,CAAC3I,KAAK,UAClBmU,EAAW3b,KACb,MAAO,CAAC,CAACmQ,KAAK,CAAC3I,KAAKmU,EAAW3b,YAE5B2V,EAAS,CAAC,CAACmC,UAAU,MAAO3H,KAAK,CAAC3I,KAAK,IAAI6I,MAAM,CAAC7I,KAAK,KAAM,CAACsQ,UAAU,KAAM3H,KAAK,CAAC3I,KAAK,IAAK6I,MAAM,CAAC7I,KAAK,SAC9G7F,MAAMiU,OAAOD,EAAQQ,GAAcxQ,IACnCgQ,EAAO,GAAGtF,MAAMgL,aAAe1F,EAAO,GAAGtF,MAAMgL,aAAeM,EAAW9F,MAAQyF,MAAMK,EAAW9F,MAAQ,GAAGpQ,KAAK,KAAO,GACzHkQ,EAAO,GAAGM,UAAYN,EAAO,GAAGM,UAAY0F,EAAW1F,WAAqB,WAARtQ,EACpEgQ,EAAO,GAAGxF,KAAKkL,aAAe1F,EAAO,GAAGxF,KAAKkL,aAAe1F,EAAO,GAAGM,UAAY,IAAIN,EAAOgB,UAAW,IAAM,IAC9GhB,EAAO,GAAGyF,SAAWzF,EAAO,GAAGyF,WAAWO,EAAW9F,MACrDF,EAAO,GAAGrP,MAA+B,GAAvBqV,EAAWzF,SAAgB,MAAQ,GACrDP,EAAO,GAAGxF,KAAK3I,MAAQmU,EAAWzF,SAAW,EAAI,IAAM,GAC7B,GAAvByF,EAAWzF,WACbP,EAAO,GAAGxF,KAAK3I,MAAQ,KAEZ,YAAT7B,EACFgQ,EAAO,GAAGtF,MAAM7I,KAAOmO,EAAO,GAAGtF,MAAM7I,MAAQ,SAC3C,GAAY,UAAT7B,EAAiB,KAClBqQ,EAASZ,GAAcG,MAAMI,OAAOK,OACpC3F,EAA+B,GAAvB2F,EAAOpL,QAAQ,KAE7B+K,EAAO,GAAGtF,EAAM,QAAQ,QAAQ7I,MAAQwO,EACxCL,EAAO,GAAGtF,EAAM,QAAQ,QAAQ7I,MAAQwO,SAGf,GAAvB2F,EAAWzF,WACbP,EAAO,GAAGtF,MAAM7I,MAAQ,KAElBmO,EAGD,SAASc,GAAgBd,EAAQiG,WACnC7D,EAAM,GACF1W,EAAI,EAAGA,EAAIsU,EAAOrU,OAAQD,IAAI,IAClCsU,EAAOtU,GAAGyW,YACZC,GAAO,IAAIpC,EAAOtU,GAAGyW,UAAU,KAC7BnC,EAAOtU,GAAGiF,QACZyR,GAAO,IAAIpC,EAAOtU,GAAGiF,MAAM,KAEzBqP,EAAOtU,GAAG8O,KAAK,IACdwF,EAAOtU,GAAG8O,KAAK3I,KAEjBuQ,GADepC,EAAOtU,GAAG8O,KAAK3I,QAG5BmO,EAAOtU,GAAG8O,KAAKkL,aAAa,KAC1BQ,EAAmBlG,EAAOtU,GAAG8O,KAAKkL,aACtCtD,GAAO6D,EAAUC,EAAiBpV,QAAQkP,EAAOgB,UAAW,KAAOkF,MAIlElG,EAAOtU,GAAG+Z,WACZrD,GAAO6D,EAAU,IAAMjG,EAAOkB,aAE5BlB,EAAOtU,GAAGgP;IACTsF,EAAOtU,GAAGgP,MAAMgL,eAClBtD,GAAOpC,EAAOtU,GAAGgP,MAAMgL,cACrB1F,EAAOtU,GAAGgP,MAAM7I,KAGlBuQ,GAFgBpC,EAAOtU,GAAGgP,MAAM7I,KAK/BnG,GAAKsU,EAAOrU,OAAS,IACvByW,GAAO,YAEFA,EAGR,SAASd,GAAYc,WACd+D,EAAW/D,EAAI3E,OAAOjF,MAAM,KAC9BwH,EAAS,GAELtU,EAAI,EAAGA,EAAIya,EAASxa,OAAQD,IAAI,KACnCsW,EAAYC,GAAYkE,EAASza,IACrCsU,EAAOtU,GAAK,CAACiF,MAAMqR,EAAUrR,MAAOwR,UAAUH,EAAUG,UAAW3H,KAAK,GAAIE,MAAM,QAE5E+C,EAASuE,EAAUI,IAEzBpC,EAAOgB,UAAYoB,EAAIpC,OAAOgB,UAC9BhB,EAAOkB,YAAckB,EAAIpC,OAAOkB,aAEO,EAApCzD,EAAOxI,QAAQ+K,EAAOgB,aACxBhB,EAAOtU,GAAG4U,WAAY,OAEjB8F,EAAc5C,GAAS/F,EAAQuC,EAAOkB,aAExC1G,EAAO4L,EAAY,GACnB1L,EAAQ0L,EAAY,IAAM,GAE3BA,EAAY,KACdpG,EAAOtU,GAAG+Z,UAAW,GAEtBjL,EAAO6L,GAAiB7L,EAAM,OAAQwF,EAAOgB,WAC7CtG,EAAQ2L,GAAiB3L,EAAO,QAASsF,EAAOgB,WAEhDhB,EAAOtU,GAAG8O,KAAO,CAChB3I,KAAM2I,EAAK8L,SACXZ,aAAclL,EAAKkL,cAGpB1F,EAAOtU,GAAGgP,MAAQ,CACjB7I,KAAM2I,EAAK+L,UAAY7L,EAAM6L,UAC7Bb,aAAchL,EAAMgL,qBAGf1F,EAGR,SAASqG,GAAiBG,EAASxW,EAAMgR,OACpCyF,EACO,QAARzW,IAEFyW,GADAA,EAAmBD,EAAQzV,MAAM,UACK0V,EAAiBC,MAAQC,kBAG5DL,EAAW,GACXC,EAAY,GACZb,EAAe,GACXkB,EAAI,EAAGA,EAAIJ,EAAQ7a,OAAQib,OAC9B1D,GAAYsD,EAAQI,IAavBlB,GAAgBc,EAAQI,OAbG,IACxBJ,EAAQI,IAAM5F,GAAakC,GAAYsD,EAAQI,EAAE,KAAO1D,GAAYsD,EAAQI,EAAE,IAAI,CACpFlB,GAAgBc,EAAQI,eAGd,QAAR5W,GACC4W,EAAIH,EAAiB,CACvBH,GAAYE,EAAQI,YAGtBL,GAAaC,EAAQI,SAKhB,CAACN,SAAUA,EAAUC,UAAWA,EAAWb,aAAcA,GAGjE,SAASzD,GAAYM,OAChB5R,EAAQ,GACR2R,EAAQ,GACRhY,EAAQiY,EAAKtN,QAAQ,SACV,IAAX3K,GACCiY,EAAK,GAAGxR,MAAM,SAAS,KACtBoB,EAAMoQ,EAAKtN,QAAQ,KACvBqN,EAAQC,EAAKpK,OAAO7N,EAAM,EAAG6H,EAAI7H,EAAM,GACvCiY,EAAOA,EAAKpK,OAAOhG,EAAI,OAKV,KADf7H,EAAQiY,EAAKtN,QAAQ,MACJ,KACZ9C,EAAMoQ,EAAKtN,QAAQ,KACvBtE,EAAQ4R,EAAKpK,OAAO7N,EAAM,EAAG6H,EAAI7H,EAAM,GACvCiY,EAAOA,EAAKpK,OAAOhG,EAAI,SAEjB,CAACgQ,UAAUG,EAAO3R,MAAMA,EAAOyR,IAAIG,GAmB3C,SAASW,GAAYxO,SACL,MAARA,GAAuB,MAARA,GAAuB,MAARA,EAGtC,SAAS8O,GAAS1L,EAAKyL,OAEhBxS,EAAQ+G,EAAI/G,MAAM,UAAUwS,EAAQ,iBACvCxS,EACK,CAAC+G,EAAIjD,UAAU,EAAG9D,EAAM2V,MAAM,GAAI5O,EAAIjD,UAAU9D,EAAM2V,MAAM,IAE5D,CAAC5O,GAIH,SAAS+O,GAAYpJ,EAAQzN,EAAM8W,MACzCrJ,EAASA,GAAUA,EAAO2E,IAAM3E,EAAO2E,IAAMhB,GAAgB3D,QAKzDsJ,EAFE/E,EAAYC,GADJN,GAAYlE,GACU,IAAI2E,OAGrCJ,EACF,IAAI,IAAItW,EAAI,EAAGA,EAAIsW,EAAUrW,OAAQD,OACjB,KAAhBsW,EAAUtW,KACZqb,GAAQA,IACNA,MAEQ,QAAR/W,GAAkB,WAAW+I,KAAKiJ,GAAW,KACzCmB,EAAWC,GAAiBpB,EAAU7J,OAAOzM,GAAI,WACpDyX,EAAS,KACR2D,EAKF,OAAO,KAJa,QAAjB3D,EAASnT,KACX,OAAO,MAOA,UAARA,GAAoC,KAAhBgS,EAAUtW,GAChC,OAAO,IAIJ,SAASsb,GAAcja,EAAMqM,EAAKlB,OAClC7D,EAAOtH,EAAKsP,OAAOjD,UAClB/E,GAAQA,EAAKmJ,aAAenJ,EAAKmJ,YAAYtF,GAG9C,SAAS+O,GAAcnb,UACtBA,GAAS,cAAwB,cAARA,EAG1B,SAASob,GAAkB7S,EAAM6D,OACjCiP,EAAa9S,EAAKmJ,YAAYtF,GAC9BkP,EAASpb,MAAMC,KAAKC,YAAYM,QAChC6a,EAASR,GAAYM,EAAY,QAAQ,UAExCnb,MAAMzB,KAAK+c,UAAWF,EAAOC,EAAS,gBAAkB,yCA7rBzD,SAAStQ,GAAKhK,GACpBA,EAAKmD,YAAY,cAAe,SAAC1E,UAwFlC,SAAS+b,EAAKxa,EAAKvB,OACdE,EACHc,EAAUhB,EAAKgB,WAEbA,EACF,IAAId,EAAI,EAAGA,EAAIc,EAAQb,OAAQD,IAC9B6V,GAAiB/U,EAAQd,GAAG,GAAGc,EAAQd,GAAG,IA9FF6b,CAAKxa,EAAMvB,KACrDuB,EAAKmD,YAAY,kBAAmB,SAAC1E,EAAMqB,UA4E5C,SAAS0J,EAAUxJ,EAAMvB,OAClBgB,EAAU,GACVgb,EAAiB,CAAC,UAAW,MAAO,QAAS,OAAQ,cAEvD,IAAI9b,KAAK6T,IACqB,GAA9BiI,EAAevS,QAAQvJ,IACzBc,EAAQiD,KAAK,CAAC/D,EAAE6T,GAAc7T,KAEhCF,EAAKgB,QAAUA,EApFuC+J,CAAUxJ,EAAMvB,0TCJvE,SAASic,GAAOC,OACX3F,EAAO2F,EAAKzP,WAAW,UAEb,IAAN8J,GAAYA,GAAM,KAAgB,IAARA,GAAsB,IAARA,EAOjD,SAAS4F,GAAQC,EAASlc,EAAGmc,WAJxB9F,EAKA9D,EAAM2J,EAAQjc,OACd2M,EAAQuP,EACRC,GAAS,EAELpD,EAAEhZ,EAAGgZ,EAAEzG,EAAKyG,IAAI,KACnB1H,EAAO4K,EAAQlD,MACP,MAAR1H,OAKC8K,KACO,KAAP9K,EAAW,IACG,KAAd4K,EAAQlc,YAKO,OADjB4M,EAAQsP,EAAQzP,OAAOzM,EAAGgZ,EAAEhZ,IAClB,KACT4M,EAAQA,EAAMH,OAAO,EAAGG,EAAM3M,OAAO,IACtCD,EAAEgZ,EAAE,OAGD,KAAK+C,GAAOzK,UA5Bf+E,EACS,KADTA,EA4BiC/E,EA5BrB/E,WAAW,KACR8J,GAAM,WA4Bf,CAAC6F,EAAQzP,OAAOzM,EAAGgZ,EAAEhZ,GAAIgZ,EAAGhZ,EAAG4M,QAjBvCwP,GAAUA,QAsBL,CAACF,EAAQzP,OAAOzM,GAAIgZ,EAAGhZ,EAAG4M,GAGlC,IAAIyP,GAAU,kBACd,SAASC,GAAWnW,UACZkW,GAAQhP,KAAKlH,GAGd,SAASoW,GAASC,WACpB9O,EAAM,EAAG+O,EAAM,EAAGxS,EAAI,EAAG2F,EAAO,EAAG8M,EAAQ,EAC3CC,GAAQ,EAEH3D,EAAGwD,EAAKvc,OAAO,EAAM,GAAH+Y,EAAMA,IAAI,KAChC1H,EAAMkL,EAAKxD,GAAGzM,WAAW,GACjB,KAAR+E,EAKAA,EAAM,IAETmL,IAAQnL,EAAM,IAAIrH,EAClBA,GAAK,KAEA0S,IACGjP,EAAM+O,EAAcE,IAATF,EAAM,GAAiB7M,GAAzC3F,EAAI,GAGLwS,IAAQnL,EAAM,IAAIrH,EAClBA,GAAG,IAdHyS,GAAc9M,QAwBT,CAAClC,EAAK+O,EAAKC,GAGnB,SAASE,GAAUC,2BACAA,QAmBnB,SAASC,GAAeC,EAAM1b,EAAMmb,EAAM5P,OACrCyJ,EAAQhV,EAAK0L,OAAOC,QAAQwP,EAAM5P,OAClCyJ,EAAM,MAAO,OAEb2G,EAAW3G,EAAK9M,QAAQ,MACV,IAAdyT,IAEc,OADjBpQ,EAAQyJ,EAAK5J,OAAO,EAAGuQ,IACb,KACTpQ,EAAQA,EAAMH,OAAO,EAAGG,EAAM3M,OAAO,IACtCoW,EAAOA,EAAK5J,OAAOuQ,EAAS,YAGjB3G,EAAKvJ,MAAM,eAChBmQ,GAAUF,YAAYnQ,GAO9B,SAASqQ,GAAUF,EAAMzU,EAAGqQ,EAAG/L,WAChB2P,GAASjU,MAAlB6F,OAAGC,WACMmO,GAAS5D,MAAlBtK,OAAGC,UAEDD,EAAHF,EAAO,KAAM+O,EAAE/O,EAAIA,EAAGE,EAAIA,EAAG6O,KAC1B5O,EAAHF,EAAO,KAAM8O,EAAE9O,EAAIA,EAAGE,EAAIA,EAAG4O,QAEnB,KAAVtQ,GACHmQ,EAAKhZ,KAAK,CAACoK,EAAGC,EAAGC,EAAGC,EAAG,sBACNH,cAAMC,cAAMC,cAAMC,SAEnCyO,EAAKhZ,KAAK,CAACoK,EAAGC,EAAGC,EAAGC,EAAI1B,uBACLA,eAAUuB,cAAMC,cAAMC,cAAMC,QAI1C,SAASxB,GAAMoP,EAASiB,EAAYpQ,WACtCqQ,EAAQ,GACRpC,EAAQ,EACRoB,GAAS,EAAOiB,GAAK,EAChBrd,EAAmB,MAAfkc,EAAQlc,GAAa,EAAI,EAAGA,EAAIkc,EAAQjc,OAAQD,IAAI,KAC5DsR,EAAM4K,EAAQlc,MACP,KAAPsR,EACH8K,GAAUA,OACJ,IAAKA,KACA,KAAP9K,GAA8B,KAAhB4K,EAAQlc,EAAE,GAC3Bqd,GAAK,OACC,GAAW,KAAP/L,GAA8B,KAAhB4K,EAAQlc,EAAE,GAClCqd,GAAK,OACC,IAAKA,EAAG,KACRC,EAAkB,MAARhM,KACZgM,GAAWvB,GAAOzK,GAAK,SACA2K,GAAQC,EAASlc,EAAG,OAAzCwc,OAAM/V;AAAMmG,OACb2Q,EAAO9W,EAAM,GAEZmG,IAAWuQ,GAAcvQ,GAC1BA,IAEF5M,GAAK4M,EAAM3M,QAAUqd,EAAU,EAAI,IAEZ,MAApBpB,EAAQqB,EAAK,KAAejB,GAAWE,IAAUzP,GAAUA,EAAOyP,MAErEgB,GAASJ,EAAOlB,EAASlc,EAAGgb,EADpBmC,EAAaX,EAAOD,GAASC,IAErCxB,EAAQuC,EAAK,IAGPJ,IAEPK,GAASJ,EAAOlB,EAASlc,EAAGgb,EADpB,CAACpO,EAAO4P,EAAMc,IAEtBtC,EAAQuC,EAAK,GAEdvd,EAAIud,WAMJvC,GAAOkB,EAAQjc,QAClBmd,EAAMrZ,KAAKmY,EAAQzP,OAAOuO,IACpBoC,EAGR,SAASI,GAASJ,EAAOlB,EAASlc,EAAGgb,EAAO5a,GACnC,IAAJJ,GACHod,EAAMrZ,KAAKmY,EAAQzP,OAAOuO,EAAOhb,EAAEgb,IACpCoC,EAAMrZ,KAAK3D,GC7IZ,SAASqd,GAAerc,SAChB,CACNC,KAAM,iBACNsB,IAAK,uBACL4E,WAAU,EACV/F,SAAU,SAASW,OACdgE,EAAO,UACRhE,EAAIwC,OACNwB,GAAQ,+DAAiEhE,EAAIwC,KAAO,cACrFwB,GAAQhE,EAAI/B,OAASE,MAAMC,KAAKC,YAAYG,MAAMwB,EAAIC,KAAOD,EAAIC,IAGlEtC,KAAMsB,EACNiB,GAAG,CACFqb,YAAa,SAAStb,OACjBub,EAASpb,KAAKpB,OAAOkC,UACtBsa,EAAO,KACLtc,EAAOf,MAAM8C,GAAGua,GAAQlW,mBACxBiE,EAAS,CAACnJ,KAAK+W,QAAQlX,OACxB9B,MAAM8C,GAAGua,GAAQxc,OAAOwO,KAAK,KAC3BA,EAAOtO,EAAK+B,GAAG,SAAS0M,gBACzBH,IACFjE,EAASA,EAAOxL,OAAO,CAACyP,EAAK/Q,MAAM+Q,EAAKlJ,OAE1CpF,EAAK8C,UAAU,YAAYuH,aCrE1B3K,QAAQ,CACbC,KAAM,cACNC,SAAS,gBACTC,eAAMC,cACLA,EAAO6B,QAAU,CAChB3B,KAAM,kBACNvB,KAAMqB,EAAOyc,aAEdzc,EAAO0c,UAAYtb,KAAKsb,eAEnBC,kBAAoB,QACpBjZ,MAAMC,WAAa,6BAEnBN,YAAY,aAAc,SAAC6R,EAAMwG,UAC9BnT,EAAKqU,cACA,KAAT1H,IAE+C,IAA5C,IAAIxX,MAAU6K,EAAKsU,iBAAmB,KAC1CtU,EAAKuU,kBACLvU,EAAKwU,kBAEL5d,MAAMwL,MAAM,WACXpC,EAAKjC,mBAAmB4K,OAAO8L,cAAc,WAG/C7d,MAAMsJ,KAAKwU,aAAavB,WAIrBrY,YAAY,gBAAiB,sBACjClE,MAAM+d,YAAY9b,KAAK+b,gBAElBA,UAAYhe,MAAMie,MAAMhc,KAAKuG,eAAgB,UAAW,SAAA+T,GAC5D2B,EAAKC,QAAQ5B,QAIhBgB,mBAAUzd,OACLwJ,EAAO,GACLvG,EAASd,KAAKkF,mBACdiX,EAAape,MAAMkB,SAASmd,WAE9B,IAAIhP,KAAQpN,KAAKub,kBAAkB,KAChC5E,EAAQ3W,KAAKub,kBAAkBnO,QAChCiP,cAAc1F,EAAM,GAAIA,EAAM,GAAIA,EAAM,IAAI,WAE7C4E,kBAAoB,GAGtB1d,GAAmB,KAAVA,EAAM,WACX2M,EAAS1J,EAAO0J,OAAO8R,QACvBhS,EAAQC,GAAM1M,GAAO,EAAM2M,GAC3BH,EAAQvJ,EAAOuI,iBAEjBkT,EAAa,EAET9e,EAAI,EAAGA,EAAI6M,EAAM5M,OAAQD,OAC7BA,EAAE,GAAM,EACV4J,GAAQ8U,EAAW7R,EAAM7M,QACtB,KACG+e,EAAYze,MAAM4D,QAAQ2I,EAAM7M,IAChCgf,EAAYD,EAAYxc,KAAK0c,aAAapS,EAAM7M,GAAG,GAAI6M,EAAM7M,GAAG,IAAM,GACtEkf,EAAa3c,KAAK4c,YAElBC,IAAeL,GAAeG,GAAcA,GAActS,GAC5D8C,EAAO6M,GAASwC,EAAYlS,EAAM7M,GAAG,GAAK6M,EAAM7M,IAC9Cqf,EAAWN,EAAYC,EAAUnS,EAAM7M,GAAG,GAAK6M,EAAM7M,GAErDsf,EAAY,cAAcjS,KAAKR,EAAM7M,OACxCof,GAAgBL,GAAalS,EAAM7M,GAAG,IAAM4M,EAAO,KACjD2S,YAEc,KAAd1S,EAAM7M,EAAE,IAAa6M,EAAM7M,EAAE,IAAOsf,EAAU,KAC7CE,SAAUC,YAEXH,EAAU,KACNpG,EAAQnM,EAAOF,EAAM7M,IAAI8M,MAAM,KACrC4C,EAAO6M,GAASrD,EAAM,IACtBsG,EAAWjD,GAASrD,EAAM,SAG1BsG,EAAWjD,GAASwC,EAAYlS,EAAM7M,EAAE,GAAG,GAAK6M,EAAM7M,EAAE,IACxDyf,EAAeV,EAAYC,EAAUnS,EAAM7M,EAAE,GAAG,GAAK6M,EAAM7M,EAAE,GAC7DA,GAAG,EAGJuf,EAAgBhd,KAAKmd,SAAShQ,EAAK,GAAIA,EAAK,GAAI8P,EAAS,GAAIA,EAAS,GAAIV,GAC1ElV,uDAAqD2V,GAAeT,eAAeQ,EAAYzS,EAAM7M,GAAKqf,EAAS,IAAII,kBAIvHF,EAAgBhd,KAAKmd,SAAShQ,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIoP,GAClElV,uDAAqD2V,GAAeT,eAAeO,aAIhFE,IACHT,GAFc,GAEAA,GAAuB,EAAgB,QAGtDlV,GAAQyV,OAKXzV,EAAO8U,EAAWte,UAEnBiD,EAAOD,GAAG,SAAS+G,UAEhBwV,SAASC,eAAiBrd,KAAKuG,gBACjCvG,KAAKsd,aACCjW,GAERqU,sCACO5a,EAASd,KAAKkF,sBAEjBlF,KAAK4c,YAAY,IAChB5c,KAAK4c,aAAe9b,EAAOuI,iBAAiB,KACxC5C,EAAMzG,KAAKY,WAEXuM,EAAOnN,KAAKpB,OAAO2e,gBACpBC,OAAO,CAACD,WAAW,OAExBzc,EAAO2c,UAAUzd,KAAK4c,aAEtB7e,MAAMwL,MAAM,WACXzI,EAAOgP,OAAOnQ,OAAOwN,EAAKhC,IAAKgC,EAAK/B,QACpCsS,EAAK3c,SAAS0F,GACdiX,EAAK/B,2BAGA3b,KAAK4c,cAGdP,uBAAclR,EAAKlB,EAAKwO,EAAOkF,WACxBvd,8CAA2CqY,GACxC5B,EAAI1L,EAAI9O,MAAOwa,GAAK1L,EAAIjH,IAAK2S,QAChC,IAAIC,EAAI7M,EAAI5N,MAAOya,GAAM7M,EAAI/F,IAAK4S,SACjC5R,mBAAmBrE,GAAG,SAAS8c,EAAO,gBAAgB,cAAc9G,EAAGC,EAAG1W,GAAK,IAEvF8b,iBAAQ5B,OACHxG,EAAOwG,EAAEsD,OAAStD,EAAEuD,WAGb,GAAR/J,GAAmB,GAALA,GAAWA,EAAK,IAAkC,MAA5B9T,KAAKY,WAAW8F,OAAO,GAAU,KACnEoX,EAAe,IAARhK,EAAY,OAAiB,KAATA,EAAY,QAAgB,IAAPA,EAAU,OAAO,KACxD,IAATA,IACHgK,EAAM,cAEFnC,uBACAzW,mBAAmB4K,OAAO8L,cAAckC,KAG/CR,0BACKxc,EAASd,KAAKkF,uBACdlF,KAAK4c,aAAe5c,KAAK4c,aAAe9b,EAAOuI,iBAAiB,KAC/D8D,EAAOnN,KAAKpB,OAAO2e,WACnBtW,EAAOnG,EAAOgP,OAAOiO,YAAY5Q,GAClCA,GAAQlG,IACVA,EAAK4I,yBAAoB9R,MAAMkB,SAASmd,OAAOpc,KAAKY,yBAGvD+a,+BACKqC,EAAOhe,KAAKY,WACZE,EAASd,KAAKkF,mBACdiI,EAAOnN,KAAKpB,OAAO2e,WAElBpQ,EAKD6Q,GAFOld,EAAOmd,aAAa9Q,EAAKhC,IAAKgC,EAAK/B,eAGvCxM,OAAOf,MAAQmgB,EACpBld,EAAOod,aAAa/Q,EAAKhC,IAAKgC,EAAK/B,OAAQ4S,GAC3Cld,EAAO8G,WAPR5H,KAAKe,SAAS,WAWRD,EAAOqd,kBAEfC,uBAAcvgB,QACRgK,aAAahK,IAEnBgK,sBAAahK,QACP4d,gBAAkB,IAAInf,SAErBqd,EAAU3Z,KAAKY,cAClB+Y,GAA+B,MAApBA,EAAQjT,OAAO,GAAS,KAC/BJ,EAAStG,KAAKuG,eAAeC,eAC/BG,EAAOgT,EAAQ/S,UAAU,EAAGN;AAC5BO,EAAO8S,EAAQ/S,UAAUN,GAK7BK,GAHmB,gBAAgBmE,KAAKnE,GAAQA,EAAK9D,QAAQ,gBAAiBhF,GAAS8I,EAAO9I,IAG9D,KAAXgJ,EAAK,GAAY,GAAK,UAEtC9F,SAAS4F,EAAOE,QAChBN,eAAe8X,kBAAkB1X,EAAKjJ,OAAQiJ,EAAKjJ,UAG1D4gB,2BACK1a,EAAO5D,KAAKY,WAAW2d,cAChB3a,EAAKsG,OAAOtG,EAAKlG,OAAO,EAAE,GACzBoF,MAAM,SAEnB0b,8BACK5a,EAAO5D,KAAKY,WACV0F,EAAStG,KAAKuG,eAAeC,qBACjB,KAAX5C,EAAK,IAAaA,EAAK0C,EAAO,IAAM1C,EAAK0C,EAAO,GAAGxD,MAAM,kBAEjE2b,kBAAStU,EAAOtH,OAIX8D,EAAME,EAHJP,EAAStG,KAAKuG,eAAeC,eAC7BmT,EAAU3Z,KAAKY,WAKlBiC,IACFA,EAAU7C,KAAKwb,eAAiBlV,GAAUtG,KAAKwb,cAAczO,IAAM/M,KAAKwb,cAAckD,SAEjFC,EAAU9b,EAAU7C,KAAKwb,cAAczO,IAAMzG,EAEnDK,EAAOgT,EAAQ/S,UAAU,EAAG+X,GAAWxU,EACvCtD,EAAO8S,EAAQ/S,UAAUN,QAEpBkV,cAAgB,CAACzO,IAAK4R,EAASD,IAAKvU,EAAMzM,aAE1CqD,SAAS4F,EAAOE,IAEtB6V,sBAAarS,EAAO0Q,WACDhd,MAAMwH,YAAYwV,IAAkC,GAAvB1Q,EAAMrD,QAAQ,KAAa+T,cAClD1Q,OAAWA,GAAS,KAE7CuU,qBAAYC,EAAOC,SACX,CACNziB,MAAOK,KAAKqiB,IAAIF,EAAOC,GACvB5a,IAAKxH,KAAKsT,IAAI6O,EAAOC,KAGvB3B,kBAAS6B,EAAMC,EAAMC,EAAMC,EAAMzc,OAC1ByI,EAAMnL,KAAK4e,YAAYI,EAAME,GAC7BjV,EAAMjK,KAAK4e,YAAYK,EAAME,GAC7B1G,EAAQ,CAACtN,EAAI9O,MAAO8O,EAAIjH,IAAK+F,EAAI5N,MAAO4N,EAAI/F,KAAKrC,KAAK,KACtDud,EAAcpf,KAAKub,kBAAkB9C,MAEvC2G,EAKH,OAAOA,EAAY,QAJd7D,kBAAkB9C,GAAS,CAACtN,EAAKlB,EAAKvH,QACtC2Z,cAAclR,EAAKlB,EAAKvH,KAK7B3E,MAAMqB,GAAGigB,eCjQZthB,MAAMS,QAAQ,CACbC,KAAM,mBACNa,SAAS,CACRc,IAAK,8BACLnB,SAAU,IACVM,MAAO,EACP8C,YAAY,IAEZtE,MAAMqB,GAAGN,MCRXf,MAAMS,QAAQ,CACbC,KAAM,SACNa,SAAS,CACRggB,OAAQ,IACRjd,YAAY,EACZjC,IAAI,qBACJT,QAAQ,EACR4f,KAAM,QACNC,WAAW,IACX9f,QAAO,IAEP3B,MAAM0hB,YAAY1hB,MAAMqB,GAAGsgB,MCV7B3hB,MAAMS,QAAQ,CACbE,SAAU,SACVD,KAAK,gBACLkhB,OAAO,eACF9hB,EAAQmC,KAAKY,YAAcZ,KAAKpB,OAAOghB,aACtC7e,UAAUlD,IAEhBuF,UAAU,SAASvF,GACfA,GAASmC,KAAKpB,OAAOihB,SACvBhiB,GAAQ,EACDA,GAASmC,KAAKpB,OAAOghB,UAC5B/hB,GAAQ,GACTE,MAAMqB,GAAGugB,OAAOxc,UAAUC,UAAUR,KAAK5C,KAAKnC,IAE/C+C,SAAS,eACJhC,EAASoB,KAAKpB,OACdf,EAAQe,EAAOf,aACVA,GAASA,GAAOe,EAAOihB,SAAmCjhB,EAAOghB,UAAS,EAAzChhB,EAAOihB,WAAU,GAE5DvgB,SAAS,CACRL,SAAS,SAASW,EAAKkgB,OAClB1f,GAAqB,IAAdR,EAAI/B,OAAiB+B,EAAI/B,OAAS+B,EAAIggB,QAAW,iBAAmB,GAC3EG,EAAMD,EAAOtd,aAAa5C,EAAKkgB,SAC5B,2BAA2B1f,EAAI,kBAAkBR,EAAIogB,OAAO,cAAcpgB,EAAIqgB,QAAQ,OAAOF,EAAI,YAGxGhiB,MAAMqB,GAAGugB,QAIZ5hB,MAAMS,QAAQ,CACbC,KAAK,uBACLC,SAAS,SACTwhB,cAAa,EACbnf,SAAS,gBACHof,aACLpiB,MAAMqB,GAAGugB,OAAOxc,UAAUpC,SAAS8C,MAAM7D,KAAM8D,gBAC1Csc,iBAEJriB,MAAMqB,GAAGugB,QCxCZ5hB,MAAMS,QAAQ,CACbC,KAAM,mBACNa,SAAS,CACR+C,YAAY,GAEb1D,MAAO,gBACD2D,MAAMC,WAAa,+BAExBxE,MAAMqB,GAAGH,ULRXlB,MAAMS,QAAQ,CACbC,KAAM,gBACNC,SAAU,SACVY,SAAS,CACRyC,KAAK,aACLxC,MAAO,IAERZ,MAAO,SAASC,WACV0D,MAAMC,WAAa,wBAAwB3D,EAAOyhB,MAAM,4BAA4B,IACtFzhB,EAAOkG,OAASlG,EAAOwD,KAAK,KAC1BA,EAAQxD,EAAOwD,MAAMxD,EAAOH,KAC/BmF,EAAOhF,EAAOkG,OAAO,GACnBlG,EAAOyhB,QACTzc,GAAQ,mGACThF,EAAOkG,MAAQ,+DAA+D1C,EAAK,aAAawB,EAChGhF,EAAOI,QAAUjB,MAAMC,KAAKC,YAAYE,SAASS,EAAOH,OAAO,GAE7DG,EAAOC,UAAYD,EAAOyE,QAC5BzE,EAAOyE,MAAQ6X,GAAetc,EAAOC,YAEtCd,MAAMqB,GAAGgc,QAGXrd,MAAMS,QAAQ,CACbC,KAAM,yBACNC,SAAU,SACVY,SAAS,CACRyC,KAAK,aACLxC,MAAO,GACPuC,OAAQ,IAETnD,MAAO,SAASC,WACV0D,MAAMC,WAAa,0BACrB3D,EAAOkG,MAAO,KACZ1C,EAAQxD,EAAOwD,MAAQxD,EAAOH,MAAM,GACvCmF,EAAOhF,EAAOkG,MACflG,EAAOkG,MAAQ,+DAAiE1C,EAAO,iBACvFxD,EAAOkG,OAAS,6CAA6ClB,EAAK,UAC9DhF,EAAOyhB,QACVzhB,EAAOkG,OAAS,oFACjBlG,EAAOI,QAAUjB,MAAMC,KAAKC,YAAYE,SAASS,EAAOH,OAAO,GAE7DG,EAAOC,UAAYD,EAAOyE,QAC5BzE,EAAOyE,MAAQ6X,GAAetc,EAAOC,YAEtCd,MAAMqB,GAAGgc,QM7CXrd,MAAMS,QAAQ,CACbC,KAAK,gBACLa,SAAS,CACRoF,QAAQ,EACR3C,KAAK,QACLM,YAAW,EACXie,eAAe,CACdC,WAAW,KAGb5hB,MAAM,SAASC,GACdA,EAAOuB,KAAO,CAAC,CAAC2B,OAAO,YAClBP,OAAOC,KAAK,gBACXgf,mBAGPA,8BACMve,YAAY,WAAY,SAAS+b,OAC/Bvf,EAAOuB,KAAKygB,aAAa7hB,OAAOH,aAEjC0hB,aACM,QAAR1hB,EAAe,KACb,IAAIhB,KAAKuC,KAAKwE,cACZA,SAAS/G,GAAGsD,SAASid,GACvBA,GACHhe,KAAK0gB,iBAAiB,GAAG3f,SAAS,OAEhC,KACG4f,EAAQ3gB,KAAKY,WAAWlD,YACzB8G,SAASoc,KAAK7f;AAAS4f,GAAS3gB,KAAK6gB,OAAS,EAAI,GACnDF,GACH3gB,KAAK0gB,iBAAiB,GAAG3f,SAAS,QAE/Bqf,kBAGPrf,SAAS,SAASlD,WACZ2G,SAAW,QACXqc,OAAShjB,EAAMH,OAEF,EAAfG,EAAMH,OAAW,KACf8G,EAAW,GACXsc,EAAO,GAGXjjB,EAAMkjB,QAAQ,SAAA1W,GACbyW,EAAKtf,KAAK,CAAE1C,KAAM,WAAYkiB,WAAY3W,EAAM5L,KAAMA,KAAM4L,EAAM5L,KAAMZ,MAAOwM,EAAM4W,eAGhFC,EAAaJ,EAAKpjB,OAASK,MAAMsC,KAAKsE,QAAQwc,YAC9CzhB,EAPY,IAOHwhB,EAEf1c,EAAShD,KAAK,CACb1C,KAAK,aAAcC,KAAK,CAACoB,KAAK2gB,GAC9BphB,OAAQA,EACRoC,OAAQpC,EAZS,IAYYwhB,IAG9B1c,EAAShD,KAAK,CAAEvC,SAAS,kCAAmC6C,OAAO,KACnE0C,EAAShD,KAAK,CAAE1C,KAAK,WAAYkiB,WAAWjjB,MAAMC,KAAKC,YAAYC,OAAO,qBAAsBO,KAAK,OAAQZ,MAAM,IAEnHE,MAAMqB,GAAGoF,EAAUxE,WAEkB,EAA9BA,KAAKqB,gBAAgB3D,QAC5BK,MAAMqB,GAAG,CAAC,CAAC0C,OAAO,OAAY9B,OAGhCY,SAAS,mBACFwgB,EAAaphB,KAAK0gB,iBACpBW,EAAS,GAGL5jB,EAAI,EAAGA,EAAI2jB,EAAW1jB,OAAQD,IAClC2jB,EAAW3jB,GAAGmD,YAChBygB,EAAO7f,KAAK4f,EAAW3jB,GAAGmB,OAAOH,aAE5B4iB,GAERX,8BACOY,EAAathB,KAAKuhB,UAAU,qBAC3BD,EAAaA,EAAWlgB,UAAUC,gBAAkB,KAE1DtD,MAAMqB,GAAGyF,MClFZ9G,MAAMS,QAAQ,CACbC,KAAK,WACLa,SAAS,CACR2M,SAAU,EACVnK,OAAQ,KAETnD,MAAM,SAASC,cAEdA,EAAOa,KAAO,CACb,CACCW,IAAI,kBACJnB,SAASL,EAAOkG,MAChBvF,MAAMX,EAAO2hB,WACble,YAAW,GAEZ,CACCvD,KAAK,OACLvB,KAAKqB,EAAOrB,KACZ6C,IAAIxB,EAAOwB,IACXnB,SAASL,EAAOK,SAChBU,QAAQ,EACRD,QAAO,EACP2C,YAAW,EACXvC,GAAG,CACF0hB,eAAe,WACdra,EAAKlH,gBAAgB2B,UAAU,WAAY,SAMhDb,SAAS,SAASlD,QAAYwD,gBAAgB,GAAG1B,OAAO9B,IACxD+C,SAAS,kBAAkBZ,KAAKqB,gBAAgB,GAAGF,iBACnDyG,QAAS,gBAAgBvG,gBAAgB,GAAGuG,WAC5C6Z,MAAM,cACJ1jB,MAAMqB,GAAGkgB,cCnCN9gB,QAAQ,CACbC,KAAM,YACNa,SAAS,CACRmG,MAAK,EACLrF,IAAI,oCACJsF,MAAK,EACLgc,QAAO,EACPC,SAAQ,EACRC,SAAS,GACTC,UAAU,IACVC,SAAQ,EACRC,SAAQ,GAETpjB,MAAM,gBAEA2D,MAAM0f,aAAa,cAAe,UAElCzgB,OAAOC,KAAK,WAChBzD,MAAMkkB,UAAUC,UAAU,SAAUnkB,MAAM0D,KAAKzB,KAAKmiB,YAAaniB,OACjEjC,MAAMkkB,UAAUC,UAAU,YAAankB,MAAM0D,KAAKzB,KAAKmiB,YAAaniB,YAC/DoiB,iBAEDngB,YAAY,aAAc,WAC9BlE,MAAM+d,YAAY9b,KAAKqiB,eAClBC,MAAMC,gBAGbC,YAAY,SAAS3kB,UAChBA,GACHE,MAAM0kB,YAAYC,QAAQ1iB,KAAKsC,MAAOtC,MAEhCnC,GAER8kB,SAAS,SAAS5V,EAAKuN,eACjB1Y,UAAU,aAAc,CAACmL,EAAKuN,IAC5BvN,GAER6V,YAAY,SAASC,EAAQvI,OACtBwI,EAAMxI,EAAEyI,UACTD,EAAIE,eAAgBF,EAAIE,aAAa,wBAAyBF,EAAIE,aAAa,qBAG/EZ,UAAUzhB,WACTsiB,EAAWllB,MAAMsJ,KAAKC,OAAOub,GAC7BK,EAAQnlB,MAAMsJ,KAAK0F,IAAIuN,GACvB6I,EAAUplB,MAAMsJ,KAAKC,OAAOub,EAAOO,YACnCC,EAAQtlB,MAAM8C,GAAGb,KAAKpB,OAAOkC,QAAQwiB,wBAE3CvlB,MAAM0kB,YAAY/V,IAAMuW,EAASxb,EAAIyb,EAAMzb,EAAI0b,EAAQ1b,EACvD1J,MAAM0kB,YAAYlW,KAAO0W,EAASvb,EAAIwb,EAAMxb,EAAIyb,EAAQzb,EAAI2b,EAAM3b,EAE3D3J,MAAMwlB,OAAOvjB,KAAKsC,SAE1BkhB,aAAa,SAASvc,EAAMsY,OACrB7X,EAAI1H,KAAKpB,OAAO2N,KAAO3C,SAAS2V,EAAKhc,MAAMgJ,KAAK,IAChD9E,EAAIzH,KAAKpB,OAAO8N,IAAM9C,SAAS2V,EAAKhc,MAAMmJ,IAAI,IAEpD3O,MAAM0kB,YAAY/V,IAAM3O,MAAM0kB,YAAYlW,KAAO,OAE5C3K,UAAU,gBAAiB,CAAC8F,EAAGD,KAGrC2a,QAAQ,sBACDlkB,EAASH,MAAMC,KAAKC,YAAYC,WAClC8B,KAAKsiB,MAAM,KACV/kB,EAAO,CACV,CAAEM,MAAMK,EAAO,eAAgBulB,QAAQ,CACtC,CAAE5jB,GAAG,MAAOhC,MAAMK,EAAO,oBACzB,CAAE2B,GAAG,MAAOhC,MAAMK,EAAO,oBACzB,CAAE2B,GAAG,QAAShC,MAAMK,EAAO,yBAIzBH,MAAM8C,GAAGb,KAAKpB,OAAOkC,QAAQoE,mBAAmBtG,OAAO8kB,WAC1DnmB,GACC,CAAEsC,GAAG,OAAQhC,MAAMK,EAAO,wBACvBX,IACH,CAAEsC,GAAG,MAAOhC,MAAMK,EAAO,wBAGtBokB,MAAQvkB,MAAMqB,GAAG,CACrBN,KAAK,cACL6kB,cAAc,CACbC,WAAY5jB,KAAKpB,OAAOiB,IAEzBtC,KAAKA,EACLuC,GAAG,CACF+jB,gBAAiB,SAAAhkB,UAAMsH,EAAK2c,aAAajkB,IACzCkkB,aAAc,kBAAM5c,EAAK6c,uBAGrBC,EAAOlmB,MAAMsJ,KAAK+J,OAAO,OAAQ,SAAS,oDAC3CiR,SAAWtkB,MAAMie,MAAMiI,EAAM,QAAS,WACvC9c,EAAKmb,MAAMva,YACbZ,EAAKmb,MAAM3hB,OAEXwG,EAAKmb,MAAM3a,KAAKsc,UAEb3hB,MAAMmB,WAAWsM,YAAYkU,UAE5BjkB,KAAKsiB,OAEbwB,aAAa,SAASjkB,UACdA,OACD,WACC+B,UAAU,eAAgB,cAE3B,YACCA,UAAU,aAAc,cAEzB,MACJ7D,MAAMmmB,MAAMlkB,KAAKoB,UAAW,CAAC+iB,QAAQ,oBAEjC,MACJpmB,MAAMqmB,MAAMpkB,KAAKoB,qBAEb,QACJrD,MAAMia,QAAQhY,KAAKoB,UAAW,CAACijB,QAAQ,MAI1CL,aAAa,eACNllB,EAAOkB,KAAKoB,UACftC,EAAKvB,MAAQuB,EAAKvB,KAAK+mB,KACzBtkB,KAAKsiB,MAAMiC,SAAS,SAEpBvkB,KAAKsiB,MAAMkC,SAAS,UAEtBrC,YAAY,SAASrjB,GACjBA,GAAQA,EAAKoG,oBAAsBlF,MACrCA,KAAK4B,UAAU,eAAgB,MAE/B7D,MAAMqB,GAAGoG,QCpIZzH,MAAMS,QAAQ;AACbC,KAAM,gBACNE,MAAO,SAASC,cACfA,EAAOuB,KAAO,CACb,CACCrB,KAAM,aACNuD,YAAY,EACZtD,KAAM,CACLD,KAAM,YACNsB,IAAK,yBACLZ,OAAQzB,MAAMsC,KAAKsE,QAAQ8f,aAAa5f,KACxC6f,OAAO,EACP3iB,KAAM,QACN5B,KAAM,CACLH,KAAK2kB,qBAGP7kB,GAAG,CACF8kB,cAAc,WAEb7mB,MAAM6D,UAAU,UAAW,OAI9B,CAAE9C,KAAK,SAAUgG,MAAM/G,MAAMC,KAAKC,YAAYC,OAAO,YAAa+G,MAAM,WACvEkC,EAAK0d,iBAIRF,iBAAkB,SAASlnB,cACpBqB,EAAOkB,KACP9B,EAASH,MAAMC,KAAKC,YAAYC,OAChC4mB,EAAY,sEACZpgB,EAAU3G,MAAMsC,KAAKsE,QAAQogB,YAAY,QAExC,CACNjmB,KAAK,gBACLulB,iBAAUnmB,EAAO,0BAAiBT,EAAIA,EAAE,EAAI,cAAKqnB,GACjD/lB,KAAK,CACJD,KAAK,OACL4F,QAAAA,EACA4b,eAAe,CACdC,WAAW,KAEZzgB,GAAG,CACFU,SAAU,WACTyb,EAAKra,UAAU,WAAY,MAG7B4C,SAAS,CACR,CAAE1F,KAAK,OAAQgG,MAAM5G,EAAO,eAAgBO,KAAK,QAAS0L,OAAM,EAAMrK,GAAG,CACxEU,SAAU,SAASiG,EAAKue,OACjBC,EAAQxe,EAAIye,cACfze,GAAOwe,SACJ9E,kBACApf,SAASkkB,QACT7E,gBAENthB,EAAK8C,UAAU,gBAAiB,CAACqjB,EAAOD,OAG1C,CAAElmB,KAAK,qBAAsBgG,MAAM5G,EAAO,sBAAuBO,KAAK,SACtE,CAAEK,KAAK,WAAYgG,MAAM5G,EAAO,iBAAkBO,KAAK,WACvD,CAAEK,KAAK,aAAcgG,MAAM5G,EAAO,iBAAkBL,MAAM,SAAUY,KAAK,SAAU0mB,QAASnlB,KAAKolB,eAChG3kB,QAAQ,CACP3B,KAAM,sBACNvB,KAAM,CACL,CAACsC,GAAG,SAAUhC,MAAMK,EAAO,yBAC3B,CAAC2B,GAAG,WAAYhC,MAAMK,EAAO,2BAC7B,CAAC2B,GAAG,UAAWhC,MAAMK,EAAO,0BAC5B,CAAC2B,GAAG,QAAShC,MAAMK,EAAO,6BAM/BmnB,QAAQ,aACM,eACN/F,EAAStf,KAAKC,gBACpBqf,EAAOgG,WAAWtlB,cAEZulB,EAASjG,EAAOje,gBAEb5D,EAAI,EAAGA,EAAI8nB,EAAO7nB,OAAQD,IAClC8nB,EAAO9nB,GAAG+f,OAAO,CAAC6G,iBAAUnmB,EAAO,0BAAiBT,EAAE,cAAKqnB,KAC3DS,EAAO9nB,GAAGmK,iBAGX9I,EAAK8C,UAAU,WAAY,KACpB,MAKXijB,WAAY,eACLvF,EAAStf,KAAKwlB,YACdC,EAAYnG,EAAOje,gBAAgB3D,OACnCgoB,EAAWpG,EAAOqG,QAAQ3lB,KAAK2kB,iBAAiBc,IAEtD1nB,MAAM8C,GAAG6kB,GAAUnE,UAAU,CAAC9iB,KAAM,UAAUgjB,SAE/C1gB,SAAU,SAASlD,GAClBA,EAAQA,GAAS,OAGX0nB,EADSvlB,KAAKwlB,YACEnkB,gBAChBsf,EAAQ4E,EAAO7nB,UAElBijB,EAAQ9iB,EAAMH,OAChB,IAAI,IAAID,EAAIkjB,EAAOljB,EAAII,EAAMH,OAAQD,SAC/B+nB,YAAYF,WAAWC,EAAO9nB,EAAE,SAClC,GAAGI,EAAMH,OAASijB,EACtB,IAAI,IAAIljB,EAAII,EAAMH,OAAYijB,EAAJljB,EAAWA,SAC/BonB,iBAEH,IAAIpnB,EAAI,EAAGA,EAAI8nB,EAAO7nB,OAAQD,IAAI,KAC/BoH,EAAO0gB,EAAO9nB,GAAG4D,gBAAgB,GACjC8I,EAAQtF,EAAK0c,UAAU,CAAC9iB,KAAM,UAGpC0L,EAAMgW,aACNtb,EAAK+gB,UAAU/nB,EAAMJ,IACrB0M,EAAMiW,iBAGRyF,YAAa,SAASC,EAAKjoB,GAC1BioB,EAAI3F,aACJ2F,EAAI/kB,SAASlD,GACbioB,EAAI1F,gBAELoF,4BACQxlB,KAAKuhB,UAAU,cAAcngB,WAErC2kB,YAAa,SAASpe,QAChByd,eAAiBzd,OACjB4Z,UAAU,aAAc,OAAOR,QAAQ,SAAAiF,GACxCre,EACFqe,EAAOre,OAEPqe,EAAOrlB,UAGVC,SAAU,eACH/C,EAAQ,UAECmC,KAAKwlB,YACbnkB,gBAAgB0f,QAAQ,SAAAkF,GAC9BpoB,EAAM2D,KAAKykB,EAAM5kB,gBAAgB,GAAG6kB,eAE9BroB,IAENE,MAAMqB,GAAGkgB,cCpJN6G,QAAQC,WAAaroB,MAAMiU,OAAO,CACvCqU,YAAY,eACLhgB,EAAStI,MAAMooB,QAAQC,eAEzB/f,EAAOhD,MAAM,KACVA,EAAQtF,MAAMqB,GAAG,CACtBN,KAAK,QACLC,KAAK,CACJD,KAAK,WACLwnB,OAAM,EACNC,YAAW,EACXzmB,GAAG,CACFU,SAAU,SAASiG,GAClBA,EAAMA,EAAI,QACLxG,gBAAgBumB,mBAAmB3oB,MAAQ4I,EAAMzJ,EAAmByJ,GAAO,GAChF1I,MAAM6D,UAAU,YAAa,OAIhC9B,GAAG,CACF2mB,QAAS,WACR1oB,MAAM6D,UAAU,YAAa,QAIhCyE,EAAOhD,MAAQA,EAAMzE,OAAOiB,UAGtBwG,EAAOhD,OAEfqjB,OAAO,sBACAzf,EAAOlJ,MAAMsJ,KAAK+J,OAAO,MAAO,SAC7B,mBACN,mCAEE/N,MAAQrD,KAAKqmB,cAElBtoB,MAAMie,MAAM/U,EAAKxD,WAAY,QAAS,kBAAK0D,EAAKzF,WAAWiG,KAAKV,KAEzDA,GAERvF,2BACQ3D,MAAM8C,GAAGb,KAAKqD,QAEtBsjB,UAAU,eACHC,EAAQ5mB,KAAKuG,eACblD,EAAQrD,KAAK0B,WAEnB2B,EAAMmjB,mBAAqBI,EAC3BvjB,EAAMsE,KAAKif,GAEXA,EAAM5E,aAAa,gBAAiB,SAErC6E,wBAAehpB,OACRipB,EAAW9mB,KAAK0B,WAAWN,UAEjC0lB,EAAS3G,aACT2G,EAAS/lB,SAASlD,GAClBipB,EAAS1G,gBAEV2G,YAAY,gBACNJ,aAEN5lB,SAAS,SAASlD,GAEjBA,EAD0B,KAAVA,GAAgBR,MAAY,EAANQ,GACrB,IAAIvB,KAASM,EAAmBiB,QAC5CgpB,eAAehpB,OAEd2R,EAASyJ,GAAkBjZ,KAAKpB,OAAOuM,IAAKnL,KAAKpB,OAAOiB,SACzD0G,eAAe1I,MAAQ2R,EAAO3R,IAEpC+C,SAAS,eACF/C,EAAQmC,KAAKuG,eAAe1I,kBAC7B6D,WAAWf,OACT9C,IAENE,MAAMooB,QAAQviB,MC/EjB7F,MAAMooB,QAAQa,cAAgBjpB,MAAMiU,OAAO,CAC1CJ,UAAU,SAAS/T,OAEduI,EADEsZ,EAAO1f,KAAKuG,sBAGd1I,GAAS6hB,EAAKuH,OAAOppB,KACxBuI,EAAOsZ,EAAK3I,QAAQlZ,IACduI,GAAQA,EAAKoJ,QAErB0X,UAAU,SAAS7jB,GAClBtF,MAAMooB,QAAQ9mB,WAAW6nB,UAAUrjB;AAAM7D,KAAM8D,WAE/CT,EAAMrC,UAAUwc,OAAO,WAAY,SAAS5d,UACpCA,EAAIunB,QAAUvnB,EAAI/B,UAGzBE,MAAMooB,QAAQ9mB,gBCdJ+nB,GAAU,CACtB9Y,KAAM,SAASxP,OACVqL,EAAQrL,EAAK+B,GAAG,SAAS0M,mBAC1BpD,KAsDL,SAASkd,EAASvoB,EAAKqL,OAClB1M,EAAGgZ,EACN6Q,EAAKnd,EAAM9N,MACXwP,EAAK1B,EAAMjG,QAEPzG,EAAW,EAAP6pB,EAAGnc,IAAO1N,GAAY,EAAPoO,EAAGV,IAAO1N,QAC5BgZ,EAAc,EAAV6Q,EAAGlc,OAAUqL,GAAe,EAAV5K,EAAGT,OAAUqL,OACpC3X,EAAK+B,GAAG,SAAS0N,QAAQ9Q,EAAGgZ,GAC9B,OAAO,SAGH,EAhEF4Q,CAASvoB,EAAKqL,GAChBrL,EAAKyoB,gBAEF,SACCxV,EAAS,GACL8E,EAAI1M,EAAM9N,MAAM8O,IAAK0L,GAAG1M,EAAMjG,IAAIiH,IAAK0L,IAAI,KAC9C,IAAIC,EAAI3M,EAAM9N,MAAM+O,OAAQ0L,GAAG3M,EAAMjG,IAAIkH,OAAQ0L,IAAI,KACpDjZ,EAAQiB,EAAKmf,aAAapH,EAAEC,MAC7BjZ,GAAOkU,EAAOvQ,KAAK3D,GACJ,EAAfkU,EAAOrU,OAAW,SAEJ,EAAfqU,EAAOrU,OAAW,MAEL,EAAdqU,EAAOrU,OACToB,EAAK0oB,QAAQ,CACZ5jB,KAAK7F,MAAMC,KAAKC,YAAYC,OAAO,wBACjCupB,KAAK,kBAAK3oB,EAAK4oB,iBAGlB5oB,EAAK4oB,iBAITC,KAAM,SAAS7oB,GACdA,EAAK6oB,QAENC,KAAM,SAAS9oB,GACdA,EAAK8oB,yBAEY,SAAS9oB,GAC1BA,EAAK+oB,cAAc,0BAEJ,SAAS/oB,GACxBA,EAAKgpB,YAAY,4BAEA,SAAShpB,OAEtBa,EADQb,EAAK+B,GAAG,SACDM,gBACnBrC,EAAKipB,cAAcpoB,GAAyB,SAAfA,EAAOyL,OAAgBzL,EAAOyL,OAAS,kBAEvD,SAAStM,OAElBa,EADQb,EAAK+B,GAAG,SACDM,gBACnBrC,EAAKkpB,WAAWroB,EAASA,EAAOwL,IAAM,wBAElB,SAASrM,GAC7B4X,GAAmB5X,EAAM,wBAEL,SAASA,GAC7B4X,GAAmB5X,GAAO,SCnDfmpB,GAAa,CACzB,CAACpoB,GAAI,QAAShC,MAAO,SACrB,CAACgC,GAAI,uBAAwBhC,MAAO,UACpC,CAACgC,GAAI,oBAAqBhC,MAAO,WACjC,CAACgC,GAAI,SAAUhC,MAAO,UACtB,CAACgC,GAAI,UAAWhC,MAAO,WACvB,CAACgC,GAAI,kBAAmBhC,MAAM,YAiBxB,SAASqqB,GAAmBppB,OAC5Bqa,EAASpb,MAAMC,KAAKC,YAAYG,MAClC+pB,EAAgB,CACnB,CAAEtoB,GAAG,MAAUmI,MAAM,SAAUnK,MAAMsb,EAAO,kBAC5C,CAAEtZ,GAAG,MAAUmI,MAAM,SAAUnK,MAAMsb,EAAO,kBAC5C,CAAEtZ,GAAG,OAAUmI,MAAM,SAAUnK,MAAMsb,EAAO,gBAC5C,CAAEtZ,GAAG,OAAUmI,MAAM,SAAUnK,MAAMsb,EAAO,wBAEhB,GAA1Bra,EAAKF,OAAOwpB,YACdD,EAAc3mB,KAAK,CAAE3B,GAAG,SAAUmI,MAAM,SAAUnK,MAAMsb,EAAO,mBACzDgP,EAGD,SAASE,GAAgBvpB,OACzBqa,EAASpb,MAAMC,KAAKC,YAAYG,MAClCkqB,EAAgB,CACnB,CAAEzoB,GAAG,MAAUmI,MAAM,MAAOnK,MAAMsb,EAAO,eACzC,CAAEtZ,GAAG,MAAUmI,MAAM,MAAOnK,MAAMsb,EAAO,eACzC,CAAEtZ,GAAG,OAAUmI,MAAM,MAAOnK,MAAMsb,EAAO,aACzC,CAAEtZ,GAAG,OAAUmI,MAAM,MAAOnK,MAAMsb,EAAO,qBAEb,GAA1Bra,EAAKF,OAAOwpB,YACdE,EAAc9mB,KAAK,CAAE3B,GAAG,SAAUmI,MAAM,MAAOnK,MAAMsb,EAAO,gBACtDmP,EAID,SAASC,WACR,CACN,CAAC1oB,GAAI,cAA6BhC,MAAO2qB,GAAe,UACxD,CAAC3oB,GAAI,cAA6BhC,MAAO2qB,GAAe,UACxD,CAAC3oB,GAAI,4BAA6BhC,MAAO2qB,GAAe,wBACxD,CAAC3oB,GAAI,yBAA6BhC,MAAO2qB,GAAe,qBACxD,CAAC3oB,GAAI,iBAA6BhC,MAAO2qB,GAAe,aACxD,CAAEC,UAAW,aACb,CAAC5oB,GAAI,YAA6BhC,MAAO2qB,GAAe,SAK1D,IAAME,GAAU,CACf,CAAC7oB,GAAI,KAAMhC,MAAO,MAClB,CAACgC,GAAI,OAAQhC,MAAO,QACpB,CAACgC,GAAI,MAAOhC,MAAO,OACnB,CAACgC,GAAI,QAAShC,MAAO,SACrB,CAACgC,GAAI,SAAUhC,MAAO,UACtB,CAACgC,GAAI,MAAOhC,MAAO,OACnB,CAACgC,GAAI,QAAShC,MAAO,SACrB,CAACgC,GAAI,aAAchC,MAAO,eAG3B,SAAS2qB,GAAe3qB,OACnBsb,EAASpb,MAAMC,KAAKC,YAAYG,aAC7B+a,EAAM,MAAY,IAAMA,EAAO,SAAStb,GAAOkJ,cAiBhD,IAAM4hB,GAAe,eACZ,oBACD,2BACK,aAGPvpB,GAAK,CACjBgc,OAAQ,SAASxc,SACT,CACNE,KAAM,gBAAiBS,MAAOX,EAAOW,OAAOyM,EAAazM,MAAOM,GAAIjB,EAAOH,KAAMA,KAAMG,EAAOH,KAAOqG,MAAOlG,EAAOkG,MACnH1E,IAAKxB,EAAOwB,KAAK,GAAIwf,QAAS+I,GAAa/pB,EAAOH,MAAOohB,SAAU,SACnE7gB,QAASjB,MAAMC,KAAKC,YAAYE,SAASS,EAAOH,OAAO,KAGzDmqB,YAAa,SAAShqB,SACd,CACNE,KAAM,eAAiBsB,IAAKxB,EAAOwB,IAAM3B,KAAMG,EAAOH,KAAMc,MAAOX,EAAOW,OAAOyM,EAAazM,MAAM,GACpGgB,MAAO,8FAA8F3B,EAAOH,KAAK,aACjHO,QAASjB,MAAMC,KAAKC,YAAYE,SAASS,EAAOH,OAAO,KAGzDoqB,aAAc,SAASjqB,SACf,CACNE,KAAM,uBAAwBS,MAAOyM,EAAazM,MAAOM,GAAIjB,EAAOH,KAAMA,KAAMG,EAAOH,KACvFqG,MAAO,+DAA+DlG,EAAOH,KAAK,YAClFO,QAASjB,MAAMC,KAAKC,YAAYE,SAASS,EAAOH,OAAO,KAGzDqqB,WAAY,SAASlqB,OAChBmqB,EAAMhrB,MAAMkG,KAAKrF,UACrBb,MAAMiU,OAAO+W,EAAK,CAACjqB,KAAM,SAAUS,MAAOyM,EAAazM,MAAOM,GAAIjB,EAAOH,KACxEqG,MAAO,+DAA+DlG,EAAOH,KAAK,YAClF2B,IAAK,GACLpB,QAASjB,MAAMC,KAAKC,YAAYE,SAASS,EAAOH,OAAOV,MAAMC,KAAKC,YAAYG,MAAMQ,EAAOH,OAAO,KAEhGG,EAAOghB,SACT7hB,MAAMiU,OAAO+W,EAAI,CAACjqB,KAAM,gBAAiB8gB,QAAShhB,EAAOghB,QAASC,SAAUjhB,EAAOihB,WAAU,GAGvFkJ,GAERC,UAAW,SAASpqB,SACX,CACPE,KAAM,YAAaL,KAAMG,EAAOH,KAAM2B,IAAIxB,EAAOwB,KAAK,GAAIb,MAAOX,EAAOW,OAAOyM,EAAazM,MAAM,GAAKV,QAAQD,EAAOC,UAGxHc,OAAQ,SAASf,UAChBb,MAAMiU,OAAOpT,EAAO,CACnBE,KAAM,aACNe,GAAIjB,EAAOH,KACXZ,MAAOuO,EAAcxN,EAAOH,MAC5BgC,QAAS,CACRL,IAAK,uBAELsE,QAAS;AACTnH,KAAMqB,EAAOC,WAIfD,EAAOI,QAAUjB,MAAMC,KAAKC,YAAYE,SAASS,EAAOH,OAAO,GAC5DG,EAAOqqB,aACTrqB,EAAO6B,QAAQC,WAAY,EAC3B9B,EAAO6B,QAAQlB,MAAQX,EAAOqqB,YAE5BrqB,EAAOsqB,gBACTtqB,EAAO6B,QAAQ1B,KAAO,CACrBE,SAAUL,EAAOsqB,gBAEhBtqB,EAAOuqB,cACTvqB,EAAO6B,QAAQ1B,KAAOH,EAAO6B,QAAQ1B,MAAQ,GAC7CH,EAAO6B,QAAQ1B,KAAKe,GAAKlB,EAAOuqB,aAE1BvqB,GAERyT,UAAW,iBACH,CACNvT,KAAM,qBAGRyB,MAAO,SAAS3B,OACX2B,EAAQ3B,EAAO2B,aACO,IAAvBA,EAAMyG,QAAQ,OAChBzG,EAAQ,IAGF,CACNtB,SAHDsB,EAAQxC,MAAMC,KAAKC,YAAYC,OAAOU,EAAO2B,QAAQA,EAGnCzB,KAAM,mBAAoBgD,OAAQkK,EAAaod,cAGlEV,QAAS,SAAS9pB,SACV,CAACE,KAAM,iBAAkBS,MAAMX,EAAOW,OAAOyM,EAAazM,MAAM,GAAIhC,KAAMmrB,GAAS7oB,GAAIjB,EAAOH,KAAMA,KAAMG,EAAOH,KACvHO,QAASjB,MAAMC,KAAKC,YAAYE,SAASS,EAAOH,QAElD4qB,MAAO,SAASzqB,SACR,CAACE,KAAM,eAAgBjB,MAAOuO,EAAcxN,EAAOH,MAAOc,MAAMX,EAAOW,OAAOyM,EAAazM,MAAM,GAAIhC,KAAMqB,EAAOC,QACxHJ,KAAMG,EAAOH,KAAMO,QAASjB,MAAMC,KAAKC,YAAYE,SAASS,EAAOH,QAErE6qB,WAAY,SAAS1qB,SACb,CACNE,KAAM,qBACNS,MAAO,GACPM,GAAIjB,EAAOH,KACXA,KAAMG,EAAOH,QAKH8qB,GAAa,eACV,kBACNnqB,GAAGO,OAAO,CAAClB,KAAM,cAAeI,QAAQopB,GAAY1oB,MAAO,mBAEvD,kBACJH,GAAGO,OAAO,CAAClB,KAAM,YAAaI,QA7HxC,SAAS2qB,YACJC,EAAU,CACb,IAAI,IAAI,KAAK,KAAK,KAAK,KAAK,KAC5B,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAE1BC,EAAW,GAERjsB,EAAG,EAAGA,EAAIgsB,EAAQ/rB,OAAQD,IACjCisB,EAASloB,KAAK,CAAC3B,GAAI4pB,EAAQhsB,GAAGM,MAAMC,KAAKC,YAAYC,OAAOyrB,GAAI9rB,MAAO4rB,EAAQhsB,YAEzEisB,EAmHwCF,GAAejqB,MAAO,oBAEtD,kBACPH,GAAGgc,OAAO,CAAC3c,KAAK,cAAcqG,MAAO,IAAK1E,IAAK,oCAEzC,kBACNhB,GAAGgc,OAAO,CAAC3c,KAAM,aAAaqG,MAAO,IAAI1E,IAAI,2CAElC,kBACXhB,GAAGgc,OAAO,CAAC3c,KAAM,kBAAkBqG,MAAO,IAAI1E,IAAK,kCAElD,kBACDhB,GAAGwpB,YAAY,CAACnqB,KAAM,QAAQ2D,KAAK,OAAOhC,IAAI,mCAExC,kBACLhB,GAAGwpB,YAAY,CAACnqB,KAAM,aAAa2D,KAAK,cAAchC,IAAI,0BAA2Bb,MAAO,cAE1F,kBACHH,GAAGspB,QAAQ,CAAEjqB,KAAM,0BAEb,eACT0a,EAASpb,MAAMC,KAAKC,YAAYE,gBAC7BiB,GAAGiqB,MAAM,CAAC5qB,KAAM,aAAc2B,IAAK,qBAAsBvB,QAAQ,CACvE,CAACgB,GAAI,OAAQO,IAAK,6BAA8BpB,QAASma,EAAO,eAChE,CAACtZ,GAAI,SAAUO,IAAK,+BAAgCpB,QAASma,EAAO,iBACpE,CAACtZ,GAAI,QAASO,IAAK,8BAA+BpB,QAASma,EAAO,qCAGlD,eACbA,EAASpb,MAAMC,KAAKC,YAAYE,gBAC5BiB,GAAGiqB,MAAM,CAAC5qB,KAAM,iBAAkB2B,IAAK,qBAAsBvB,QAAQ,CAC5E,CAACgB,GAAI,MAAOO,IAAK,4BAA6BpB,QAASma,EAAO,cAC9D,CAACtZ,GAAI,SAAUO,IAAK,+BAAgCpB,QAASma,EAAO,iBACpE,CAACtZ,GAAI,SAAUO,IAAK,+BAAgCpB,QAASma,EAAO,0BAG9D,kBACA/Z,GAAG0pB,WAAW,CAACrqB,KAAM,OAAQmhB,QAAQ,OAAQC,SAAS,mBAEpD,kBACFzgB,GAAGO,OAAO,CAChBlB,KAAM,SAAUc,MAAO,IAAKV,QA5O/B,SAAS+qB,QACFzQ,EAASpb,MAAMC,KAAKC,YAAYC,aAC/B,CACN,CAAC2B,GAAI,SAAUhC,MAAOsb,EAAO2G,QAC7B,CAACjgB,GAAI,QAAShC,MAAOsb,EAAO0Q,SAAUC,QAAS,SAC/C,CAACjqB,GAAI,MAAOhC,MAAOsb,EAAO4Q,OAAQD,QAAS,WAC3C,CAACjqB,GAAI,UAAWhC,MAAOsb,EAAO1G,QAASqX,QAAQ,OAC/C,CAACjqB,GAAI,OAAQhC,MAAOsb,EAAO/c,KAAM0tB,QAAQ,SACzC,CAACjqB,GAAI,SAAUhC,MAAOsb,EAAOvG,OAAQkX,QAAQ,UAC7C,CAACjqB,GAAI,SAAUhC,MAAOsb,EAAO,mBAmOQyQ,GAAkBX,WAAY,IAClEC,cAAe,SAAStpB,OAEnB4P,EAAUgC,GAAc5R,EAAIC,IAAM2R,GAAc5R,EAAIC,IAAI+R,UAAY,GACpEzE,EAAO,CAAC/M,IAAI,IACZ0pB,EAAUta,GAAU5P,EAAIkqB,QAAQta,EAAO5P,EAAIkqB,QAAS3c,GAAM,UACvDvN,EAAI/B,OAAS2R,EAAO,mCAAmCrC,EAAK/M,IAAI,IAAI+M,EAAK/M,IAAI,IAAI,KAAK0pB,EAAQ,UAAU,KAEhHX,YAAY,CACXhO,YAAa,SAAStb,GACZ,UAANA,GACFG,KAAKkF,mBAAmBtD,UAAU,YAAa,CAAC,CAAC/B,GAAGA,iBAK/C,SAASf,SACX,CACNL,KAAM,SACNK,KAAM,gBAAiBsD,KAAM,SAC7Bie,OAAO,EAAMjT,MAAM,EAAM7N,MAAO,GAChCV,QAAQqpB,GAAmBppB,SAGtB,SAASA,SACR,CACNL,KAAM,MAAOK,KAAM,gBAAiBsD,KAAM,MAC1Cie,OAAO,EAAMjT,MAAM,EAAM7N,MAAO,GAChCV,QAAQwpB,GAAgBvpB,WAGjB,iBACD,CACNL,KAAM,QAASK,KAAM,gBAAiBsD,KAAM,eAC5Cie,OAAO,EAAMjT,MAAM,EAAM7N,MAAO,GAChCV,QAAQ0pB,aAGF,iBACA,CACN9pB,KAAK,QAASK,KAAK,gBAAiBsD,KAAK,YACzCie,OAAM,EAAMxhB,QAAQ,CACnB,CAACgB,GAAG,iBAAkBhC,MAAOE,MAAMC,KAAKC,YAAYC,OAAO,mBAC3D,CAAC2B,GAAG,gBAAiBhC,MAAOE,MAAMC,KAAKC,YAAYC,OAAO,2BAIrD,iBACA,CACNO,KAAK,QAASK,KAAK,gBAAiBsD,KAAK,gBACzCie,OAAM,EAAMxhB,QAAQ,CACnB;AAACgB,GAAG,gBAAiBhC,MAAME,MAAMC,KAAKC,YAAYC,OAAO,kBACzD,CAAC2B,GAAG,YAAahC,MAAOE,MAAMC,KAAKC,YAAYC,OAAO,yBAI9C,iBACH,CACNO,KAAM,UACNK,KAAM,gBAAiBsD,KAAM,WAC7Bie,OAAO,EAAMjT,MAAM,EAAM7N,MAAO,qBAGjB,kBACTH,GAAGypB,aAAa,CAACpqB,KAAM,oCAEb,kBACVW,GAAGypB,aAAa,CAACpqB,KAAM,mCAEf,kBACRW,GAAGypB,aAAa,CAACpqB,KAAM,mBC9ThC,SAASurB,GAAQpmB,OACZuV,EAASpb,MAAMC,KAAKC,mBACjBkb,EAAO/a,MAAMwF,IAASuV,EAAOjb,OAAO0F,IAASuV,EAAOhb,SAASyF,IAASA,EAmBvE,SAASqmB,SACX7iB,EAlBL,SAAS8iB,QACJzsB,EAAGgB,EAAMc,EACZ4qB,EAAS,MACD,CAAC,OAAO,eACN,CAAC,gBAAgB,YAAY,gBAEvCC,EAAS,OAEL3rB,KAAQ0rB,MAER1sB,EADJ2sB,EAAO3rB,GAAQ,EACNhB,EAAI0sB,EAAO1rB,GAAMf,OAAQD,IACjC8B,EAAQxB,MAAMsJ,KAAKG,YAAYwiB,GAAQG,EAAO1rB,GAAMhB,IAAK,+BAA+B8B,MAAQ,EAChG6qB,EAAO3rB,GAAQ/B,KAAKsT,IAAIzQ,EAAM6qB,EAAO3rB,WAGhC2rB,EAGKF,GACRd,EAAcpd,EAAaod,kBAExB,CACN,CACC1kB,QAAS,EACTlF,OAAQ,EACRW,KAAK,CACJ,CACCX,OAAQ,EACRC,KAAM,CACL,CACChB,KAAM,QAASK,KAAM,yBAA0BgG,MAAOklB,GAAQ,SAAU3J,OAAO,EAC/ExhB,QAAQ,CACP,CAACgB,GAAI,aACL,CAACA,GAAI,cACL,CAACA,GAAI,kBAGP,CACCM,KAAK,CACJ,CAACkqB,QAAS,gBACV,CAACA,QAAS,kBAGZ,CACClqB,KAAK,CACJ,CAACkqB,QAAS,aAKd,GACA,CAACprB,SAAU+qB,GAAQ,QAASlrB,KAAM,mBAAoBgD,OAAQsnB,EAAa7pB,MAAO,MAGpF,CAACT,KAAM,oBACP,CACC4F,QAAS,EACTvE,KAAK,CACJ,CAACkqB,QAAS,OAAQvrB,KAAM,gBAAiBgG,MAAOklB,GAAQ,QAASzqB,MAAO6H,EAAMugB,MAC9E,CAAC0C,QAAS,OAAQvrB,KAAM,gBAAiBgG,MAAOklB,GAAQ,QAASzqB,MAAO6H,EAAMugB,MAC9E,CAAC1oB,SAAU+qB,GAAQ,aAAclrB,KAAM,mBAAoBgD,OAAQsnB,KAGrE,CAACtqB,KAAM,oBACP,CACC4F,QAAS,EACTvE,KAAK,CACJ,CACCX,OAAQ,EACRC,KAAK,CACJ,CACCD,OAAQ,EACRC,KAAK,CACJ,CAAC4qB,QAAS,cAAe9qB,MAA0C,GAAlCxB,MAAMsC,KAAKsE,QAAQwc,YAAY,GAAK,GACrE,CAACkJ,QAAS,eAGZ,CAACA,QAAS,aAGZ,CACC7qB,OAAQ,EACRC,KAAK,CACJ,CACCD,OAAQ,EACRC,KAAK,CACJ,CAAC4qB,QAAS,eACV,CAACA,QAAS,cACV,CAACA,QAAS,qBAIZ,CAACA,QAAS,cACV,CAACA,QAAS,WAIZ,CAACprB,SAAU+qB,GAAQ,QAASlrB,KAAM,mBAAoBgD,OAAQsnB,KAGhE,CAACtqB,KAAM,oBACP,CACC4F,QAAS,EACTvE,KAAK,CACJ,CACCX,OAAQ,EACRC,KAAK,CACJ,CAAC4qB,QAAS,cACV,CAACA,QAAS,UAGZ,CACC7qB,OAAQ,EACRC,KAAK,CACJ,CAAC4qB,QAAS,kBAEV,CAACA,QAAS,UAGZ,CAACprB,SAAU+qB,GAAQ,SAAUlrB,KAAM,mBAAoBgD,OAAQsnB,KAIjE,CAACtqB,KAAM,oBACP,CACC4F,QAAS,EACTvE,KAAK,CACJ,CAACkqB,QAAS,UACV,CACC7qB,OAAQ,EACRC,KAAK,CACJ,CAAC4qB,QAAS,qBACV,CAACA,QAAS,uBAIZ,CAACprB,SAAU+qB,GAAQ,UAAWlrB,KAAM,mBAAoBgD,OAAQsnB,KAGlE,CAACtqB,KAAM,oBACP,CACC4F,QAAS,EACTvE,KAAK,CACJ,CAACV,KAAK,CACL,CAAE4qB,QAAS,YACX,CAAEA,QAAS,iBACX,CAAEA,QAAS,sBACX,CAAEA,QAAS,YACX,CAAEA,QAAS,WAEZ,CAAC5qB,KAAK,CACL,CAAE4qB,QAAS,aACX,CAAEA,QAAS,aACX,CAAEA,QAAS,aACX,CAAEA,QAAS,kBAEZ,CAACprB,SAAU+qB,GAAQ,QAASlrB,KAAM,mBAAoBgD,OAAQsnB,KAGhE,CAACtqB,KAAM,oBACP,CACC4F,QAAS,EACTvE,KAAK,CACJ,CACCV,KAAK,CACJ,CAAC4qB,QAAS,QAASvrB,KAAM,gBAAiBgG,MAAOklB,GAAQ,SAAUzqB,MAAM6H,EAAMkjB,QAC/E,CAACD,QAAS,cAAevrB,KAAM,gBAAiBgG,MAAOklB,GAAQ,WAAYzqB,MAAM6H,EAAMkjB,UAGzF,CAACD,QAAS,QAASvrB,KAAM,gBAAiBgG,MAAOklB,GAAQ,SAAUzqB,MAAM6H,EAAMkjB,QAC/E,CAACrrB,SAAU+qB,GAAQ,UAAWlrB,KAAM,mBAAoBgD,OAAQsnB,KAIlE,CAACtqB,KAAM,oBACP,CACC4F,QAAS,EACTvE,KAAK,CACJ,CACCV,KAAK,CACJ,CAACU,KAAK,CACL,CAACkqB,QAAQ,OACT,CAACA,QAAQ,YAEV,CACClqB,KAAK,CACJ,CAACkqB,QAAQ,kBACT,CAACA,QAAQ,kBAGX,CACClqB,KAAK,CACJ,CAACkqB,QAAQ,eACT,CAACA,QAAQ,sBAKb,CAACprB,SAAU+qB,GAAQ,QAASlrB,KAAM,mBAAoBgD,OAAQsnB,KAGhE,CAACtqB,KAAM,oBACP,QC1MIsF,GAAU,aACF,CAAC,OAAO,aACb,CAAC,cAAc,YAAY,cAAc,aAAa,kBAAkB,QAAQ,aAAa,iBAC5F,CAAC,aAAa,iBAAiB,OAAO,eACrC,CAAC,WAIL,SAAS0E,GAAKhK,GACpBA,EAAKmD,YAAY,kBAAmB,kBAmDrC,SAASsoB,EAAMzrB,GACdA,EAAKmD,YAAY,gBAAiB,SAACuoB,UAGpC,SAAS5E,EAAU9mB,EAAM0rB,OAClBC,EAWP,SAASC,EAAa5rB,EAAM0rB,WACrBG,EAAY,CACjB,cACA,YACA,aACA,iBACA,SACA,aACA,SAGKxd,EAAOqd,EAAS,GAChBC,EAAYG,GAAc9rB,EAAMqO,GAE9B1P,EAAI,EAAGA,EAAI+sB,EAAS9sB,OAAQD,IAAI,SACjCotB,EAAYD,GAAc9rB,EAAM0rB,EAAS/sB,IAEvCkb,EAAIgS,EAAUjtB,OAAO,EAAQ,GAALib,EAAQA,IAAI,KACrCmS,EAAWH,EAAUhS,GACxB8R,EAAUK,IAAaD,EAAUC,YAC5BL,EAAUK,GACjBH,EAAUI,OAAOpS,EAAG,QAIlBgS,EAAUjtB,OACb,aAGK+sB,EAxCWC,CAAa5rB,EAAM0rB,GACrC1rB,EAAK+B,GAAG,OAAO+kB,UAAU6E,GALuB7E,CAAU9mB,EAAM0rB,KApDtBD,CAAMzrB,KAChDA,EAAKmD,YAAY,YAAa,SAAC+oB,GACb,kBAAbA,EAAOnrB,IA0Db,SAASorB,EAAYnsB,EAAML,EAAMZ,OAC1BqtB,EAAUpsB,EAAK+B,GAAG,OAAO2D,SAAS/F,GAEpCysB,GACHA,EAAQnqB,SAASlD,GA7DhBotB,CAAYnsB,EAAMksB,EAAOvsB,KAAMusB,EAAOntB,aAGpC2G,EAAW,MAEZ1F,EAAKF,OAAOusB,QAAQ;IAClBC,EAAetsB,EAAKF,OAAOusB,QACb,QAAfC,IACFA,EAAcC,KACXttB,MAAMwH,YAAYzG,EAAKF,OAAO0sB,aAChCxsB,EAAKF,OAAO0sB,WAAY,IAE1B9mB,EC5BK,SAAS+mB,EAAezsB,EAAK0sB,OAC/BC,EAAe,SAAS9U,OACvB,IAAIlZ,EAAG,EAAGA,EAAIkZ,EAAMjZ,OAAQD,IAAI,KAC/BgB,EAAOkY,EAAMlZ,GAAG4sB,WAChB5rB,EAAK,KACJqiB,EAAOyI,GAAW9qB,GAAQ8qB,GAAW9qB,GAAMK,GAAQM,GAAG0pB,WAAW,CAACrqB,KAAKA,IAC3EV,MAAMiU,OAAO2E,EAAMlZ,GAAIqjB,GAGrBnK,EAAMlZ,GAAG0C,MACXsrB,EAAa9U,EAAMlZ,GAAG0C,MACpBwW,EAAMlZ,GAAGgC,MACXgsB,EAAa9U,EAAMlZ,GAAGgC,eAGzBgsB,EAAaD,GACNA,EDYOD,CAAezsB,EAAMssB,QAGlC5mB,ECZK,SAASknB,EAAW5sB,EAAK0sB,OAyBT1sB,EAAML,EAAMktB,EAxB9B/sB,EAAS,OACT,IAAIgtB,KAASJ,EAChB5sB,EAAO4C,MAsBc1C,EAtBKA,EAsBO6sB,EAtBMH,EAsBZ/sB,EAtBKmtB,GAuBrB,CACXzrB,KAAK,CACJ,CACCuE,QAAQ,EACRjF,KAAK,CAAC,CACLD,OAAQ,EACRC,KAvBL,SAASosB,EAAa/sB,EAAMsF,WACvB3E,EAAO,GACHhC,EAAG,EAAGA,EAAI2G,EAAQ1G,OAAQD,IAAI,KACjCgB,EAAO2F,EAAQ3G,MACD,UAAf6H,EAAO7G,GACTgB,EAAK+B,KAAK/C,OAEN,KACAqiB,EAAOyI,GAAW9qB,GAAQ8qB,GAAW9qB,GAAMK,GAAQM,GAAG0pB,WAAW,CAACrqB,KAAKA,IAC3EgB,EAAK+B,KAAKsf,WAGLrhB,EAWGosB,CAAa/sB,EAAM6sB,MAG3BvsB,GAAGmB,MAAM,CAACA,MAAM9B,QA/BjBG,EAAO4C,KAAKpC,GAAGiT,oBAETzT,EDMO8sB,CAAW5sB,EAAMA,EAAKF,OAAOwF,SAAWA,QAElD0nB,EAAM,CACThtB,KAAK,UACLsB,IAAK,4CACLP,GAAG,MACH6E,QAAQ,EACRF,SAAUA,EACV1E,GAAI,CACHU,SAAU,eACLurB,EAAS/rB,KAAKygB,aACd5iB,EAAQkuB,EAAOnrB,WACfnC,EAAOstB,EAAOntB,OAAOH,KACd,UAARA,GAA6B,UAATZ,IACtBA,EAAQ,IACI,UAARY,GAA6B,UAATZ,GACxBiB,EAAK8C,UAAU,aAAc,CAACnD,EAAMZ,KAEtCsd,YAAa,SAAUtb,OAClBmsB,EAASltB,EAAKmtB,QAAQpsB,GACtBunB,GAAQ4E,GACX5E,GAAQ4E,GAAQppB,KAAK5C,KAAMlB,GAE3BA,EAAK8C,UAAU,YAAa,CAAC,CAAE/B,GAAImsB,eAKvCltB,EAAK8C,UAAU,aAAc,CAAC,UAAWkqB,IAClCA,EAoDR,SAASlB,GAAc9rB,EAAMqO,OACtBmB,EAAOxP,EAAK+B,GAAG,SAAS0N,QAAQpB,EAAKhC,IAAKgC,EAAK/B,WAClDkD,WACwBA,KAAzBnB,EAAKhC,SAAKgC,EAAK/B,gBAEXxL,EAAMd,EAAKoP,SAASf,EAAKhC,IAAKgC,EAAK/B,QACnC+C,EAASvO,EAAM7B,MAAMkG,KAAKrE,EAAIgP,OAAS,OAExC,IAAInR,KAAK2O,EACT+B,EAAO1Q,KACV0Q,EAAO1Q,GAAK2O,EAAc3O,WAE5B0Q,EAAOqB,OAAS6H,GAASlJ,EAAOqB,QAAU,SAAWrB,EAAOqB,OAErDrB,WE9HQ+d,GAAU/gB,EAAKrM,EAAMqtB,OAChCR,EAAU7sB,EAAK+B,GAAG,SAASjC,OAAO+sB,QAGlCtvB,EAAQ,CACX8O,IAAIA,EACJC,OAAOugB,EAJ2B,SAAjBA,EAAQ,GAAG9rB,GAAgB,EAAI,GAIpBA,IAEzBusB,EAAO,CACVjhB,IAAMghB,GAAUhhB,EAChBC,OAAQugB,EAAQA,EAAQjuB,OAAO,GAAGmC,IAGhCxD,EAAM+O,QAAUghB,EAAKhhB,QACvBihB,GAAahwB,EAAO+vB,EAAMttB,GAGrB,SAASwtB,GAAUxtB,OACrByX,EAAQzX,EAAK+B,GAAG,SAAStD,KAAKgZ,MAC9BoV,EAAU7sB,EAAK+B,GAAG,SAASjC,OAAO+sB,QAClCY,EAA+B,SAAjBZ,EAAQ,GAAG9rB,GAAgB,EAAI,EAE7CxD,EAAQ,CACX8O,IAAKoL,EAAM,GACXnL,OAAQugB,EAAQY,GAAa1sB,IAE1BusB,EAAO,CACVjhB,IAAKoL,EAAMA,EAAM7Y,OAAO,GACxB0N,OAAQugB,EAAQA,EAAQjuB,OAAO,GAAGmC,IAGhCxD,EAAM+O,QAAUghB,EAAKhhB,QACvBihB,GAAahwB,EAAO+vB,EAAMttB,GAGrB,SAAS0tB,GAAaphB,EAAQtM,EAAM2tB,OACtClW,EAAQzX,EAAK+B,GAAG,SAAStD,KAAKgZ,MAOlC8V,GAHY,CAAClhB,IAHEoL,EAAM,GAGOnL,OAAQA,GACzB,CAACD,IAHEoL,EAAMA,EAAM7Y,OAAO,GAGP0N,OAASqhB,GAAarhB,GAEtBtM,GAGpB,SAAS4tB,GAActhB,EAAQtM,OAC/B6tB,EAAe7tB,EAAK+B,GAAG,SAAS0M,yBAClCof,GACCvhB,GAAUuhB,EAAatwB,MAAM+O,QAAUA,GAAUuhB,EAAazoB,IAAIkH,QAMjE,SAASwhB,GAAezhB,EAAKC,EAAQtM,UACpC+tB,GAAc1hB,EAAKrM,IAAS4tB,GAActhB,EAAQtM,GAGnD,SAAS+tB,GAAc1hB,EAAKrM,OAC5B6tB,EAAe7tB,EAAK+B,GAAG,SAAS0M,yBAClCof,GACCxhB,GAAOwhB,EAAatwB,MAAM8O,KAAOA,GAAOwhB,EAAazoB,IAAIiH,KAMxD,SAAS2hB,GAAc1hB,EAAQtM,OAC/B6tB,EAAe7tB,EAAK+B,GAAG,SAAS0M,gBAEjCof,EAKJH,GAFW9vB,KAAKqiB,IAAI4N,EAAatwB,MAAM+O,OAAQuhB,EAAazoB,IAAIkH,OAAQA,GAErDtM,EADRpC,KAAKsT,IAAI2c,EAAatwB,MAAM+O,OAAQuhB,EAAazoB,IAAIkH,OAAQA,IAHxEohB,GAAaphB,EAAQtM,GAQvB,SAASutB,GAAatmB,EAAGqQ,EAAGtX,GAC3BA,EAAK+B,GAAG,SAASksB,cAAchnB,EAAGqQ,GAI5B,SAAS4W,GAAa5hB,EAAQtM,OAChCS,EAAQ,GACN0tB,EAAcnuB,EAAKgR,OAAOod,gBAAgB9hB,GAAQ7L,MAExDT,EAAKgR,OAAOqd,QAAQ,SAAShiB,OACtBmD,EAAOxP,EAAKgR,OAAOvB,QAAQpD,EAAKC,QACnCkD,GAAkB,EAAVA,EAAK,SAGV1K,EAAO5D,KAAKgqB,QAAQ7e,EAAKC,GACzB7H,EAAQzE,EAAKoP,SAAS/C,EAAKC,GAC3BhL,EAAMmD,EAAQA,EAAM1D,GAAK,MAE3B+D,EAAKf,QAAQ,kBAAmB,IAAK,KAClCkH,EAAOvC,EAAY1I,EAAM8E,EAAMxD,GAElCtB,EAAKsuB,cAAcjiB,EAAKC,KAC1BrB,EAAKxK,OAAS,IACZT,EAAKuuB,cAAcliB,EAAKC,KAC1BrB,EAAKxK,OAAS,IAEZgE,GAA6B,QAApBA,EAAMqL,MAAM/B,MAAkB9C,EAAKxK,MAAQ0tB,IACtDljB,EAAKxK,MAAQ0tB,GACVljB,EAAKxK,MAAQA,IAChBA,EAAQwK,EAAKxK,WAGhBT,EAAKgR,OAAOwd,eAAeliB,EAAQ7L,GAG7B,SAASguB,GAAUpiB,EAAKrM,OAC1BgD,EAAS,GAEbhD,EAAKgR,OAAO0d,WAAW,SAASpiB,MAClB,SAAVA,EAAkB,KACdxH,EAAO5D,KAAKgqB,QAAQ7e,EAAKC,GAG3B7L,EAAQS,KAAKktB,gBAAgB9hB,GAAQ7L,MACnC+O,EAAOxP,EAAKgR,OAAOvB,QAAQpD,EAAKC,GACnCkD,IACF/O,EAAQT,EAAKgR,OAAO2d,YAAY,CAACtiB,IAAImD,EAAK,GAAIlD,OAAOkD,EAAK,KAAK2B,iBAE5D1M,EAAQzE,EAAKoP,SAAS/C,EAAKC,GAC3BhL,EAAMmD,EAAQA,EAAM1D,GAAK,MAEzB+D,EAAKf,QAAQ,kBAAmB,IAAK,KACpCkH,EAAOvC,EAAY1I,EAAM8E,EAAMxD,EAAKb,GACpCwK,EAAKjI,OAASA,IAAQA,EAASiI,EAAKjI,YAI3ChD,EAAKgR,OAAO4d,aAAaviB,EAAKrJ,GAGxB,SAAS6rB,GAAgBtxB,EAAM6H,EAAKpF,MACtCA,EAAKgR,OAAOlR,OAAOylB,YAEjBjkB,EAAM,kBAERwtB,EAAKvxB,EAAM8O,IAAK0iB,EAAK3pB,EAAIiH,IAAK2iB,EAAKzxB,EAAM+O,OAAQ2iB,EAAK7pB,EAAIkH,UAC3DyiB,EAAGD,SAAe,CAACC,EAAID,GAAfA,OAAIC,UACZE,EAAGD,SAAe,CAACC,EAAID,GAAfA,OAAIC,OAEfjvB,EAAKgR,OAAOqd,QAAQ,SAAShiB,GACzBA,EAAMyiB,GAAYC,EAAN1iB,EACdrM,EAAKgR,OAAOke,cAAc7iB,EAAK,QAAS/K,GAExCtB,EAAKgR,OAAOme,WAAW9iB,EAAK,QAAS/K,KAGvCtB,EAAKgR,OAAO0d,WAAW,SAASvjB,OACzBhD,EAAOnI,EAAKgR,OAAOoe,cAAcjkB,GAC7B,SAAPA,GAAmBhD,IAEnBgD,EAAM6jB,GAAYC,EAAN9jB,EACdlM,MAAMsJ,KAAK8mB,UAAUlnB,EAAM7G,GAE3BrC,MAAMsJ,KAAK+mB,OAAOnnB,EAAM7G,GAAK,8LCjKzB,SAAS0I,GAAKhK,EAAM+S,GAC1B/S,EAAKmD,YAAY,kBAAmB,kBA+BrC,SAASsoB,EAAMzrB,OAyDVuvB,EACAC,EAzDAC,EAAOzvB,EAAKgR,OAEZ0e,EAAqBzwB,MAAMie,MAAMoB,SAASre,KAAM,YAE5C,SAASub,GACfhR,aAAaP,GACbA,EAAShL,MAAMwL,MAAM,SAAS+Q,OAC1Bxb,EAAK2vB,SAASC,eAAeC,gBAG5BxhB,EAAOohB,EAAKK,OAAOtU,GACnBuU,EAAU/vB,EAAK2vB,SAASK,cAAgBhwB,EAAK2vB,SAASK,aAAa/mB,eAEpEoF,GAAQrO,EAAK2vB,SAASM,IAAI5hB,EAAKhC,IAAKgC,EAAK/B,QAAQ,KAC/CmS,EAAaze,EAAK2vB,SAASC,eAAevhB;CAC1CoQ,GAAeA,EAAWpS,KAAOgC,EAAKhC,KAAOoS,EAAWnS,QAAU+B,EAAK/B,SAAayjB,GACvF/vB,EAAK8C,UAAU,YAAY,CAAC,CAAC/B,GAAI,cAAesN,KAAAA,EAAM6hB,UAAU,UAE1DH,IAAY/vB,EAAK2vB,SAASK,aAAaxsB,MAAM2sB,SAAS3U,EAAEyI,SAC/DjkB,EAAK8C,UAAU,gBAAiB,OAC/B,EAAM,CAAC0Y,GAAI,OAlBiD,IAC5DvR,EAsBDjK,EAAKF,OAAOswB,OACfX,EAAK3vB,OAAOuwB,UAAW,YAgDfC,QACJC,EAAMd,EAAKptB,eAAc,MAC1BkuB,EAAI3xB,OAAO,KACTrB,EAAQgzB,EAAI,GACZnrB,EAAMmrB,EAAIA,EAAI3xB,OAAO,GAAG2xB,EAAIA,EAAI3xB,OAAO,GAAG2xB,EAAI,GAClDC,GAAoBjzB,EAAO6H,EAAKpF,OAE5B,KACAvB,EAAO,CAAC4N,IAAI,EAAGC,OAAO,GAC1BkkB,GAAoB/xB,EAAMA,EAAMuB,IArDlCyvB,EAAKtsB,YAAY,mBAAoB,SAACstB,EAAIC,GAErCD,EAAGnf,MAAQrS,MAAMqX,WAA0B,KAAbma,EAAG1xB,QAEjC0xB,EAAG1xB,OAAS0xB,EAAGnf,MAClBtR,EAAKof,aAAasR,EAAGrkB,IAAKqkB,EAAGpkB,OAAQmkB,EAAG1xB,OACxC0wB,EAAK3mB,WAEN2nB,EAAG1xB,MAAQ0xB,EAAGnf,OAGfme,EAAKtsB,YAAY,UAAW,SAASwtB,GAChClB,EAAKmB,aACR3xB,MAAMwL,MAAM,WACXglB,EAAK3S,cAAc,UAGrB7d,MAAMsJ,KAAKwU,aAAa4T,KAIzB3wB,EAAKmD,YAAY,oBAAqB,SAACkJ,EAAKC,UAAYtM,EAAK6wB,aAAaxkB,EAAKC,KAC/EmjB,EAAKtsB,YAAY,oBAAqB,SAACoE,UACtCvH,EAAK8C,UAAU,oBAAqB,CAACyE,EAAO8E,IAAK9E,EAAO+E,WAOzDmjB,EAAKtsB,YAAY,iBAAkB,SAACpC,SAAoB,SAAbA,EAAGuL,SAC9CmjB,EAAKtsB,YAAY,sBAAuB,SAAC5F,EAAO6H,EAAK0rB,UAChDA,GACc,UAAjBvzB,EAAM+O,QAAqC,UAAflH,EAAIkH,SACX,UAAjB/O,EAAM+O,SAAoB/O,EAAM+O,OAAS,GAC1B,UAAflH,EAAIkH,SAAoBlH,EAAIkH,OAAS,KAEtB,UAAjB/O,EAAM+O,QAAqC,UAAflH,EAAIkH,UAClCkkB,GAAoBjzB,EAAM6H,EAAKpF,IACxB,KAkBTyvB,EAAKtsB,YAAY,iBAAkB,kBAAMmtB,MACzCb,EAAKtsB,YAAY,oBAAqB,WACrClE,MAAMwL,MAAM,kBAAM6lB,QAEnBb,EAAKtsB,YAAY,iBAAkB,WAClClE,MAAMwL,MAAM,kBAAM6lB,QAGnBrxB,MAAMie,MAAMuS,EAAKjsB,MAAMmB,WAAY,YAAa,SAAA6W,OACzCuV,EAAetB,EAAK3vB,OAAOixB,aAC3B5lB,EAAMskB,EAAKK,OAAOtU,MAErBrQ,GAAOA,EAAI6lB,KAAK,IACfD,EAAa,KACTE,EAAKxB,EAAKrB,gBAAgBjjB,EAAImB,QAAQ7L,MACtCwN,EAAMhP,MAAMsJ,KAAK2oB,YAAY1V,MAChCvN,EAAIrF,EAAImoB,EAAa9lB,MAAQgmB,EAAGhjB,EAAIrF,EAAImoB,EAAa9lB,KAAK,EAC5D,OAEFskB,EAAkBpkB,EAAI6lB,QAIxB/xB,MAAMie,MAAMuS,EAAKjsB,MAAMmB,WAAY,YAAa,SAAA6W,MAC5C+T,EAAgB,KACZpkB,EAAMskB,EAAKK,OAAOtU,GAErBrQ,IACFqkB,EAAgBrkB,EAAI6lB,KACpBR,GACC,CAAClkB,OAAQmjB,EAAK0B,SAAS5B,IACvB,CAACjjB,OAAQmjB,EAAK0B,SAAS3B,GAAe,IACtCxvB,WAMEoxB,EAAsBnyB,MAAMie,MAAMoB,SAASre,KAAM,UAAW,WAC9DsvB,IACkB,MAAjBC,IACFgB,GACCf,EAAK0B,SAAS5B,GACdvvB,EACAyvB,EAAK0B,SAAS3B,GAAe,IAE9BA,EAAgB,MAEjBD,EAAkB,QAIpBE,EAAKtsB,YAAY,iBAAkB,SAACpC,GACjB,UAAdA,EAAGuL,QACNkkB,GAAczvB,EAAGsL,IAAKrM,SAGpBqxB,EAAkB,EACtB5B,EAAKtsB,YAAY,gBAAiB,SAACpC,EAAIya,MACtB,SAAbza,EAAGuL,YAIFglB,EAAc,IAAI9zB,KAClB+zB,EAAYD,EAAcD,GAAmB,IAE7CE,EACHf,GAAiBzvB,EAAGuL,OAAQtM,IAE5BqxB,EAAkBC,EACd9V,EAAEgW,SACLhB,GAAkBzvB,EAAGuL,OAAQtM,GAE7BwwB,GAAiBzvB,EAAGuL,OAAQtM,SAb7BwwB,GAAcxwB,SAmBZyxB,EAAiB,KACrBhC,EAAKtsB,YAAY,cAAe,SAACkL,EAAMmN,GAClB,UAAhBnN,EAAK/B,SACHkP,EAAEgW,UAGDC,EAGJjB,GAAciB,EAAgBzxB,EAAMqO,EAAKhC,KAL1CmkB,GAAcniB,EAAKhC,IAAKrM,GAOzByxB,EAAiBpjB,EAAKhC,OAKxBrM,EAAKmD,YAAY,UAAW,kBAAM0L,GAAM7O,KAExCA,EAAKmD,YAAY,oBAAqB,kBAAMssB,EAAKiC,aAEjDjC,EAAKtsB,YAAY,SAAU,WAG1BlE,MAAMwL,MAAM,eACPwZ,EAAS3F,SAASC,kBAElB0F,GAA4B,SAAlBA,EAAO7b,aAEjBua,EAAQ1jB,MAAMkkB,UAAUwO,WACxBC,EAAajP,GAChBA,GAAS8M,GACT9M,EAAMvc,kBACNuc,EAAMvc,qBAAuBpG,EAE1B4xB,GACH3yB,MAAMkkB,UAAU0O,SAASpC,KAExBvuB,KAAM,GAAI,OA+Ff,SAAS4wB,EAAc9xB,GACtBf,MAAMsJ,KAAKsH,SAAS,IAAI7P,EAAKgR,OAAOxN,MAAMzC,GAAG,oDA7F7C+wB,CAAc9xB,GAEdA,EAAKmD,YAAY,aAAc,WAC9BlE,MAAM+d,YAAY0S,GAClBzwB,MAAM+d,YAAYoU,KAlPuB3F,CAAMzrB,SAE5CgH,EAAY,CACfhH,KAAK,YAAae,GAAG,QAASO,IAAI,4CAA4CtB,EAAKkP,OACnFnI,gBAAqC,YAApB9H,MAAMsC,KAAKC,OAA2C,QAApBvC,MAAMsC,KAAKC,MAAkB,GAAK,GACrFuwB,OAAO,EACPC,UAAW,EACXC,YAAW,EACXC,eAAe,GACfC,UAAS,EACTC,WAAYrf,EAAMvT,WAAa,SAAW,WAC1C6yB,aAAa,EACbC,YAAW,UAIY,IAApBvf,EAAMwf,YACTxf,EAAMwf,UAAY,SACfxf,EAAMyf,4BACRzf,EAAM0f,aAAe,SAASnrB,UAC1BrI,MAAMmZ,MAAMC,SAAS/Q,KACvBA,EAAOA,EAAKlJ,WAAW2F,QAAQ,IAAKgP,EAAMyf,4BACpClrB,KAGNyL,IACH/L,EAAY/H,MAAMiU,OAAOlM,EAAW+L,GAAO,IAErC/L,EA0ND,SAAS0rB,GAAc1yB,EAAMc,EAAKkgB,EAAQjiB,EAAOuN,EAAQqmB,OACzDxnB,EAAMmB,EAAOvL,GACbsL,EAAMvL,EAAIC,GACZO,EAAM,GAEJwD,EAAiB,KAAV/F,GAAgBR,MAAMQ,GAC7B2R,EAAS2E,GAAkBrV,EAAMqM,EAAKlB,GACtCynB,EAAcvd,GAAgB3E,EAAQ,SAAW2E,GAAkBtW,GAErEgU,EAAQ,MACP4f,IACJ5f,GAAS/S,EAAK2vB,SAASM,IAAI5jB,EAAKlB,GAAO,4CAA8C,GACrF4H,GAAS/S,EAAKuuB,cAAcliB,EAAKlB,GAAO,yCAA2C,KAIhFynB,KAAiB9tB,GAAQuQ,GAAgB3E,EAAQ,cAChDA,EAAO,KACJrC,EAAO,CAAE/M,IAAI,IACbuxB,EAASxd,GAAc3E,MACzBmiB,EAAO,KACNC,EAAWD,EAAO9zB,EAAOsP,GAE1BykB,GAAY7zB,MAAMC,KAAKC,YAAYI,MAAM,iBACvC8O,EAAK/M,MACRA,mBAAgB+M,EAAK/M,UACtBvC,EAAQ+zB,GAEAhuB,IACR/F,GAAgB,SAIlBA,GAAgB,SAIfiB,EAAK+yB,SAAYh0B,GAAmB,IAAVA,EACrB,KAELE,MAAMwH,YAAY1H,IAAoB,OAAVA,KAC9BA,EAAQ,mBAEMuC,cAAOvC,mBAAciB,EAAK+yB,OAAS,GAAKhgB,IAGjD,SAASlE,GAAM7O,OACfyvB,EAAOzvB,EAAK+B,GAAG,SACrB0tB,EAAKuD,mBAECnG,EAAU7sB,EAAKF,OAAOmzB,YACtB5xB,EAAOrB,EAAKF,OAAOozB,SAEnBvyB,EAAO,CAAC,CACbI,GAAG,QAASwkB,OAAO;AAAI9kB,MAAM,GAC7Ba,IAAI,iBACJnB,SAAS,SAACgzB,UACFA,EAAGpyB,MAIHpC,EAAE,EAAGA,GAAGkuB,EAASluB,IACzBgC,EAAK+B,KAAK,CACT3B,GAAGpC,EACH4I,OAAO,OACPge,OAAO,CACNzgB,KAAMsuB,EAAWz0B,IAElBwB,SAAS,SAASW,EAAKkgB,EAAQjiB,EAAOuN,UAC9BomB,GAAc1yB,EAAMc,EAAKkgB,EAAQjiB,EAAOuN,MAGjDtM,EAAK8C,UAAU,eAAe,CAACnC,EAAKhC,KAErC8wB,EAAK4D,eAAe1yB,WAEdlC,EAAO,GACJE,EAAE,EAAGA,GAAG0C,EAAM1C,IACtBF,EAAKiE,KAAK,CAAE3B,GAAGpC,IAEhB8wB,EAAK6D,MAAM70B,GCvUL,SAASuL,GAAKhK,OAChByvB,EAAOzvB,EAAK+B,GAAG,SAEfkO,EAAMhR,MAAMs0B,IAAIC,MAAQ,UAAY,UACxCv0B,MAAMkkB,UAAUC,UAAUnT,EAAI,KAAM,WAAYwf,EAAKmB,aAAapD,GAAUxtB,IAAUyvB,IAElFzvB,EAAKF,OAAO8kB,SAAS,CACxB3lB,MAAMkkB,UAAUC,UAAU,MAAO,SAACpjB,EAAM2wB,MAEN,KAA5BA,EAAG7R,OAAS6R,EAAG5R,cAEhB0U,EAAMzzB,EAAKqC,eAAc,GACzBoxB,EAAI70B,SACP6wB,EAAKiE,SAAU,EACfjE,EAAKkE,KAAKF,EAAI,OAEbhE,GAEHxwB,MAAMkkB,UAAUC,UAAU,QAAS,SAACpjB,OAC/ByzB,EAAMzzB,EAAKqC,eAAc,GACzBoxB,EAAI70B,SACJoB,EAAKF,OAAON,WACdiwB,EAAK3sB,UAAU,qBAAsB,CAAC2wB,EAAI,KAE1ChE,EAAKkE,KAAKF,EAAI,MAEdhE,GAEHxwB,MAAMkkB,UAAUC,UAAU,YAAa,kBAAMwQ,GAAI5zB,IAAOyvB,GACxDxwB,MAAMkkB,UAAUC,UAAU,SAAU,kBAAMwQ,GAAI5zB,IAAOyvB,OAEjD3G,EAAO7pB,MAAMs0B,IAAIC,MAAQ,kBAAoB,SACjDv0B,MAAMkkB,UAAUC,UAAU0F,EAAM,kBAAM9oB,EAAK8oB,QAAQ2G,GACnDxwB,MAAMkkB,UAAUC,UAAUnT,EAAI,KAAM,kBAAMjQ,EAAK6oB,QAAQ4G,GAEvDxwB,MAAMkkB,UAAUC,UAAUnT,EAAI,KAAM,kBAAM4jB,GAAY7zB,EAAM,gBAAgByvB,GAC5ExwB,MAAMkkB,UAAUC,UAAUnT,EAAI,KAAM,kBAAM4jB,GAAY7zB,EAAM,eAAeyvB,GAC3ExwB,MAAMkkB,UAAUC,UAAUnT,EAAI,KAAM,SAAC3R,EAAGkd,UAY1C,SAASsY,EAAM9zB,EAAMwb,UACpBqY,GAAY7zB,EAAM,mBACXf,MAAMsJ,KAAKwU,aAAavB,GAdgBsY,CAAM9zB,EAAMwb,IAAIiU,GAC9DxwB,MAAMkkB,UAAUC,UAAUnT,EAAI,KAAM,SAAC3R,EAAGkd,UAe1C,SAASuY,EAAM/zB,EAAMwb,UACpBxb,EAAK8C,UAAU,YAAY,CAAC,CAAC/B,GAAI,WAC1B9B,MAAMsJ,KAAKwU,aAAavB,GAjBgBuY,CAAM/zB,EAAMwb,IAAIiU,IAIhE,SAASmE,GAAI5zB,GACZkJ,EAAMC,IAAI,WACTnJ,EAAKiS,iBAAiB,SAAC5D,UAASrO,EAAKof,aAAa/Q,EAAKhC,IAAIgC,EAAK/B,OAAQ,MACxEtM,EAAK8I,YAaP,SAAS+qB,GAAY7zB,EAAMg0B,OACtB3lB,EAAOrO,EAAKqC,mBACbgM,EAAK,KACH5J,EAAQzE,EAAKoP,SAASf,EAAKhC,IAAKgC,EAAK/B,QAErC2nB,EAAYpK,GAAamK,GAGzBzP,EAAS9f,GAASA,EAAMqL,MAAMkkB,KAAUC,EAF3B,SAEoDA,EACrEj0B,EAAK8C,UAAU,aAAc,CAACkxB,EAAMzP,+BCpE/B,SAAS2P,aACX9Y,EAAM,EAAGjS,EAAM3K,EAASwG,WACnBrG,EAAI,EAAGA,EAAIwK,EAAIvK,OAAQD,IAAI,KAC/BL,EAAID,EAAW8K,EAAIxK,KACb,IAANL,IAAa8c,GAAK9c,UAEhB8c,WAKD,SAAS+Y,aACX/Y,EAAM,EAAGyG,EAAQ,EAAG1Y,EAAM3K,EAASwG,WAC9BrG,EAAI,EAAGA,EAAIwK,EAAIvK,OAAQD,IAAI,KAC/BL,EAAID,EAAW8K,EAAIxK,KACb,IAANL,IACH8c,GAAK9c,EAAGujB,YAGHzG,EAAIyG,SAIL,SAASuS,aACXvS,EAAQ,EAAG1Y,EAAM3K,EAASwG,WACrBrG,EAAI,EAAGA,EAAIwK,EAAIvK,OAAQD,KAErB,IADFN,EAAW8K,EAAIxK,KAEtBkjB,WAEKA,UAID,SAASwS,aACXxS,EAAQ,EAAG1Y,EAAM3K,EAASwG,WACrBrG,EAAI,EAAGA,EAAIwK,EAAIvK,OAAQD,IAC5BwK,EAAIxK,IAAa,EAAPwK,EAAIxK,IAAQ,GAAIkjB,WACvBA,cAID,SAASyS,aACXzS,EAAQ,EAAG1Y,EAAM3K,EAASwG,WACrBrG,EAAI,EAAGA,EAAIwK,EAAIvK,OAAQD,IACpB,GAAPwK,EAAIxK,IAAMkjB,WACRA,OAKD,SAAS0S,aACXrjB,EAAM,GAAI/H,EAAM3K,EAASwG,WACpBrG,EAAI,EAAGA,EAAIwK,EAAIvK,OAAQD,IAAI,KAC/BL,EAAID,EAAW8K,EAAIxK,KACb,IAANL,IAAkB4S,EAAF5S,GAAgB,KAAP4S,KAC5BA,EAAM5S,UAED4S,GAAO,OAKR,SAASsjB,aACXvU,EAAM,GAAI9W,EAAM3K,EAASwG,WACpBrG,EAAI,EAAGA,EAAIwK,EAAIvK,OAAQD,IAAI,KAC/BL,EAAID,EAAW8K,EAAIxK,KACb,IAANL,IAAgBA,EAAE2hB,GAAc,KAAPA,KAC5BA,EAAM3hB,UAED2hB,GAAO,WAKR,SAASwU,aACXC,EAAU,GAAIvrB,EAAM3K,EAASwG,WACxBrG,EAAI,EAAGA,EAAIwK,EAAIvK,OAAQD,IAAI,KAC/BL,EAAID,EAAW8K,EAAIxK,KACd,IAANL,IACFo2B,EAAoB,KAAVA,EAAap2B,EAAEo2B,EAAQp2B,UAE5Bo2B,cAKD,SAASC,GAAWC,OACtBh2B,EAASg2B,EAAK,GAAGh2B,WACjB,IAAID,KAAKi2B,KACTA,EAAKj2B,GAAGC,SAAWA,EACrB,eAEEi2B,EAAK,EACAl2B,EAAI,EAAGA,EAAIi2B,EAAK,GAAGh2B,OAAQD,IAAI,KACnC+1B,EAAU,OACV,IAAII,KAAKF,EAAK,KACbt2B,EAAID,EAAWu2B,EAAKE,GAAGn2B,QAClB,IAANL,EACC,CAAEo2B,EAAU,QADAA,EAAoB,KAAVA,EAAep2B,EAAGo2B,EAAQp2B,EAGjDW,MAAMwH,YAAYiuB,KAAUG,GAAIH,UAE9BG,SAID,SAASE,aACXC,EAAK,EAAG7rB,EAAM3K,EAASwG,WAClBrG,EAAI,EAAGA,EAAIwK,EAAIvK,OAAQD,IAAI,KAC/BL,EAAID,EAAW8K,EAAIxK,IACR,iBAALL,IACT02B,GAAMp3B,KAAKq3B,IAAI32B,EAAG,WAEb02B,QAID,SAASE,aACX/rB,EAAM3K,EAASwG,WACf6c,EAAQ3gB,KAAKkzB,MAAMjrB,GACnBgsB,EAAMj0B,KAAKizB,QAAQhrB,GAEnBiS,EAAM,EACDzc,EAAI,EAAGA,EAAIwK,EAAIvK,OAAQD,IAAI,KAC/BL,EAAID,EAAW8K,EAAIxK,KACd,IAANL,IACF8c,GAAOxd,KAAKq3B,IAAI32B,EAAI62B,EAAK,WAEpB/Z,EAAIyG,UAIL,SAASuT,SACXjsB,EAAM3K,EAASwG,kBACZpH,KAAKy3B,KAAKn0B,KAAKg0B,KAAK/rB,WAIrB,SAASmsB,GAAMC,EAAKN,OACtBO,EAAIn3B,EAAWk3B,GAAME,EAAIp3B,EAAW42B,MACzB,iBAALO,GAA4B,iBAAJC,EACjC,OAAO73B,KAAKq3B,IAAIO,EAAGC,aAKd,SAASC,GAASH,EAAKI,OACzBH,EAAIn3B,EAAWk3B,GAAMK,EAAIv3B,EAAWs3B,MACzB,iBAALH,GAA4B,iBAAJI,EACjC,OAAOJ,EAAEI,QAIJ,SAASC,GAAKN,OAChBj3B,EAAID,EAAWk3B,OACV,IAANj3B,GAAkB,GAAHA,EACjB,OAAOV,KAAKy3B,KAAK/2B,QAGZ,SAASw3B,GAAIP,OACfj3B,EAAID,EAAWk3B,OACV,IAANj3B,EACF,OAAOV,KAAKm4B,IAAIz3B,SAGX,SAAS03B,YACRp4B,KAAKq4B,aAGN,SAASC,YACRt4B,KAAKs4B,QAIN,SAASC,GAAIZ,OACfj3B,EAAID,EAAWk3B,OACV,IAANj3B,EACF,OAAOV,KAAKI,MAAMM,UAIb,SAAS83B,GAAMb,EAAKc,OACtB/3B,EAAID,EAAWk3B,GACfK,EAAIv3B,EAAWg4B,IAAW,MACrB,IAAN/3B,EACF,OAAOg4B,WAAWh4B,EAAEi4B,QAAQX,eAIvB,SAASY,GAAUjB,EAAKc,OAC1B/3B,EAAID,EAAWk3B,GACfK,EAAIv3B,EAAWg4B,IAAW,MACrB,IAAN/3B,EACF,OAAQV,KAAKC,MAAMS,EAAEV,KAAKq3B,IAAI,GAAIW,IAAIh4B,KAAKq3B,IAAI,GAAGW,YAI7C,SAASa,GAAQlB,EAAIc,OACvB/3B,EAAID,EAAWk3B,GACfK,EAAIv3B,EAAWg4B,IAAW,MACrB,IAAN/3B,EACF,OAAOV,KAAK84B,KAAKp4B,EAAEV,KAAKq3B,IAAI,GAAIW,IAAIh4B,KAAKq3B,IAAI,GAAGW,UAI3C,SAASe,GAAMpB,OACjBj3B,EAAID,EAAWk3B,OACV,IAANj3B,EACF,OAAOwM,SAASxM;KAIX,SAASs4B,GAAKrB,OAChBj3B,EAAID,EAAWk3B,OACV,IAANj3B,EAAY,KACVyZ,EAAIna,KAAKI,MAAMM,UACZyZ,EAAE,EAAEA,EAAE,EAAEA,QAKV,SAAS8e,GAAItB,OACfj3B,EAAID,EAAWk3B,OACV,IAANj3B,EAAY,KACVyZ,EAAIna,KAAKI,MAAMM,UACZyZ,EAAE,EAAEA,EAAEA,EAAE,iDCrOD+e,SACXr4B,EAAOma,MAAMvU,UAAUwU,MAAM/U,KAAKkB,kBACtCvG,EAAOA,EAAK8X,IAAI,SAASzV,SACL,WAAf0F,EAAO1F,GACHA,EAAIiC,KAAK,IACVjC,KAEIiC,KAAK,UAGX,SAASg0B,GAAKjyB,EAAM+c,UACrB/c,EACEA,EAAKgD,UAAU,EAAG+Z,GADL,QAId,SAASmV,GAAIlyB,EAAMvH,EAAOskB,UAC3B/c,EACEA,EAAKgD,UAAUvK,EAAOA,EAAQskB,GADjB,UAId,SAASoV,GAAMnyB,EAAM+c,UACtB/c,EACEA,EAAKgD,UAAUhD,EAAKlG,OAASijB,GADhB,UAId,SAASqV,GAAMpyB,UAChBA,EACEA,EAAKmD,cADQ,UAId,SAASkvB,GAAMryB,UAChBA,EACEA,EAAKshB,cADQ,WAId,SAASgR,GAAOtyB,OACjBA,QAAe,OAChBuyB,EAAOvyB,EAAKmD,cAAcwD,MAAM,SAE/B,IAAI6rB,KADTxyB,EAAO,GACSuyB,EACfvyB,IAASA,EAAO,IAAM,IAAMuyB,EAAKC,GAAKxvB,UAAU,EAAG,GAAGse,cAAgBiR,EAAKC,GAAKxvB,UAAU,UAEpFhD,QAGD,SAASyyB,GAAKzyB,UACfA,EACEA,EAAK2a,OADQ,QAId,SAAS+X,GAAI1yB,UACdA,GAAiB,IAATA,EACNA,EAAK1G,WAAWQ,OADW,yCCjDnB64B,GAAKC,EAAMC,EAAOC,UAE1B15B,EADM,IAAIV,KAAKk6B,EAAMC,EAAM,EAAGC,UAI/B,SAASC,GAAKC,EAAMC,EAAQ/X,UAE3B9hB,EADM,IAAIV,KAAK,KAAM,EAAG,EAAGs6B,EAAMC,EAAQ/X,SAI1C,SAASgY,GAAI16B,UACZQ,EAAmBR,GAAM26B,iBAG1B,SAASC,GAAM56B,UACdQ,EAAmBR,GAAM66B,WAAW,QAGrC,SAASC,GAAK96B,UACbQ,EAAmBR,GAAMG,mBAG1B,SAAS46B,YAERn6B,EADM,IAAIV,eAIX,SAAS86B,GAAQ/6B,EAAO6H,EAAKmzB,UACxB,KAARA,IACFh7B,EAAQO,EAAmBP,GAC3B6H,EAAMtH,EAAmBsH,IAGnBmzB,OACD,WACGnzB,EAAI3H,cAAgBF,EAAME,kBAC7B,WACqD,IAA3C2H,EAAI3H,cAAgBF,EAAME,eACxB2H,EAAI+yB,WAAc56B,EAAM46B,eAEpC,WACGv6B,KAAKC,MAAMuH,EAAM7H,OAEpB,SACEG,EAAO0H,EAAI6yB,UAAY16B,EAAM06B,aAChCv6B,EAAO,EAAE,KACL86B,EAAgB,IAAIh7B,KAAKD,EAAME,cAAeF,EAAM46B,WAAa,EAAG,GAAGF,iBACtE7yB,EAAI6yB,UAAYO,EAAgBj7B,EAAM06B,iBAEvCv6B,MAEH,SACE+6B,EAASrzB,EAAI+yB,WAAa56B,EAAM46B,kBAC/BM,EAAS,EAAI,GAAKA,EAASA,MAE9B,SACE/6B,EAAOL,EAAa+H,GAAO/H,EAAaE,UACvCG,EAAO,EAAI,IAAMA,EAAOA,kCC3D3B,SAASg7B,GAAMpvB,yDAC2BrK,MAAMkB,SAASmd,OAAOhU,oBAGhE,SAASqvB,GAAUj6B,EAAKuE,EAAM21B,EAAQC,OACxCl6B,EAAGmB,EAAS,CAAEmD,KAAMA,EAAMW,MAAOg1B,EAAQE,cAAcD,GAC1Dp4B,EAAiB,OAARwC,EAAe,GAAI,QACzBtE,EAAG,EAAIA,EAAID,EAAIE,OAAQD,IAC1BD,EAAIC,GAAKD,EAAIC,IAAI,SACXM,MAAM85B,WAAWC,YAAYl5B,EAA7Bb,CAAqCP,EAAK,CAAE+B,MAAMA,EAAOuC,OAAQ,gBAGlE,SAASi2B,GAAU3vB,EAAKxE,UAC9BA,EAAOA,GAAQwE,+DAC8CrK,MAAMkB,SAASmd,OAAOhU,gBAASrK,MAAMkB,SAASmd,OAAOxY,eAG5G,SAASo0B,GAAG3jB,EAAOtH,EAAKkrB,UAC1B5jB,EACItH,EAEAkrB,KChBIC,GAAU,GCwDvB,SAASC,GAAYr5B,EAAMqM,EAAKlB,EAAKpM,GACpCA,EAAQb,EAAmBa,GAC3BiB,EAAKof,aAAa/S,EAAKlB,EAAKpM,GAkB7B,SAASu6B,GAAc5oB,OAClB6oB,EAAa7oB,EAAS,SAAW,YAClCoJ,GAAYpJ,EAAQ,UACtB6oB,EAAa,SACNzf,GAAYpJ,EAAQ,UAC3B6oB,EAAa,QACPA,EAGD,SAASC,GAAQx5B,EAAMqM,EAAKC,OAC5BoL,EAAQ1X,EAAKsP,OAAOjD,GAAKotB,aAC3B/hB,GAASA,EAAMpL,GAClB,OAAOoL,EAAMpL,GAGf,SAASotB,GAAQ15B,EAAMqM,EAAKlB,EAAKuF,EAAQzN,EAAMwB,GAE9CzE,EAAK25B,UAAW,MACZ56B,EAAQiB,EAAKmf,aAAa9S,EAAKlB,GAE7ByuB,EAA4B,iBAAT76B,GAAiC,KAAZA,EAAM,GAC9C86B,IAAcp1B,GAAmB,QAAViM,GAAuB1Q,EAAKsK,eAAyB,QAARrH,GAEpE62B,EAAaF,IAAclpB,E1BqL3B,SAASqpB,EAAc/5B,EAAMjB,WAE/Bi7B,EADAC,EAAQ,EAENvuB,EAAS1L,EAAK0L,OAAO8R,QACrBhS,EAAQC,GAAM1M,GAAO,EAAM2M,GAEzB/M,EAAI,EAAGA,EAAI6M,EAAM5M,OAAQD,OAE7BA,EAAE,GAAM,EAAE,KAENy6B,EAAU5tB,EAAM7M,GAAGqF,MAAM,6CAC5Bo1B,GACFA,EAAQnX,QAAQ,SAAAiY,IACS,EAArBA,EAAKhyB,QAAQ,MACf+xB,IAGID,GADgB,iEACWhuB,KAAKkuB,KACnCF,EAAaC,MAELA,EAAQD,IACjBA,EAAa,aAIZ,IAAIA,EAAW,IAChB/6B,MAAM4D,QAAQ2I,EAAM7M,IAAI,IACvB6M,EAAM7M,GAAG,IAAMqB,EAAKuK,iBAGtB,SAFAiB,EAAM7M,GAAK6M,EAAM7M,GAAG,OAMhB0P,EAAO,cAAcrC,KAAKR,EAAM7M,IAAMuc,GAASxP,EAAOF,EAAM7M,IAAI8M,MAAM,KAAK,IAAMyP,GAAS1P,EAAM7M,IAChGgB,EAAOsa,GAAcja,EAAMqO,EAAK,GAAIA,EAAK,OAG5C1O,EACF,MAAO,CAAC0V,IAAKhB,GAAgB1U,K0B5NUo6B,CAAc/5B,EAAMjB,GAAS,KAEjEw6B,EAAaD,GAAc5oB,GAAUopB,GACrCK,EAjFP,SAASC,EAAcp6B,EAAMqM,EAAKlB,EAAKpM,EAAO86B,EAAWD,EAAWL,EAAY90B,OAE3ExB,EAAO,aACPhE,MAAMwH,YAAY1H,MAClB66B,EACF32B,EAAO,SAEJ,uBAAuB+I,KAAKjN,GAC9BkE,EAAO,OACA,yBAAyB+I,KAAKjN,KACrCkE,EAAO,eAEJ,GAAI1E,MAAMQ,IAEV,GAAiB,UAAdw6B,GAA0BM,EAAU,KAGrCQ,EAASp7B,MAAMzB,KAAK88B,UAAWr7B,MAAMC,KAAKC,YAAYM,QAAQ86B,eAExD,KADZx7B,EAASs7B,EAAOt7B,KACGR,MAAMQ,KAIrB0F,EACF40B,GAAYr5B,EAAMqM,EAAKlB,EAAKpM,GAE5BiB,EAAKw6B,WAAW,kBAAMnB,GAAYr5B,EAAMqM,EAAKlB,EAAKpM,KAEnDkE,EAAO,cAfRA,EAAO,gBAmBFA,EAiDYm3B,CAAcp6B,EAAMqM,EAAKlB,EAAKpM,EAAO86B,EAAWD,EAAWL,EAAY90B,IAe3F,SAASg2B,EAAWz6B,EAAMqM,EAAKlB,EAAKlI,EAAMk3B,EAAYZ,EAAYO,OAC7D/6B,EAAQiB,EAAKmf,aAAa9S,EAAKlB,GAC7ByuB,EAA4B,iBAAT76B,GAAiC,KAAZA,EAAM,GAC9C27B,EAAa16B,EAAKsuB,cAAcjiB,EAAKlB,MAExC2uB,EACF95B,EAAK26B,UAAUtuB,EAAKlB,EAAK2uB,EAAWzkB,UAChC,GAAW,QAARpS,EAAe,IAEL,QAAds2B,EAAqB,KACjBjf,EAASsf,GAAsD,GAAzC76B,EAAMqnB,cAAcle,QAAQ,UAClDmS,EAASpb,MAAMC,KAAKC,YAAYM,QAChCiR,EAAS4J,EAASD,EAAOugB,WAAavgB,EAAOxG,WACnD7T,EAAK26B,UAAUtuB,EAAKlB,EAAKuF,GAItBkpB,GAAcc,GACjB16B,EAAK66B,cAAcxuB,EAAKlB,EAAK,CAAC5D,OAAQ,mBAElB,UAAdgyB,GAAkC,UAARt2B,GAAkC,UAAdk3B,GAErDn6B,EAAK26B,UAAUtuB,EAAKlB,EAAK,MAId,QAARlI,GAAkB22B,IAAcc,GAAmC,cAArBA,EAAWnzB,QAC5DvH,EAAK66B,cAAcxuB,EAAKlB,EAAK,OAvC9BsvB,CAAWz6B,EAAMqM,EAAKlB,EADtBlI,EA3CD,SAAS63B,EAAU73B,EAAMk3B,EAAYZ,EAAYK,EAAW76B,UAC3DkE,EAAOA,GAAQk3B,EAGE,UAAdA,EACFl3B,EAAO,SACAs2B,IACPt2B,EAAOs2B,GAEG,QAARt2B,IAAmB22B,GAAa1f,GAAcnb,KAChDkE,EAAO,UAEDA,EA+BA63B,CAAU73B,EAAMk3B,EAAYZ,EAAYK;CAAW76B,GACzBo7B,EAAYZ,EAAYO,OAEnDxyB,EAAOtH,EAAKsP,OAAOjD,GACrB/E,EAAKmyB,YACRnyB,EAAKmyB,UAAY,IAClBnyB,EAAKmyB,UAAUtuB,GAAOlI,SAEfjD,EAAK25B,SD9Gb16B,MAAMiU,OAAOkmB,GAASzO,IACtB1rB,MAAMiU,OAAOkmB,GAAS2B,IACtB97B,MAAMiU,OAAOkmB,GAAS97B,IACtB2B,MAAMiU,OAAOkmB,GAAS4B,+BCNf,SAAShxB,GAAKhK,GACpBA,EAAKmD,YAAY,eAAgB,SAASkJ,EAAKlB,EAAKpM,EAAOkE,GACtD/B,KAAKy4B,UAERD,GAAQx4B,KAAMmL,EAAKlB,EADJ8O,GAAc/Y,KAAMmL,EAAKlB,GACRlI,KAIlCjD,EAAKmD,YAAY,uBAAwB,SAASkJ,EAAKlB,EAAKuF,GACvDxP,KAAKy4B,UACRD,GAAQx4B,KAAMmL,EAAKlB,EAAKuF,EAAQ,MAAM,KAGxC1Q,EAAKmD,YAAY,WAAY,SAAS+oB,EAAQjZ,GAChC,YAAViZ,GAAwBjZ,EAAO6f,UAAsC,cAA1B7f,EAAO6f,SAASvrB,QAEjC,QAAzB+xB,GADYrf,GAAc/Y,KAAM+R,EAAO5G,IAAK4G,EAAO3G,UAErDpL,KAAKy5B,UAAU1nB,EAAO5G,IAAK4G,EAAO3G,OAAQrN,MAAMC,KAAKC,YAAYM,QAAQoU,4BChBzEonB,GAAc,GAClB,IAAI,IAAIt8B,MAAKy6B,GACL,cAAHz6B,IAAiBs8B,GAAYv4B,KAAK/D,IAEhC,SAASqL,GAAKhK,UACpBA,EAAKmD,YAAY,kBAAmB,kBAqBrC,SAASsoB,EAAMzrB,OACVuH,EAASvH,EAAK+B,GAAG,uBA+FZm5B,EAAa7uB,EAAKC,OACpBmS,EAAalX,EAAOzH,OAAO2e,WAC9BA,GAAcA,EAAWpS,KAAOA,GAAOoS,EAAWnS,QAAUA,GAC9D6uB,EAAW,CAAC9uB,IAAAA,EAAKC,OAAAA,aAGV8uB,EAAU77B,EAAO8O,EAAMgtB,YAE1Br7B,EAAKsuB,cAAcjgB,EAAKhC,IAAKgC,EAAK/B,SAAW6uB,EAAW9sB,EAAMgtB,MAClE9zB,EAAOob,QACH0Y,GACH9zB,EAAOiX,cACD,YAKA8c,EAAcjvB,EAAIC,OACpBivB,EAAWv7B,EAAKsuB,cAAcjiB,EAAKC,IAAWtM,EAAK6wB,aAAaxkB,EAAKC,UACxEivB,EACFh0B,EAAOi0B,UAEPj0B,EAAOk0B,SACDF,WAGCJ,EAAW9sB,EAAMgtB,OACnBE,EAAWD,EAAcjtB,EAAKhC,IAAKgC,EAAK/B,eAC9C/E,EAAOzH,OAAO2e,WAAapQ,EAC3B9G,EAAOtF,SAAUo5B,EAAQ,YAMjBlc,EAAa9S,EAAKC,OACtBvN,EAAQiB,EAAKmf,aAAa9S,EAAKC,MACF,QAA9BktB,GAAQx5B,EAAMqM,EAAKC,IAAiC,KAAZvN,EAAM,GAAU,KACpD2R,EAASyJ,GAAkBna,EAAKsP,OAAOjD,GAAMC,GACnDvN,EAAQ2R,EAAO5S,EAAmBiB,WAE5BA,EAZuBogB,CAAa9Q,EAAKhC,IAAKgC,EAAK/B,SAE1DtM,EAAKqf,iBAAmBkc,EAAW,KAAO,SAASt0B,EAAEqQ,EAAEmZ,EAAGiL,UAAYC,EAAWlL,EAAIiL,EAAIz0B,KACjFs0B,WAYAI,EAAWlL,EAAIiL,EAAIrtB,OACvB7G,EAASD,EAAOE,eAAeC,eAE/B6D,EAAQ,MACThE,EAAOuW,YAAY,KACfC,EAAc/d,EAAKuK,iBACtBhD,EAAOuW,aAAeC,IACxBxS,EAAQhE,EAAOqW,aAAaG,QAGxB1S,EAAQolB,GAAMiL,EAAKnwB,EAAMklB,YAAQllB,EAAMklB,cAAMllB,EAAMmwB,GACnDE,EAAcr0B,EAAOmV,iBAExBkf,GAAeA,EAAY3tB,KAAOzG,EAASo0B,EAAYhc,IACzDrY,EAAOoY,SAAStU,GAAO,GACvB7D,EAASD,EAAOmV,cAAczO,IAAM5C,EAAMzM,WAEtC,CAAA,IAAG2I,EAAOmY,iBAKd,gBASOtC,EAAQqT,GACZlpB,EAAOs0B,cACVt0B,EAAOqV,kBACPrV,EAAOsV,kBACPtV,EAAOtF,SAASwuB,EAAKzwB,EAAKmf,aAAasR,EAAGpkB,IAAKokB,EAAGnkB,QAAU,YAEtD,EAfC8Q,CAAQ/O,GAJf9G,EAAOoY,SAAStU,GAChB7D,GAAU6D,EAAMzM,cAKjB2I,EAAOob,QACPpb,EAAOE,eAAe8X,kBAAkB/X,EAAQA,GAChDD,EAAOiX,cAEA,WAYCsd,IACRv0B,EAAOmX,OAAO,CAACD,WAAW,OAC1BlX,EAAOtF,SAAS,IAChBsF,EAAOi0B,UAlLRx7B,EAAKgR,OAAO7N,YAAY,oBAAqB,SAASkL,OACjDE,EAAOvO,EAAKgR,OAAO0iB,eACvB1zB,EAAKgR,OAAO0iB,SAAU,EAEf0H,EAAUl6B,KAAMmN,EAAME,KAG9BvO,EAAKgR,OAAO7N,YAAY,qBAAsB,SAASkL,UAC/C+sB,EAAUl6B,KAAMmN,GAAM,KAG9BrO,EAAKgR,OAAO7N,YAAY,iBAAkB,SAASpC,GAC/Cf,EAAKsuB,cAAcvtB,EAAGsL,IAAKtL,EAAGuL,SAChCpL,KAAKyyB,KAAK5yB,GACXwG,EAAOob,UAGR3iB,EAAKgR,OAAO7N,YAAY,gBAAiB,WACrCoE,EAAO/D,MAAM2sB,SAAS7R,SAASC,gBACjChX,EAAOiX,eAGTxe,EAAKmD,YAAY,eAAgB,SAAC4U,EAAEC,EAAE1Z,OACjC+P,EAAO9G,EAAOzH,OAAO2e,WACrBpQ,GAAQA,EAAKhC,KAAO0L,GAAK1J,EAAK/B,QAAU0L,GAC3CzQ,EAAOtF,SAAS3D,KAGlB0B,EAAKmD,YAAY,gBAAiB,SAAC1E,OAC7BuB,EAAKqf,iBAAiB,KACtBhR,EAAO5P,EAAK,GAChB08B,EAAW9sB,MAIbrO,EAAKmD,YAAY,WAAY,SAACoL,MACjB,UAARA,GAAoBhH,EAAOs0B,YAAY,KACpCxtB,EAAO9G,EAAOzH,OAAO2e,WACxBpQ,GAAQ9G,EAAOzF,YAAc9B,EAAKmf,aAAa9Q,EAAKhC,IAAKgC,EAAK/B,iBACzD/E,EAAOmV,cACdnV,EAAOqV,kBACPrV,EAAOsV,sBAKV7c,EAAKmD,YAAY,oBAAqB,SAACxD,OAChC0O,EAAO9G,EAAOzH,OAAO2e,cACxBpQ,EAAK,KACD7G,EAASD,EAAOE,eAAeC,eAC/BC,EAAMJ,EAAOzF,WAChB9B,EAAKmf,aAAa9Q,EAAKhC,IAAKgC,EAAK/B,SAAW3E,GAC1CJ,EAAOuW,cACVvW,EAAOuW,YAAc9d,EAAKuK,kBAC3BtL,MAAMwL,MAAM,cACR9K,GAAQ4H,EAAOuW,YAAY,CAC7B9d,EAAKqf,iBAAmB,SAClBhR,EAAO9G,EAAOzH,OAAO2e,WAC3Bze,EAAKgR,OAAOnQ,OAAOwN,EAAKhC,IAAKgC,EAAK/B,QAGnC/E,EAAOtF,SAAS0F,GAEhBJ,EAAOuB,UAEPvB,EAAOob,QACPpb,EAAOE,eAAe8X,kBAAkB/X,EAAQA,GAChDD,EAAOiX,aAEPxe,EAAKqf,iBAAmB,SAASpY,EAAEqQ,EAAEmZ,EAAGiL,UAAYC,EAAWlL,EAAIiL,EAAIz0B,OAIxE60B,OAIH97B,EAAKmD,YAAY,UAAW,kBAAMnD,EAAKqf,iBAAmB,OAE1Drf,EAAKmD,YAAY,cAAe,kBAAM24B,MAEtC97B,EAAKmD,YAAY,WAAY,SAASxD,EAAMI,OACrCsO,EAAO9G,EAAOzH,OAAO2e,WACrBsd,EAAe1tB,GAAQA,EAAKhC,KAAOtM,EAAQsM,KAAOgC,EAAK/B,QAAUvM,EAAQuM,QAC5EyvB,GAAyB,QAARp8B,GAA0B,YAARA,GACrC27B,EAAcv7B,EAAQsM,IAAKtM,EAAQuM,UAGrCtM,EAAKmD,YAAY,iBAAkB,SAAC4U,EAAGC,UAAMkjB,EAAanjB,EAAGC,KAC7DhY,EAAKmD,YAAY,eAAgB,SAAC4U,EAAGC,UAAMkjB,EAAanjB,EAAGC,KAnHjByT,CAAMzrB,KAEzC,CACNA,KAAK,UACLsB,IAAI,uBACJoE,SAAS,CACR,CACC1F,KAAK,QACLgG,MAAM/G,MAAMC,KAAKC,YAAYK,WAAvB,KACNiB,MAAM,IAEP,CACCT,KAAK,cACLu7B,UAAS,EACTx6B,GAAG,aACHwb,YAAa0e,MCzBV,SAASe,GAAKt9B,EAAKu9B,UAElBv9B,EADMw9B,GAAUx9B,EAAKu9B,IAItB,SAASC,GAAUx9B,EAAKu9B,WAC1B3Q,GAAU,EACN3sB,EAAG,EAAG2sB,EAAO,GAAK3sB,EAAID,EAAIE,OAAQD,IACtCs9B,EAAKv9B,EAAIC,MACX2sB,EAAS3sB,UAEJ2sB,EAGD,SAAS6Q,GAAa19B,EAAMszB,EAAO1wB,EAAMV,OAC3C,IAAIhC,EAAE,EAAGA,EAAEF,EAAKG,OAAQD,IAAI,KAE3B6W,EAAO/W,EAAKE,GACZ6W,EAAK,GAAGnU,IAAMA,EAAKmU,EAAK,IACxBA,EAAK,GAAG7U,IAAMA,EAAK6U,EAAK,OAG1Buc,EACF;AAAI,IAAIpzB,EAAI,EAAGA,EAAIozB,EAAMnzB,OAAQD,IAAI,KAE9By9B,EAAarK,EAAMpzB,GAAG,GAAKozB,EAAMpzB,GAAG,GAAK,EACzC09B,EAAatK,EAAMpzB,GAAG,GAAKozB,EAAMpzB,GAAG,GAAK,EAE/B0C,EAAb+6B,IAAmB/6B,EAAO+6B,GACbz7B,EAAb07B,IAAmB17B,EAAO07B,SAGxB,CAAM,EAALh7B,EAAa,EAALV,OC9BXZ,GAAU,CACf,eACA,gBAGKu8B,GAAY,gBACD,SAASt8B,GACxBA,EAAK0oB,QAAQ,CACZ5jB,KAAM7F,MAAMC,KAAKC,YAAYC,OAAO,0BAClCupB,KAAK,WACP9J,GAAO7e,EAAMA,EAAKu8B,gCAGJ,SAASv8B,GACxB2zB,GAAK3zB,EAAMA,EAAKu8B,2BAEJ,SAASv8B,GACrBw8B,GAAIx8B,iBAES,SAASA,IA2VxB,SAASmF,EAAKnF,GACbw8B,GAAIx8B,EAAMA,EAAKwJ,aA3VdrE,CAAKnF,KAIA,SAASgK,GAAKhK,GACpBA,EAAKmD,YAAY,kBAAmB,kBAgGrC,SAASsoB,EAAMzrB,GACdy8B,GAAQz8B,GAELA,EAAK+B,GAAG,cACV/B,EAAK+B,GAAG,aAAaoB,YAAY,cAAe,WAC/Cq5B,GAAIx8B,KAGNA,EAAKmD,YAAY,mBAAoB,SAACxD,UA+FvC,SAAS+8B,EAAY18B,EAAKL,GACtBK,EAAK+B,GAAG,YACV/B,EAAK+B,GAAG,UAAUlB,OAAOlB,GACzBK,EAAK+B,GAAG,UAAU0jB,SAAS9lB,IAlGmB+8B,CAAY18B,EAAKL,KAEhEK,EAAKmD,YAAY,YAAa,SAASw5B,GACnCL,GAAUK,EAAQ57B,KACpBu7B,GAAUK,EAAQ57B,IAAIG,QAGrBlB,EAAK+B,GAAG,YACV/B,EAAK+B,GAAG,UAAUtD,KAAK0E,YAAY,iBAAkB,kBA0CvD,SAASy5B,EAAsB58B,OAC1BqsB,EAAUrsB,EAAK+B,GAAG,kBAClB0H,EAASzJ,EAAK+B,GAAG,UAElB0H,EAAOoY,SAAYpY,EAAO3J,OAAOW,MAAMT,EAAKF,OAAO+8B,cACrDxQ,EAAQyQ,UAAU,SAAS,GAE3BzQ,EAAQyQ,UAAU,SAjDyCF,CAAsB58B,KACjFA,EAAK+B,GAAG,UAAUoB,YAAY,gBAAiB,kBAuBjD,SAAS45B,EAAkB/8B,OACpByJ,EAASzJ,EAAK+B,GAAG,UACjBi7B,EAAYvzB,EAAO+a,iBAAiB5b,KAE1B,GAAbo0B,EACFh9B,EAAK+B,GAAG,cAAcy5B,cAEnB,CACHx7B,EAAK+B,GAAG,cAAc05B,aAClBwB,EAAWj9B,EAAKF,OAAO+8B,iBACxBG,IAAcvzB,EAAOoY,QAASpY,EAAO3J,OAAOW,MAAMw8B,GAAWA,cAC/Dj9B,EAAK+B,GAAG,cAAcy5B,UAIxBx7B,EAAK+B,GAAG,cAAc05B,SAtCgCsB,CAAkB/8B,KACvEA,EAAK+B,GAAG,UAAUoB,YAAY,cAAe,SAAC+5B,UAkDhD,SAASC,EAAUn9B,EAAML,EAAM41B,OACzB,IAAIx0B,KAAMf,EAAKo9B,WACfp9B,EAAKo9B,QAAQr8B,GAAIpB,MAAQA,EAAM,KAC5B2H,EAAOtH,EAAKo9B,QAAQnR,OAAOlrB,EAAI,GACrCf,EAAKo9B,QAAQnR,OAAOsJ,EAAK,EAAGjuB,EAAK,WAtDwB61B,CAAUn9B,EAAKk9B,EAAQ3/B,MAAM2/B,EAAQvjB,SAC/F3Z,EAAK+B,GAAG,UAAUoB,YAAY,kBAAmB,SAACohB,UAAU8Y,GAAOr9B,EAAKukB,EAAMjT,IAAIiT,EAAMxlB,UAnH/C0sB,CAAMzrB,KAG1C,SAASs9B,GAAct9B,OACzB4kB,EAAW5kB,EAAKF,OAAO8kB,SACvBqY,EAAWj9B,EAAKF,OAAO+8B,cACvBxQ,EAAW,CACdrsB,KAAM,UACNe,GAAI,iBACJO,IAAK,mDACL6L,SAAU,EACVnK,OAAQ,GACR0C,SAAS,CACR,CACC1F,KAAM,SAAUiD,KAAK,aAAcxC,MAAO,GAAIM,GAAI,YAClDiF,MAAO,oDACP9F,QAASjB,MAAMC,KAAKC,YAAYE,SAAS,cAAc,GAAIgnB,OAAOzB,GAEnE,CACC7jB,GAAG,SACHf,KAAK,SACLS,MAAO,EAAIw8B,EACX9K,UAAUvN,EACVwN,WAAY,WACZ7qB,OAAO,OACPg2B,UAAU,QACVt6B,KAAK,CACJxC,MAAOw8B,EACPj6B,OAAQ,GACR7C,SAAU,SAASW,SACX,QAAQA,EAAI/B,MAAM,UACtB6lB,EAAuF,GAA9E,gFAGbtjB,IAAI,uBAELilB,QAAQ,CACPiX,yBAA0B,SAAShiB,EAAGza,IAkF3C,SAAS08B,EAAcz9B,EAAMwb,EAAGza,GAC3Bf,EAAK09B,aACR19B,EAAK09B,WAAaz+B,MAAMqB,GAlD1B,SAASq9B,EAAS39B,WACbvB,EAAO,GACHE,EAAE,EAAGA,EAAIoB,GAAQnB,OAAOD,IAC/BF,EAAKiE,KAAK,CAAC3B,GAAIhB,GAAQpB,GAAII,MAAME,MAAMC,KAAKC,YAAYG,MAAMS,GAAQpB,KAAKoB,GAAQpB,SAEhFi/B,EAAQ,CACX59B,KAAM,iBACNvB,KAAMA,UAEPuB,EAAK8C,UAAU,aAAc,CAAC,aAAc86B,IACrCA,EAwCqBD,CAAS39B,IACpCA,EAAK69B,iBAAiBn7B,KAAK1C,EAAK09B,YAChC19B,EAAK09B,WAAWv6B,YAAY,cAAe,SAACpC,UA8N9C,SAAS+8B,EAAW99B,EAAMe,GACrBf,EAAK09B,WAAWj/B,KAAKs/B,QAAQh9B,EAAI,mBACpCu7B,GAAUv7B,GAAIf,GAhOoC89B,CAAW99B,EAAKe,MAGhEf,EAAK09B,WAAWzlB,QAAQ,kBACM,GAA7BjY,EAAK+B,GAAG,UAAU8f,QACpB7hB,EAAK09B,WAAWM,YAAY,gBAE5Bh+B,EAAK09B,WAAWO,WAAW,iBAC1Bj+B,EAAK8C,UAAU,oBAAqB,CAAC/B,KACvCf,EAAK09B,WAAW70B,KAAK2S,GA9FjBiiB,CAAcz9B,EAAMwb,EAAGza,KAGzBC,GAAG,CACFqb,YAAa,SAAStb,GAClBA,GAAMf,EAAKu8B,cACbv8B,EAAK2e,UAAU5d,MAInB,CACCf,KAAM,SAAUiD,KAAK,aAAcxC,MAAO,GAAIM,GAAI,aAAcw6B,UAAS,EAAMlV,QAAO,EACtFrgB,MAAO,iDAAkDk4B,MAAM,QAC/D/3B,MAAM,WAAWg4B,GAAan+B,GAAO,KAEtC,CACCA,KAAM,SAAUiD,KAAK,aAAcxC,MAAO,GAAIM,GAAI,aAAcslB,QAAO,EACvErgB,MAAO,kDAAmDk4B,MAAM,QAChE/3B,MAAM,WAAWg4B,GAAan+B,EAAM,cAKvCA,EAAK8C,UAAU,aAAc,CAAC,iBAAkBupB,IAEzCA,EAGR,SAAS8R,GAAan+B,EAAMo+B,OACvB30B,EAASzJ,EAAK+B,GAAG,UACrB0H,EAAO40B,SAAS50B,EAAO+a,iBAAiB5b,EAAGw1B,EAAUp+B,EAAKF,OAAO+8B,cAAgB,GA0G3E,SAASL,GAAIx8B,EAAMyF,OACrBkU,EAAOha,EAAM2+B,SAGjBA,GAAkB,GADlB3kB,EAAQjb,GAAcsB,EAAKo9B,QAAS,SAAAx0B,UAAKA,EAAEjJ,MAAQK,EAAKu8B,gBACpC5iB,EAAM,EAAE3Z,EAAKo9B,QAAQx+B,OACzCe,EAYD,SAAS4+B,EAAYv+B,OAChB2Z,EAAQ3Z,EAAKo9B,QAAQx+B,OAAO,OAC1B4/B,GAASx+B,EAAOf,MAAMC,KAAKC,YAAYC,OAAOmM,MAAMoO,IACzDA,WACU1a,MAAMC,KAAKC,YAAYC,OAAOmM,MAAMoO,EAhBxC4kB,CAAYv+B,GACnByF,EAAUA,GAAW,CAAChH,KAAK,IAC3BuB,EAAKo9B,QAAQnR,OAAOqS,EAAU,EAAG,CAChC3+B,KAAMA,EACN8F,QAASA,IAEVzF,EAAK+B,GAAG,UAAUy6B,IAAI,CAACz7B,GAAIpB,EAAMZ,MAAOY,GAAM2+B,GAC9Ct+B,EAAK2e,UAAUhf,GACfK,EAAK8C,UAAU,aAAc,CAACnD,IACvBA,EAkBD,SAASg0B,GAAK3zB,EAAKL,GACzBK,EAAK+B,GAAG,UAAU4xB,KAAKh0B,GAGjB,SAASkf,GAAO7e,EAAKL,OACvBga,EAAO8kB;CACa,EAArBz+B,EAAKo9B,QAAQx+B,SACf+a,EAAQjb,GAAcsB,EAAKo9B,QAAQ,SAAAx0B,UAAKA,EAAEjJ,MAAQA,IAClDK,EAAKo9B,QAAQnR,OAAOtS,EAAM,GACtB3Z,EAAKo9B,QAAQzjB,KAChBA,EAAQ,GACT8kB,EAAYz+B,EAAKo9B,QAAQzjB,GACzB3Z,EAAKu8B,aAAe,KACjBv8B,EAAK+B,GAAG,YACV/B,EAAK+B,GAAG,UAAU8c,OAAOlf,GACzBK,EAAK+B,GAAG,UAAU+G,WAEnB9I,EAAK2e,UAAU8f,EAAS9+B,MACxBK,EAAK8C,UAAU,gBAAiB,CAACnD,KAI5B,SAAS09B,GAAOr9B,EAAKL,EAAKyK,MAC5BzK,GAAQyK,WAGRzL,EAAI,GACAyL,GAAWo0B,GAASx+B,EAAMoK,IACjCA,EAAUnL,MAAMC,KAAKC,YAAYC,OAAOmM,MAAQ5M,EAChDA,IAEDyL,EAAUA,EAAQrG,QAAQ,eAAe,IAAI+D,UAAU,EAAG,QAEtDyD,EAAQizB,GAASx+B,EAAML,GACvB8J,EAASzJ,EAAK+B,GAAG,aAErBwJ,EAAM5L,KAAOyK,EACVpK,EAAKu8B,cAAgB58B,IACvBK,EAAKu8B,aAAenyB,GAElBX,EACSA,EAAOwO,QAAQtY,GACrBZ,MAAQqL,EACbX,EAAOhL,KAAKigC,SAAS/+B,EAAKyK,GAC1BX,EAAOX,QAAQsB,GAGhBpK,EAAK8C,UAAU,gBAAiB,CAACnD,EAAMyK,KAsBjC,SAASqyB,GAAQz8B,EAAMc,GACzBA,IAAKA,EAAM,CAACrC,KAAK,KACjBqC,EAAI2I,SACP3I,EAAM29B,GAAS39B,QAEZnB,EAAOmB,EAAI2I,OAAO,GAAG9J,KACzBK,EAAKu8B,aAAe,GACpBv8B,EAAKo9B,QAAUt8B,EAAI2I,OAtMb,SAASoF,EAAM7O,EAAMc,OACvB69B,EAAO3+B,EAAK+B,GAAG,aACf48B,EAAK,CACRA,EAAK3L,eACD7pB,EAAM,GACVrI,EAAI2I,OAAOwY,QAAQ,SAAS1W,GAC3BpC,EAAIzG,KAAK,CAAC3B,GAAGwK,EAAM5L,KAAMZ,MAAOwM,EAAM5L,SAEvCg/B,EAAKrL,MAAMnqB,IA+LZ0F,CAAM7O,EAAMc,GACZ+H,GAAK7I,EAAML,GAGL,SAAS8+B,GAAS39B,SACjB,CACN2I,OAAO,CAAC,CACP9J,KAAMV,MAAMC,KAAKC,YAAYC,OAAOmM,MAAQ,EAC5C9F,QAAS3E,KAKL,SAAS+H,GAAK7I,EAAKL,GACrBA,GAAQK,EAAKu8B,eAEdv8B,EAAK8C,UAAU,oBAAqB,CAACnD,MACnCK,EAAKu8B,eACRiC,GAASx+B,EAAMA,EAAKu8B,cAAc92B,QAAUzF,EAAKwJ,aAElDxJ,EAAKu8B,aAAe58B,EAEpBmJ,GAAQ9I,EADEw+B,GAASx+B,EAAML,GAAM8F,SAG/BzF,EAAK8C,UAAU,mBAAoB,CAACnD,MAI/B,SAAS6+B,GAASx+B,EAAML,UACvBjB,GAASsB,EAAKo9B,QAAS,SAAAx0B,UAAKA,EAAEjJ,MAAQA,IAQvC,SAASi/B,GAAU5+B,UAClBA,EAAKu8B,aAGb,SAASzzB,GAAQ9I,EAAMc,WACHpC,GAAiBoC,EAAIrC,KAAMqC,EAAIixB,MAAO/xB,EAAKF,OAAOozB,SAAUlzB,EAAKF,OAAOmzB,gBAAtF5xB,OAAMV,OACXX,EAAK8C,UAAU,UAAW,IACtBzB,GAAQrB,EAAKF,OAAOozB,UAAYvyB,GAAQX,EAAKF,OAAOmzB,cACvDjzB,EAAKF,OAAOozB,SAAW7xB,EACvBrB,EAAKF,OAAOmzB,YAActyB,EAC1BX,EAAK6+B,eAGN7+B,EAAKsK,eAAgB,EACrBtK,EAAK8C,UAAU,cAAe,CAAChC,IAC/Bd,EAAKsK,eAAgB,EACrBtK,EAAKgR,OAAOlI,UACT9I,EAAKF,OAAO0sB,WACdxsB,EAAK+B,GAAG,UAAU+G,cC3WPg2B,GAAb,sBACa9+B,kBACNA,KAAOA,yJAMRkB,KAAK69B,eACHA,QAAU9/B,MAAMqB,GAAGY,KAAKrB,cACxBG,KAAK69B,iBAAiBn7B,KAAKxB,KAAK69B,cAChCA,QAAQ57B,YAAY,SAAU,WAClCkF,EAAK22B,QACL//B,MAAMkkB,UAAU0O,SAASxpB,EAAKrI,aAE1B++B,QAAQ57B,YAAY,SAAU,WAClClE,MAAMkkB,UAAU0O,SAASxpB,EAAK02B,gBAI1Bh5B,EAAO7E,KAAK69B,QAAQz8B,eACrBy8B,QAAQl2B,QAC0B,IAAnC3H,KAAK+9B,MAAM/9B,KAAK69B,QAASh5B,IAC5B7E,KAAKqE,6CAGDw5B,QAAQl9B,aA1Bf,GC+BA,SAASq9B,GAASp6B,UACZA,GAGW,OADhBA,EAAOA,EAAK2a,QACH,KACR3a,EAAOA,EAAKsG,OAAO,IACQ,MAAxBtG,EAAKA,EAAKlG,OAAO,KACpBkG,EAAOA,EAAKsG,OAAO,EAAGtG,EAAKlG,OAAO,IAC5BkG,GAPW,GC/BZ,IAEMq6B,GAAb,wFAA+BL,qCACxBM,EAAKr5B,WACLsI,KAAOnN,KAAKlB,KAAKqC,iBAClBnB,KAAKmN,KACR,OAAO,EAERtI,EAAKL,SAAS25B,QAAQn4B,QAAQ,IAC9BnB,EAAKL,SAAS4D,IAAIrH,SAAS,QAIvBxD,EDFC,SAAS6gC,EAAWvgC,MACtBA,GAAsC,IAA7BA,EAAMmJ,QAAQ,WAC1B,MAAO,CACNoB,IAAK41B,GAASngC,EAAMqM,OAAO,EAAGrM,EAAMH,OAAO,KCDjC0gC,CADCp+B,KAAKlB,KAAKmf,aAAaje,KAAKmN,KAAKhC,IAAKnL,KAAKmN,KAAK/B,SAExD7N,GAAQA,EAAK6K,KAChBvD,EAAKL,SAAS4D,IAAIrH,SAASxD,EAAK6K,KAEjCvD,EAAKL,SAAS4D,IAAIqZ,mDAGZtc,EAAOnF,KAAKlB,KAAKF,OAAOuG,KACxBk5B,EAAUl5B,GAAQA,EAAKm5B,QAAW,WAEjC,CACNx/B,KAAM,gBACN4G,KAAM3H,MAAMC,KAAKC,YAAYC,OAAO,eACpCuH,MAAM,EACNuU,SAAU,SACVjb,KAAK,CACJD,KAAK,OACL0F,SAAS,CACR,CAAE1F,KAAK,OAAQL,KAAK,MAAQwW,YAAYlX,MAAMC,KAAKC,YAAYC,OAAO,aAAc4B,GAAG,UAC3E,SAACy+B,UAAUp3B,EAAKq3B,YAAYD,MAExC,CAAEz/B,KAAK,QAASgG,MAAM/G,MAAMC,KAAKC,YAAYC,OAAO,YAAamrB,MAAO,UACxE,CAAEvqB,KAAK,WAAYgG,MAAM/G,MAAMC,KAAKC,YAAYC,OAAO,gBAAiBugC,OAAOJ,EAAQv+B,GAAG,CACzF4+B,gBAAiB,SAASC,kBACpB3+B,KAAKpB,OAAO6/B,OAAO,KACjBG,EAAS,IAAIC,kBACnBD,EAAOE,OAAS,SAACxkB,UAAM2B,EAAK8iB,cAAcv6B,SAAS4D,IAAIrH,SAASuZ,EAAEyI,OAAOqH,SACzEwU,EAAOI,cAAcL,EAAKA,OACnB,EAGP3+B,KAAK++B,cAAcv6B,SAAS25B,QAAQn4B,QAAQ,KAE9Ci5B,aAAc,SAAS74B,EAAM84B,QACvBH,cAAcv6B,SAAS4D,IAAIrH,SAASm+B,EAASC,aAGpD,CAAErgC,KAAK,WAAYL,KAAK,UAAW4D,YAAY,EAAMjC,IAAK,uBAAwBnB,SAAS,GAAI6C,OAAO,MAIxGhC,GAAG,CACFs/B,YAAa,kBAAMj4B,EAAKk4B,WACxBC,cAAe,kBAAMn4B,EAAK9C,iDAKtB8I,EAAOnN,KAAKmN,KACZoxB,EAAQv+B,KAAKu/B,QAAQv/B,KAAK69B,QAAQz8B,UAAUoD,SAAS4D,IAAIxH,iBAC1D9B,KAAK0gC,SAASryB,EAAKhC,IAAKgC,EAAK/B,OAAQmzB,QACrCl6B,wCAEE+D;MACF,mCAAmC0C,KAAK1C,KAC5CA,EAAM,UAAYA,GACZA,sCAEIm2B,GACPA,IACHA,EAAQxgC,MAAMkB,SAASmd,OAAOpc,KAAKu/B,QAAQhB,SACtCV,QAAQtc,UAAU,QAAQ/c,SAAS25B,QAAQn4B,QAAQ,yCAAyCu4B,EAAM,mBAxE1G,4BAFsB,gCCCTN,GAAb,wFAA+BC,oCACzBlT,QACCpsB,OAASosB,EAAOpsB,YAChB6gC,OAASzU,EAAOyU,YAEhB3gC,KAAK8C,UAAU,gBAAiB,CAAC5B,KAAKy/B,OAAQ,UAEnDvB,GAAc/6B,UAAUu8B,KAAK77B,MAAM7D,KAAM8D,gDAGpChF,KAAK8C,UAAU,eAAgB,CAAC5B,KAAKy/B,OAAQ,eAC7C7gC,OAASoB,KAAKy/B,OAAS,4DAGvB3gC,KAAKmD,YAAY,gBAAiB,SAACpC,EAAIkC,GACxCoF,EAAK02B,SAAW12B,EAAK02B,QAAQ91B,aAAuB,SAARhG,GAC9CoF,EAAK9C,eAGFvF,KAAKmD,YAAY,YAAa,SAAArC,GACrB,mBAAVA,EAAIC,IAA2BsH,EAAK02B,SAAW12B,EAAK02B,QAAQ91B,aAC9DZ,EAAK9C,UAGA65B,GAAc/6B,UAAUxE,MAAMkF,MAAM7D,KAAM8D,yCAE5Co6B,EAAKr5B,GAEVA,EAAKL,SAAS25B,QAAQn4B,QAAQ,IAC9BnB,EAAKL,SAAS4D,IAAIrH,SAAS,IAExBf,KAAKpB,QAAUoB,KAAKpB,OAAOrB,MAC7BsH,EAAKL,SAAS4D,IAAIrH,SAASf,KAAKpB,OAAOrB,MAExCsH,EAAKL,SAAS4D,IAAIqZ,8CAGZ8c,EAAQv+B,KAAKu/B,QAAQv/B,KAAK69B,QAAQz8B,UAAUoD,SAAS4D,IAAIxH,eAC5DZ,KAAKy/B,OACPz/B,KAAKlB,KAAK6gC,MAAMC,OAAO5/B,KAAKy/B,OAAQlB,OACjC,KACG1+B,EAAKG,KAAKlB,KAAK6gC,MAAMrE,IAAI,KAAM,KAAM,QAASiD,QAC/Cz/B,KAAK6gC,MAAMrkB,UAAUzb,QAEtBwE,cA5CP,4BAFsB,+BCClBw7B,GAAU,GACVC,GAAW,GACR,SAAS3wB,GAAOtR,EAAOkiC,EAAMnmB,OAC/BomB,ElC0LE,SAAS5N,EAAMzY,EAAS7a,OAxGV0b,EAAYnQ,IAC3BwM,EAAEC,EAuG6B8C,4DAAU,GAC1C9F,EAAM,UACN0G,EAAO,GAEPX,GAAS,EACTomB,EAAO,GAAIC,EAAY,MAET,KAAdvmB,EAAQ,GAAW,OAAO,MAEzB,IAAIlc,EAAI,EAAGA,EAAIkc,EAAQjc,OAAQD,IAAI,KACnCsR,EAAM4K,EAAQlc,MAEP,KAAPsR,EACH8K,GAAUA,MACN,CAAA,GAAW,KAAP9K,GAA8B,KAAhB4K,EAAQlc,EAAE,GAAU,SACxBic,GAAQC,EAASlc,EAAE,MAAhCwc,OACLxc,OAAU,EACVqW,oBAAqBmG,YAGjB,IAAKJ,IAAkB,KAAP9K,GAAcyK,GAAOzK,IAAM,SACZ2K,GAAQC,EAASlc,EAAGmc,MAAlDumB,OAASj8B,OAAK7H,OAAOgO,OAGtB4P,EAAOkmB,EAAQjb,iBAEnBznB,EAAIyG,EAAM,EAGI,KAAX+V,EAAK,GAAU,CACjBnG,GAAQuG,GAAUJ,SAGd,GAAoB,KAAhBN,EAAQlc,EAAE,GAClBqW,oBAAmBmG,QAEf,GAAIF,GAAWE,MACC,KAAhBN,EAAQlc,EAAE,GACbwiC,EAAOhmB,EAAMimB,EAAY71B,EACzB5M,YAEa,KAATwiC,EACHnsB,GAAQ4G,GAAUF,EAAMylB,EAAMhmB,EAAMimB,GACpCD,EAAO,OACD,KACA9yB,GArJSqN,EAqJUA,EArJEnQ,EAqJUA,MApJ9B2P,GAoJwBC,MApJ/BpD,OAAEC,OAEO,KAAVzM,GACHmQ,EAAKhZ,KAAK,CAACqV,EAAEC,EAAED,EAAEC,EAAEzM,uBACAA,eAAUwM,cAAKC,SAElC0D,EAAKhZ,KAAK,CAACqV,EAAEC,EAAED,EAAEC,EAAE,sBACFD,cAAKC,SA8IC,KAAhB6C,EAAQzV,GACV4P,oBAAkB3G,qBAAeA,gBAAUA,WAE3C2G,GAAQ3G,MAIP,KACAhD,EAAQoQ,GAAeC,EAAM1b,EAAMmb,EAAM5P,MAGhC,IAATF,EAAY,CACf2J,GAAQuG,GAAU,eAGnBvG,GAAQ3J,EAIL8P,IAASkmB,IACZxmB,EAAUA,EAAQzP,OAAO,EAAG7N,GAAO4d,EAAKN,EAAQzP,OAAOhG,cAMpD2V,EAcJ/F,GAAQ/E,EAZI,MAARA,GAAgC,MAAjB4K,EAAQlc,EAAE,GAC5BqW,GAAQ,OAEQ,MAAR/E,GAAgC,MAAjB4K,EAAQlc,EAAE,IACjCqW,GAAQ,KACRrW,KAEkB,MAARsR,GAAgC,MAAjB4K,EAAQlc,EAAE,IAA+B,MAAjBkc,EAAQlc,EAAE,GAC3DqW,GAAQ,KAERA,GAAQ/E,QAMJ,CAAE+E,KAAMA,EAAK,IAAKssB,SAAS5lB,EAAM5W,KAAM+V,GkCpRjCwf,CAAat7B,EAAOkiC,EAAMnmB,GACpCA,IAAYkmB,GAASlmB,KACvBkmB,GAASlmB,GAAW,QACjB3K,EAAQ2K,EAAUkmB,GAASlmB,GAAWimB,UAC1CG,EAAO/2B,QAAUgG,EAAMpR,GAASoR,EAAMpR,IAavC,SAASwiC,EAAgBxiC,cAEhB,IAAIuW,SAASvW,GACnB,MAAMyc,UACAgmB,IAjBwCD,CAAgBL,EAAOlsB,MAChEksB,EAGD,SAASO,GAAeC,GAC9BX,GAAU,GACNW,IACHV,GAAW,IAGb,SAASQ,YACDviC,MAAMC,KAAKC,YAAYI,MAAM,uBClBrBoiC,GAAW9mB,EAASqR,EAAQ5d,WACrCszB,EAAQn2B,GAAMoP,GAAS,GACvB3J,EAAM0wB,EAAMhjC,OACZrB,EAAQ+Q,EAAOA,EAAK/Q,MAAQ,KAC5B6H,EAAMkJ,EAAOA,EAAKlJ,IAAM,KACvByc,EAAaqK,EAAbrK,MAAO9gB,EAAMmrB,EAANnrB,GAELpC,EAAI,EAAGA,EAAIuS,EAAKvS,GAAG,KAExBM,MAAM4D,QAAQ++B,EAAMjjC,aACSijC,EAAMjjC,MAA9B4M,OAAO8C,OACR2L,OAAiB,IAAM,GAC7B4nB,EAAMjjC,GAAKqb,EAAOzO,EAAQyO,EAAO,IAAM3L,eAIb6M,GAAS0mB,EAAMjjC,OAArC0N,OAAKC,OAAQ+O,OAEZwmB,EAAmB,EAARxmB,EACXymB,EAAsB,EAARzmB,EACdhQ,EAAQ02B,GAAWH,EAAOjjC,MAGtB,QAANoC,KAAkBmrB,EAAO8V,KAAQ31B,GAAO9O,EAAM8O,KAAOA,GAAOjH,EAAIiH,KAAOC,GAAU/O,EAAM+O,QAAUA,GAAUlH,EAAIkH,QAClHA,GAAUw1B,EAAc,EAAI5V,EAAO5f,OACnCD,GAAOw1B,EAAW,EAAI3V,EAAO7f,SAEzB,GAAS,OAANtL,GAAqB,UAANA,EAAe,KAC/BkhC,EAAc,OAANlhC,EACV4G,EAAMs6B,EAAQ51B,EAAMC,KACrBuV,EAAQ,GAAc,SAATxW,GACZ6gB,EAAO3uB,OAASoK,GAAOuT,GAAS0mB,EAAMjjC,EAAE,IAAIsjC,EAAQ,EAAI,GAAK/V,EAAO3uB,MAAQK,KAAKm4B,IAAIlU,GAAO,CAC9F+f,EAAMjjC,GAAKijC,EAAMjjC,EAAE,GAAK,QACxBA,GAAK,cAIJutB,EAAO3uB,OAASoK,EAAI,KAClBkF,YACDgV,EAAQ,GAAKqK,EAAO3uB,MAAQK,KAAKm4B,IAAIlU,GAASla,EAAI,KACjD0D,EAIC,CACHu2B,EAAMjjC,GAAK,iBAJXgJ,EAAMukB,EAAO3uB,OAAkB,OAAT8N,EAAiB,EAAI,GAC3CwB,GAAU,EAORA,IACHlF,GAAOka,GAELogB,EACF51B,EAAM1E,EAEN2E,EAAS3E,GAKXi6B,EAAMjjC,GADH2N,GAAU,GAAKD,GAAO,EACd,SAECy1B,EAAY,IAAI,IAAM1O,EAAW9mB,IAAWu1B,EAAS,IAAI,IAAMx1B,SAGtEu1B,EAAM7+B,KAAK,IAGnB,SAASg/B,GAAWH,EAAOjoB,SACL,KAAlBioB,EAAMjoB,EAAM,IAAaioB,EAAMjoB,EAAM,GAChC,QACkB,KAAlBioB,EAAMjoB,EAAM,IAAaioB,EAAMjoB,EAAM,GACrC,WADH,EAIC,SAASuoB,GAAiBrnB,EAASsnB,EAAS/3B,EAAS2I,WACvD6uB,EAAQn2B,GAAMoP,GAAS,GACnBlc,EAAI,EAAGA,EAAIijC,EAAMhjC,OAAQD,OAC7BM,MAAM4D,QAAQ++B,EAAMjjC,IAAI,KACtByjC,EAAYR,EAAMjjC,GAAG,KAAOwjC,GAC5BpvB,EAAMsvB,YAAcD,IACvBrvB,EAAMsvB,YAAa,OAChB92B,EAAQ62B,EAAYh4B,EAAUw3B,EAAMjjC,GAAG,GAC3CijC,EAAMjjC,GAAK,IAAI4M,EAAM,KAAKq2B,EAAMjjC,GAAG,UAG9BijC,EAAM7+B,KAAK,ICbZ,SAASu/B,GAAYtiC,EAAML,OAC3BwQ,EAAQnQ,EAAKuiC,oBAEdpyB,EAAMxQ,GAAM,KACV6iC,EAAY7iC,GAAQA,GAAQi/B,GAAU5+B,GAwF9C,SAASyiC,EAAgBziC,EAAML,OACxB4L,EAAQizB,GAASx+B,EAAML,OACzB4L,EACH,WAEKm3B,EAAOn3B,EAAM9F,QACblG,EAAQ,GACRojC,EAAW,GAEXj3B,EAAS,SAER,CACN1B,KAAK,cACA04B,EAAKh3B;KACH,IAAI/M,EAAI,EAAGA,EAAI+jC,EAAKh3B,OAAO9M,OAAQD,IAAK,KACxC6W,EAAOktB,EAAKh3B,OAAO/M,GACvB+M,EAAO8J,EAAK,IAAMA,EAAK,MAIrBktB,EAAKjkC,SACH,IAAIE,EAAI,EAAGA,EAAI+jC,EAAKjkC,KAAKG,OAAQD,IAAK,SAEf+jC,EAAKjkC,KAAKE,MAAhC0N,OAAKC,OAAQvN,UACbQ,EAAM8M,KACV9M,EAAM8M,GAAO,IAGG,OAFjB9M,EAAM8M,GAAKC,GAAUvN,GAEX,GAAW,KAEhBqxB,EAAOpwB,EAAK4iC,kBAAkBtP,MAAMv0B,EAAOiB,EAAK6iC,eAAgBljC,GACpEJ,EAAM8M,GAAKC,GAAU8jB,EAAKjmB,YAGrB,IAAIwN,EAAE,EAAGA,EAAEyY,EAAKkR,SAAS1iC,OAAQ+Y,OACjCyY,EAAKkR,SAAS3pB,GAAG,GAAG,CACvBgrB,EAASjgC,KAAKggC,EAAKjkC,KAAKE,cAQ9BmkC,sBAAanjC,UACL+L,EAAO/L,IAEf2P,gBAAO3Q,UACCY,EAAMZ,IAAM,IAEpBokC,iBAAQpkC,EAAGgZ,SACMwkB,GAAauG,EAAKjkC,KAAMikC,EAAK3Q,MAAO,EAAG/xB,EAAKF,OAAOmzB,sBAA3DtyB,UAEDA,EAAJgX,EACF,KAAM,4BAED5Y,EAAQmC,KAAKoO,OAAO3Q,GAAGgZ,SACR,mBAAV5Y,EACHiB,EAAK4iC,kBAAkBI,QAAQjkC,EAAOiB,EAAK6iC,gBAE5C9jC,GAERkkC,QAAQ,kBACAtjC,GAERujC,SAAS,SAASp2B,EAAGC,EAAGC,EAAGC,WACtB9D,EAAM,GACDxK,EAAImO,EAAInO,GAAKqO,EAAIrO,QACpB,IAAIgZ,EAAI5K,EAAI4K,GAAK1K,EAAI0K,IACzBxO,EAAIzG,KAAKxB,KAAK6hC,QAAQpkC,EAAEgZ,WACnBxO,IA9JoEs5B,CAAgBziC,EAAML,GAyDpG,SAASwjC,EAAenjC,SAChB,CACNgK,KAAK,aAGL84B,sBAAanjC,UACLK,EAAK0L,OAAOC,QAAQhM,IAE5B2P,OAAO,SAASyI,UACR/X,EAAKsP,OAAOyI,IAEpBgrB,QAAQ,SAAShrB,EAAEC,MACfA,EAAIhY,EAAKF,OAAOmzB,YAClB,KAAM,+BACAjzB,EAAKsP,OAAOyI,GAAGC,IAEvBirB,QAAS,iBACD,IAERC,SAAS,SAASp2B,EAAGC,EAAGC,EAAGC,WACtB9D,EAAM,GACDxK,EAAImO,EAAInO,GAAKqO,EAAIrO,YACrB2I,EAAOtH,EAAKsP,OAAO3Q,GACdgZ,EAAI5K,EAAI4K,GAAK1K,EAAI0K,IACzBxO,EAAIzG,KAAK4E,EAAKqQ,WAETxO,IAnF6Cg6B,CAAenjC,OAGhEwiC,EACH,QAEYryB,EAAMxQ,GAOrB,SAASyjC,EAAcZ,SACf,CACNx4B,KAAK,WACJw4B,EAAQx4B,QAET84B,sBAAanjC,UACL6iC,EAAQM,aAAanjC,IAE7BsY,QAAQ,SAASF,UACTyqB,EAAQlzB,OAAOyI,IAEvBjW,kBAASiW,EAAEC,OACNrQ,EAAM66B,EAAQO,QAAQhrB,EAAEC,GACxBhM,EAAW,EAAJrE,SACNpJ,MAAMyN,IAAiB,KAARrE,EACbA,GAAQ,GADwBqE,GAGxCq3B,uBAAc1jC,OACTqV,EAAO9T,KAAK4hC,aAAanjC,IAASA,MACZ,GAAtBqV,EAAK9M,QAAQ,KAAY,MAAO,OAChC+F,EAAM5C,EAAM2J,UACT9T,KAAKgiC,SAASn+B,MAAM7D,KAAM+M,IAElCi1B,kBAASp2B,EAAGC,EAAGC,EAAGC,WACX9D,EAAMq5B,EAAQU,SAASp2B,EAAGC,EAAGC,EAAGC,GAC7BtO,EAAIwK,EAAIvK,OAAO,EAAM,GAAHD,EAAMA,IAAI,KAChCgJ,EAAMwB,EAAIxK,GACVqN,EAAe,KAARrE,EAAmB,EAANA,EAAU,GAClCwB,EAAIxK,GAAKJ,MAAMyN,GAASrE,GAAQ,GAAMqE,SAEhC7C,GAER85B,QAAS,kBACDT,EAAQS,WAEhBK,aAAa,kBAmHf,SAASA,EAAax2B,EAAGC,EAAGC,EAAGC,EAAG0Z,GACjCA,EAAYA,GAAa,UACnBloB,EAAO,GACP8kC,EAAc,GACX5kC,EAAImO,EAAI02B,EAAO,EAAG7kC,GAAKqO,EAAIrO,IAAK6kC,IAAO,CAC/C/kC,EAAK+kC,GAAQ,WACPl8B,EAAOpG,KAAKoO,OAAO3Q,GAChBgZ,EAAI5K,EAAIikB,EAAOrK,EAAWhP,GAAK1K,EAAI0K,IAAKqZ,IAAO,IACpDryB,GAAKqO,EAAG,KACJy2B,EAAYviC,KAAK+hC,UACvBM,YAAeE,EAAYA,EAAU,IAAM,WAAK94B,EAAOgN,WAAK7K,cAAMnC,EAAOgN,WAAK3K,kBAAegkB,GAC7FrK,IAEDloB,EAAK+kC,iBAAaxS,IAAU1pB,EAAKqQ,UAG5B,CAAClZ,EAAM8kC,EAAa5c,IAlIL5hB,MAAMy9B,EAASx9B,YAEpC0+B,aAAa,kBAmIf,SAASA,EAAa52B,EAAGC,EAAGC,EAAGC,EAAG0Z,GACjCA,EAAYA,GAAa,UACnBloB,EAAO,GACP8kC,EAAc,GACX5kC,EAAIoO,EAAIikB,EAAO,EAAGryB,GAAKsO,EAAItO,IAAKqyB,IAAO,CAC/CvyB,EAAKuyB,GAAQ,OACR,IAAIrZ,EAAI7K,EAAI02B,EAAO7c,EAAWhP,GAAK3K,EAAI2K,IAAK6rB,IAAO,KACjDl8B,EAAOpG,KAAKoO,OAAOqI,MACtBhZ,GAAKsO,EAAG,KACJw2B,EAAYviC,KAAK+hC,UACvBM,YAAeE,EAAYA,EAAU,IAAM,WAAK94B,EAAOoC,WAAM4K,cAAKhN,EAAOsC,WAAM0K,kBAAc6rB,GAC7F7c,IAEDloB,EAAKuyB,iBAAawS,IAAUl8B,EAAK3I,UAG5B,CAACF,EAAM8kC,EAAa5c,IAlJL5hB,MAAMy9B,EAASx9B,aA9CTo+B,CAAcZ,IAEpCx4B,cAECmG,EAAMxQ,GC9DP,SAASgkC,GAAa3jC,EAAM8E,EAAMiO,OACpCE,EAAS,MACM,iBAARnO,EAAiB,KACrBmJ,EAAM5C,EAAMvG,EAAM9E,MACpBiO,EAAI,KACDy0B,EAAOJ,GAAYtiC,EAAMiO,EAAI,IACnCgF,EAASyvB,EAxBZ,SAASQ,EAASljC,EAAM8M,EAAGC,EAAGC,EAAGC,EAAG1B,WAC7B0H,EAAS,GACNtU,EAAEmO,EAAInO,GAAGqO,EAAIrO,YACf2I,EAAOpG,KAAK+W,QAAQtZ,GACjBgZ,EAAE5K,EAAI4K,GAAG1K,EAAI0K,IAAI,KACrB5Y,EAASuI,EAAKqQ,IAAkB,IAAZrQ,EAAKqQ,GAAYrQ,EAAKqQ,GAAK,GACnD5Y,EAAQ,CAAEgC,GAAGhC,EAAOA,MAAMA,GAErBwM,GAASA,GAASvL,EAAKu8B,eAC3Bx9B,EAAK,OAAa2zB,GAAc1yB,EAAMsH,EAAM,EAAMA,EAAKqQ,GAAI,CAAC5W,GAAG4W,IAAI,GACnE5Y,EAAK,OAAauI,EAAKmJ,aAAenJ,EAAKmJ,YAAYkH,IAExD1E,EAAOvQ,KAAK3D,UAGPkU,GASoBlO,MAAM29B,GAAO1iC,YAASiO,KAAQ,SAGpD,GAAIhP,MAAM4D,QAAQiC,GACtB,IAAK,IAAInG,EAAE,EAAGA,EAAEmG,EAAKlG,OAAQD,IAAI,KAC5BL,EAAKwG,EAAKnG,IAAkB,IAAZmG,EAAKnG,GAAYmG,EAAKnG,GAAK,GAC/CL,EAAkB,WAAbkI,EAAOlI,GAAkBW,MAAMkG,KAAK7G,GAAK,CAAEyC,GAAGzC,EAAGS,MAAMT,GAC5D2U,EAAOvQ,KAAKpE,MAGVyU,EAAM,IACLA,EAAM6wB,eACH53B,EAAO,GACJrN,EAAEsU,EAAOrU,OAAO,EAAM,GAAHD,EAAMA,IAC7BqN,EAAKiH,EAAOtU,GAAGoC,IAClBkS,EAAOgZ,OAAOttB,EAAG,GAEjBqN,EAAKiH,EAAOtU,GAAGoC,KAAM,UAIpB8iC,GAAQ,EACHllC,EAAEsU,EAAOrU,OAAO,EAAM,GAAHD,EAAMA,IACjCsU,EAAOtU,GAAGI,MAAQ+kC,OAAO7wB,EAAOtU,GAAGI,OACX,KAApBkU,EAAOtU,GAAGI,QACbkU,EAAOgZ,OAAOttB,EAAG,GACjBklC,GAAQ,GAIN9wB,EAAM0E,OACTxE,EAAOoE,KAAK,SAAS0sB,EAAMC,OACpBC,EAAUjkC,EAAK+B,GAAG,SAAStD,KAAKylC,QAAQC,GACxCl9B,EAAI88B,EAAKhlC,MACTuY,EAAI0sB,EAAKjlC,aAERE,MAAMmZ,MAAMC,SAASpR,IAAMhI,MAAMmZ,MAAMC,SAASf,GAAK2sB,EAAQG,OAAIn9B,EAAGqQ,GAAK2sB,EAAQnwB,OAAO7M,EAAGqQ,KAGhGusB,GAAS9wB,EAAM1L,QAClB4L,EAAOoxB,iBArEDC,UAED,CAAEvjC,GAAG,SAAUhC,MAAM,GAAIspB,OAAO,oCADxBppB,MAAMC,KAAKC,YAAYC,OAC4C,kBAAkB,WAmElFklC,IAEbvxB,EAAM8wB,OACT5wB,EAAOoxB,QAAQ,CAAEtjC,GAAG,SAAUwjC,QAAO,EAAMxlC,MAAM,YAE5CkU,MAiBKuxB,GAAb,sBACaxkC,kBACNykC,QAAUzkC,OACVwd,QAAU,kDAGVA,QAAU,+BAEZ7d,EAAMmF,QACJ2/B,QAAQ3hC,UAAU,kBAAmB,CAACnD,EAAMmF,SAC5C0Y,QAAQ7d,GAAQmF,EAErB28B,IAAe,QACVgD,QAAQ3hC,UAAU,gBAAiB,oCAEjCnD,EAAM4L,MACTA,EAAM,KACHm5B,EAAWpC,GAAYphC,KAAKujC,QAASl5B,UACpCm5B,EAAWA,EAAS5B,aAAanjC,GAAQ,YAG1CuB,KAAKsc,QAAQ7d,kCAEdA,UACCuB,KAAKsc,QAAQ7d,GAEpB8hC,IAAe,QACVgD,QAAQ3hC,UAAU,gBAAiB;qBAGpCrE,EAAO,OACP,IAAIkB,KAAQuB,KAAKsc,QACpB/e,EAAKiE,KAAK,CAAE/C,KAAAA,EAAM0L,MAAMnK,KAAKsc,QAAQ7d,YAE/BlB,gCAEFA,MACAA,UAEDE,EAAIF,EAAKG,OACPD,KAAI,KACLqZ,EAAIvZ,EAAKE,QACR6e,QAAQxF,EAAE,IAAMA,EAAE,4CAIpBrY,EAAMlB,EAAO,OACZkB,KAAQuB,KAAKsc,QACjB/e,EAAKiE,KAAK,CAAC/C,EAAKuB,KAAKsc,QAAQ7d,YACvBlB,QAjDT,GCzFMW,GAASH,MAAMC,KAAKC,YAAYC,WAazB+/B,GAAb,wFAA+BL,qCACxBM,EAAKr5B,WACLsI,KAAOnN,KAAKlB,KAAKqC,iBAClBnB,KAAKmN,KACR,OAAO,MAEFs2B,EAAM5+B,EAAKL,cACZ1F,KAAKqf,iBAAmB,SAASoR,EAAIrrB,EAAK6B,EAAGqQ,UACjDqtB,EAAIt5B,MAAMpJ,SAASgF,EAAE,IAAIqQ,IAClB,GAGRqtB,EAAIt5B,MAAMpJ,SAAS,QAIfxD,EPfC,SAASmmC,EAAW7lC,MACtBA,GAA0C,IAAjCA,EAAMmJ,QAAQ,eAAqB,KAC3CpD,EAAO/F,EAAMqM,OAAO,GAAIrM,EAAMH,OAAO,IAAI6M,MAAM,WAC5C,CACNJ,MAAOvG,EAAK,GACZ7B,KAAMi8B,GAASp6B,EAAK,IACpBlB,MAAOs7B,GAASp6B,EAAK,IACrBg0B,cAAeoG,GAASp6B,EAAK,MOQnB8/B,CADC1jC,KAAKlB,KAAKmf,aAAaje,KAAKmN,KAAKhC,IAAKnL,KAAKmN,KAAK/B,SAExD7N,IACHsH,EAAKsb,aACLsjB,EAAI1hC,KAAKhB,SAASxD,EAAKwE,MACvB0hC,EAAIt5B,MAAMpJ,SAASxD,EAAK4M,OACpB5M,EAAKmF,QACR+gC,EAAIE,UAAU5iC,SAASxD,EAAKmF,OAC5B+gC,EAAIG,UAAU7iC,SAASxD,EAAKmF,QAEzBnF,EAAKq6B,eACR6L,EAAII,UAAU9iC,SAASxD,EAAKq6B,eAC7B/yB,EAAKub,oBACA0jB,iBAGNL,EAAIt5B,MAAMsX,6CAGL3iB,KAAKqf,iBAAmB,sDAGtB,CACNrf,KAAM,gBACN4G,KAAKxH,GAAO,mBACZuH,MAAM,EACNuU,SAAU,SACVjb,KAAK,CACJD,KAAK,OAAQilC,aAAa,EAAGjkC,GAAG,CAAEU,SAAW,kBAAK2G,EAAK28B,kBAAoBt/B,SAAS,CACnF,CAAC1F,KAAM,aAAcL,KAAK,OAAQqG,MAAM5G,GAAO,kBAAmBL,MAAM,OAAQmmC,cAAc,OAAQvjC,QAAQ,CAC7G3B,KAAO,sBACPvB,KAzDN,SAAS0mC,UACA,CACP,CAACpkC,GAAG,OAAQhC,MAAMK,GAAO,eACzB,CAAC2B,GAAG,SAAUhC,MAAMK,GAAO,iBAC3B,CAAC2B,GAAG,aAAchC,MAAMK,GAAO,qBAC/B,CAAC2B,GAAG,OAAQhC,MAAMK,GAAO,eACzB,CAAC2B,GAAG,MAAOhC,MAAMK,GAAO,cACxB,CAAC2B,GAAG,MAAOhC,MAAMK,GAAO,eAkDf+lC,IACHnkC,GAAG,CACLU,SAAU,SAASuB,OACZ8C,EAAO7E,KAAK++B,qBACXh9B,OACD,MACJ8C,EAAK+2B,UAAU,aAEX,MACJ/2B,EAAK+2B,UAAU,iBAGf/2B,EAAK+2B,UAAU,OAInB,CAAE98B,KAAK,OAAQgG,MAAM5G,GAAO,mBAAoBO,KAAK,SACrD,CAAEK,KAAK,qBAAsBgG,MAAM5G,GAAO,mBAAoBO,KAAK,YAAaoB,GAAG,sBAAuBhC,MAAM,UAAWm/B,MAAM,KACjI,CAAEl+B,KAAK,qBAAsBgG,MAAM5G,GAAO,sBAAuBO,KAAK,YAAaZ,MAAM,UAAWm/B,MAAM,KAC1G,CAAEl+B,KAAK,qBAAsBgG,MAAM5G,GAAO,sBAAuBO,KAAK,YAAaZ,MAAM,UAAWm/B,MAAM,KAC1G,CAAEl+B,KAAK,WAAYL,KAAK,UAAW4D,YAAW,EAAMjC,IAAI,uBAAwB0B,OAAO,MAGzFhC,GAAG,CACFs/B,YAAa,kBAAMj4B,EAAKk4B,WACxBC,cAAe,kBAAMn4B,EAAK9C,8CAIlBT,MACPA,GAAQuG,EAAMvG,EAAM5D,KAAKlB,MAC3B,OAAO,OACHA,KAAKolC,MAAM,CAACtgC,KAAK1F,GAAO,uDAIvBX,EADOyC,KAAK69B,QAAQz8B,UACR8kB,eAClB3oB,EAAK4M,MAAQ5M,EAAK4M,MAAM+a,cAEpB3nB,EAAK4M,OAASnK,KAAK6gC,WAAWtjC,EAAK4M,OAAO,KACvCvL,EAASoB,KAAKmkC,YAAY5mC,QAE3BuB,KAAKslC,aAAapkC,KAAKmN,KAAKhC,IAAKnL,KAAKmN,KAAK/B,OAAQxM,QACnDyF,qDAKAQ,EAAO7E,KAAK69B,QAAQz8B,UACpB7D,EAAOsH,EAAKqhB,eAClB3oB,EAAK4M,MAAQ5M,EAAK4M,MAAM+a,cAEpB3nB,EAAK4M,OAASnK,KAAK6gC,WAAWtjC,EAAK4M,OAAO,KACzC1M,EACHsU,EDtCG,SAASsyB,EAAYvlC,EAAM8E,OAC7BmO,EAAS,MACM,iBAARnO,EAAiB,KACrBmJ,EAAM5C,EAAMvG,EAAM9E,MACpBiO,EAAI,KACDy0B,EAAOJ,GAAYtiC,EAAMiO,EAAI,IACnCgF,EAASyvB,EAAOA,EAAKQ,SAASn+B,MAAM29B,EAAMz0B,GAAO,SAGlDgF,EAAShU,MAAMkG,KAAKL,UAEdmO,EC2BKsyB,CAAYrkC,KAAKlB,KAAMvB,EAAK4M,OACrCvL,EAASoB,KAAKmkC,kBACX1mC,EAAG,EAAIA,EAAIsU,EAAOrU,OAAQD,IAC7BsU,EAAOtU,GAAKsU,EAAOtU,IAAI,EACxBoH,EAAKL,SAAS25B,QAAQp9B,SAAShD,MAAM85B,WAAWC,YAAYl5B,EAA7Bb,CAAqCgU,EAAQ,CAAExS,MAAM,IAAKuC,OAAQ,WAGjG+C,EAAKL,SAAS25B,QAAQp9B,SAAS,wCAGrBnC,OACLiG,EAAO7E,KAAK69B,QAAQz8B,UACpB7D,EAAOsH,EAAKqhB,mBAClBtnB,EAASA,GAAU,CAAEmD,KAAMxE,EAAKwE,MACd,QAAdxE,EAAKwE,MACRnD,EAAO8D,MAAQnF,EAAKqmC,UACpBhlC,EAAOg5B,cAAgBr6B,EAAKsmC,WAErBh/B,EAAKL,SAASm/B,UAAU57B,cAC/BnJ,EAAO8D,MAAQnF,EAAKomC,WAEd/kC,QAzHT,4BAfsB,+BCATq/B,GAAb,wFAA+BL,qCACxBM,OACC7/B,EAAQ6/B,EAAIr9B,GAAG,SACfgE,EAAOq5B,EAAIr9B,GAAG,QAGpBgE,EAAKs1B,QACLt1B,EAAKy/B,kBACLz/B,EAAKL,SAAS/F,KAAKgjB,QACnB5c,EAAKL,SAAS2F,MAAMpJ,SAASf,KAAKlB,KAAKylC,oBAEvClmC,EAAMyzB,WACNzzB,EAAM+zB,MAAOpyB,KAAKlB,KAAK0L,OAAOg6B,kBAEzB1lC,KAAKqf,iBAAmB,SAASoR,EAAIrrB,EAAK6B,EAAGqQ,UACjDvR,EAAKL,SAAS2F,MAAMpJ,S3CsChB,SAAS0jC,EAAa/8B,EAAED,EAAE4C;AACxBA,EAAOQ,EAAYR,GAAO,IAAK,IAAI3C,EAAE,IAAID,E2CvClBg9B,CAAa1+B,EAAEqQ,EAX/B,MAYN,wCAIHtX,KAAKqf,iBAAmB,6CAGvBtZ,EAAO7E,KAAK69B,QAAQh9B,GAAG,QACvBtD,EAAOsH,EAAKqhB,YAEZ3d,EAAShL,EAAK4M,MAAMnD,QAAQ,QAClCzJ,EAAK4M,MAAQ5M,EAAK4M,MAAMD,OAAO,EAAG3B,EAAO,GAAGhL,EAAK4M,MAAMD,OAAO3B,EAAO,GAAG2c,cACxE3nB,EAAKkB,KAAOlB,EAAKkB,KAAKymB,cAEtBrgB,EAAK+gB,UAAUroB,GAEXsH,EAAK6/B,WAAW,KACfrmC,EAAQ2B,KAAK69B,QAAQh9B,GAAG,SAExBtD,EAAKsC,IAAMxB,EAAM4oB,OAAO1pB,EAAKsC,IAChCxB,EAAMsmC,WAAWpnC,EAAKsC,GAAItC,GAE1Bc,EAAMi9B,IAAI/9B,QAENuB,KAAK0L,OAAO8wB,IAAI/9B,EAAKkB,KAAMlB,EAAK4M,OACrCtF,EAAKs1B,6CAGKt6B,mBACNf,KAAK0oB,QAAQ,CACjB5jB,KAAM7F,MAAMC,KAAKC,YAAYC,OAAO,0BAClCupB,KAAK,eACHppB,EAAQ8I,EAAK02B,QAAQh9B,GAAG,SAC5BsG,EAAKrI,KAAK0L,OAAOmT,OAAOtf,EAAM0Y,QAAQlX,GAAIpB,MAC1CJ,EAAMsf,OAAO9d,uCAGLA,OACHgF,EAAO7E,KAAK69B,QAAQh9B,GAAG,QAC7BgE,EAAKy/B,kBACLz/B,EAAK+gB,UAAU5lB,KAAK69B,QAAQh9B,GAAG,SAASkW,QAAQlX,+CAG1C+kC,EAAU,CACflgC,QAAQ,EACR3C,KAAM,QACNtC,KAAK,CACJ,CAAEX,KAAM,sBAAuBe,GAAI,QAASwC,YAAW,EAAMspB,QAAQ,CACpE,CAAE9rB,GAAG,OAAQwkB,OAAOtmB,MAAMC,KAAKC,YAAYC,OAAO,cAAeqB,MAAO,KACxE,CAAEM,GAAG,QAASwkB,OAAOtmB,MAAMC,KAAKC,YAAYC,OAAO,eAAgBqB,MAAO,KAC1E,CAAEN,SAAS,4CAA6CM,MAAM,IAC9D,CAAEN,SAAS,2CAA4CM,MAAM,KAE9DyF,WAAU,EAAMlD,OAAQ,IACxBujB,QAAQ,aACK,SAACoK,EAAI5vB,UAAOoc,EAAK4oB,YAAYhlC,iBAC5B,SAAC4vB,EAAI5vB,UAAOoc,EAAK6oB,UAAUjlC,MAEzC,CAAEN,MAAO,IAAKT,KAAM,OAAQe,GAAG,OAC9BqX,MAAM,CACLzY,KAAK,SAACZ,OACDknC,EAAU,cAAcj6B,KAAKjN,GAC7BQ,EAAQ4d,EAAK4hB,QAAQh9B,GAAG,SACxBtD,EAAO0e,EAAK4hB,QAAQh9B,GAAG,QAAQqlB,YAE/Bwc,GAAS,SACbrkC,EAAM8uB,QAAQ,SAASttB,OAClBD,EAAMI,KAAK+W,QAAQlX,GACnBD,EAAInB,MAAQZ,GAAS+B,EAAIC,IAAMtC,EAAKsC,KACvC6iC,GAAS,KAGJqC,GAAWrC,GAEnBv4B,MAAMqB,GAEP8U,eAAe,CACdC,WAAY,IAEb/b,SAAS,CACR,CAAE1F,KAAM,OAAQL,KAAK,OAAQumC,QAAQ,EAAGlgC,MAAO/G,MAAMC,KAAKC,YAAYC,OAAO,eAC7E,CAAEY,KAAM,OAAQL,KAAK,QAASumC,QAAQ,EAAGlgC,MAAO/G,MAAMC,KAAKC,YAAYC,OAAO,0BAM3E,CACNY,KAAM,gBACN2G,MAAK,EACLC,KAAM3H,MAAMC,KAAKC,YAAYC,OAAO,eACpC+mC,YAAY,EACZ1lC,MAAO,IACPya,SAAU,SACVjb,KAAM6lC,EACN9kC,GAAG,CACFs/B,YAAa,kBAAMnjB,EAAKipB,aACxB5F,cAAe,kBAAMrjB,EAAK5X,iBAjH9B,4BAFsB,2BCGT45B,GAAb,wFAA+BL,2CAEzB/4B,EAAO7E,KAAK69B,QAAQh9B,GAAG,gBACtBsM,KAAOnN,KAAKlB,KAAKqC,eAAc,IAC/BnB,KAAKmN,KAAKzP,OACd,OAAO,EAERmH,EAAKs1B,YAGDt8B,EAAQmC,KAAKlB,KAAKsuB,cAAcptB,KAAKmN,KAAK,GAAGhC,IAAKnL,KAAKmN,KAAK,GAAG/B,QAC/DvN,GAASA,EAAMgB,SAClBgG,EAAKL,SAAS2F,MAAMpJ,SAASlD,EAAMgB,cAE/BC,KAAKqf,iBAAmB,SAASoR,EAAIrrB,EAAK6B,EAAGqQ,UACjDvR,EAAKL,SAAS2F,MAAMpJ,SAASgF,EAAE,IAAIqQ,IAC5B,GAGRvR,EAAKL,SAAS2F,MAAMsX,6CAGf3iB,KAAKqf,iBAAmB,sDAGtB,CACNrf,KAAM,gBACNkb,SAAS,SACTtU,KAAK3H,MAAMC,KAAKC,YAAYC,OAAO,kBACnCuH,MAAM,EACN1G,KAAK,CACJ2F,QAAQ,EAAG5F,KAAK,OAAQe,GAAG,OAAQM,KAAK,CACvC,CAAErB,KAAK,OAAQgG,MAAM/G,MAAMC,KAAKC,YAAYC,OAAO,kBAAmBO,KAAK,WAG7EqB,GAAG,CACFs/B,YAAa,kBAAMj4B,EAAKk4B,WACxBC,cAAe,kBAAMn4B,EAAK9C,iDAKtB0N,EAAS/R,KAAK69B,QAAQh9B,GAAG,QAAQ2D,SAAS2F,MAAMvJ,WAElDmR,EACC5H,EAAM4H,EAAQ/R,KAAKlB,OAGtBkJ,EAAMC,IAAI,eACJ,IAAIxK,EAAI,EAAGA,EAAIuC,KAAKmN,KAAKzP,OAAQD,SAChCqB,KAAK66B,cAAc35B,KAAKmN,KAAK1P,GAAG0N,IAAKnL,KAAKmN,KAAK1P,GAAG2N,OAAQ,CAAE/E,OAAO,gBAAiBxH,QAAQkT,KAChG/R,WACEqE,SANLrE,KAAKlB,KAAKolC,MAAM,CAACtgC,KAAK7F,MAAMC,KAAKC,YAAYC,OAAO,iBAUrD8B,KAAKqE,cAxDR,4BAFsB,8BCFT8gC,GAAU,aAwBhB,SAASC,GAAStmC,EAAMqM,EAAKC,EAAQiC,EAAMmD,OAC7CnS,EAAQS,EAAK+B,GAAG,SACD,WAAfyE,EAAO6F,IAAsC,WAAlB7F,EAAO8F,GACrCpD,EAAMC,IAAI,YAqBZ,SAASo9B,EAAehpC,EAAO6H,EAAK+E,EAAQnI,OACtC,IAAI4G,EAAIrL,EAAM8O,IAAKzD,GAAGxD,EAAIiH,IAAKzD,QAC9B,IAAID,EAAIpL,EAAM+O,OAAQ3D,GAAGvD,EAAIkH,OAAQ3D,IACzCwB,EAAQrG,KAAK9B,GAAQd,KAAM0H,EAAGD,GAvB9B49B,CAAel6B,EAAKC,EAAQ,SAASD,EAAKC,GACzCg6B,GAAStmC,EAAMqM,EAAKC,EAAQiC,GAAM,QAIpCA,GAAkB,IAATA,IACIvO,EAAKwmC,OAAOn6B,GAAOrM,EAAKwmC,OAAOn6B,IAAQ,IAC7CC,GAAUiC,GAEhBhP,EAAM4vB,WAAW9iB,EAAKC,EAAQ+5B,IAAS,GAEvC9mC,EAAM2vB,cAAc7iB,EAAKC,EAAQ+5B,IAAS,GAE3CrmC,EAAK8C,UAAU,WAAY,CAAC,OAAQ,CAAEuJ,IAAAA,EAAKC,OAAAA,EAAQvN,OAAQwP,EAAMukB,SAAUvkB,MAGvEmD,GACJnS,EAAMuJ,UASD,SAAS+nB,GAAa7wB,EAAMqM,EAAKC,WAChCtM,EAAKwmC,OAAOn6B,IAAKrM,EAAKwmC,OAAOn6B,GAAKC,yCArDnC,SAAStC,GAAKhK,GACpBA,EAAKwmC,OAAS,GACdxmC,EAAKmD,YAAY,UAAW,kBAgB7B,SAAS0L,EAAM7O,GACdA,EAAKwmC,OAAS,GAjBoB33B,CAAM7O;AACxCA,EAAKmD,YAAY,SAAU,SAACF,EAAMoJ,EAAKC,EAAQiC,GACjC,SAATtL,GAAiBqjC,GAAStmC,EAAMqM,EAAKC,IAAUiC,GAAM,KAG1DvO,EAAKmD,YAAY,YAAa,SAACsjC,GAChB,cAAVA,EAAG1lC,IAoET,SAAS2lC,EAAK1mC,OACT8sB,EAAQ9sB,EAAK+B,GAAG,SAAS0M,mBACzBqe,EAAM,KACLve,EAAOvO,EAAK6wB,aAAa/D,EAAMvvB,MAAM8O,IAAKygB,EAAMvvB,MAAM+O,QAC1DtM,EAAKsmC,SAASxZ,EAAMvvB,MAAOuvB,EAAM1nB,KAAMmJ,IAvEtCm4B,CAAK1mC,KAGPA,EAAKmD,YAAY,WAAY,SAAC+oB,EAAQuJ,GACxB,sBAAVvJ,GAuEL,SAASya,EAAehnC,EAAMiN,EAAKnO,EAAMlB,OACpCqpC,EAASnoC,EAAKmoC,OACjBjoC,EAAIioC,EAAOhoC,UAETgO,OACIjO,KAAI,SACUioC,EAAOjoC,MAArB0N,OAAIC,QACND,GAAe,OAAR1M,GAAiB0M,GAAM9O,EAAM8O,KAAOC,GAAkB,UAAR3M,GAAoB2M,GAAU/O,EAAM+O,UAC/E,OAAR3M,EACC0M,EAAM9O,EAAM8O,IAAMO,EACrBg6B,EAAO3a,OAAOttB,EAAE,GAEhBioC,EAAOjoC,GAAG,GAAS,EAAJ0N,EAAQO,EACN,UAARjN,IACN2M,EAAS/O,EAAM+O,OAASM,EAC3Bg6B,EAAO3a,OAAOttB,EAAG,GAEjBioC,EAAOjoC,GAAG,GAAY,EAAP2N,EAAWM,KAvF7B+5B,CAAelR,EAAE91B,KAAK81B,EAAE7oB,IAAI6oB,EAAEh3B,KAAMg3B,EAAEl4B,gDA0ClC,SAASiM,GAAUxJ,EAAKvB,OAC1B4N,EAAKC,EACRs6B,EAAS,OACNv6B,KAAOrM,EAAKwmC,WACXl6B,KAAUtM,EAAKwmC,OAAOn6B,GACtBrM,EAAKwmC,OAAOn6B,GAAKC,IACnBs6B,EAAOlkC,KAAK,CAAC2J,EAAIC,IAEpB7N,EAAKmoC,OAASA,QAGR,SAASpsB,GAAKxa,EAAKvB,OACrBE,EACHioC,EAASnoC,EAAKmoC,UAEZA,EACF,IAAIjoC,EAAI,EAAGA,EAAIioC,EAAOhoC,OAAQD,IAC7B2nC,GAAStmC,EAAM4mC,EAAOjoC,GAAG,GAAGioC,EAAOjoC,GAAG,IAAG,GAAM,MCjBlD,SAAS8Q,GAAQzP,EAAMqM,EAAKC,OACvBhF,EAAOtH,EAAK+B,GAAG,SAAS0N,UAAUpD,MAClC/E,EACH,OAAOA,EAAKgF,GAGP,SAASu6B,GAAQ7mC,EAAMqO,EAAMzF,EAAGD,EAAG+I,QACrC9I,EAAE,GAAKD,EAAE,KAEV+I,GAAU1R,EAAK8C,UAAU,eAAgB,CAACuL,EAAKhC,IAAKgC,EAAK/B,OAAQ,CAAC1D,EAAGD,MAAK,KACxE0D,EAAMrM,EAAKsP,OAAOjB,EAAKhC,KACvB/K,EAAM+K,EAAIkD,UAAYlD,EAAIkD,SAASlB,EAAK/B,SAAiB,GACzDw6B,EAAWC,GAAY/mC,EAAMqO,EAAKhC,IAAKgC,EAAK/B,QAC5Cw6B,IACHxlC,GAAO,IAAMwlC,GAkHhB,SAASE,EAAahnC,EAAMqO,EAAMzF,EAAGD,OAChChK,EAAEgZ,EAAE5Y,EACPsN,EAAe,EAATgC,EAAKhC,IACXC,EAAqB,EAAZ+B,EAAK/B,OACd26B,GAAWjnC,EAAKmf,aAAa9S,EAAIC,OAC9B3N,EAAI0N,EAAK1N,EAAI0N,EAAI1D,EAAGhK,QACnBgZ,EAAIrL,EAAQqL,EAAIrL,EAAO1D,EAAG+O,IAElB,MADX5Y,EAAQiB,EAAKmf,aAAaxgB,EAAEgZ,KACVA,GAAKrL,GAAU3N,GAAK0N,IAClC46B,IACFA,GAAU,EACVjnC,EAAKof,aAAa/S,EAAIC,EAAOvN,IAE9BiB,EAAKof,aAAazgB,EAAEgZ,EAAE,KA7HxBqvB,CAAahnC,EAAMqO,EAAMzF,EAAGD,GAC5B3I,EAAK+B,GAAG,SAAS8kC,QAAQx4B,EAAKhC,IAAKgC,EAAK/B,OAAQ1D,EAAGD,EAAG,KAAMrH,GACvDoQ,IACJ1R,EAAK8C,UAAU,cAAe,CAACuL,EAAKhC,IAAKgC,EAAK/B,OAAQ,CAAC1D,EAAGD,KAC1DtC,EAAKrG,EAAM,QAAS,CACnBqM,IAAIgC,EAAKhC,IAAKC,OAAQ+B,EAAK/B,OAC3B1D,EAAEA,EAAGD,EAAEA,MAMJ,SAASu+B,GAAWlnC,EAAMqO,OAC5BmB,EAAOxP,EAAK+B,GAAG,SAAS0N,QAAQpB,EAAKhC,IAAKgC,EAAK/B,QAChDkD,GAAQxP,EAAK8C,UAAU,gBAAiB,CAAEuL,EAAKhC,IAAKgC,EAAK/B,OAAQ,CAACkD,EAAK,GAAIA,EAAK,QAClFxP,EAAK+B,GAAG,SAASmlC,WAAW74B,EAAKhC,IAAKgC,EAAK/B,QAC3CtM,EAAK8C,UAAU,eAAgB,CAAEuL,EAAKhC,IAAKgC,EAAK/B,OAAQ,CAACkD,EAAK,GAAIA,EAAK,MACvEnJ,EAAKrG,EAAM,QAAS,CACnBqM,IAAIgC,EAAKhC,IAAKC,OAAQ+B,EAAK/B,OAC3B1D,EAAE,EAAGD,EAAE,KAKH,SAASu6B,GAASzP,OACpB0T,EAAIC,EAAIC,EAAIC,EAChBD,EAAKC,EAAK,EACVH,EAAKC,EAAKxtB,aAEL,IAAIjb,EAAE,EAAGA,EAAE80B,EAAI70B,OAAQD,IAAI,KAC3B4oC,EAAmB,EAAd9T,EAAI90B,GAAG2N,OACZk7B,EAAgB,EAAX/T,EAAI90B,GAAG0N,IAEhB86B,EAAKvpC,KAAKqiB,IAAIsnB,EAAIJ,GAClBE,EAAKzpC,KAAKsT,IAAIq2B,EAAIF,GAClBD,EAAKxpC,KAAKqiB,IAAIunB,EAAIJ,GAClBE,EAAK1pC,KAAKsT,IAAIs2B,EAAIF,SAGZ,CACNj5B,KAAK,CAAEhC,IAAI+6B,EAAI96B,OAAO66B,GACtBv+B,EAAGy+B,EAAGF,EAAG,EACTx+B,EAAG2+B,EAAGF,EAAG,GAIJ,SAASK,GAAWznC,EAAMqM,EAAKC,EAAQhL,EAAKk7B,OAC5ChtB,EAAOC,GAAQzP,EAAMqM,EAAKC,GAC5BkD,IACCgtB,GAC0B,GAAzBhtB,EAAK,GAAGtH,QAAQ5G,KACnBkO,EAAK,IAAM,IAAMlO,GAElBkO,EAAK,GAAKA,EAAK,GAAGzL,QAAQ,IAAMzC,EAAK,KAKxC,SAASylC,GAAY/mC,EAAMqM,EAAKC,OAC3Bw6B,EAAW,UACZ9mC,EAAKsuB,cAAcjiB,EAAKC,IAC1Bw6B,EAASpkC,KAAK,aACZ1C,EAAKuuB,cAAcliB,EAAKC,IAC1Bw6B,EAASpkC,KAAK,aACRokC,EAAS/jC,KAAK,KAiCtB,IAAI2kC,GAAe,gBACD,SAASr7B,EAAKC,EAAQkD,EAAMlB,UACrCA,EAAKlJ,IAAIkH,QAAUA,EAAOkD,EAAK,GAAG,mBAEzB,SAASnD,EAAKC,EAAQkD,EAAMlB,UACrCA,EAAKlJ,IAAIiH,KAAOA,EAAImD,EAAK,GAAG,IA6B9B,SAASm4B,GAAYn4B,EAAM0c,EAAQ3uB,EAAO6H,EAAK3G,OACjDG,EAAyB,OAAhBstB,EAAOhjB,MAAiBsG,EAAK,GAAKA,EAAK,GAChDo4B,EAA4B,OAAhB1b,EAAOhjB,MAAiB,CAAS,EAARsG,EAAK,GAAc,EAARA,EAAK,GAAKA,EAAK,GAAG,GAAK,CAAS,EAARA,EAAK,GAAc,EAARA,EAAK,GAAKA,EAAK,GAAG,GACrGq4B,EAA4B,OAAhB3b,EAAOhjB,MAAiB,CAAC3L,EAAM8O,IAAKjH,EAAIiH,KAAO,CAAC9O,EAAM+O,OAAQlH,EAAIkH,QAG9EM,EAAMi7B,EAAU,GAAKA,EAAU,GAAK,EAExCA,EAAU,GAAKjqC,KAAKsT,IAAI22B,EAAU,GAAID,EAAU,IAChDC,EAAU,GAAKjqC,KAAKqiB,IAAI4nB,EAAU,GAAID,EAAU,QAE5CE,EAAcD,EAAU,IAAMD,EAAU,MAEzCC,EAAU,IAAMA,EAAU,GAAG,IACf,OAAb3b,EAAOnrB,KACT6L,GAA0C,GAAnCi7B,EAAU,GAAKA,EAAU,GAAI,IAErB,OAAb3b,EAAOnrB,IAAe+mC,IAAyB,EAAEl7B,EAAZhO,EAAgB,KACnDG,EAAQi9B,GAAKv9B,EAAM,SAASM,UACvBA,EAAM,IAAMyQ,EAAK,IAAMzQ,EAAM,IAAMyQ,EAAK,KAGjDzQ,EAAM,GAAqB,OAAhBmtB,EAAOhjB,MAAiBnK,EAAM,GAAK6N,EAAM7N,EAAM,GAC1DA,EAAM,GAAqB,UAAhBmtB,EAAOhjB,MAAoBnK,EAAM,GAAK6N,EAAM7N,EAAM,OAEzDgpC,EAAW7L,GAAUz9B,EAAM,SAASspC,UAChCA,EAAS,IAAMhpC,EAAM,IAAMgpC,EAAS,IAAMhpC,EAAM,KAAOgpC,EAAS,IAAMhpC,EAAM,IAAMgpC,EAAS,IAAMhpC,EAAM,OAGhG,EAAZgpC,GACFtpC,EAAKwtB,OAAO8b,EAAS,GAGlBD,GAA4B,OAAb5b,EAAOnrB,KAC1ByO,EAAK,GAAqB,UAAhB0c,EAAOhjB,MAAoBsG,EAAK,GAAG5C,EAAM4C,EAAK,GACxDA,EAAK,GAAqB,OAAhB0c,EAAOhjB,MAAiBsG,EAAK,GAAG5C,EAAM4C,EAAK,WAGhDA,EAGD,SAASw4B,GAAUhoC,EAAM+S,EAAO1G,EAAKlB,EAAK88B,EAAQC,OAEpDpT,EAAI90B,EAAKgR,OAAOvB,QAAQpD,EAAKlB,MAC9B4H,GAASA,EAAMvD,KAAK,KAClBA,EAAOuD,EAAMvD,KAEdnD,GAAe,EAARmD,EAAK,GAAK04B,EAAU77B,KAAOlB,GAAe,EAARqE,EAAK,GAAK04B,EAAU57B,SAE/DtM,EAAKgR,OAAOm3B,SAAS97B,EAAKlB,EAAKqE,EAAK,GAAIA,EAAK,GAAI,SAACzQ,EAAOqpC,EAAKC,IAC7DvT,EAAI90B,EAAKgR,OAAOvB,QAAQ24B,EAAIC,KACtBnB,GAAWlnC,EAAM,CAACqM,IAAIyoB,EAAE,GAAIxoB,OAAOwoB,EAAE,OACzC,GACH+R,GAAQ7mC,EAAM,CAACqM,IAAIA,EAAKC,OAAOnB,GAAMqE,EAAK,GAAIA,EAAK,IACrC,IAAXy4B,GACFf,GAAWlnC,EAAM,CAACqM,IAAI0G,EAAM1G,IAAKC,OAAOyG,EAAM5H,YAGzC2pB,GACPoS,GAAWlnC,EAAM,CAACqM,IAAIyoB,EAAE,GAAIxoB,OAAOwoB,EAAE,gCAtQhC,SAAS9qB,GAAKhK,GACpBA,EAAKmD,YAAY,gBAAiB,SAACkJ,EAAKC,EAAQ7H,OAC3C+K,EAAOC,GAAQzP,EAAMqM,EAAKC,MAC1BkD,EAAK,KACJs3B,EAAWC,GAAY/mC,EAAMqM,EAAKC,GACtCkD,EAAK,IAAM/K,EAAQA,EAAM1D,GAAK,KAAO+lC,EAAY,IAAMA,EAAY,OAIrE9mC,EAAKmD,YAAY,cAAe,SAAC1E,MAC5BA,EAAKszB,MACR,IAAK,IAAIpzB,EAAI,EAAGA,EAAIF,EAAKszB,MAAMnzB,OAAQD,IAAK,KACvC6Q,EAAO/Q,EAAKszB,MAAMpzB,GACtBkoC,GAAS7mC,EACR,CAAEqM,IAAKmD,EAAK,GAAIlD,OAAQkD,EAAK,IACrB,EAARA,EAAK,GACG,EAARA,EAAK,IACL,MAKJxP,EAAKmD,YAAY,kBAAmB,SAAC1E,OAChCszB,EAAQ,GACRvM,EAAOxlB,EAAK+B,GAAG,SAAS0N,aACxB+V,EAAK,KACH,IAAI4iB,KAAO5iB,EAAK,KAChBnZ,EAAMmZ,EAAK4iB,OACV,IAAIC,KAAOh8B,EAAI,KACfmD,EAAOnD,EAAIg8B,GACftW,EAAMrvB,KAAK,CAAK,EAAJ0lC,EAAW,EAAJC,EAAO74B,EAAK,GAAIA,EAAK,MAI1C/Q,EAAKszB,MAAQA,KAIf/xB,EAAKmD,YAAY,SAAU,SAACF,EAAMoJ,EAAKC,EAAQvN,EAAOupC,GAC1C,QAARrlC,GAA0B,SAARA,IACR,QAARA,IACHqlC,GAAUA,GAkGd,SAASC,EAASvoC,EAAKqM,EAAKC,EAAOvN,EAAMupC,GACrCA,EACFpB,GAAWlnC,EAAK,CAACqM,IAAKA,EAAKC,OAAQA,IAGnCu6B,GAAQ7mC,EAAM,CAACqM,IAAKA,EAAKC,OAAQA,GAASvN,EAAM,GAAIA,EAAM,IAtGzDwpC,CAASvoC,EAAMqM,EAAKC,EAAQvN,EAAOupC,MAIrCtoC,EAAKmD,YAAY,WAAY,SAACxD,EAAMI,MACxB,QAARJ,EACF8nC,GAAWznC,EAAMD,EAAQsM,IAAKtM,EAAQuM,OAAQ+5B;AAAStmC,EAAQ+yB,eAC3D,GAAW,sBAARnzB,GAmGV,SAASgnC,EAAehnC,EAAMiN,EAAKnO,EAAMlB,OACpCw0B,EAAQtzB,EAAKszB,SACdnlB,MACE,IAAIjO,EAAIozB,EAAMnzB,OAAO,EAAM,GAAJD,EAAMA,IAAI,SACjBozB,EAAMpzB,MAApB0N,OAAIC,OAENM,EAAM,IACG,OAARjN,GAAiB0M,GAAO9O,EAAM8O,IAAIO,EAAI,EACxCA,EAAMrP,EAAM8O,IAAM0lB,EAAMpzB,GAAG,GACX,UAARgB,GAAoB2M,GAAU/O,EAAM+O,OAAOM,EAAI,IACvDA,EAAMrP,EAAM+O,OAASylB,EAAMpzB,GAAG,MAGrB,OAARgB,GAAiB0M,GAAM9O,EAAM8O,KAAe,UAAR1M,GAAoB2M,GAAU/O,EAAM+O,UAC1EylB,EAAMpzB,GAAG,GAAc,OAARgB,EAAkB,EAAJ0M,EAAQO,EAAIP,EACzC0lB,EAAMpzB,GAAG,GAAa,UAARgB,EAAwB,EAAP2M,EAAWM,EAAIN,IAjH/Cq6B,CAAe5mC,EAAQJ,KAAKI,EAAQ6M,IAAI7M,EAAQtB,KAAMsB,EAAQxC,YAC1D,GAAW,iBAARoC,EACP,OA8HH,SAAS6oC,EAAiBxoC,EAAMqM,EAAKC,EAAQgC,EAAMC,OAC9CiB,EAAOC,GAAQzP,EAAMqM,EAAKC,YACvBkD,IAAMk4B,GAAan5B,KAAMm5B,GAAan5B,GAAMlC,EAAKC,EAAQkD,EAAMlB,GAhI7Dk6B,CAAiBxoC,EAAMD,EAAQsM,IAAKtM,EAAQuM,OAAQvM,EAAQuO,KAAMvO,EAAQwO,yFCoBpF,SAASM,GAAM7O,GACdA,EAAKgR,OAAOy3B,WAAa,GACzBC,GAAc1oC,GAGR,SAAS2oC,GAAWppC,OACpBqpC,EAAUrpC,EAAMkpC,WAChBl/B,EAAM,OACP,IAAI8C,KAAOu8B,MACV,IAAIt8B,KAAUs8B,EAAQv8B,GAC1B9C,EAAI7G,KAAKkmC,EAAQv8B,GAAKC,WACjB/C,EAyBD,SAASs/B,GAAa7oC,EAAMqL,OAC9By9B,GAAW,EACfv8B,EAAUlB,EAAOrL,EAAM,SAASA,EAAMqO,OACjChH,EAASrH,EAAKgR,OAAOy3B,WAAWp6B,EAAKhC,KACrChF,GACCA,EAAOgH,EAAK/B,UACfw8B,GAAW,SACJzhC,EAAOgH,EAAK/B,QAEnBtM,EAAKgR,OAAOke,cAAc7gB,EAAKhC,IAAKgC,EAAK/B,OAAQ,aACjDtM,EAAKgR,OAAOke,cAAc7gB,EAAKhC,IAAKgC,EAAK/B,OAAQ,oBAEjDm7B,GAAWznC,EAAMqO,EAAKhC,IAAKgC,EAAK/B,OAAQ,aAAa,GACrDm7B,GAAWznC,EAAMqO,EAAKhC,IAAKgC,EAAK/B,OAAQ,oBAAoB,MAK3Dw8B,GACH9oC,EAAK+oC,oBAQA,SAASC,GAAehpC,EAAMqM,EAAKC,EAAQjB,IAC7CA,IACHA,EAAQ,CAACjG,IAAI,CAACiH,IAAIA,KAEfhB,EAAMjG,OAETiG,EAuBF,SAAS49B,EAAejpC,EAAMqM,EAAKC,EAAQ+gB,MACtChhB,IAAQghB,MACNA,EAAShhB,EAAKghB,EAASrtB,EAAKF,OAAOozB,UACnClzB,EAAKmf,aAAakO,EAAO,EAAG/gB,GADiB+gB,YAK5CphB,EAAQI,EAAI,EAAGC,EAAQ+gB,EAAQ/gB,GA9B7B28B,CAAejpC,EAAMqM,EAAKC,EADrBjB,EAAMjG,IAAIiH,aAGjBhB,EAGD,SAAS69B,GAAcnqC,YACnBA,EAAMoqC,UAAapqC,EAAMqW,WAAarW,EAAMqW,UAAU/N,QAGjE,SAAS+hC,GAAeppC,OACjB4oC,EAAU5oC,EAAKgR,OAAOy3B,eACvB,IAAIp8B,KAAOu8B,MACV,IAAIt8B,KAAUs8B,EAAQv8B,MACtBu8B,EAAQv8B,GAAKC,GAAS,OAAO,SAC5B,EAGR,SAASo8B,GAAc1oC,OAChBjB,EAAQqqC,GAAeppC,GAC7BA,EAAK8C,UAAU,YAAa,CAAC,CAAC/B,GAAG,iBAAkBpB,KAAK,gBAAiBZ,MAAAA,KAcnE,SAASsqC,GAAcrpC,EAAMqM,EAAKC,OACnC,IAAI3N,EAAE0N,EAAK1N,EAAEqB,EAAKF,OAAOozB,SAAUv0B,IAAI,KACrC2I,EAAOtH,EAAKsP,OAAO3Q,EAAE,GACrBI,EAAQuI,EAAK,IAAIgF,IAAWhF,EAAKgF,MAEnCvN,GAAmB,IAAVA,EAAY,KAClBkE,EAAOu2B,GAAQx5B,EAAMrB,EAAE,EAAG2N,SAChB,UAARrJ,GAA4B,QAARA,EAAkBA,EAAO,OAEjD,GAAc,KAAVlE,EACR,YAEK,OAmDD,SAASuqC,GAAYtpC,EAAM+S,EAAO1G,EAAKlB,EAAK88B,EAAQC,OACpD7gC,EAAS0L,EAAM1L,OAErBA,EAAOtH,QAAU4M,EAAYtF,EAAOtH,QAAS,MAAOmoC,EAAU77B,IAAK,CAACC,OAAOyG,EAAM5H,IAAKkB,IAAI0G,EAAM1G,MAChGhF,EAAOtH,QAAU4M,EAAYtF,EAAOtH,QAAS,SAAUmoC,EAAU57B,OAAQ,CAACA,OAAOyG,EAAM5H,IAAKkB,IAAI0G,EAAM1G,aAE/FhF,EAAOtI,aAAcsI,EAAO8C,QACnCnK,EAAKupC,cAAcl9B,EAAKlB,EAAK9D,GAGvB,SAASmiC,GAAgBj7B,EAAMtL,WAC/B+U,EAAIyxB,GAAWl7B,GACZ5P,EAAE,EAAGA,EAAEqZ,EAAEpZ,OAAQD,OACrBqZ,EAAErZ,GAAGoC,IAAMkC,EAAM,OAAO+U,EAAErZ,GAGzB,SAAS+qC,GAAc/pC,UACtBV,MAAMkG,KAAMskC,GAAW9pC,IAGxB,SAASgqC,GAAkBp7B,EAAMxP,OAC/BoqC,EAAwBpqC,EAAxBoqC,SAAU/zB,EAAcrW,EAAdqW,UACZw0B,EAAMJ,GAAgBj7B,EAAM6G,EAAUnS,MACtCkH,EAAUy/B,EAAMA,EAAIz/B,QAAU,kBAAmB,MAEnDg/B,MACE,IAAIxqC,EAAE,EAAGA,EAAEwqC,EAASvqC,OAAQD,IAChCwqC,EAASxqC,GAAKmlC,OAAOqF,EAASxqC,WAGzB,SAASI,UACXoqC,GACiC,IAA7BA,EAASjhC,QAAQnJ,GAEI,KAArBqW,EAAU/N,QAAiB8C,EAAQpL,EAAOqW,EAAU/N,SAK9D,SAASwiC,GAAO9qC,UACRA,IAAUR,MAAMQ,KAAWmb,GAAcnb,GAGjD,IAAM0qC,GAAa,CAClBxe,OAAO,CACN,CAAElqB,GAAG,UAAWm9B,MAAM,OAAQ/zB,QAAQ,SAASlD,EAAEqQ,SACnC,KAANrQ,GAAqB,EAAFqQ,EAAJ,EAAFrQ,IAErB,CAAElG,GAAG,OAAQm9B,MAAM,OAAQ/zB,QAAQ,SAASlD,EAAEqQ,SAChC,KAANrQ,GAAe,EAAFA,EAAQ,EAAFqQ,IAE3B,CAAEvW,GAAG,iBAAkBm9B,MAAM,OAAQ/zB,QAAQ,SAASlD,EAAEqQ,SAC1C,KAANrQ,GAAsB,EAAFqQ,GAAL,EAAFrQ,IAErB,CAAElG,GAAG,cAAem9B,MAAM,OAAQ/zB,QAAQ,SAASlD,EAAEqQ,SACvC,KAANrQ,GAAe,EAAFA,GAAS,EAAFqQ,IAE5B,CAAEvW,GAAG,QAASm9B,MAAM,OAAQ/zB,QAAQ,SAASlD,EAAEqQ,UAAWrQ,GAAKqQ,IAC/D,CAAEvW,GAAG,WAAYm9B,MAAM,OAAQ/zB,QAAQ,SAASlD,EAAEqQ,UAAWrQ,GAAKqQ,IAClE,CAAEvW,GAAG,WAAYm9B,MAAM,OAAQ/zB,QAAQ,SAASlD,EAAEqQ,UACI,IAA9CrQ,EAAEgB,cAAcC,QAAQoP,EAAErP,iBAElC,CAAElH,GAAG,cAAem9B,MAAM,OAAQ/zB,QAAQ,SAASlD,EAAEqQ,UACC,IAA9CrQ,EAAEgB,cAAcC,QAAQoP,EAAErP,kBAGnCnD,KAAM,CACL,CAAE/D,GAAG,WAAYm9B,MAAM,OAAQ/zB,QAAQ,SAASlD,EAAEqQ,UACI,IAA9CrQ,EAAEgB,cAAcC,QAAQoP,EAAErP,iBAElC,CAAElH,GAAG,cAAem9B,MAAM,OAAQ/zB,QAAQ,SAASlD,EAAEqQ,UACC,IAA9CrQ,EAAEgB,cAAcC,QAAQoP,EAAErP,iBAElC,CAAElH,GAAG,QAASm9B,MAAM,OAAQ/zB,QAAQ,SAASlD,EAAEqQ,UACvCrQ,EAAEgB,gBAAkBqP,EAAErP,gBAE9B,CAAElH,GAAG,WAAYm9B,MAAM,OAAQ/zB,QAAQ,SAASlD,EAAEqQ,UAC1CrQ,EAAEgB,gBAAkBqP,EAAErP,gBAE9B,CAAElH,GAAG,aAAcm9B,MAAM,OAAQ/zB,QAAQ,SAASlD,EAAEqQ,UACQ,IAApDrQ,EAAEgB,cAAc6hC,YAAYxyB,EAAErP,cAAe,KAErD,CAAElH,GAAG,gBAAiBm9B,MAAM,OAAQ/zB,QAAQ,SAASlD,EAAEqQ,UACK,IAApDrQ,EAAEgB,cAAc6hC,YAAYxyB,EAAErP,cAAe,KAErD,CAAElH,GAAG,WAAYm9B,MAAM,OAAQ/zB,QAAQ,SAASlD,EAAEqQ,UACyB,IAAnErQ,EAAEgB,cAAcC,QAAQoP,EAAErP,cAAehB,EAAErI,OAAS0Y,EAAE1Y,UAE9D,CAAEmC,GAAG,cAAem9B,MAAM,OAAQ/zB,QAAQ,SAASlD,EAAEqQ,UACsB,IAAnErQ,EAAEgB,cAAcC,QAAQoP,EAAErP,cAAehB,EAAErI,OAAS0Y,EAAE1Y,WAG/DtB,KAAM,CACL,CAAEyD,GAAG,UAAWm9B,MAAM,aAAc/zB,QAAS,SAASlD,EAAGqQ,UACjDuyB,GAAO5iC,IAAUqQ,EAAJrQ,IAErB,CAAElG,GAAG,OAAQm9B,MAAM,aAAc/zB,QAAS,SAASlD,EAAGqQ,UAC9CuyB,GAAO5iC,IAAMA,EAAIqQ,IAEzB,CAAEvW,GAAG,iBAAkBm9B,MAAM,aAAc/zB,QAAS,SAASlD,EAAGqQ,UACxDuyB,GAAO5iC;GAAWqQ,GAALrQ,IAErB,CAAElG,GAAG,cAAem9B,MAAM,aAAc/zB,QAAS,SAASlD,EAAGqQ,UACrDuyB,GAAO5iC,IAAMA,GAAKqQ,IAE1B,CAAEvW,GAAG,QAASm9B,MAAM,aAAc/zB,QAAS,SAASlD,EAAGqQ,UAC/CuyB,GAAO5iC,IAAMA,GAAKqQ,IAE1B,CAAEvW,GAAG,WAAYm9B,MAAM,aAAc/zB,QAAS,SAASlD,EAAGqQ,UACjDuyB,GAAO5iC,IAAMA,GAAKqQ,IAE3B,CAAEvW,GAAG,UAAWm9B,MAAO,kBAAmB/zB,QAAS,SAASlD,EAAGqQ,WACzDuyB,GAAO5iC,OACHqQ,EAAE/Z,OAAS0J,EAAIqQ,EAAE/Z,UAAY+Z,EAAElS,KAAO6B,EAAIqQ,EAAElS,QAEtD,CAAErE,GAAG,aAAcm9B,MAAO,kBAAmB/zB,QAAS,SAASlD,EAAGqQ,WAC5DuyB,GAAO5iC,MACHqQ,EAAE/Z,OAAS0J,GAAKqQ,EAAE/Z,QAAY+Z,EAAElS,KAAO6B,GAAKqQ,EAAElS,gCA/VnD,SAAS4E,GAAKhK,OACdT,EAAQS,EAAKgR,OAEnBhR,EAAKmD,YAAY,UAAW,kBAAM0L,GAAM7O,KACxC6O,GAAM7O,GAENT,EAAMwqC,SAASC,mBAAqB,SAACxuB,EAAGza,OACjCsG,EAAS9H,EAAMkpC,WAAW1nC,EAAGsL,KAAKtL,EAAGuL,QACrCiC,EAAOlH,EAAOkH,MAAQ86B,GAAcrpC,EAAMe,EAAGsL,IAAKtL,EAAGuL,QAEvDvM,EAAU,GACVsH,EAAOtH,UACmB,iBAAlBsH,EAAOtH,QACjBA,EAAU4jC,GAAa3jC,EAAMqH,EAAOtH,QAAS,CAAE6jC,QAAO,EAAMnsB,OAAM,EAAMpQ,QAAO,IACvEpI,MAAM4D,QAAQwE,EAAOtH,WAC7BA,EAAU4jC,GAAa3jC,EAAMqH,EAAOtH,QAAS,CAAEsH,QAAO,MAExDrH,EAAK8C,UAAU,YAAa,CAAC,CAAC/B,GAAG,eAAgBsN,KAAKtN,EAAIwN,KAAAA,EAAMxO,QAAAA,EAASsH,OAAAA,MAE1E9H,EAAM0qC,YAAYD,mBAAqB,kBAAM,GAE7ChqC,EAAKmD,YAAY,YAAa,SAACsjC,GAChB,kBAAVA,EAAG1lC,IAoKT,SAASmpC,EAAclqC,OAChBqL,EAAQrL,EAAKgR,OAAOvC,gBAEtB26B,GAAeppC,IAClBkJ,EAAMC,IAAI,WACTnJ,EAAKmqC,kBAEF9+B,GACHrL,EAAKgR,OAAOid,cAAc5iB,EAAM9N,MAAO8N,EAAMjG,MAEtCiG,GACRnC,EAAMC,IAAI,mBACLkD,EAAMhB,EAAM9N,MAAM8O,IACb1N,EAAE0M,EAAM9N,MAAM+O,OAAQ3N,GAAG0M,EAAMjG,IAAIkH,OAAQ3N,IACnDqB,EAAKupC,cAAcl9B,EAAK1N,EAAG,CAAEoB,QAAQsL,MAGxCq9B,GAAc1oC,GApLZkqC,CAAclqC,SAGZ8oC,GAAW,EACf9oC,EAAKmD,YAAY,SAAU,SAACF,EAAMoJ,EAAKC,EAAQvN,MAClC,UAARkE,EACHlE,EAAyB,UAAhByH,EAAOzH,GAAqBA,EAAQ,KAC7CiB,EAAKupC,cAAcl9B,EAAKC,EAAQvN,GAChC+pC,GAAW,OAEP,GAAY,gBAAR7lC,EAAuB,KACzBoE,EAASrH,EAAKuuB,cAAcliB,EAAKC,MAEvCjF,EAAOtI,MAAQA,SACRsI,EAAO8C,QACVpL,GAASA,EAAMqW,UAAU,KACtB7G,EAAOlH,EAAOkH,MAAQ86B,GAAcrpC,EAAMqM,EAAKC,GACrDjF,EAAO8C,QAAUw/B,GAAkBp7B,EAAMlH,EAAOtI,OAEjD+pC,GAAW,MAGLtM,EAAMz9B,GAASmqC,GAAcnqC,GACnCQ,EAAMi9B,EAAI,aAAa,iBAAiBnwB,EAAKC,EAAQ,oBACrDm7B,GAAWznC,EAAMqM,EAAKC,EAAQ,mBAAoBkwB,MAIpDx8B,EAAKmD,YAAY,cAAe,WAC3B2lC,IACH9oC,EAAK+oC,oBACLD,GAAW,KAIb9oC,EAAKmD,YAAY,WAAY,SAAC+oB,EAAQuJ,GACvB,UAAVvJ,GACHub,GAAWznC,EAAMy1B,EAAEppB,IAAKopB,EAAEnpB,OAAQ,YAAampB,EAAE3C,UACjD2U,GAAWznC,EAAMy1B,EAAEppB,IAAKopB,EAAEnpB,OAAQ,mBAAqBmpB,EAAE3C,UAAY2C,EAAE3C,SAAS/zB,OAASmqC,GAAczT,EAAE3C,SAAS/zB,QAClH2pC,GAAc1oC,IAEI,sBAAVksB,GA8IX,SAASya,EAAehnC,EAAMiN,EAAKnO,EAAMlB,OAClCqrC,EAAUnqC,EAAKmqC,WAEjBh8B,MACC,IAAIjO,EAAEiqC,EAAQhqC,OAAO,EAAM,GAAHD,EAAMA,IAAI,SACXiqC,EAAQjqC,MAA7B0N,OAAIC,OAAOjF,UACJ,OAAR1H,GAAiB0M,GAAO9O,EAAM8O,KAAe,UAAR1M,GAAoB2M,GAAU/O,EAAM+O,OAAO,IAEvE,OAAR3M,EAAc,IACb0M,EAAM9O,EAAM8O,IAAMO,EAAI,CACzBg8B,EAAQ3c,OAAOttB,EAAE,YAGjBiqC,EAAQjqC,GAAG,GAAS,EAAJ0N,EAAQO,OAErB,GAAY,UAARjN,EAAiB,IACrB2M,EAAS/O,EAAM+O,OAASM,EAAI,CAC/Bg8B,EAAQ3c,OAAOttB,EAAG,YAGlBiqC,EAAQjqC,GAAG,GAAY,EAAP2N,EAAWM,EAE7BvF,EAAOtH,QAAU4M,EAAYtF,EAAOtH,QAASJ,EAAMiN,EAAKrP,KAnKzDopC,CAAelR,EAAE91B,KAAM81B,EAAE7oB,IAAK6oB,EAAEh3B,KAAMg3B,EAAEl4B,kCAkBpC,SAASiM,GAAUxJ,EAAKvB,WACxBmqC,EAAUD,GAAW3oC,EAAKgR,QAC1Bsa,EAAS7sB,EAAKmqC,QAAU,GAErBjqC,EAAI,EAAGA,EAAEiqC,EAAQhqC,OAAQD,IAAI,OACKiqC,EAAQjqC,GAA7C0N,IAAAA,IAAKC,IAAAA,OAAQvM,IAAAA,QAASwO,IAAAA,KAAMxP,IAAAA,MACjCA,EAAQA,GAASE,MAAMkG,KAAKpG,GAC5BusB,EAAO5oB,KAAK,CAAC2J,EAAKC,EAAQ,CAACvN,MAAAA,EAAOgB,QAAAA,EAASwO,KAAAA,YAItC,SAASiM,GAAKxa,EAAKvB,OACnBmqC,EAAUnqC,EAAKmqC,WAEjBA,EAAQ,KACN,IAAIjqC,EAAI,EAAGA,EAAIiqC,EAAQhqC,OAAQD,IACnCqB,EAAKupC,cAAcX,EAAQjqC,GAAG,GAAIiqC,EAAQjqC,GAAG,GAAKiqC,EAAQjqC,GAAG,IAAM,CAACoB,QAAQ,KAE7EC,EAAK+oC,+CA0BA,SAASqB,GAASpqC,EAAMqM,EAAKC,OAC7Bs8B,EAAU5oC,EAAKgR,OAAOy3B,kBACrBG,EAAQv8B,MAAUu8B,EAAQv8B,GAAKC,kICnI1B6yB,GAAb,wFAA+BL,oCACzB5S,sBACC7d,KAAO6d,EAAO7d,UACdg8B,MAAQne,EAAO3d,UACf+7B,QAAUpe,EAAO7kB,QAGjBnG,KAAKmN,WAEHrO,KAAK6wB,aAAa3vB,KAAKmN,KAAKhC,IAAKnL,KAAKmN,KAAK/B,eAC1C,MAGHpL,KAAK69B,QAAQ,MACZA,QAAU9/B,MAAMqB,GAAGY,KAAKrB,cACxBG,KAAK69B,iBAAiBn7B,KAAKxB,KAAK69B,cAChCA,QAAQ57B,YAAY,SAAU,kBAAMkF,EAAK22B,cAExCz/B,EAAQ2B,KAAKlB,KAAK+B,GAAG,SAC3BxC,EAAM4D,YAAY,YAAa,kBAAMkF,EAAKkiC,eAC1ChrC,EAAM4D,YAAY,YAAa,kBAAMkF,EAAKkiC,mBAGY,IAAnDrpC,KAAK+9B,MAAM/9B,KAAKopC,QAAQvrC,MAAOmtB,EAAOnsB,SACzC,OAAOmB,KAAKqE,aACRw5B,QAAQl2B,KAAM3H,KAAKspC,+DAGlBjrC,EAAQ2B,KAAKlB,KAAK+B,GAAG,gBACdxC,EAAMkQ,QAAQvO,KAAKmN,KAAKhC,IAAKnL,KAAKmN,KAAK/B,QACtC/M,EAAMovB,YAAYztB,KAAKmN,MAAQ9O,EAAM0f,YAAY/d,KAAKmN,oCAE/DtP,EAAOgB,OACN6gB,EAAO1f,KAAKgB,UACZmF,EAASnG,KAAKupC,YAEhBpjC,EAAOvH,OAAOyO,OAASrN,KAAKmpC,QAC/BhjC,EAAOqX,OAAO,aAAcxd,KAAKwoC,cAAcxoC,KAAKmpC,QACpDhjC,EAAOqX,OAAO,OAAQxd,KAAKmpC,YAItBpnC,EAAOlE,GAASA,EAAM0qC,YAAc1qC,EAAM0qC,WAAWxmC,KACvDA,IAASynC,GAAoBxpC,KAAKmpC,MAAOpnC,KAC5ClE,EAAQ,IAET6hB,EAAKoS,WACLpS,EAAKniB,KAAKksC,WAAW5qC;AAGrBsH,EAAOvH,OAAOf,MAAQ,GACtBsI,EAAOpF,SAAUhD,MAAMkG,KAAKpG,GAAO,gDAG7Bsb,EAASpb,MAAMC,KAAKC,YAAYC,aAC/B,CACNY,KAAK,QACLsB,IAAI,gBACJsE,QAAQ,EACRglC,SAAS,QACT3qC,KAAK,CACJS,OAAO,EACPW,KAAK,CACJ,CACCrB,KAAK,SACL6qC,MAAM,QACNt8B,KAAK,OACLk7B,WAAWvoC,KAAKwoC,cAAc,QAC9BoB,OAAO,CACN,OACA,CAAE9qC,KAAK,oBAAqBynB,YAAW,EAAMyW,MAAM,aAAcl9B,GAAG,CACnEU,SAAS,kBAAMyb,EAAKstB,YAAYM,iBAEjC,CAAE/qC,KAAK,yBAA0BynB,YAAW,EAAMyW,MAAM,kBAAmBl9B,GAAG,CAC7EU,SAAS,kBAAMyb,EAAKstB,YAAYM,kBAGlC5qC,SAAS,SAASW,UACVA,EAAIunB,QAAUvnB,EAAI/B,QAG3B,CAAE4B,KAAK,CACN,GACA,CAAEX,KAAK,SAAUgG,MAAMqU,EAAM,OAAYnU,WAAU,EAAM5E,IAAI,oBAAqBN,GAAG,aACrE,kBAAMmc,EAAK5X,WAE3B,CAAEvF,KAAK,SAAUgG,MAAMqU,EAAM,MAAWnU,WAAU,EAAM5E,IAAI,kBAAmBN,GAAG,aAClE,kBAAMmc,EAAK4tB,gEAQzB1jC,EAASnG,KAAKupC,YACd1C,EAAW7mC,KAAKopC,QAAQvrC,MACxBA,EAAQmC,KAAKopC,QAAQvrC,MAAQsI,EAAOvF,gBACrCwoC,QAAQngC,QAAUugC,GAAsBxpC,KAAKmpC,MAAOtrC,QAEpDiB,KAAK+oC,yBACL/oC,KAAK8C,UAAU,WAAY,CAAC,eAAgB,CAAEuJ,IAAInL,KAAKmN,KAAKhC,IAAKC,OAAOpL,KAAKmN,KAAK/B,OAAQvN,MAAMgpC,EAAUjV,SAAS/zB,UACnHisC,aAAa9pC,KAAKmN,KAAKhC,IAAKnL,KAAKmN,KAAK/B,OAAQ,mBAAoBo+B,GAAkB3rC,SAEpFwG,6CAEO8G,EAAKC,EAAQhL,EAAKk7B,OACxBj9B,EAAQ2B,KAAKlB,KAAK+B,GAAG,SACrByN,EAAOtO,KAAKuO,QAAQlQ,EAAO8M,EAAKC,GAElCkD,IACCgtB,GAC0B,GAAzBhtB,EAAK,GAAGtH,QAAQ5G,KACnBkO,EAAK,IAAM,IAAMlO,GAElBkO,EAAK,GAAKA,EAAK,GAAGzL,QAAQ,IAAMzC,EAAK,KAGvC/B,EAAMi9B,EAAI,aAAa,iBAAiBnwB,EAAKC,EAAQhL,mCAE9C/B,EAAO8M,EAAKC,OACfhF,EAAO/H,EAAMkQ,UAAUpD,MACvB/E,EACH,OAAOA,EAAKgF,4CAGNpL,KAAKupC,YAAYloC,gBAAgB,8CAGjCrB,KAAK69B,QAAQz8B,UAAUC,gBAAgB,2CAG1CrB,KAAK69B,QAAQ91B,YAAY,KACtBd,EAAOjH,KAAKspC,iBACZjrC,EAAQ2B,KAAKlB,KAAK+B,GAAG,SAEvBkpC,GAAW,KACX9iC,EAAK,KACF+iC,EAAajsC,MAAMsJ,KAAKC,OAAQL,GAChCgjC,EAAclsC,MAAMsJ,KAAKC,OAAQjJ,EAAMiE,MAAM4nC,uBAAuB,iBAAiB,IACrFC,EAAQH,EAAWviC,EAAIwiC,EAAYxiC,EACnC2iC,EAAQJ,EAAWtiC,EAAIuiC,EAAYviC,EAAIsiC,EAAWzqC,MAExDwqC,EAAYI,EAAQ,GAAKA,EAAMH,EAAWloC,OAASmoC,EAAYnoC,QAC9DsoC,EAAQ,GAAKA,EAAMJ,EAAWzqC,MAAQ0qC,EAAY1qC,MAAQxB,MAAMs0B,IAAIgY,YAEjEpjC,GAAQ8iC,EACZ/pC,KAAK69B,QAAQl2B,KAAK,CAACD,GAAG,KAAMD,GAAG,OAE/BzH,KAAK69B,QAAQl2B,KAAKV,0CAGPxI,WACP0a,EAASpb,MAAMC,KAAKmI,OACpBoiC,EAAaiB,GAAkB/qC,GAE5BhB,EAAE,EAAGA,EAAE8qC,EAAW7qC,OAAQD,IAC9B8qC,EAAW9qC,GAAGoC,KACjB0oC,EAAW9qC,GAAGI,MAAQsb,EAAOovB,EAAW9qC,GAAGoC,YAEtC0oC,QAhKT,4BAFsB,8BCGTtK,GAAb,wFAA+BL,+CAExB/4B,KAAO7E,KAAK69B,QAAQh9B,GAAG,aACvB6e,KAAO1f,KAAK69B,QAAQh9B,GAAG,aACvBs9B,QAAUn+B,KAAK69B,QAAQh9B,GAAG,gBAE1BsM,KAAOnN,KAAKlB,KAAKqC,eAAc,IAC/BnB,KAAKmN,KAAKzP,OACd,OAAO,OAEH4sC,SAAStqC,KAAKlB,WAEdA,KAAKqf,iBAAmB,kBACrB,wCAIHrf,KAAKqf,iBAAmB,gDAGvBngB,EAAOD,MAAMC,KAAKC,YAClBssC,EAAevsC,EAAKE,OACpBwT,EAAgB1T,EAAKO,QAGrBqV,EAAaO,GAAkB,OAE/Bq2B,EAAe,CACpB,CACC/rC,KAAK,QACLK,KAAK,UACLsB,IAAI,uBACJ0E,MAAMylC,EAAa,kBACnB1sC,MAAM,EACNm/B,MAAM,UAEP,CACCv+B,KAAM,YACNK,KAAK,WACLgG,MAAMylC,EAAY,UAClBvN,MAAM,UAEP,CACCl+B,KAAK,WACLgG,MAAMylC,EAAY,SAClBzoC,OAAQ,IACRrD,KAAK,WACLu+B,MAAM,SACN58B,IAAI,+BACJnB,SAAU,SAAAW,MACNuH,EAAKuY,KAAK,KACRlQ,EAASrI,EAAKyK,UAAUhS,EAAIC,IAE1B0D,EAAQ,CAACnD,IAAI,IACbvC,GAFN2R,EAAS2E,GAAgB3E,EAAO2E,IAAK3E,EAAOoE,cAEtB,WAAYrQ,SAE3B,gBAAgBA,EAAMnD,IAAI,KAAKvC,EAAM,YAG9CN,KAAK,CAAC,CAACsC,GAAG,GAAI,CAACA,GAAG,GAAI,CAACA,GAAG,GAAI,CAACA,GAAG,MAI9B4qC,EAAe,CACpB,CACC3rC,KAAK,OACLgG,MAAOylC,EAAa,kBACpB9rC,KAAK,SACLulC,cAAc,MACdhH,MAAM,SACN/nB,YAAY,UAAUrB,EAAWb,UAAU,MAAMa,EAAWX,YAAY,eAEzE,CACCpT,GAAI,OACJZ,SAAU,2IAAyDsrC,EAAa,eAAe,OAC/FloC,YAAW,EACX26B,MAAM,WAIF0N,EAAa,CAClB,CACCjsC,KAAK,OACLu+B,MAAM,OACNl+B,KAAK,WACLyhB,WAAY,GACZze,OAAQ,IACRgD,MAAMylC,EAAa,eACnBnqC,IAAI,2BACJnB,SAAU,SAAAW,UAAOuU,GAAgBvU,EAAI/B,MAAO+V,EAA3BO,CAAuC,OACxD5W,KAAK,CACJmU,EAAciB,WACdjB,EAAcgoB,WACdhoB,EAAci5B,eACdj5B,EAAck5B,wBAKV,CACN9rC,KAAM,gBACNkb,SAAS,SACTza,MAAM,IACNmG,KAAM6kC,EAAa,gBACnB9kC,MAAM,EACN1G,KAAK,CACJ2F,QAAQ,EACRjF,KAAK,CACJ,CACCX,KAAK,OACLe,GAAG,OACHO,IAAI,2BACJb,MAAM;AACNG,QAAO,EACPnC,KAAKyC,KAAK6qC,aACVlrC,QAAO,EACPG,GAAG,CACF0hB,eAAgB,SAAC3hB,UAChBsH,EAAK2jC,aACEjrC,EAAG,QACJ,aACA,OACJsH,EAAKtC,KAAK+2B,UAAU/7B,EAAG,kBAGvBsH,EAAKtC,KAAK+2B,UAAU,UACpBz0B,EAAKtC,KAAKL,SAAS6N,UAAU1K,OACjB,WAAT9H,EAAG,IACLsH,EAAKtC,KAAKL,SAAS6N,UAAU1R,WAKnC,CACC7B,KAAK,OACLe,GAAG,OACHiC,OAAO,IACPmK,SAAS,EACT8+B,SAAS,GACTvmC,SAAS,CACR,CACC3E,GAAI,UACJZ,SAAU,SAASW,UACfA,EAAI/B,OAASG,EAAKK,MAAM,gBACnBuB,EAAI/B,MACL,iBAAiB+B,EAAIQ,IAAI,KAAKR,EAAI/B,MAAM,WAEhDuC,IAAK,8BACL6kC,YAAY,EACZ5iC,YAAW,IAEX1E,OAAO6sC,EAAcC,EAAcC,GACrCpqB,eAAgB,CACfC,WAAY,KAEbzgB,GAAI,CACHU,SAAU,kBAAM2G,EAAK2jC,kBAKzBhrC,GAAG,CACFs/B,YAAa,kBAAMj4B,EAAKk4B,WACxBC,cAAe,kBAAMn4B,EAAK6jC,2DAKxBjpC,EAAO/B,KAAK0f,KAAKve,gBACjB4Q,EAAkB,UAARhQ,EAAkB,CAACyN,OAAOxP,KAAK6E,KAAKqhB,YAAY1W,QAAQxP,KAAK6E,KAAKqhB,YAChFnU,EAAOhQ,KAAOA,EAEdiG,EAAMC,IAAI,eACJ,IAAIxK,EAAI,EAAGA,EAAIwe,EAAK9O,KAAKzP,OAAQD,IACrC0W,GAAc8H,EAAKnd,KAAMmd,EAAK9O,KAAK1P,GAAG0N,IAAK8Q,EAAK9O,KAAK1P,GAAG2N,OAAQ2G,EAAOvC,OAAQuC,UAG5EjT,KAAK+B,GAAG,SAAS+G,eACjBojC,kDAGCznC,EAAQvD,KAAKlB,KAAKoP,SAASlO,KAAKmN,KAAK,GAAGhC,IAAKnL,KAAKmN,KAAK,GAAG/B,QAC1D3M,EAAO8E,GAASA,EAAMqL,MAAMY,OAASjM,EAAMqL,MAAMY,OAAS,SAG5D2E,GAAa1V,IAChBuB,KAAKlB,KAAK8C,UAAU,YAAa,CAAC,CAAC/B,GAAG,iBAAkBpB,KAAK,SAAUZ,MAAMY,UACzE4F,0CAEIiO,OACHvQ,EAAO/B,KAAK0f,KAAKve,gBACnB4Q,EAAS/R,KAAK6E,KAAKqhB,mBAEvBnU,EAAOO,SAAWA,GAAYP,EAAOO,SAC1B,UAARvQ,GACS,QAARA,IACFgQ,EAAO3V,KAAO,IAGR,CACN+X,IAAKA,GAFNpC,EAASoC,GAAiBpS,EAAMgQ,IAG/B6B,WAAWO,GAAkBpS,KAIvB,CACNoS,IAAKpC,EAAOvC,OACZoE,WAAYO,GAAkBpS,qCAGxBjD,OAIJiD,EAHEoX,EAASpb,MAAMC,KAAKC,YACpBsF,EAAQzE,EAAKoP,SAASlO,KAAKmN,KAAK,GAAGhC,IAAKnL,KAAKmN,KAAK,GAAG/B,QACvD2G,EAAS,CAAEE,MAAM,EAAGI,UAAW,EAAGC,SAAU,EAAGlW,KAAM+c,EAAO5a,QAAQoU,WAAYnD,OAAQ,IAGxF/Q,EAAO8E,GAASA,EAAMqL,MAAMY,OAASjM,EAAMqL,MAAMY,OAAS,GAE9DuC,EAAOvC,OAAS2E,GAAoB1V,GAAQ,SASjC,WAJVsD,EAHGtD,EAEY,UAARA,EACAA,EAAO,SAEP0V,GAAkB1V,GAAMsT,OAAOhQ,KAJ/BtD,EAAO,UAOdV,MAAMiU,OAAOD,EAAQoC,GAAkB1V,GAAMsT,QAAQ,OAEhD3L,EAAOpG,KAAKlB,KAAK+B,GAAG,SAASkW,QAAQ/W,KAAKmN,KAAK,GAAGhC,KAClDlB,EAAMjK,KAAKmN,KAAK,GAAG/B,YAEpBvN,MAAQE,MAAMwH,YAAYa,EAAK6D,IAAQ,GAAK7D,EAAK6D,QAEjDpF,KAAK+gB,UAAU7T,QACf2N,KAAK/f,OAAOoC,QACZ+oC,sDAGCjmC,EAAO7E,KAAK6E,KAAKL,SACjBgL,EAASxP,KAAK4R,YAChB/T,EAAQmC,KAAKnC,MAEXotC,EAAmB,KAAVptC,GAAgBR,MAAMQ,GAElCsW,GAAgB3E,EAAQ,UAAYy7B,GAAU92B,GAAkBtW,IAClEA,EAAQ,KACDotC,IAAW92B,GAAgB3E,EAAQ,YAC1C3R,EAAQ,gBAEL0F,EAAQ,CAACnD,IAAI,IACjBvC,EAAQsW,GAAgB3E,EAAO2E,IAAK3E,EAAOoE,WAAnCO,CAA+CtW,EAAO0F,QAGzD46B,QAAQ/L,MAAM,CAACv0B,MAAMA,EAAOuC,IAAImD,EAAMnD,MAC3CyE,EAAKyN,SAAS1K,UACd/C,EAAKzI,KAAKwL,UAGV/C,EAAK2K,OAAOzO,SAASyO,EAAO2E,8CAGtBgF,EAASpb,MAAMC,KAAKC,YAAYC,aAC/B,CACN,CAAC2B,GAAI,QAAShC,MAAOsb,EAAO0Q,UAC5B,CAAChqB,GAAI,MAAOhC,MAAOsb,EAAO4Q,QAC1B,CAAClqB,GAAI,UAAWhC,MAAOsb,EAAO1G,SAC9B,CAAC5S,GAAI,OAAQhC,MAAOsb,EAAO/c,MAC3B,CAACyD,GAAI,SAAUhC,MAAOsb,EAAO,yBA7QhC,4BAFsB,wBCGhBjF,GAAY,CACjB,CAACrU,GAAI,IAAIhC,MAAO,KAChB,CAACgC,GAAI,IAAIhC,MAAO,KAChB,CAACgC,GAAI,IAAIhC,MAAO,KAChB,CAACgC,GAAI,KAAKhC,MAAOE,MAAMC,KAAKC,YAAYC,OAAO,0BAC/C,CAAC2B,GAAI,KAAKhC,MAAOE,MAAMC,KAAKC,YAAYC,OAAO,6BAUnC+/B,GAAb,wFAA+BL,0DAEzB9+B,EAAOkB,KAAKlB,KACZosC,EAAQlrC,KAAK69B,QAAQz8B,UAAUC,gBAAgB,GAAGA,gBAClD9D,EAAO,GAEX2tC,EAAMnqB,QAAQ,SAAAlc,MACRA,EAAKqhB,eACNnU,EAASlN,EAAKqhB,YACd9f,EAAO,GACXA,EAAK5E,KAAKuQ,EAAOmC,WAEO,OAArBnC,EAAOmC,UACT9N,EAAK5E,KAAK2F,EAAKgkC,gBAAgBp5B,EAAOlU,QAEtCuI,EAAK5E,KAAK,CAAC2F,EAAKgkC,gBAAgBp5B,EAAOlU,OAAQsJ,EAAKgkC,gBAAgBp5B,EAAOq5B,UAE5EhlC,EAAK5E,KAAKuQ,EAAOxO,WACb,IAAI9F,EAAE,EAAGA,EAAI2I,EAAK1I,OAAQD,OACd,KAAZ2I,EAAK3I,IAAcM,MAAM4D,QAAQyE,EAAK3I,MAA+B,GAAxB2I,EAAK3I,GAAGuJ,QAAQ,IAC/D,OAAO,EAETzJ,EAAKiE,KAAK4E,MAGXtH,EAAK8C,UAAU,iBAAkB,CAACrE,qCAE1BwI,OACFsuB,EAAMe,WAAWrvB,UACnBsuB,GAAOtuB,EAAUsuB,EACdtuB,qDAIDslC,EADOrrC,KAAKlB,KACMypC,WAAWxZ,IAAI/uB,KAAKmN,KAAKhC,IAAKnL,KAAKmN,KAAK/B,WAE7DigC,EAAW,KACTH,EAAQlrC,KAAK69B,QAAQz8B,UAAUC,gBAAgB,GAAGA,gBACtDgqC,EAAWtqB,QAAQ,SAAC3a,EAAM3I,OACnBsU,EAAS,GACfA,EAAOmC,UAAY9N,EAAK,GACrBrI,MAAM4D,QAAQyE,EAAK,KACrB2L,EAAOlU,MAAQoe,EAAKqvB,aAAallC,EAAK,GAAG,IACzC2L,EAAOq5B,OAASnvB,EAAKqvB,aAAallC,EAAK,GAAG,KAG1C2L,EAAOlU,MAAQoe,EAAKqvB,aAAallC,EAAK,IAEvC2L,EAAOxO,MAAQ6C,EAAK,GACpB8kC,EAAMztC,EAAE,GAAGmoB,UAAU7T,2CAKXlU,UACTmC,KAAKurC,YAAwB,KAAV1tC,GAA4B,KAAZA,EAAM,IAC3CA,EAAQjB,EAAmBiB,GACpBmC,KAAKurC,WAAW1tC,IAEjBA,EAAMX,mDAGEW,GACZmC,KAAKurC,WACJluC,MAAMQ;EACO,KAAZA,EAAM,KAERA,EADeE,MAAMzB,KAAK88B,UAAWr7B,MAAMC,KAAKC,YAAYM,QAAQ86B,cAC5DF,CAAOt7B,GACfA,EAAQR,MAAMQ,GAAS,GAAKb,EAAmBa,IAIhDA,EAAQmb,GAAcnb,GAAS,GAAKA,EAGrCA,EAAQmC,KAAKwrC,SAAS3tC,EAAO,WAEvBA,yCAIF4tC,qBACApnC,yCAIOrE,KAAK69B,QAAQz8B,UAAUC,gBAAgB,GAAGA,gBAChD0f,QAAQ,SAAAlc,GACTA,EAAK+gB,WAAW/gB,EAAK+gB,UAAU,CAAC1R,UAAW,GAAIrW,MAAO,GAAIutC,OAAQ,GAAI7nC,MAAO,0DAK7E4J,KAAOnN,KAAKlB,KAAKqC,iBAClBnB,KAAKmN,KACR,OAAO,MAEF/G,EAAOpG,KAAKlB,KAAKsP,OAAOpO,KAAKmN,KAAKhC,KACpCpJ,EAAOqE,EAAKmyB,UACbx2B,IACFA,EAAOA,EAAK/B,KAAKmN,KAAK/B,SAEZ,QAARrJ,IACF/B,KAAKurC,WAAatyB,GAAkB7S,EAAMpG,KAAKmN,KAAK/B,cAEhDyyB,QAAQtc,UAAU,OAAQ,OAAOR,QAAQ,SAAAjiB,GAC7CA,EAAK0e,OAAO,CAACvI,YAAqB,QAARlT,EAAiB2b,EAAK4tB,aAAa,MAAS,KACtExsC,EAAK8I,iBAGD9I,KAAKqf,iBAAmB,SAACoR,EAAIrrB,EAAK6B,EAAGqQ,UACrCsH,EAAKguB,aAAe3lC,GAAKqQ,GAC5BsH,EAAKguB,YAAY3qC,SAAS,IAAIgF,IAExB,QAEH4lC,qDAIA7sC,KAAKqf,iBAAmB,YACtBne,KAAKurC,gBACPK,yCAGEruC,EAAMojB,kBAYTnjB,EAAM,CAXI,CACbsE,OAAQ,GACR4C,QAAQ,CACP6H,KAAM,IAEP9M,KAAM,CACL,CAAEX,KAAK,QAASS,MAAM,IAAKuF,MAAO/G,MAAMC,KAAKC,YAAYC,OAAOimB,SAChE,CAAErlB,KAAK,QAASS,MAAO,IAAKuF,MAAO/G,MAAMC,KAAKC,YAAYC,OAAOgW,WACjE,CAAEpV,KAAK,QAASgG,MAAO/G,MAAMC,KAAKC,YAAYC,OAAOL,UAKnDuI,EAAO,CACVtH,KAAM,OACN4F,QAAS,EACTrC,YAAY,EACZjC,IAAI,wBACJoE,SAAU,CAAC,CACVhF,OAAQ,GACRC,KAAM,CACL,CACCX,KAAK,aACLL,KAAM,QACNc,MAAM,IACN0V,YAAalX,MAAMC,KAAKC,YAAYC,OAAO,qBAC3CkC,IAAK,8BACLK,QAAS,CACRiE,QAAQ,EACRrC,YAAY,EACZjC,IAAK,4BACLrB,KAAM,CACLE,kBAASW,OACFQ,EAAM,wBAAwBR,EAAIQ,gCAClBA,eAAQR,EAAInB,gBAEnClB,KAAMA,KAIT,CACCuB,KAAK,aACLS,MAAO,IACPd,KAAM,YACNwW,YAAalX,MAAMC,KAAKC,YAAYC,OAAO,wBAC3C4B,GAAI,CACHU,SAAU,SAASwd,GACN,OAATA,OACG+gB,cAAcv6B,SAAS4mC,OAAOzjC,YAE9Bo3B,cAAcv6B,SAAS4mC,OAAOzqC,SAItCF,QAAQ,CACP3B,KAAM,sBACNC,KAAK,CACJxB,KAAM2W,MAIT,CACCzU,KAAM,CACL,CACCX,KAAM,OACNgB,GAAI,CACH+rC,QAAS,SAACC,GACTC,EAAKL,YAAcI,GAEpBE,OAAQ,SAACF,OACJjuC,EAAQiuC,EAAalrC,WACZ,KAAV/C,IACFA,EAAQkuC,EAAKZ,gBAAgBttC,GAC7BiuC,EAAa/qC,SAASgrC,EAAKT,aAAaztC,OAI3CY,KAAM,SAEP,CACCK,KAAM,OACNL,KAAM,SACNqB,GAAI,CACH+rC,QAAS,SAACC,GACTC,EAAKL,YAAcI,GAEpBE,OAAQ,SAACF,OACJjuC,EAAQiuC,EAAalrC,WACZ,KAAV/C,IACFA,EAAQkuC,EAAKZ,gBAAgBttC,GAC7BiuC,EAAa/qC,SAASgrC,EAAKT,aAAaztC,OAI3CsnB,QAAQ,KAIX,CAAErmB,KAAK,OAAQsB,IAAI,6BAA8BgC,KAAK,YAAa6C,MAAO,WAC5DjF,KAAK++B,cACb5E,cAKHxZ,KACLnjB,EAAIgE,KAAK4E,UAEH5I,6CAIDgC,EAASzB,MAAMsC,KAAKsE,QAAQ8f,aAAa5f,WAExC,CACN/F,KAAM,gBACN4G,KAAM3H,MAAMC,KAAKC,YAAYC,OAAO,sBACpC8b,SAAS,SACTza,MAAO,IACPkG,MAAM,EACNjG,OAAAA,EACAT,KAAK,CACJD,KAAM,OACN4F,QAAQ,EACRrC,YAAY,EACZlC,KAAMH,KAAKisC,QAlQf,SAASC,EAAkB3uC,UACnBA,EAAK8X,IAAI,SAAAjP,UACfA,EAAKvG,GAAKuG,EAAKhG,IACRgG,IA+Pc8lC,CAAkBlsC,KAAKlB,KAAKF,OAAOutC,gBAAiB,IAExErsC,GAAG,CACFs/B,YAAa,kBAAMgN,EAAK/M,WACxBC,cAAe,kBAAM8M,EAAK/nC,iBA/P9B,4BAjBsB,oCCDT45B,GAAb,wFAA+BL,qCACxBM,EAAKr5B,QACL/F,KAAKqf,iBAAmB,kBACrB,GAGRtZ,EAAKL,SAAS+D,OAAOxH,SAASf,KAAKqsC,aACnCxnC,EAAKL,SAAS8nC,SAASvrC,SAAS,QAChC8D,EAAKL,SAAS8nC,SAAS/lC,eAAe5G,8CAGjCb,KAAKqf,iBAAmB,sDAGtB,CACNrf,KAAM,gBACN4G,KAAM3H,MAAMC,KAAKC,YAAYC,OAAO,gBACpCuH,MAAM,EACNuU,SAAU,SACVjb,KAAK,CACJD,KAAK,OACL0F,SAAS,CACR,CAAE1F,KAAK,OAAQL,KAAK,WAAawW,YAAYlX,MAAMC,KAAKC,YAAYC,OAAO,gBAC3E,CAAEY,KAAK,gBAAiBL,KAAK,YAG/BqB,GAAG,CACFs/B,YAAa,kBAAMj4B,EAAKk4B,WACxBC,cAAe,kBAAMn4B,EAAK9C,uDAKtBvF,EAAOkB,KAAKlB,KACZyJ,EAASzJ,EAAKo9B,QAChBr+B,EAAQ,GAEJJ,EAAI,EAAGA,EAAI8K,EAAO7K,OAAQD,IACjCI,EAAM2D,KAAK,CACV/C,KAAM8J,EAAO9K,GAAGgB,KAChBwiB,OAAQniB,EAAKu8B,eAAiB9yB,EAAO9K,GAAGgB,KAAO,EAAI,WAG9CZ,wCAGDkU,EAAS/R,KAAK69B,QAAQz8B,UAAU8kB,YACtCnoB,MAAMia,QAAQhY,KAAKlB,KAAMiT,QACpB1N,cAhDP;yBAFsB,8BCET45B,GAAb,wFAA+BL,qCACxBM,EAAKr5B,OACG7E,KAAKlB,KAAKqC,gBAEtB,OAAO,EACHnB,KAAKusC,aAAa1nC,IACtBA,EAAKs1B,QACNt1B,EAAKL,SAAS/F,KAAKgjB,6CAEP5c,OACNsI,EAAOnN,KAAKlB,KAAKqC,mBACnBgM,EAAK,KACF/G,EAAOpG,KAAKlB,KAAKsP,OAAOjB,EAAKhC,KAC7BtN,EAAQuI,EAAK,IAAI+G,EAAK/B,SAAWhF,EAAK+G,EAAK/B,WAC7CvN,GAAyC,IAAhCA,EAAMmJ,QAAQ,cAAoB,KACxCsD,EAAQzM,EAAM0M,MAAM,YAC1B1F,EAAK+gB,UAAU,CACdnnB,KAAO6L,EAAM,IAAM,GACnBlC,IAAMkC,EAAM,IAAM,MAEZ,UAGF,mDAIA,CACNxL,KAAM,gBACN4G,KAAM3H,MAAMC,KAAKC,YAAYC,OAAO,cACpCuH,MAAM,EACNuU,SAAU,SACVjb,KAAK,CACJD,KAAK,OACL0F,SAAS,CACR,CAAE1F,KAAK,OAAQL,KAAK,OAASwW,YAAYlX,MAAMC,KAAKC,YAAYC,OAAO,cACvE,CAAEY,KAAK,OAAQL,KAAK,MAAQwW,YAAYlX,MAAMC,KAAKC,YAAYC,OAAO,eAGxE4B,GAAG,CACFs/B,YAAa,kBAAMj4B,EAAKk4B,WACxBC,cAAe,kBAAMn4B,EAAK9C,iDAMtB8I,EAAOnN,KAAKlB,KAAKqC,gBACjB5D,EAAOyC,KAAK69B,QAAQz8B,UAAU8kB,YAEhCtiB,EAAO,GACPrG,EAAK6K,MACR7K,EAAKkB,KAAOlB,EAAKkB,MAAQlB,EAAK6K,IACzB,gBAAgB0C,KAAKvN,EAAK6K,OAC9B7K,EAAK6K,IAAM,UAAY7K,EAAK6K,KAC7BxE,wBAAsBrG,EAAK6K,kBAAS7K,EAAKkB,iBAGrCK,KAAKof,aAAa/Q,EAAKhC,IAAKgC,EAAK/B,OAAQxH,QACzC9E,KAAK8I,eACLvD,cA5DP,4BAFsB,0BCET45B,GAAb,wFAA+BL,qCACxBM,EAAKr5B,GACVA,EAAK+gB,UAAU,CACdroB,KAAK,UACLivC,MAAM,KACNC,IAAI,OACJp/B,KAAK,YACLq/B,WAAW,EACXltC,OAAO,qDAID,CACNV,KAAM,gBACN4G,KAAM3H,MAAMC,KAAKC,YAAYC,OAAO,eACpCuH,MAAM,EACNknC,OAAM,EACNptC,MAAM,IAAKuC,OAAO,IAClBkY,SAAU,SACV5V,SAAQ,EACRrF,KAAK,CACJD,KAAK,OACL0F,SAAS,CACR,CAAEzC,KAAK,UAAW9C,SAAUlB,MAAMC,KAAKC,YAAYC,OAAO,mBAC1D,CAAEuB,KAAK,CACN,CAAEX,KAAK,QAASL,KAAK,OAAOmuC,UAAS,EAAM/tC,QAAQ,CAClD,CAAEgB,GAAG,UAAWhC,MAAME,MAAMC,KAAKC,YAAYC,OAAO,kBACpD,CAAE2B,GAAG,MAAOhC,MAAME,MAAMC,KAAKC,YAAYC,OAAO,eAChD,CAAE2B,GAAG,YAAahC,MAAME,MAAMC,KAAKC,YAAYC,OAAvB,YACtB4B,GAAG,CACLU,SAAS,SAASwd,GACN,OAARA,GACWhe,KAAK++B,cACbv6B,SAASkoC,WAAW3rC,SAAS,MAIrC,CAAEZ,KAAK,CACN,CAACrB,KAAK,WAAYL,KAAK,aAAcuiB,WAAWjjB,MAAMC,KAAKC,YAAYC,OAAO,gBAC9E,CAACY,KAAK,WAAYL,KAAK,aAAcuiB,WAAWjjB,MAAMC,KAAKC,YAAYC,OAAvB,YAChD,CAACY,KAAK,WAAYL,KAAK,WAAYuiB,WAAWjjB,MAAMC,KAAKC,YAAYC,OAAO,cAC5E,CAACY,KAAK,WAAYL,KAAK,SAAUuiB,WAAWjjB,MAAMC,KAAKC,YAAYC,OAAvB,YAG9C,CAAE6D,KAAK,UAAW9C,SAAUlB,MAAMC,KAAKC,YAAYC,OAAO,gBAC1D,CAAEY,KAAK,QAASL,KAAK,QAASI,QAAQ,CACrC,CAAEgB,GAAG,SAAUhC,MAAME,MAAMC,KAAKC,YAAYC,OAAO,gBACnD,CAAE2B,GAAG,KAAMhC,MAAME,MAAMC,KAAKC,YAAYC,OAAO,YAC/C,CAAE2B,GAAG,KAAMhC,MAAME,MAAMC,KAAKC,YAAYC,OAAO,cAEhD,CAAE6D,KAAK,UAAW9C,SAAUlB,MAAMC,KAAKC,YAAYC,OAAO,iBAC1D,CAAEuB,KAAK,CACN,CAACX,KAAK,QAASL,KAAK,MAAOI,QAAQ,CAClC,CAAEgB,GAAG,OAAQhC,MAAME,MAAMC,KAAKC,YAAYC,OAAO,eACjD,CAAE2B,GAAG,OAAQhC,MAAME,MAAMC,KAAKC,YAAYC,OAAO,kBAElD,CAAEqB,MAAM,IACR,CAAET,KAAK,QAASS,MAAM,IAAKd,KAAK,OAAQI,QAAQ,CAC/C,CAAEgB,GAAG,WAAYhC,MAAME,MAAMC,KAAKC,YAAYC,OAAO,kBACrD,CAAE2B,GAAG,YAAahC,MAAME,MAAMC,KAAKC,YAAYC,OAAO,uBAGxD,CACCuB,KAAK,CACJ,GACA,CAAEX,KAAM,SAAUsB,IAAI,uBAAwBgF,OAAO,MACpDvH,MAAOE,MAAMC,KAAKC,YAAYC,OAAO6G,OAAQC,WAAU,EACvDC,MAAO,kBAAMkC,EAAK9C,UAEnB,CAAEvF,KAAM,SAAUjB,MAAOE,MAAMC,KAAKC,YAAYC,OAAO2uC,MAAOznC,OAAO,QAASJ,WAAU,EACvFC,MAAO,kBAAMkC,EAAKk4B,uDASlB9hC,EAAOyC,KAAK69B,QAAQz8B,UAAU8kB,YACpC3oB,EAAKiC,OAASjC,EAAKiC,OAAO,EAAE,QACvB6E,QACLtG,MAAM8uC,MAAM7sC,KAAKlB,KAAMvB,SAlFzB,4BAFsB,uBCET0gC,GAAb,wFAA+BL,oCACzB5S,sBAEC7d,KAAO6d,EAAO7d,KAAO6d,EAAO7d,KAAOnN,KAAKlB,KAAKqC,iBAG7CnB,KAAKmN,WAEHrO,KAAK6wB,aAAa3vB,KAAKmN,KAAKhC,IAAKnL,KAAKmN,KAAK/B,UAAY4f,EAAOgE,WAElEhvB,KAAKlB,KAAK8C,UAAU,sBAAuB,CAAC5B,KAAKmN,KAAKhC;AAAKnL,KAAKmN,KAAK/B,QAAS4f,EAAOgE,kBAChF,OAGHlwB,KAAK2vB,SAASC,eAAiB,CAACC,YAAa3D,EAAOgE,SAAU7hB,KAAMnN,KAAKmN,MAE1EnN,KAAK69B,eACHA,QAAU9/B,MAAMqB,GAAGY,KAAKrB,cACxBG,KAAK69B,iBAAiBn7B,KAAKxB,KAAK69B,cAChC/+B,KAAK2vB,SAASK,aAAe9uB,KAAK69B,aAClCA,QAAQ57B,YAAY,SAAU,kBAAIkF,EAAK22B,eACvCh/B,KAAKmD,YAAY,gBAAiB,kBAAIkF,EAAK02B,QAAQl9B,cAGnDkE,EAAO7E,KAAK69B,QAAQz8B,UAEpBkN,EAAOtO,KAAKlB,KAAK+B,GAAG,SAAS0N,QAAQvO,KAAKmN,KAAKhC,IAAKnL,KAAKmN,KAAK/B,QAC9DhF,EAAOkI,EAAO,CAACnD,IAAKnL,KAAKmN,KAAKhC,IAAKC,OAAgB,EAARkD,EAAK,GAAKA,EAAK,GAAG,GAAMtO,KAAKmN,KAE9EpP,MAAMwL,MAAM,WACXpC,EAAK02B,QAAQl2B,KAAKR,EAAKrI,KAAK+B,GAAG,SAASkd,YAAY3X,IACpDe,EAAK2lC,iBAEiC,IAAnC9sC,KAAK+9B,MAAM/9B,KAAK69B,QAASh5B,IAC5B7E,KAAKqE,6CAGD0oC,SAAW/sC,KAAK69B,QAAQtc,UAAU,CAACziB,KAAK,kBACxCG,SAAWe,KAAK69B,QAAQtc,UAAU,CAACziB,KAAK,8DAGtC,CACNA,KAAM,QACNsB,IAAI,kBACJwhB,SAAS,IACTC,UAAU,IACV6nB,SAAS,QACThoB,QAAO,EACP5hB,GAAG,CACFktC,aAAa,WACZ/wB,EAAK4hB,QAAQl9B,OACbsb,EAAK4hB,QAAQl2B,OACVsU,EAAK8wB,SAAShlC,aAChBkU,EAAK8wB,SAAStrB,UAGjB1iB,KAAK,CACJkuC,SAAQ,EACRt2B,MAAM,CACL,CACC7X,KAAM,WACNsB,IAAI,sBACJiC,YAAY,EACZ3C,OAAO,OACP2lB,QAAQ,qBACe,WAChBpJ,EAAKnd,KAAKF,OAAO8kB,UAAYzH,EAAKnd,KAAK6wB,aAAa1T,EAAK9O,KAAKhC,IAAK8Q,EAAK9O,KAAK/B,SACjF6Q,EAAKixB,UAAUjxB,EAAKnd,KAAK2vB,SAASM,IAAI9S,EAAK9O,KAAKhC,IAAK8Q,EAAK9O,KAAK/B,YAInE,CACCtM,KAAM,WACNgB,GAAG,CACFU,SAAS,WACRyb,EAAKkxB,cAENtB,QAAQ,WACP5vB,EAAKnd,KAAK2vB,SAASC,eAAiB,CAACC,YAAY,EAAMxhB,KAAM8O,EAAK9O,OAEnE6+B,OAAO,WACN/vB,EAAKnd,KAAK2vB,SAASC,eAAiB,GACpCzS,EAAK4hB,QAAQl9B,uDASbysC,EAAUptC,KAAKlB,KAAK2vB,SAASM,IAAI/uB,KAAKmN,KAAKhC,IAAKnL,KAAKmN,KAAK/B,QAC7DpL,KAAKlB,KAAK2vB,SAASC,eAAeC,WACpC3uB,KAAKktC,UAAUE,GAEfptC,KAAKqtC,aAAaD,wCAEPxpC,QACP3E,SAAS0I,YACT1I,SAAS+G,QAAQpC,qCAEbA,mBACJ9E,KAAK+B,GAAG,SAASlB,OAAOK,KAAKmN,KAAKhC,IAAKnL,KAAKmN,KAAK/B,QACtDrN,MAAMwL,MAAM,WACXmU,EAAK4vB,eAAe1pC,GACpB8Z,EAAKqvB,SAASplC,OACd+V,EAAKqvB,SAAStrB,oDAIV3iB,KAAK2vB,SAAS6M,IAAIt7B,KAAKmN,KAAKhC,IAAKnL,KAAKmN,KAAK/B,OAAQpL,KAAK+sC,SAASnsC,mDAExDgD,QACTmpC,SAAS5sB,kBACT4sB,SAAShsC,SAAS6C,GAAM,SACxBmpC,SAAS3sB,qBAnHhB,4BAFsB,6BCCT6d,GAAb,wFAA+BL,oCACzB5S,QACChjB,MAAQgjB,EAAOhjB,WACfqc,OAAS2G,EAAOntB,MACrB+/B,GAAOz6B,UAAUu8B,KAAK77B,MAAM7D,KAAM8D,+CAG5ByuB,EAAMvyB,KAAKlB,KAAKqC,oBAClBoxB,EACH,OAAO,OACHzzB,KAAKqf,iBAAmB,kBACrB,OAGF3Z,EAAWxE,KAAK69B,QAAQz8B,UAAUoD,cACnCzC,KAAOyC,EAAQ,UACfuF,KAAOvF,EAAQ,UAEfq5B,QAAQ0P,UAAUlsC,gBAAgB,GAAG2E,QAAQhG,KAAKqkB,YAGnDxmB,EAFE0wB,EAAOvuB,KAAKlB,KAAK+B,GAAG,SAIzBhD,EADgB,OAAdmC,KAAKgI,MACCumB,EAAKxX,QAAQwb,EAAIpnB,KAAKqiC,SAAWjf,EAAK3vB,OAAO6uC,UAE7Clf,EAAKrB,gBAAgBqF,EAAInnB,QAAQ7L,OAASgvB,EAAK3vB,OAAOquB,iBAE1DlrB,KAAK2rC,UAAU,GAAG7vC,MAAQE,MAAMC,KAAKC,YAAYC,OAAqB,OAAd8B,KAAKgI,MAAiB,SAAW,cACzFjG,KAAKhB,SAAS,QACdgB,KAAK6F,eAELmC,KAAKhJ,SAASlD,QACdkM,KAAK0X,6CAGL3iB,KAAKqf,iBAAmB,2CAGvBpc,EAAO/B,KAAK+B,KAAKnB,WAEnBmJ,EAAO,OACA,GAARhI,EACFgI,EAA4B,EAArB/J,KAAK+J,KAAKnJ,WACF,GAARmB,IACPgI,EAAO/J,KAAKlB,KAAK+B,GAAG,SAASjC,OAAqB,OAAdoB,KAAKgI,MAAiB,YAAc,gBAExD,OAAdhI,KAAKgI,MACPhI,KAAKlB,KAAK4uB,aAAa,KAAM3jB,GAE7B/J,KAAKlB,KAAKwuB,eAAe,KAAMvjB,QAE3B1F,mDAGC8U,EAASpb,MAAMC,KAAKC,YAAYC,aAC/B,CACNY,KAAM,gBACNkb,SAAS,SACTza,MAAO,IACPkG,MAAM,EACN1G,KAAK,CACJ2F,QAAQ,EACRjF,KAAK,CACJ,CACCX,KAAK,QAASL,KAAK,OAAQmuC,UAAS,EAAMe,aAAa,GACvD7tC,GAAG,CACFU,SAAU,SAAAX,GACA,GAANA,EACFsH,EAAK4C,KAAKwwB,SAEVpzB,EAAK4C,KAAKuwB,YAGbz7B,QAAQ,CACP,CAACgB,GAAG,EAAGhC,MAAO,IACd,CAACgC,GAAG,EAAGhC,MAAOsb,EAAO,gBACrB,CAACtZ,GAAG,EAAGhC,MAAOsb,EAAO,mBAGvB,CAAChZ,KAAM,CACN,CAACrB,KAAK,OAAQL,KAAM,OAAQc,MAAM,SAIrCO,GAAG,CACFs/B,YAAa,kBAAMj4B,EAAKk4B,WACxBC,cAAe,kBAAMn4B,EAAK9C,iBAtF9B,GCWMupC,GAAQ,CAAEC,GAAKC,GAAKC,GAAKC,GAAKC,GAAKzE,GAAKr1B,GAAK+5B,GAAKC,GAAKC,GAAKC,GAAKC,yBDbjD,yBEGtB,IAAIC,IAAkB,EAuEf,SAAS5mB,GAAK7oB,GACpB0vC,GAAe1vC,GAAM;CAGf,SAAS8oB,GAAK9oB,GACpB0vC,GAAe1vC,EAAK,GAGd,SAAS6O,GAAM7O,GACjByvC,KACHzvC,EAAK2vC,eAAiB,GACtB3vC,EAAK4vC,eAAiB,GAIxB,SAASC,GAAa7vC,EAAMvB,GACvBuB,EAAK8vC,eAER9vC,EAAK2vC,eAAe1jB,OAAOjsB,EAAK4vC,cAAc,GAE9C5vC,EAAK2vC,eAAejtC,KAAKjE,GACzBuB,EAAK4vC,iBAIA,SAASpV,GAAWyB,EAAMj8B,GAChCA,EAAK8vC,mBAEJ7T,EAAKn4B,KAAK9D,WAGVA,EAAK8vC,gBAIA,SAASC,GAAY9T,GAC3BwT,IAAkB,EAClBxT,IACAwT,IAAkB,EAGnB,SAASC,GAAe1vC,EAAMgwC,OACzBvxC,EAAOuB,EAAK2vC,eAAoB,EAALK,EAAQhwC,EAAK4vC,cAAcI,EAAMhwC,EAAK4vC,kBAClEnxC,EAAK,KACHM,EAAe,EAAPixC,EAAWvxC,EAAKq0B,SAAWr0B,EAAKM,MACxCq/B,EAAiB,EAAL4R,EACZ3lC,EAAS,CAAC5L,EAAKytB,OAAQztB,EAAK4N,IAAK5N,EAAK6N,OAAQvN,EAAOq/B,GAEzDp+B,EAAK4vC,eAAiBI,MAGlB9mC,EAAQzK,EAAKyK,MACb+mC,EAAWjwC,EAAK2vC,eAAoB,EAALK,EAAQhwC,EAAK4vC,cAAcI,EAAMhwC,EAAK4vC,eAEzEpV,GAAW,WACVx6B,EAAK8C,UAAU,SAAUuH,GACpBnB,GAAW+mC,GAAY/mC,GAAS+mC,EAAS/mC,QAC7ClJ,EAAK8I,UACL9I,EAAK8C,UAAU,cAAe,MAE9B9C,GAECiwC,GAAY/mC,GAASA,GAAS+mC,EAAS/mC,OACzCwmC,GAAe1vC,EAAMgwC,QCwHpB/lC,0BD5PG,SAASD,GAAKhK,GACpB6O,GAAM7O,GAwIP,SAASkwC,EAAalwC,GACrBA,EAAKmD,YAAY,SAAU,SAASF,EAAMoJ,EAAKC,EAAQvN,UAC9CkE,OACF,aACJjD,EAAKkpB,WAAWnqB,aAEZ,gBACJiB,EAAKipB,cAAclqB,MA9ItBmxC,CAAalwC,GACbA,EAAKmD,YAAY,cAAe,kBAAM0L,GAAM7O,KAC5CA,EAAKmD,YAAY,mBAAoB,kBAAM0L,GAAM7O,KAEjDA,EAAKmD,YAAY,sBAAuB,SAACkJ,EAAKC,EAAQkE,EAAQ2B,MACzD0e,GAAa7wB,EAAMqM,EAAKC,GAAS,OAAO,EAC5CujC,GAAa7vC,EAAM,CAACksB,OAAQ,QAAS7f,IAAIA,EAAKC,OAAQA,EAAQvN,MAAOoT,EAAQ2gB,SAAUtiB,EAAQtH,MAAOA,EAAMnK,UAG7GiB,EAAKmD,YAAY,sBAAuB,SAACkJ,EAAKC,EAAQ6jC,EAAQC,MACzDvf,GAAa7wB,EAAMqM,EAAKC,GAAS,OAAO,EAC5CujC,GAAa7vC,EAAM,CAACksB,OAAQ,QAAS7f,IAAIA,EAAKC,OAAQA,EAAQvN,MAAOqxC,EAAQtd,SAAUqd,EAAQjnC,MAAOA,EAAMnK,UAG7GiB,EAAKmD,YAAY,eAAgB,SAACkJ,EAAKC,EAAQvN,MAC1C8xB,GAAa7wB,EAAMqM,EAAKC,GAAS,OAAO,EAC5CujC,GAAa7vC,EAAM,CAACksB,OAAQ,OAAQ7f,IAAIA,EAAKC,OAAQA,EAAQvN,MAAOA,EAAO+zB,SAAS/zB,EAAOmK,MAAOA,EAAMnK,UAGzGiB,EAAKmD,YAAY,gBAAiB,SAACkJ,EAAKC,EAAQvN,MAC3C8xB,GAAa7wB,EAAMqM,EAAKC,GAAS,OAAO,EAC5CujC,GAAa7vC,EAAM,CAACksB,OAAQ,QAAS7f,IAAIA,EAAKC,OAAQA,EAAQvN,MAAOA,EAAO+zB,SAAS/zB,EAAOmK,MAAOA,EAAMnK,UAG1GiB,EAAKmD,YAAY,WAAY,SAAC+oB,EAAQprB,UACrC+uC,GACC7vC,EACA,CACCksB,OAAQA,EACR7f,IAAKvL,EAAIuL,KAAO,KAChBC,OAAQxL,EAAIwL,QAAU,KACtBvN,MAAO+B,EAAI/B,OAAS,KACpB+zB,SAAUhyB,EAAIgyB,UAAY,KAC1B5pB,MAAOA,EAAMnK,UAMhBiB,EAAK+B,GAAG,SAASoB,YAAY,iBAAkB,SAACmJ,EAAQ6jC,EAAQC,UAC/DP,GAAa7vC,EAAM,CAACksB,OAAQ,WAAY7f,IAAI,EAAGC,OAAOA,EAAQvN,MAAOqxC,EAAQtd,SAAUqd,EAAQjnC,MAAOA,EAAMnK,UAG7GiB,EAAKmD,YAAY,oBAAqB,SAAC+oB,EAAQ3uB,EAAO6H,GACnC,QAAd8mB,EAAOnrB,IAA8B,QAAdmrB,EAAOnrB,IACjC8uC,GAAa7vC,EAAM,CAAEksB,OAAOA,EAAQ7f,IAAI,EAAGC,OAAO,CAAE/O,MAAAA,EAAO6H,IAAAA,OAG7DpF,EAAKmD,YAAY,iBAAkB,SAAC+oB,EAAQ3uB,EAAO6H,GAChC,QAAd8mB,EAAOnrB,IAA8B,QAAdmrB,EAAOnrB,IACjC8uC,GAAa7vC,EAAM,CAAEksB,OAAOA,EAAQ7f,IAAI,CAAE9O,MAAAA,EAAO6H,IAAAA,GAAOkH,OAAO,MAGjEtM,EAAK+B,GAAG,SAASoB,YAAY,cAAe,SAACkJ,EAAM8jC,EAAQC,UAC1DP,GAAa7vC,EAAM,CAACksB,OAAQ,WAAY7f,IAAKA,EAAKC,OAAO,EAAGvN,MAAOqxC,EAAQtd,SAAUqd,EAAQjnC,MAAOA,EAAMnK,UAI3GiB,EAAKmD,YAAY,uBAAwB,SAACkJ,EAAKC,EAAQvN,EAAOoxC,MACzDtf,GAAa7wB,EAAMqM,EAAKC,GAAS,OAAO,EAE5CvN,EAAQA,EAAQE,MAAMkG,KAAKpG,GAAS,KACpC8wC,GAAa7vC,EAAM,CAACksB,OAAQ,YAAa7f,IAAKA,EAAKC,OAAQA,EAAQvN,MAAOA,EAAO+zB,SAAUqd,EAAQjnC,MAAOA,EAAMnK,UAEjHiB,EAAK8vC,aAAe,2DC2LrB,SAASO,GAAUrwC,GAClBwK,aAAaP,IACbA,GAAShL,MAAMwL,MAAM,eACdnK,EAAKN,EAAK6gC,UACZ,IAAI9/B,KAAMT,EAAGgwC,MAAM,KAChBC,EAAOjwC,EAAGgwC,MAAMvvC,GAEhByvC,EAAclwC,EAAGmwC,OAAOF,EAAKttC,MAC7B2kB,EAAS4oB,EAAY5oB,OACrB8oB,EAAQF,EAAYE,MAEvBA,GACFC,GAAU3wC,EAAMM,EAAG2vB,IAAIlvB,GAAK2vC,EAAOH,EAAM3oB,MAK7C,SAAS+oB,GAAU3wC,EAAMmI,EAAMuoC,EAAOH,EAAM3oB,OACrCnpB,EAAOmyC,GAAW5wC,EAAMuwC,MAEd,SAAbA,EAAKttC,KAAgB,CACpB2kB,IACFzf,EAAOyf,EAAOzf,EAAMooC,EAAM9xC,GAAM,QAE3BqB,EAASywC,EAAKzwC,OACjBA,IAAW+wC,GAAO/wC,EAAOmD,OAuS9B,SAAS6tC,EAAcpyC,EAAK6xC,EAAMvwC,OAC3BF,EAASywC,EAAKzwC,OACQ,UAAzB0G,EAAO1G,EAAOixC,UAChBjxC,EAAOixC,OAAS,CAACC,WAAYlxC,EAAOixC,aAE/BA,EAASjxC,EAAOixC,UAEnBA,EAAOC,SACTtyC,EAAIuyC,aACA,GAAGF,EAAO1lC,cACR6lC,EAAQC,GAAUnxC,EAAMuwC,GACxBa,EAAuC,QAArBtxC,EAAOuxC,WACzBC,EAAcC,GAAUR,EAAO1lC,MAAO+lC,EAAiBF,GACpDvyC,EAAI,EAAGA,EAAI2yC,EAAY1yC,OAAQD,IAAI,KACrC2I,EAAOgqC,EAAY3yC,UAClBD,EAAI,GAAG4I,IArTdwpC,CAAcryC,EAAM8xC,EAAMvwC,GAG5B0wC,EAAMvoC,EAAM1J,GA2Bb,SAAS+yC,GAASxxC,EAAMiO,OAInB,IAAIlN,KAFR9B,MAAM6D,UAAU,UAAW,IAEb9C,EAAK6gC,MAAMyP,MAAM,KACxBmB,EAAMxyC,MAAM8C,GAAGhB,GACfwvC,EAAOvwC,EAAK6gC,MAAMyP,MAAMvvC,GAC3BkN,IACFsiC,EAAK3nC,EAAI8oC,GAAY1xC,EAAMyxC,EAAKlB,EAAK3nC,EAAG,KACxC2nC,EAAK5nC,EAAI+oC,GAAY1xC,EAAMyxC,EAAKlB,EAAK5nC,EAAG,MAEzCgpC,GAAS3xC,EAAMyxC,EAAKlB,IAItB,SAASoB,GAAS3xC,EAAMyxC,EAAKlB,OACtBhsB,EAAQvkB,EAAKgR,OAAOwT,iBAE1BitB,EAAI5oC,KAAK,CACRD,EAAE2nC,EAAK3nC,EACPD,EAAE4nC,EAAK5nC,EAAE4b,EAAM5b,IAIjB,SAAS+oC,GAAY1xC,EAAMyxC,EAAKnzC,EAAG2E,MAC9B3E,GAAU,IAALA,EAEL,KACG2M,EAAe,KAARhI,EAiCf,SAAS2uC,EAAU5xC,OACdS,EAAQ,SACZT,EAAKgR,OAAO0d,WAAW,SAAS3tB,GACrB,UAAPA,IACFN,GAASS,KAAKktB,gBAAgBrtB,GAAIN,SAE7BA,EAvCqBmxC,CAAU5xC,GAAMyxC,EAAII,OA0CjD,SAASC,EAAW9xC,OACfgD,EAAS,SACbhD,EAAKgR,OAAOvS,KAAKszC,KAAK,SAASjxC,GAC9BkC,GAAUlC,EAAI4tC,SAAWzvC,MAAMsC,KAAKsE,QAAQ8oC,YAEtC3rC,EA/CkD8uC,CAAW9xC,GAAMyxC,EAAI/C,QAC7EpwC,EAAIV,KAAKqiB,IAAIriB,KAAKsT,IAAI5S,EAAG,GAAI2M,QAH7B3M,EAAI0B,EAAKgR,OAAOwT,iBAAiBvhB,GAAM,UAKjC3E,EAmMR,SAAS0zC,GAASvzC,SACK,iBAARA,IAAoD,IAAhCA,EAAKyJ,QAAQ,cAGhD,SAAS0oC,GAAW5wC,EAAMuwC,OACrB9xC,EAAO8xC,EAAK9xC,QAEb,yBAAyBuN,KAAKvN,GAChC,OAAOA,MAEFC,EAAM,MACTD,EAAK,KAED2yC,EAAuC,QAD9Bb,EAAKzwC,OACWuxC,WAC3B1qB,EAAY,EAEhBloB,EAAOwzC,GAAcxzC,OACjB,IAAIE,EAAI,EAAGA,EAAIF,EAAKG,OAAQD,IAAI,KAC7BkZ,EAAQm6B,GAASvzC,EAAKE,IAAM0M,EAAM5M,EAAKE,GAAIqB,GAAQ,QACtD6X,EAAM,KACF6qB,EAAOJ,GAAYtiC,EAAM6X,EAAM,IACrCA,EAAM,GAAK8O,MAELurB,EAAUxP,EAAOA,EAAK0O,EAAkB,eAAiB,gBAAgBrsC,MAAM29B,EAAM7qB,GAAS,QACjGq6B,EAAQ,CACVvrB,GAAaurB,EAAQ,OACjB,IAAIvzC,EAAI,EAAGA,EAAIuzC,EAAQ,GAAGtzC,OAAQD,IACjCD,EAAIC,KACPD,EAAIC,GAAK;EACVM,MAAMiU,OAAOxU,EAAIC,GAAIuzC,EAAQ,GAAGvzC,cAM9BD,EAuBR,SAASyyC,GAAUnxC,EAAMuwC,OACpB9xC,EAAO8xC,EAAK9xC,SAEb,yBAAyBuN,KAAKvN,QAG7ByyC,EAAQ,MACTzyC,EAAK,KACDqB,EAASywC,EAAKzwC,OAChB6mB,EAAY,EAChBloB,EAAOwzC,GAAcxzC,OACjB,IAAIE,EAAI,EAAGA,EAAIF,EAAKG,OAAQD,IAAI,KAC7BkZ,EAAQm6B,GAASvzC,EAAKE,IAAM0M,EAAM5M,EAAKE,GAAIqB,GAAQ,QACtD6X,EAAM,KACF6qB,EAAOJ,GAAYtiC,EAAM6X,EAAM,IACrCA,EAAM,GAAK8O,MAELurB,EAAUxP,EAAOA,EAA0B,QAArB5iC,EAAOuxC,WAAuB,eAAiB,gBAAgBtsC,MAAM29B,EAAM7qB,GAAS,KAC7Gq6B,IACFvrB,GAAaurB,EAAQ,GACrBjzC,MAAMiU,OAAOg+B,EAAOgB,EAAQ,cAKzBhB,GAGD,SAASe,GAAcxzC,UACtBA,EAAKsF,QAAQ,MAAO,IAAI0H,MAAM,KAG/B,SAASolC,GAAO5tC,SACf,YAAY+I,KAAK/I,GAGlB,SAASkvC,GAAWnyC,EAAMvB,EAAM4yC,EAAYlvB,EAAQiwB,OACpDpzB,EAAoB,QAAdqyB,EACRgB,EAAO,MAER5zC,EAAK,KACH6zC,EAAQ,GACRvB,EAAS,GACTwB,EAAa,GAEdpwB,IACCA,EAAO4uB,SACTA,EAASQ,GAAUpvB,EAAO4uB,OAAQ/xB,IAChCmD,EAAOmwB,QACTA,EAAQf,GAAUpvB,EAAOmwB,MAAOtzB,IAC9BmD,EAAOqwB,SACTD,EAAapwB,EAAOqwB,OAAOnrC,OAAO,SAAAM,UAAqC,GAA9BopC,EAAO7oC,QAAQP,EAAI0D,SAA6C,GAA7BinC,EAAMpqC,QAAQP,EAAI0D,WAGhG5M,EAAOwzC,GAAcxzC,OACjBgf,EAAa,EACbg1B,EAAa,EACjBh0C,EAAKwjB,QAAQ,SAAAiwB,OACNM,EAASnnC,EAAM6mC,EAASlyC,MAC3BwyC,EAAO,SAILE,EAHEn1C,EAAQyhB,EAAMwzB,EAAO,GAAKA,EAAO,GACjCptC,EAAM4Z,EAAMwzB,EAAO,GAAKA,EAAO,cAG7B7zC,OACD0M,EAAQ2T,EAAM/S,EAAQtN,EAAG6zC,EAAO,GAAI7zC,EAAG6zC,EAAO,GAAIA,EAAO,IAAMvmC,EAAQumC,EAAO,GAAI7zC,EAAG6zC,EAAO,GAAI7zC,EAAG6zC,EAAO,IAC7GD,EAAWlrC,OAAO,SAAAM,UAAOA,EAAI0D,OAASA,GAAS1D,EAAIwa,QAAU+vB,IAAStzC,SACxE8zC,EAAiB,IAHX/zC,EAAIpB,EAAOoB,GAAKyG,EAAKzG,MAArBA,kBAMAA,OACD0M,EAAQ2T,EAAM/S,EAAQtN,EAAG6zC,EAAO,GAAI7zC,EAAG6zC,EAAO,GAAIA,EAAO,IAAMvmC,EAAQumC,EAAO,GAAI7zC,EAAG6zC,EAAO,GAAI7zC,EAAG6zC,EAAO,QACnF,GAA1BzB,EAAO7oC,QAAQmD,KAAyC,GAAzBinC,EAAMpqC,QAAQmD,GAC/C,qBAEKsnC,EAAYJ,EAAWlrC,OAAO,SAAAM,UAAOA,EAAI0D,OAASA,GAAS1D,EAAIwa,QAAU+vB,IAAS,MAErFQ,IAAmBC,KAAeP,IAAYK,GAAc9zC,GAAKpB,GACnE,iBAED80C,EAAK3vC,KAAKiwC,GAAa,CACtBxwB,OAAQ+vB,EACR7mC,MAAAA,EACA6b,OAAQ,SACRhnB,QAAS,EACT0D,MAsDN,SAASgvC,EAAUj5B,OACZk5B,EAAS,CACd,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,kBAEvEA,EAAOl5B,EAAMk5B,EAAOj0C,QA1Dfg0C,CAAUn1B,KAGlBA,SAlBO9e,EAAIpB,EAAOoB,GAAKyG,EAAKzG,MAArBA,GAoBR8zC,EAAa,YAITJ,EAGD,SAASd,GAAU7lC,EAAQsT,EAAK8zB,OAChCtnC,EAAQ,UAEdE,EAASumC,GAAcvmC,IAChBuW,QAAQ,SAAA8wB,GACdA,EAAW1nC,EAAM0nC,WACXx1C,EAAQyhB,EAAM+zB,EAAS,GAAKA,EAAS,GACrC3tC,EAAM4Z,EAAM+zB,EAAS,GAAKA,EAAS,GAEjCp0C,EAAIpB,EAAOoB,GAAKyG,EAAKzG,IAAI,KAC1B0M,EAAQ2T,EACb/S,EAAQtN,EAAGo0C,EAAS,GAAIp0C,EAAGo0C,EAAS,GAAIA,EAAS,IACjD9mC,EAAQ8mC,EAAS,GAAIp0C,EAAGo0C,EAAS,GAAIp0C,EAAGo0C,EAAS,IAElDvnC,EAAM9I,KAAKowC,EAAYA,EAAUznC,GAASA,MAIrCG,EAGD,SAASwnC,GAAiBlzC,SACL,UAAxB0G,EAAO1G,EAAOwyC,SAChBxyC,EAAOwyC,MAAQ,CAACtB,WAAYlxC,EAAOwyC,QAER,UAAzB9rC,EAAO1G,EAAOixC,UAChBjxC,EAAOixC,OAAS,CAACC,WAAYlxC,EAAOixC,SAErCjxC,EAAOixC,OAAS9xC,MAAMiU,OAAOpT,EAAOixC,OAAQ,CAC3CvwB,OAAO,IACP+J,MAAM,SACN0oB,OAAO,WAGJnzC,EAAOozC,QACVpzC,EAAOozC,MAAQ,CACdn3B,MAAM,IAGDjc,6BA3tBD,SAASkK,GAAKhK,OAuLhBmzC,EAtLE1jB,EAAOzvB,EAAKgR,OAAOxN,MAAM4vC,cAAc,oBAE7CpzC,EAAK6gC,MAAQ,CACZwS,SAAS,SAASpwC,EAAM2kB,EAAQ8oB,GAC3BxvC,KAAKuvC,OAAOxtC,KACf/B,KAAKuvC,OAAOxtC,GAAQ,CAAE2kB,OAAOA,EAAQ8oB,MAAMA,KAE7C/pC,KAAM,SAAS5F,EAAI6H,EAAGD,OACf8oC,EAAMxyC,MAAM8C,GAAGhB,GACfuQ,EAAMrS,MAAMkG,KAAKjE,KAAKovC,MAAMvvC,SAC7BuvC,MAAMvvC,GAAI6H,EAAI8oC,GAAY1xC,EAAMyxC,EAAK7oC,EAAG,UACxC0nC,MAAMvvC,GAAI4H,EAAI+oC,GAAY1xC,EAAMyxC,EAAK9oC,EAAG,KAC7C3I,EAAK8C,UAAU,WAAY,CAAC,YAAa,CAAEuJ,IAAItL,EAAI+xB,SAAS7zB,MAAMkG,KAAKjE,KAAKovC,MAAMvvC,IAAMhC,MAAMuS,KAC9FqgC,GAAS3xC,EAAMyxC,EAAKvwC,KAAKovC,MAAMvvC,KAEhCy7B,IAAK,SAAS5zB,EAAGD,EAAG1F,EAAMxE,EAAMqB,EAAQiB,cACvCjB,EAASA,GAAU,GACR,SAARmD,IACFnD,EAASb,MAAMiU,OAAOpT,EAAQ,CAC7BmD,KAAM,OACNouC,WAAW,iBAIPruC,EAAUlD,EAAOkD,QAAU,IAC3BvC,EAAQX,EAAOW,OAAS,IAExBgxC,EAAMxyC,MAAMqB,GAAG,CACpBS,GAAGA,GAAM,aAAa9B,MAAMoK,MAC5BrJ,KAAM,YACNszC,UAAU7jB,EAAMztB,OAAOhC,EAAKgR,OAAOlR,OAAOiB,GAC1CN,MAAMA,EAAOuC,OAAOA,WAGrByuC,EAAItuC,YAAY,gBAAiB,SAACyF,EAAGD,OAC9B4b,EAAQvkB,EAAKgR,OAAOwT,iBAC1Bnc,EAAK1B,KAAK5F,EAAI6H,EAAGD,EAAE4b,EAAM5b,KAE1B8oC,EAAItuC,YAAY,eAAgB,eACzBotC,EAAQloC,EAAKioC,MAAMvvC,GACnBuQ,EAAMrS,MAAMkG,KAAKorC,GAEvBA,EAAKzwC,OAAOkD,OAASyuC,EAAI/C,QACzB6B,EAAKzwC,OAAOW,MAAQgxC,EAAII,OACxB7xC,EAAK8C,UAAU,WAAY,CAAC,cAAe,CAAEuJ,IAAItL,EAAI+xB,SAAS7zB,MAAMkG,KAAKorC,GAAOxxC,MAAMuS,OAEvFmgC,EAAItuC,YAAY,aAAc,eACvBrD,EAASuI,EAAKioC,MAAMvvC,GACpB47B,EAAUt0B,EAAKkrC,UAAUzzC,EAAOmD,OAASnD,EAAOmD,KACtDjD,EAAK8C,UAAU,YAAa,CAAC,CAAE/B,GAAG47B,EAASgE,OAAO5/B,EAAIjB,OAAAA,OAEvD2xC,EAAItuC,YAAY,eAAgB,kBAAMkF,EAAKwW,OAAO9d,KAElDA,EAAK0wC,EAAI3xC,OAAOiB,GAEhB6H,EAAI8oC,GAAY1xC,EAAMyxC,EAAK7oC,EAAG,KAC9BD,EAAI+oC,GAAY1xC,EAAMyxC,EAAK9oC,EAAG,UAEzB2nC,MAAMvvC,GAAM,CAAE6H,EAAAA,EAAGD,EAAAA,EAAG1F,KAAAA,EAAMxE,KAAAA,EAAMqB,OAAAA,QAChCghC,OAAO//B,EAAItC,EAAMqB,GAAQ,GAC9B6xC,GAAS3xC,EAAMyxC,EAAKvwC,KAAKovC,MAAMvvC,IAExBA,GAER8d,OAAQ,SAAS9d,OACVuQ,EAAMpQ,KAAKovC,MAAMvvC,GACvB9B,MAAM8C,GAAGhB,GAAIwE,eACNrE,KAAKovC,MAAMvvC,GAElBf,EAAK8C,UAAU,WAAY,CAAC,WAAY,CAAEuJ,IAAItL,EAAI+xB,SAAS,KAAM/zB,MAAMuS,MAExE2e,IAAI,SAASlvB,UACL9B,MAAM8C,GAAGhB,GAAIuB,WAErBkxC,UAAU,SAASzyC,UACXG,KAAKovC,MAAMvvC,IAEnB+/B,OAAO,SAAS//B,EAAItC,EAAMqB,EAAQ2zC,OAC3BniC,EAAMmiC,EAAQ,KAAOx0C,MAAMkG,KAAKjE,KAAKovC,MAAMvvC,IAC3CwvC,EAAOrvC,KAAKovC,MAAMvvC,GAClBunB,EAAUpnB,KAAKuvC,OAAOF,EAAKttC,SAEjCxE,EAAOA,GAAQqB,EAAOrB,MAAQ,UAC9BqB,EAASA,GAAU,IAELrB,KAEE,SAAb8xC,EAAKttC,KAAgB,KACjBA,EAAOnD,EAAOmD,QACjBA,IAAS4tC,GAAO5tC,KAAUnD,EAAO0yC,OAAO,KACpCF,EAAQxyC,EAAOwyC,OAASxyC,EAAOwyC,MAAMjnC,MACrC0lC,EAASjxC,EAAOixC,QAAUjxC,EAAOixC,OAAO1lC,MAExC+mC,EAAW9gC,GAAOA,EAAIxR,QAAUwR,EAAIxR,OAAOwyC,OAAShhC,EAAIxR,OAAOwyC,MAAMtB,SAE3ElxC,EAAO0yC,OAASL,GAAWnyC,EAAMvB,EAAMqB,EAAOuxC,WAAY,CAACiB,MAAAA,EAAOvB,OAAAA,GAASqB,QAIvEX,EAAMxyC,MAAM8C,GAAGhB,GAEfiC,EAASlD,EAAOkD,QAAU,IAC1BvC,EAAQX,EAAOW,OAAS,IAE3BgxC,EAAII,QAAUpxC,GAASgxC,EAAI/C,SAAW1rC,IACxCyuC,EAAI/yB,OAAO,CAACje,MAAAA,EAAOuC,OAAAA,IACnByuC,EAAI7uB,UAGL2tB,EAAK9xC,KAAOA,EACZ8xC,EAAKzwC,OAASA,MAEVqI,EAAOjH,KAAK+uB,IAAIlvB,MAEpBtC,EAAOmyC,GAAW5wC,EAAMuwC,GAErBjoB,EAAQV,OAAO,KACX8rB,EAAez0C,MAAMkG,KAAKorC,GAGhCmD,EAAa5zC,OAAOW,MAAQizC,EAAa5zC,OAAOkD,OAAS,EA6Q7D,SAAS2wC,EAAexrC,OACjByrC,EAAQ,SAAS5zC,SACF,aAAbA,EAAKL,MAAoC,aAAbK,EAAKL,MAErCk0C,EAAS1rC,EAAKsa,UAAUmxB;AAAO,SACxBC,EAARA,EAAiB,CAACA,GACP1rC,EAAKsa,UAAUmxB,EAAO,QAC7B3xB,QAAQ,SAAC6xB,UAAOA,EAAGtY,YAjRvBmY,CADAxrC,EAAOmgB,EAAQV,OAAOzf,EAAMurC,EAAcj1C,IAIxC6pB,EAAQooB,OACVC,GAAU3wC,EAAMmI,EAAMmgB,EAAQooB,MAAOH,GAEtCvwC,EAAK8C,UAAU,WAAY,CAAC,WAAY,CAAEuJ,IAAItL,EAAI+xB,SAAS7zB,MAAMkG,KAAKjE,KAAKovC,MAAMvvC,IAAMhC,MAAMuS,MAE9FkL,UAAU,SAASzb,OACZ0wC,EAAMxyC,MAAM8C,GAAGhB,GACfO,EAAM,0BAENyyC,EAAS90C,MAAM8C,GAAGb,KAAK8yC,YAC1BD,IAAWA,EAAOE,aACpBh1C,MAAMsJ,KAAK8mB,UAAU0kB,EAAOvwC,MAAOlC,GAEjCmwC,QACGuC,WAAajzC,EAClB9B,MAAMsJ,KAAK+mB,OAAOmiB,EAAIjuC,MAAOlC,WAGtBJ,KAAK8yC,YAEdT,UAAU,OACD,sBACA,aAET9C,OAAO,GACPH,MAAM,IAIPtwC,EAAKgR,OAAO7N,YAAY,WAAY,kBAAMquC,GAASxxC,KACnDA,EAAKgR,OAAO7N,YAAY,YAAa,kBAAMquC,GAASxxC,KACpDA,EAAKgR,OAAO7N,YAAY,YAAa,kBAAMquC,GAASxxC,KAEpDA,EAAKmD,YAAY,UAAW,kBAyL7B,SAAS+wC,EAAOl0C,GACfw6B,GAAW,eACN,IAAIz5B,KAAMf,EAAK6gC,MAAMyP,MACxBtwC,EAAK6gC,MAAMhiB,OAAO9d,IACjBf,GA7L+Bk0C,CAAOl0C,KACzCA,EAAKmD,YAAY,SAAU,SAACF,EAAMoJ,EAAKC,EAAQvN,OACxC4H,EAAgB,cAAT1D,GACT0D,GAAgB,eAAR1D,GAAkC,aAATA,IA6LvC,SAASkxC,EAAQn0C,EAAM2G,EAAM5F,EAAIhC,MAC7BA,EAAM,KACD6J,EAA4B7J,EAA5B6J,EAAGD,EAAyB5J,EAAzB4J,EAAG1F,EAAsBlE,EAAtBkE,KAAMxE,EAAgBM,EAAhBN,KAAMqB,EAAUf,EAAVe,OACtBE,EAAK6gC,MAAMyP,MAAMvvC,GAChB4F,EACF3G,EAAK6gC,MAAMl6B,KAAK5F,EAAI6H,EAAGD,GAEvB3I,EAAK6gC,MAAMC,OAAO//B,EAAItC,EAAMqB,GAG7BE,EAAK6gC,MAAMrE,IAAI5zB,EAAGD,EAAG1F,EAAMxE,EAAMqB,EAAQiB,OAEpCwG,EAASvH,EAAK+B,GAAG,eACpBwF,GAAUA,EAAO2lB,QAAUnsB,GAC7BwG,EAAOkb,UAAU,QAAQqE,UAAUhnB,QAGpCE,EAAK6gC,MAAMhiB,OAAO9d,GA7MjBozC,CAAQn0C,EAAM2G,EAAM0F,EAAKtN,KAE3BiB,EAAKmD,YAAY,WAAY,SAAC+oB,EAAQuJ,GACxB,eAAVvJ,EACFslB,GAASxxC,GACQ,sBAAVksB,GAsHV,SAASkoB,EAAYp0C,EAAML,EAAMiN,EAAKnO,EAAMlB,WACrCsjC,EAAQpiC,EAAKoiC,MACXliC,EAAI,EAAGA,EAAIkiC,EAAMjiC,OAAQD,OAC7BqzC,GAASnR,EAAMliC,GAAG,IAAI,KAClB6zC,EAAS3R,EAAMliC,GAAG,GAAG6zC,OACxBA,GACFA,EAAOvwB,QAAQ,SAAAnhB,GACdA,EAAIuK,MAAQsB,EAAY7L,EAAIuK,MAAO1L,EAAMiN,EAAKrP,SAI1CwzC,EAASlQ,EAAMliC,GAAG,GAAGoyC,QAAUlQ,EAAMliC,GAAG,GAAGoyC,OAAO1lC,MACrD0lC,IACFlQ,EAAMliC,GAAG,GAAGoyC,OAAO1lC,MAAQ4mC,GAAclB,GAAQx6B,IAAI,SAAAlL,UAASsB,EAAYtB,EAAO1L,EAAMiN,EAAKrP,KAAQwF,KAAK,UAEpGuvC,EAAQzR,EAAMliC,GAAG,GAAG2zC,OAASzR,EAAMliC,GAAG,GAAG2zC,MAAMjnC,MAClDinC,IACFzR,EAAMliC,GAAG,GAAG2zC,MAAMjnC,MAAQsB,EAAY2lC,EAAO3yC,EAAMiN,EAAKrP,IAEzDsjC,EAAMliC,GAAG,GAAKszC,GAAcpR,EAAMliC,GAAG,IAAI4X,IAAI,SAAAlL,UAASsB,EAAYtB,EAAO1L,EAAMiN,EAAKrP,KAAQwF,KAAK,MAxIjGqxC,CAAYp0C,EAAMy1B,EAAE91B,KAAM81B,EAAE7oB,IAAK6oB,EAAEh3B,KAAMg3B,EAAEl4B,SAE7CyC,EAAKmD,YAAY,oBAAqB,kBAAOquC,GAASxxC,GAAM,KAC5DA,EAAKmD,YAAY,iBAAkB,kBAAMquC,GAASxxC,GAAM,KACxDA,EAAKmD,YAAY,cAAe,SAAC1E,UA4DlC,SAAS4R,EAAOrQ,EAAMvB,OACfoiC,EAAQpiC,EAAKoiC,MAChBA,GACFrG,GAAW,WACVqG,EAAM5e,QAAQ,SAAAnhB,UAAOd,EAAK6gC,MAAMrE,IAAIz3B,MAAM/E,EAAK6gC,MAAO//B,MACpDd,GAjEsCqQ,CAAOrQ,EAAMvB,KACvDuB,EAAKmD,YAAY,kBAAmB,SAAC1E,EAAMqB,UAoE5C,SAASsS,EAAWpS,EAAMvB,EAAMqB,OAE3B,IAAInB,KADRF,EAAKoiC,MAAQ,GACA7gC,EAAK6gC,MAAMyP,MAAM,KACvBC,EAAOvwC,EAAK6gC,MAAMyP,MAAM3xC,GACxB01C,EAAM,CAAC9D,EAAK3nC,EAAG2nC,EAAK5nC,EAAG4nC,EAAKttC,KAAMstC,EAAK9xC,KAAM8xC,EAAKzwC,QACrDA,GAAUA,EAAOw0C,SACnBD,EAAI3xC,KAAK/D,GACVF,EAAKoiC,MAAMn+B,KAAK2xC,IA3EqCjiC,CAAWpS,EAAMvB,EAAMqB,KAC7EE,EAAKmD,YAAY,eAAgB,kBAAMktC,GAAUrwC,KACjDA,EAAKmD,YAAY,gBAAiB,kBAAMktC,GAAUrwC,KAElDA,EAAKmD,YAAY,aAAc,eAC1B,IAAIxE,KAAKqB,EAAK6gC,MAAMyP,MAAOrxC,MAAM8C,GAAGpD,GAAG8kB,eAI5CxkB,MAAMkE,YAAY,UAAW,SAASwtB,OACjChO,EAAQ1jB,MAAM8C,GAAG4uB,GAClBhO,GAASA,EAAM7iB,OAAOglB,aACxBnC,EAAQ1jB,MAAM8C,GAAG4gB,EAAM7iB,OAAOglB,iBAEzBxkB,EAAKqiB,IAAUA,EAAMF,UAAU,YAAY,SAAWE,EAAMF,UAAU,YAAY,cAErFniB,EAAG,CACLN,EAAK6gC,MAAMrkB,UAAUlc,OACfS,EAAKT,EAAGR,OAAOiB,GAElBoyC,IACCnzC,EAAK6gC,MAAM2S,UAAUzyC,GAAIkC,MAAQkwC,EACnC7yC,EAAGwC,UAAU,aAAc,IAE3B9C,EAAK8C,UAAU,YAAa,CAAC,CAAE/B,GAAG,2BAG5BoyC,GACRnzC,EAAK6gC,MAAMrkB,cAGbxc,EAAKmD,YAAY,gBAAiB,SAASpC,EAAIkC,GAC9CjD,EAAK6gC,MAAMrkB,UAAUzb,GACrBoyC,EAAalwC,IAGdjD,EAAKmD,YAAY,eAAgB,SAASpC,EAAIkC,GAC1CkwC,GAAclwC,GAChBhE,MAAMwL,MAAM,WACX0oC,EAAa,SAKhBnzC,EAAK6gC,MAAMwS,SAAS,QAAS,SAAClrC,EAAMooC,EAAM9xC,OAEnCqB,EAqLR,SAASy0C,EAAgBhE,EAAM9xC,EAAMq0C,OAC9B0B,EAAa,YACf10C,EAASb,MAAMkG,KAAKorC,EAAKzwC,QAIvBozC,GAFNpzC,EAASkzC,GAAiBlzC,IAELozC,MAAMn3B,MACrB04B,EAAa30C,EAAOozC,MAAMtvC,OAAS0S,UAEnCrT,EAAOnD,EAAOmD,KAEjB4tC,GAAO5tC,WACFnD,EAAO0yC,WAETkC,EAAe50C,EAAOixC,OACxBO,GAAeoD,EAAa1D,UAAY0D,EAAarpC,SACtDimC,EAAY,KACRF,EAAwC,QAArBtxC,EAAOuxC,WAChCC,EAAcC,GAAUmD,EAAarpC,MAAO+lC,EAAiB0B,OAGxD/B,EAAS,CACdxmB,MAAOmqB,EAAanqB,OAAS,SAC7B0oB,OAAQyB,EAAazB,QAAU,aAGhClC,EAAOvwB,OAA0B,UAAjBuwB,EAAOkC,OAAqB,IAAM,IAE/CpC,GAAO5tC,IA8EX,SAAS0xC,EAAWl2C,EAAMqB,EAAQixC,EAAQO,OACnCkD,EAAa,gBACf,IAAI71C,KAAKF,EAAK,GAAG,CACjBqB,EAAOixC,OAAOC,UAChBD,EAAO5wC,SAAW,SAAAW,OACX6G,EAAM7G,EAAInC,UACRgJ,GAAe,IAARA,GAAcA,EAAI,IAAI5D,QAAQywC,EAAY,IAAM,IAEhE10C,EAAOf,iBAAYJ,EAAEoF,QAAQ,IAAK,YAG/BjE,EAAOixC,OAAO1lC,QAChB0lC,EAAO5wC,SAAW,SAAAW,OACX6G,EAAM7G,EAAIwwC,EAAY,WACpB3pC,GAAe,IAARA,GAAcA,EAAI,IAAI5D,QAAQywC,EAAY,IAAM,KAEjE10C,EAAOf,iBAAYJ,cAIlBoyC,EAAO5wC,SACTL,EAAOixC,OAASA,SAETjxC,EAAOixC,OAEZjxC,EAAO80C,eACT90C,EAAO80C,aAAe90C,EAAOf,OAvG7B41C,CAAWl2C,EAAMqB,EAAQixC,EAAQO,QAC7B,GAAGxxC,EAAO0yC,OAAO,CACrBzB,EAAO99B,OAAS,OAEV8I,EAAQjc,EAAO0yC,OACrB1yC,EAAO0yC,OAAS,OAEVF,EAAQxyC,EAAOwyC,MAClBA,EAAMtB,SACRsB,EAAMjnC,MAAQimC,EAAcn6B,OAAOC,KAAK3Y,EAAK,IAAI4I,OAAO,SAAAmO,UAAsC,GAA9B87B,EAAYppC,QAAQsN,KAAa,GAAK,QAC/F88B,EAAMjnC,QACbinC,EAAMjnC,MAAQynC,EAAUR,EAAMjnC,YAE3B,IAAI1M,EAAI,EAAGA,EAAIod,EAAMnd,OAAQD,IAAI,KAC9BiF,EAAQmY,EAAMpd,GAAGiF,MACjB0D,EAAOwrC,EAAU/2B,EAAMpd,GAAG0M,UAE7B/D,GAAQgrC,EAAMjnC,MAAM,KAChBypB,EAAI,CACT/1B,iBAAUuI,OACVpH,QAAQ;AACPC,SAAU4b,EAAMpd,GAAGuB,mBAAcoH,OAAU,QAIlC,SAARrE,GAA2B,QAARA,GAA0B,UAARA,GACvC6xB,EAAEtf,KAAO,CAAE5R,MAAMA,GACjBkxB,EAAExtB,KAAO,CAAEutC,YAAYjxC,EAAOX,KAAK8Y,EAAMpd,GAAGuoB,SAG5C4N,EAAElxB,MAAQA,EACA,QAARX,GAA0B,cAARA,IACpB6xB,EAAElqB,MAAQ,IAERnM,EAAK,KAAO6yC,GAAeoD,EAAa1D,UAAU,KAC9CrpC,EAAM2pC,EAAc7yC,EAAK,GAAG6yC,EAAY3yC,IAAMF,EAAK,GAAG6I,GACtDxC,EAAQ6C,GAAe,IAARA,GAAcA,EAAI,IAAI5D,QAAQywC,EAAY,IAAM,GACrEzD,EAAO99B,OAAOvQ,KAAK,CAACoC,KAAAA,EAAMlB,MAAAA,IAG3B9D,EAAO0yC,OAAO9vC,KAAKoyB,IAIlBwd,EAAMjnC,MACRvL,EAAOwyC,MAAQ,CACdnyC,SAAU,SAAAW,OACH6G,EAAM7G,EAAIwxC,EAAMjnC,cACd1D,GAAe,IAARA,GAAcA,EAAI,IAAI5D,QAAQywC,EAAY,IAAM,IAEhE/yC,MAAO3B,EAAOwyC,MAAM7wC,MACpBqzC,UAAWL,EACX7wC,MAAO6wC,EACP14B,MAAOm3B,UAIDpzC,EAAOwyC,MAEZvB,EAAO99B,OAAOrU,OAChBkB,EAAOixC,OAASA,SAETjxC,EAAOixC,cAGhBjxC,EAAOi1C,MAAQ91C,MAAMiU,OAAOpT,EAAOi1C,OAAO,GAAI,CAC7CD,UAAWL,EACX7wC,MAAO6wC,EACP14B,MAAOm3B,EACP8B,UAAWl1C,EAAOozC,MAAM+B,OAAS,MAAQ,YAGnCh2C,MAAMiU,OAAO,CACnBlT,KAAK,SACHF,GAAQ,GA5RKy0C,CAAgBhE,EAAM9xC,EADnB0yC,GAAUnxC,EAAMuwC,WAE3BtxC,MAAMqB,GAAGR,EAAQqI,IACtB,SAACnI,EAAMvB,GACTuB,EAAKgzB,WACLhzB,EAAKszB,MAAM70B,KAGZuB,EAAK6gC,MAAMwS,SAAS,QAAS,SAAClrC,EAAMooC,EAAM9xC,OACnCqB,EAASb,MAAMiU,OAAO,CAAE5R,IAAI,uBAAwBnB,6BAAsB1B,UAAa8xC,EAAKzwC,QAAQ,IAAI,UACvGb,MAAMqB,GAAGR,EAAQqI,kFCvOpB/I,GAASH,MAAMC,KAAKC,YAAYC,OAE/B,SAAS4K,GAAKhK,GACpBA,EAAKmD,YAAY,kBAAmB,kBAgGrC,SAASsoB,EAAMzrB,OACRk1C,EAAcl1C,EAAK+B,GAAG,eACtBgE,EAAOmvC,EAAYzyB,UAAU,QAC7B/c,EAAWK,EAAKL,kBAmIbyvC,OACLzvC,EAAS,mBAAmB5D,WAAW,KACnCqI,EAAU0mC,GAAOnrC,EAASzC,KAAKnB,YAAcszC,EAAgBC,EACnEC,EAAe5vC,EAAS,gBAAiByE,eAIlCorC,EAAkB5tC,MACvBA,EAAI,KACA2pC,EAAc5rC,EAAS,gBAAgB5D,WAC7C85B,EAAY,GAAI0V,OAGXnnC,EAAU0mC,GAAOnrC,EAASzC,KAAKnB,YAAcszC,EAAgBC,EACnE1tC,EAAMA,EAAMwC,IAAY,GAExBmrC,EAAe5vC,EAAS,gBAAiBiC,YAGjC6tC,EAAiB7tC,MACtBA,EAAI,KACA8tC,EAAa/vC,EAAS,eAAe5D,WAC3C85B,EAAY,GAAI6Z,GAGjB9tC,EAAMA,EAAMytC,IAAkB,GAE9BE,EAAe5vC,EAAS,eAAgBiC,YAGhC2tC,EAAelpB,EAASzkB,GAChCykB,EAAQ/K,aACR+K,EAAQnqB,SAAS0F,GACjBykB,EAAQ9K,wBAGA8zB,QACF32C,EAAOiH,EAAS2F,MAAMvJ,WACtBuvC,EAAa3rC,EAAS2rC,WAAWvvC,WACjCwvC,EAAc5rC,EAAS,gBAAgB5D,WACzC4zC,EAAa,GAEXlD,EAASL,GAAWnyC,EAAMvB,EAAM4yC,EAAY,CAACN,OAAQO,GAAe,YAEvEkB,EAAO5zC,SACT82C,EAAalD,EAAO,GAAGnnC,OAEjBqqC,WAGCL,QACF52C,EAAOwzC,GAAcvsC,EAAS2F,MAAMvJ,YACpCkd,EAAwC,QAAlCtZ,EAAS2rC,WAAWvvC,WAC1B2zC,EAAaxD,GAAcvsC,EAAS,eAAe5D,YACrD6zC,EAAS,UAEbl3C,EAAKwjB,QAAQ,SAAAiwB,OACuB,GAAhCuD,EAAWvtC,QAAQgqC,GAAe,KAC9BhY,EAAO7uB,EAAM6mC,EAASlyC,MACzBk6B,EAAK,KACD7uB,EAAQ2T,EACb/S,EAAQiuB,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,IACjDjuB,EAAQiuB,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,KAEvB,GAAxBz7B,EAAKyJ,QAAQmD,IACfsqC,EAAOjzC,KAAK2I,OAKTsqC,EAAO5yC,KAAK,cAGX64B,EAAYj0B,EAAKue,OACrBznB,EAAOiH,EAAS2F,MAAMvJ,WAEpBivC,EAASrrC,EAAS,gBAAgB5D,WAClCwwC,EAAQ5sC,EAAS,eAAe5D,WAChCuvC,EAAa3rC,EAAS2rC,WAAWvvC,WAEjC0wC,EAASL,GAAWnyC,EAAMvB,EAAM4yC,EAAY,CAACN,OAAAA,EAAQuB,MAAAA,IAE3DpsB,EAAS+rB,GAAc/rB,GAEvBznB,EAAOwzC,GAAcxzC,GAAM4I,OAAO,SAAAM,UAA+B,GAAxBue,EAAOhe,QAAQP,KAErDA,IACFA,EAAMsqC,GAActqC,IAChBsa,QAAQ,SAAA5W,OACLuqC,EAAQpD,EAAOnrC,OAAO,SAAAvG,UAAOA,EAAIuK,OAASA,IAC5CuqC,EAAMh3C,QACTH,EAAKiE,KAAK2I,KAIbiqC,EAAe5vC,EAAS2F,MAAO5M,EAAKsE,KAAK,eAGjC8yC,EAAYluC,OACd4iB,EAAQ7kB,EAAS,gBACjBkb,EAAO2J,EAAMroB,UAET,UAAPyF,EACCiZ,EAAKuH,OAAO,WACdvH,EAAK/B,OAAO,UAEL+B,EAAKuH,OAAO,WACpBvH,EAAK4b,IAAI,CAACz7B,GAAG,SAAUhC,MAAMK,GAAO,wBAAyB,YAGtD02C,EAAanuC,OACf4iB,EAAQ7kB,EAAS,iBACjBkb,EAAO2J,EAAMroB,UAET,UAAPyF,EACCiZ,EAAKuH,OAAO,WACdvH,EAAK/B,OAAO,UAEL+B,EAAKuH,OAAO,WACpBvH,EAAK4b,IAAI,CAACz7B,GAAG,SAAUhC,MAAMK,GAAO,wBAAyB,YAGtD22C,EAAWpuC,OACbg3B,EAAO3+B,EAAK+B,GAAG,aAAai0C,YAClCC,IACAd,IAEAzvC,EAAS8sC,OAAOvrB,YAAmB,SAAPtf,GAAyB,QAAPA,GAAwB,UAAPA,GAErD,QAAPA,GAAwB,OAAPA,EAAcjC,EAASwwC,QAAQrtC,OAC9CstC,EAAUzwC,EAASwwC,SAEd,SAAPvuC,EACFjC,EAAS,gBAAgBmD,OAEzBstC,EAAUzwC,EAAS,iBAEV,OAAPiC,EACFjC,EAAS,MAAMmD,OAEfstC,EAAUzwC,EAAS,OAEjBmrC,GAAOlpC,IACTyuC,EAAU,QACV1wC,EAASkvC,aAAa/rC,OACtB81B,EAAK0X,WAAW,cAGhBD,EAAU,QAAQ,GAClBD,EAAUzwC,EAASkvC,cACnBjW,EAAK2X,WAAW,aAGdzF,GAAOlpC,IAAe,SAAPA,EACjByuC,EAAU,aAEVA,EAAU,aAAa,YAGhBG,EAAanE,OACjB3zC,EAAOiH,EAAS2F,MAAMvJ,WAEtB0wC,EAAS9sC,EAAS8sC,OAAO1wC,WACvBivC,EAASrrC,EAAS,gBAAgB5D,WAClCwwC,EAAQ5sC,EAAS,eAAe5D,WAChCuvC,EAAa3rC,EAAS2rC,WAAWvvC,WAEvC0wC,EAASL,GAAWnyC,EAAMvB,EAAM4yC,EAAY,CAACmB,OAAAA,EAAQzB,OAAAA,EAAQuB,MAAAA,GAAQF,GAErE1sC,EAAS8sC,OAAOvwC,SAASuwC,YAGjByD,QACFj3B,EAAwC,QAAlCtZ,EAAS2rC,WAAWvvC,WAC1B00C,EAAM3F,GAAOnrC,EAASzC,KAAKnB,aAC5B00C,GAAOx3B,IAAUA,GAAOw3B,GAC5B9wC,EAAS,mBAAmBgZ,OAAO,QAAStf,GAAO,qBACnDsG,EAAS,kBAAkBgZ,OAAO,QAAStf,GAAO,sBAGlDsG,EAAS,mBAAmBgZ,OAAO,QAAStf,GAAO,qBACnDsG,EAAS,kBAAkBgZ,OAAO,QAAStf,GAAO,qBAEnDsG,EAAS,mBAAmBoD,UAC5BpD,EAAS,kBAAkBoD,mBAGnBqtC,EAAUtL,GACfA,EAAM5oC,UACRqzC,EAAezK,GAChBA,EAAMhpC,gBAGEu0C,EAAUlY,EAAOnO,GACzBhqB,EAAK0c,UAAU,CAACyb,MAAMA,GAAQ,OAAOjc,QAAQ,SAAA4oB,GACzC9a,EACF8a,EAAMhiC,OAENstC,EAAUtL,KAvUb7qC,EAAKmD,YAAY,YAAa,SAAA+oB,MACb,aAAbA,EAAOnrB,GAAkB,KACrBjB,EAASosB,EAAOpsB,OAClBmT,EAASnT,GAAUA,EAAOA,QAAU,GAExCo1C,EAAYrsC,OAEZ7I,EAAKqf,iBAAmB,SAASoR,EAAIrrB,EAAK6B,EAAGqQ,OACtCqL,EAAQ1jB,MAAMkkB,UAAUwO,cAE3BujB,EAAYzyB,UAAU,SAAAziB,UAAQA,GAAQ2iB;AACrCA,GAASjd,EAAS2F,OAASsX,GAASjd,EAAS,gBAAgB,KAC3DiC,EAAMgb,EAAM7gB,WACVwrB,EAAO3lB,EAAImiC,YAAY,KAE7BniC,GAAe,GAAT2lB,EAAa,GAAK3lB,EAAIG,UAAU,EAAGwlB,EAAO,GAChD3K,EAAM1gB,SAAS0F,EAAMV,EAAE,IAAIqQ,QAEpBqL,EAAM7iB,OAAOuL,OACpBsX,EAAM1gB,SAASgF,EAAE,IAAIqQ,UAGhB,GAGRvR,EAAKs1B,QACLr7B,EAAK+B,GAAG,aAAaE,SAAS,WAE9BgR,EAAS+/B,GAAiB//B,IAEnB5H,MAAQvL,EAASA,EAAOrB,KAAOuB,EAAKylC,mBAC3CyP,EAAYhoB,OAAShB,EAAOyU,OAASzU,EAAOyU,OAAS3gC,EAAK6gC,MAAMrE,IAAI,KAAM,KAAM,QAASvpB,EAAO5H,MAAO4H,GAEvGjT,EAAK8C,UAAU,gBAAiB,CAACoyC,EAAYhoB,OAAQ,UAErD4oB,EAAa7iC,EAAO89B,OAAOxmB,OAC3BsrB,EAAY5iC,EAAO89B,OAAOkC,QAC1B8C,EAAW9iC,EAAOhQ,MAElB8C,EAAK+gB,mBAoSE2vB,EAASxjC,GACd,aAAajH,KAAKiH,EAAOhQ,QAC3BgQ,EAAOhQ,KAAOgQ,EAAOhQ,KAAKc,QAAQ,aAAc,IAAIkE,sBAC9CgL,EAvSSwjC,CAASxjC,IAErBA,EAAO89B,OAAOC,UAChBuE,EAAkBtiC,EAAO89B,OAAOC,UAC9B/9B,EAAOq/B,MAAMtB,UACfwE,EAAiBviC,EAAOq/B,MAAMtB,UAE/BuF,IAEAxwC,EAAK0c,UAAU,gBAAiB,OAAOR,QAAQ,SAAAjiB,UAAQA,EAAK02C,WAE5DhxC,EAAS2F,MAAMsX,WAIjB3iB,EAAKmD,YAAY,gBAAiB,SAACpC,EAAIkC,GACnCiyC,EAAYjsC,aAAuB,SAARhG,GAC7B0zC,GAAY32C,KAGdA,EAAKmD,YAAY,YAAa,SAAArC,GAChB,mBAAVA,EAAIC,IAA2Bm0C,EAAYjsC,aAC7C0tC,GAAY32C,KAGdA,EAAKmD,YAAY,WAAY,SAACpC,EAAIkS,GACxB,YAANlS,GAAqBkS,EAAO6f,UAC3BoiB,EAAYjsC,aAAeisC,EAAYhoB,QAAUja,EAAO5G,KAC1DsqC,GAAY32C,KAIf+F,EAAK5C,YAAY,WAAY,SAASwE,EAAKue,OACpC+G,EAAS/rB,KAAKygB,gBAGjBsL,IAAWvnB,EAAS2F,OAAS4hB,IAAWvnB,EAAS,gBAAkBunB,IAAWvnB,EAAS,gBAAgB,KACnGygB,EAAQxe,EAAIye,cACfze,GAAOwe,GAETmvB,EAAeroB,EADftlB,EAAMwe,UAKA8G,QACFvnB,EAASzC,KACb8yC,EAAWpuC,cAEPjC,EAAS2F,WACT3F,EAAS2rC,WACVnwC,KAAKygB,cAAgBjc,EAAS2rC,YAChC4E,IACEvwC,EAAS,mBAAmB5D,YAC9BqzC,IACEzvC,EAAS,kBAAkB5D,YAC7BwzC,EAAe5vC,EAAS,eAAgB0vC,KACzCmB,eAEI7wC,EAAS,kBACb8vC,EAAiB7tC,GACjB4uC,EAAarwB,cAETxgB,EAAS,mBACb6vC,EAAkB5tC,GAClB4uC,eAEI7wC,EAAS,gBACbowC,EAAanuC,cAETjC,EAAS,iBACbmwC,EAAYluC,cAERjC,EAAS,eACVA,EAAS,kBAAkB5D,YAC7BwzC,EAAe5vC,EAAS,mBACzBk2B,EAAYj0B,EAAKue,cAEbxgB,EAAS,gBACVA,EAAS,mBAAmB5D,YAC9BwzC,EAAe5vC,EAAS,oBACzBk2B,EAAYj0B,EAAKue,OAIbpmB,WAsNE82C,EAAU3jC,GACfA,EAAOijC,QACTjjC,EAAOhQ,KAAO,UAAUgQ,EAAOhQ,KAAK2E,OAAO,GAAGwe,cAAcnT,EAAOhQ,KAAKmI,OAAO,GACxE6H,EAAO,QACdA,EAAOhQ,MAAQ,aAETgQ,EA5NQ2jC,CAAU7wC,EAAKqhB,aAC9BpnB,EAAK6gC,MAAMC,OAAOoU,EAAYhoB,OAAQptB,EAAOuL,MAAOvL,KAGrD4F,EAAS8sC,OAAOrvC,YAAY,gBAAiBy4B,GApOHnQ,CAAMzrB,SAC1C62C,EAAa53C,MAAMsC,KAAKsE,QACxBD,EAAUixC,EAAW5wB,YAAY,EACjCvlB,EAASm2C,EAAWlxB,aAAa5f,WAEhC,CACNtF,MAAM,IACN4lB,QAAQ,EACRtlB,GAAG,cACHO,IAAI,eACJD,KAAK,CACJ,CACC2B,OAAQ6zC,EAAWC,UACnBx1C,IAAK,2BACLsE,QAAQ,CAAE6H,KAAM,GAChB9M,KAAM,CACL,CAAEX,KAAM,OAAQsG,OAAO,MAAOhD,KAAK,mCAAoC6C,MAAO,kBAAMwwC,GAAY32C,KAChG,CAAEiD,KAAK,SAAUM,YAAW,EAAMpD,SAAUf,GAAO,iBAGrD,CACCY,KAAK,OACL+2C,aAAY,EACZxzC,YAAY,EACZqC,QAAQ,CACPgI,IAAK,GAEN4T,eAAe,CACdC,WAAW,KAEZ/b,SAAS,CAAC,CACT1F,KAAK,UACLe,GAAG,YACH8W,MAAM,CACL,CAAE9W,GAAG,SAAUwC,YAAW,EAAMN,KAAK,OAAQgpC,SAAS,EAAG1mB,OAAOnmB,GAAO,gBAAiBiC,KAAK,CAC5F,CAACrB,KAAK,aAAcC,KAAK,CACxBS,OAAAA,EACAW,KAAK,CACJ21C,GAAc,OAAQ,aAya/B,SAAS7R,UACD,CACN,CAACpkC,GAAG,OAAQhC,MAAMK,GAAO,eACzB,CAAC2B,GAAG,SAAUhC,MAAMK,GAAO,iBAC3B,CAAC2B,GAAG,aAAchC,MAAMK,GAAO,qBAC/B,CAAC2B,GAAG,OAAQhC,MAAMK,GAAO,eACzB,CAAC2B,GAAG,MAAOhC,MAAMK,GAAO,cACxB,CAAC2B,GAAG,QAAShC,MAAMK,GAAO,gBAC1B,CAAC2B,GAAG,MAAOhC,MAAMK,GAAO,cACxB,CAAC2B,GAAG,QAAShC,MAAMK,GAAO,iBAlbiB+lC,IACpC,CAAEnlC,KAAK,WAAYgG,MAAM5G,GAAO,iBAAkBO,KAAK,UAAW0mB,QAAO,GACzE,CAAErmB,KAAK,WAAYgG,MAAM5G,GAAO,gBAAiBO,KAAK,KAAM0mB,QAAO,GACnE,CAAErmB,KAAK,OAAQgG,MAAM5G,GAAO,eAAgBO,KAAK,SACjD,CAAEK,KAAK,WAAYgG,MAAM5G,GAAO,mBAAoBO,KAAK,iBAAkBu+B,MAAM,QACjF,CAAEl+B,KAAK,WAAYgG,MAAM5G,GAAO,kBAAmBO,KAAK,eAAgB0mB,QAAO,GAC/E,CAAErmB,KAAK,WAAYgG,MAAM5G,GAAO,oBAAqBO,KAAK,mBAC1D,CAAEK,KAAK,QAASgG,MAAM5G,GAAO,mBAAoBO,KAAK,aAAcmuC,UAAS,EAAM/tC,QAAQ,CAC1F,CAACgB,GAAG,UAAWhC,MAAMK,GAAO,kBAC5B,CAAC2B,GAAG,OAAQhC,MAAMK,GAAO,iBAE1B,QAIH,CAAE2B,GAAG,WAAYwC,YAAW,EAAMN,KAAK,OAAQgpC,SAAS,EAAGrmC,QAAQ,CAACkI,OAAO,GAAIyX,OAAOnmB,GAAO,gBAAiBiC,KAAK,CAClH,CAAErB,KAAM,gBAAiBL,KAAK,YAE/B,CAAEoB,GAAG,SAAUwC,YAAW,EAAMN,KAAK,OAAQgpC,SAAS,EAAG1mB,OAAOnmB,GAAO,gBAAiBiC,KAAK,CAC5F,CAACrB,KAAK,aAAcC,KAAK,CACxBD,KAAM,YACNU,OAAQzB,MAAMsC,KAAKsE,QAAQ8f,aAAa5f,KACxCzE,IAAK,yBACLskB,OAAO,EACP3iB,KAAM,QACN5B,KAAK,CACJ,CAAEkkB,OAAOnmB,GAAO,gBAAiBa,KAAK,CACrCS,OAAAA,EACAkF,QAAAA,EACAvE,KAAK,CACJ,CAAErB,KAAM,OAAQgG,MAAM5G,GAAO,sBAAuBO,KAAK,gBACzDq3C,GAAc,eAAgB,qBAuZzC,SAASC,UACD,CACN,CAACl2C,GAAG,OAAQhC,MAAMK,GAAO,sBACzB,CAAC2B,GAAG;AAAUhC,MAAMK,GAAO,wBAC3B,CAAC2B,GAAG,QAAShC,MAAMK,GAAO,wBA3ZmC63C,IACpDD,GAAc,gBAAiB,sBA8Z1C,SAASE,UACD,CACN,CAACn2C,GAAG,MAAOhC,MAAMK,GAAO,qBACxB,CAAC2B,GAAG,SAAUhC,MAAMK,GAAO,wBAC3B,CAAC2B,GAAG,SAAUhC,MAAMK,GAAO,yBAlaoC83C,OAGxD,CAAE3xB,OAAOnmB,GAAO,cAAea,KAAK,CACnCS,OAAAA,EACAkF,QAAAA,EACAvE,KAAK,CACJ,CAAErB,KAAK,OAAQgG,MAAM5G,GAAO,qBAAsBO,KAAK,cAAe0L,OAAM,EAAM6yB,MAAM,QACxF,CAAEl+B,KAAK,OAAQgG,MAAM5G,GAAO,qBAAsBO,KAAK,cAAeu+B,MAAM,aAC5E,CAAEl+B,KAAK,OAAQgG,MAAM5G,GAAO,qBAAsBO,KAAK,cAAeu+B,MAAM,aAC5E,CAAEl+B,KAAK,WAAYgG,MAAM5G,GAAO,eAAgBO,KAAK,cAAeu+B,MAAM,QAC1E,CAAEl+B,KAAK,WAAYgG,MAAM5G,GAAO,sBAAuBO,KAAK,eAAgB0mB,QAAO,GACnF,CAAErmB,KAAK,qBAAsBgG,MAAM5G,GAAO,qBAAsBO,KAAK,cAAeu+B,MAAM,WAG5F,cA2WT,SAASyY,GAAY32C,OACdk1C,EAAcl1C,EAAK+B,GAAG,eAC5B/B,EAAK8C,UAAU,eAAgB,CAACoyC,EAAYhoB,OAAQ,UACpDgoB,EAAYhoB,OAAS,KACrBltB,EAAKqf,iBAAmB,KACxB61B,EAAYrzC,OAGb,SAASm1C,GAAcr3C,EAAMqG,EAAOvH,SAC5B,CAAEuB,KAAM,aAAcL,KAAKA,EAAMqG,MAAM5G,GAAO4G,GAAQrE,QAAQ,CACpE3B,KAAM,sBACNvB,KAAMA,IClbD,SAAS04C,GAAQjrB,EAAQ3uB,EAAO6H,EAAKpF,EAAMwb,EAAGzD,OAChDtZ,EAAME,EAAGy4C,EAASC,EAASpkC,EAC9B4O,EAAM,EAAG9R,EAAO,EAEblP,EAASb,EAAKgR,OAAOvC,gBACrB8V,EAAQvkB,EAAKgR,OAAOwT,iBAExB4yB,EAAUp3C,EAAKwJ,UAAU,CACxB4mB,MAAM,EAAMkkB,SAAQ,IAGrB+C,EAAUp4C,MAAMkG,KAAKiyC,OAEjBrlB,EAAQqlB,EAAQrlB,UACf,IAAI+C,KAAK/C,EAAM,KACfviB,EAAOuiB,EAAM+C,KACjBtlB,EAAOm4B,GAAWn4B,EAAM0c,EAAQ3uB,EAAO6H,EAAKgyC,EAAQ34C,OAC5C,IAAM,GAAK+Q,EAAK,IAAM,IAC7BuiB,EAAM9F,OAAO6I,EAAG,GAIlB7hB,EAiFD,SAASqkC,EAAiBprB,EAAQ3uB,EAAO6H,OACpCzF,EAAOusB,EAAOhjB,MACjB0D,EAAiB,OAAXsf,EAAOnrB,GAAU,EAAc,OAAXmrB,EAAOnrB,IAAW,EAAE,EAE5C6L,IAEU,OAARjN,IACHiN,GAAOA,GAAOxH,EAAIiH,IAAM9O,EAAM8O,MACnB,UAAR1M,IACHiN,GAAOA,GAAOxH,EAAIkH,OAAS/O,EAAM+O,gBAE5B,CAAC3M,KAAMA,EAAMiN,IAAKA,GA5FhB0qC,CAAgBprB,EAAQ3uB,EAAO6H,GAExCpF,EAAKqf,iBAAmB,KAEpB7D,GACHgf,GAAW,WACVx6B,EAAK8C,UAAU,WAAY,CAAC,qBAAsB,CACjDnD,KAAMsT,EAAOtT,KACbiN,IAAKqG,EAAOrG,IACZnO,KAAK24C,EACL75C,MAAOA,MAEPyC,GAEHvB,EAAO24C,EAAQ34C,KAEK,UAAhBytB,EAAOhjB,OACV2Y,EAAQzc,EAAIkH,OAAS/O,EAAM+O,OAAS,EACpCyD,EAASxS,EAAM+O,OAEE,OAAb4f,EAAOnrB,GA2Eb,SAASw2C,EAAWrrB,EAAQ3uB,EAAO6H,EAAKpF,EAAM0R,EAAQ3S,EAAON,OACxDE,EAAIF,EAAKG,OACT44C,EAAmBpyC,EAAIkH,OAAS/O,EAAM+O,OAAS,EACnDtM,EAAKF,OAAOmzB,aAAeukB,EAC3Bx3C,EAAK6O,aAEElQ,KACFF,EAAKE,GAAG,IAAMpB,EAAM+O,SACvB7N,EAAKE,GAAG,IAAM64C,GAEX9lC,EAGJjT,EAAKiE,WAALjE,IAAaM,IAFbiB,EAAK8C,UAAU,oBAAqB,CAACopB,EAAQ3uB,EAAO6H,EAAK,OArFxDmyC,CAAWrrB,EAAQ3uB,EAAO6H,EAAKpF,EAAMwb,EAAGzD,EAAGtZ,GACtB,OAAbytB,EAAOnrB,MAyFlB,SAAS02C,EAAWvrB,EAAQ3uB,EAAO6H,EAAKpF,EAAM0R,EAAQ3S,EAAON,OACxDE,EAAIF,EAAKG,OACT84C,EAAmBtyC,EAAIkH,OAAS/O,EAAM+O,OAAS,KAE/CtM,EAAKF,OAAOmzB,cAAgBykB,EAAiB,IAC5Cn6C,EAAM+O,QAAUlH,EAAIkH,OACvB,OAEDlH,EAAIkH,SACJorC,IAGD13C,EAAKF,OAAOmzB,aAAeykB,EAG3B13C,EAAK6O,YACD8oC,EAAU,QAEPh5C,KACFF,EAAKE,GAAG,IAAMpB,EAAM+O,QAAU7N,EAAKE,GAAG,IAAMyG,EAAIkH,OACnDqrC,EAAQj1C,KAAKjE,EAAKwtB,OAAOttB,EAAG,GAAG,IACvBF,EAAKE,GAAG,GAAKyG,EAAIkH,SACzB7N,EAAKE,GAAG,IAAM+4C,GAEXhmC,GACJ1R,EAAK8C,UAAU,oBAAqB,CAACopB,EAAQ3uB,EAAO6H,EAAKuyC,IAjHxDF,CAAWvrB,EAAQ3uB,EAAO6H,EAAKpF,EAAMwb,EAAGzD,EAAGtZ,GAC3CojB,GAASA,IAEgB,OAAhBqK,EAAOhjB,QACjB2Y,EAAQzc,EAAIiH,IAAM9O,EAAM8O,IAAM,EAC9B0D,EAASxS,EAAM8O,IAEE,OAAb6f,EAAOnrB,GA6Gb,SAAS62C,EAAQ1rB,EAAQ3uB,EAAO6H,EAAKpF,EAAM0R,EAAQ3S,EAAON,OACrDE,EAAIF,EAAKG,OACTi5C,EAAgBzyC,EAAIiH,IAAM9O,EAAM8O,IAAM,EAC1CrM,EAAKF,OAAOozB,UAAY2kB,EAExB73C,EAAK6O,aAEElQ,KACFF,EAAKE,GAAG,IAAMpB,EAAM8O,MACvB5N,EAAKE,GAAG,IAAMk5C,GAEXnmC,EAGJjT,EAAKiE,WAALjE,IAAaM,IAFbiB,EAAK8C,UAAU,iBAAkB,CAACopB,EAAQ3uB,EAAO6H,EAAK,OAxHrDwyC,CAAQ1rB,EAAQ3uB,EAAO6H,EAAKpF,EAAMwb,EAAGzD,EAAGtZ,GACnB,OAAbytB,EAAOnrB,MA6HlB,SAAS+2C,EAAQ5rB,EAAQ3uB,EAAO6H,EAAKpF,EAAM0R,EAAQ3S,EAAON,OACrDE,EAAIF,EAAKG,OACTm5C,EAAgB3yC,EAAIiH,IAAM9O,EAAM8O,IAAM,KAEtCrM,EAAKF,OAAOozB,WAAa6kB,EAAc,IACtCx6C,EAAM8O,KAAOjH,EAAIiH,IACpB,OAEDjH,EAAIiH,MACJ0rC,IAGD/3C,EAAKF,OAAOozB,UAAY6kB,EAExB/3C,EAAK6O,YAED8oC,EAAU,QACPh5C,KACFF,EAAKE,GAAG,IAAMpB,EAAM8O,KAAO5N,EAAKE,GAAG,IAAMyG,EAAIiH,IAChDsrC,EAAQj1C,KAAKjE,EAAKwtB,OAAOttB,EAAG,GAAG,IACvBF,EAAKE,GAAG,GAAKyG,EAAIiH,MACzB5N,EAAKE,GAAG,IAAMo5C,GAEXrmC,GACJ1R,EAAK8C,UAAU,iBAAkB,CAACopB,EAAQ3uB,EAAO6H,EAAKuyC,IApJrDG,CAAQ5rB,EAAQ3uB,EAAO6H,EAAKpF,EAAMwb,EAAGzD,EAAGtZ,GACxCojB,GAASA,QAKPif,EAAS,CAAE//B,GAAGmrB,EAAOhjB,MAAO3L,MAAMwS,EAAQ8R,MAAMA,OACpDljB,EAAIF,EAAKG,OACFD,KACFF,EAAKE,GAAG,IAA4B,iBAAfF,EAAKE,GAAG,IAA8C,KAA3BF,EAAKE,GAAG,GAAGyM,OAAO,EAAG,KACxE3M,EAAKE,GAAG,GAAKgjC,GAAWljC,EAAKE,GAAG,GAAImiC,OAGtC9gC,EAAK8C,UAAU,WAAY,CAAC,cAAc,CAAC/D,MAAOs4C,EAASvkB,SAAUskB,KAErE5c,GAAW,WACVwd,GAAgBh4C,EAAMo3C,GACtBp3C,EAAKgR,OAAOqtB,SAAS9Z,EAAM3b,EAAG2b,EAAM5b,IACnC3I,GAEEa,EAAO,KACN4uB,EAAOzvB,EAAK+B,GAAG,UACnBlB,EAMF,SAASo3C,EAAcp3C,EAAQ4uB,OAC1BpuB,EAAOouB,EAAK5N,QACZlhB,EAAO8uB,EAAK3vB,OAAO+sB,QAAQjuB,cACV,EAAjBiC,EAAOtD,MAAM8O,IAAQhL,EAAa,KACnB,EAAfR,EAAOuE,IAAIiH,IAAQhL,EAAa,KACZ,EAApBR,EAAOtD,MAAM+O,OAAW3L,EAAa,KACnB,EAAlBE,EAAOuE,IAAIkH,OAAW3L,EAAa,KAEhCE,EAdGo3C,CAAcp3C,EAAQ4uB,KAE9BA,EAAKxB,cAAcptB,EAAOtD,MAAOsD,EAAOuE,MAe3C,SAAS4yC,GAAgBh4C,EAAMvB,GAG9BsxC,GAAY,WACX/vC,EAAKqf,iBAAmB,KACxBrf,EAAKszB,MAAM70B,gCA5HN,SAASuL,GAAKhK,GACpBA,EAAKmD,YAAY,YAAa,SAAC+oB,EAAQ3uB,EAAO6H,MAC5B,OAAb8mB,EAAOnrB,IAA4B,OAAbmrB,EAAOnrB,GAAY,KACxCuN,EAAOtO,EAAKgR,OAAOvC,iBACpBH,GAAU/Q,GAAS6H,IACrB7H,EAAQ+Q,EAAK/Q,MACb6H,EAAMkJ,EAAKlJ,KAGR7H,GAAS6H,GACZ8D,EAAMC,IAAI,WACTguC,GAAQjrB,EAAQ3uB,EAAO6H,EAAKpF,QAMhCA,EAAKmD,YAAY,SAAU,SAAC+oB,EAAQ7f,EAAKC,EAAQvN,GACnC,eAAVmtB,IACFuV,IAAe,GACfuW,GAAgBh4C,EAAKjB,oBC+HjB,SAASm5C,GAAUl4C,EAAMjB,OAC3BkiC,EAAOkX,GAASn4C,UAEpBjB,EAAQq5C,GADM/nC,GAAOtR,EAAOkiC,EAAM,IACT92B,QAAS82B,GAgEnC,SAASmX,GAASv9B,EAASomB,OACtBliC,EACAs5C,EAAQp5C,MAAMC,KAAKC,YAAYI,MAAM,kBAExCR,EAAQ8b,EAAQ/W,KAAKm9B,GACpB,MAAMzlB,UAEA68B,QAGa,iBAAVt5C,EACNu5C,SAASv5C,GAENnB,KAAKI,MAAY,IAANe,GAAc,IAFJs5C,EAGD,iBAAVt5C,EACVA,EAAQA,EAAMX,WAAai6C,EAE3Bt5C,EAIT,SAASo5C,GAASn4C,OACbmiB,EAAS1Y,GAAmBzJ,SAEzB,CACNu4C,GAAG,SAAShtC,EAAOuB,EAAIC,EAAIC,EAAIC,UACvBxD,GAAmBzJ,EAAMuL,GAAO23B,SAASp2B;CAAGC,EAAGC,EAAGC,IAE1D8K,EAAEoK,EAAO+gB,SACTsV,GAAG,SAASjtC,EAAOwM,EAAGC,UACdvO,GAAmBzJ,EAAMuL,GAAOzJ,SAASiW,EAAEC,IAEnD1Z,EAAE6jB,EAAOrgB,SACT22C,EAAErf,GACF3D,EAAE,GACFja,EAAE,SAASA,SAASA,+BAxPf,SAASxR,GAAKhK,OAChBshC,EAAW,GACXoX,EAAW,GACXC,GAAY,EAEhB34C,EAAKuiC,gBAAkB,OAqCnBqW,EACAC,EAnCA5X,EAAOkX,GAASn4C,YAqCX84C,EAAU/gC,EAAGC,EAAG7N,OAClBkC,EAAMrM,EAAKsP,OAAOyI,GAClBhZ,EAAQq5C,GAASjuC,EAAS82B,GAChC50B,EAAI2L,GAAKjZ,MAEHg6C,EAAS,IAAF/gC,EAAYD,EACnB8J,EAAQg3B,EAAcE,IAASF,EAAcE,IAAS,GAAK,EAE7DH,EAAWG,KAAUh6C,GAAiB,IAAR8iB,IAQlC+2B,EAAWG,GAAQh6C,EAEnBi6C,EAAcjhC,EAAGC,aAITghC,EAAcC,EAAMC,OAItB1jC,EAAO8rB,EAAS2X,MAClBzjC,EAAK,KACFsX,EAAQtX,EAAK0jC,MACfpsB,MACE,IAAInuB,EAAI,EAAGA,EAAImuB,EAAMluB,OAAQD,IAAI,OACNmuB,EAAMnuB,GAA9B0N,IAAAA,IAAKC,IAAAA,OAAQnC,IAAAA,QAChBkC,GAAO4sC,GAAQ3sC,GAAU4sC,GAC5BJ,EAAUzsC,EAAKC,EAAQnC,cAOnBgvC,IACR7X,EAAW,GACXoX,EAAW,OAEPjpB,EAAOzvB,EAAK+B,GAAG,SACfwiB,EAAQkL,EAAK2pB,WACbvsB,EAAUtI,EAAMgM,IAAI1xB,OAAO0lB,EAAM8B,QAErCoJ,EAAKpB,QAAQ,SAASvtB,WACjBwG,EAAOpG,KAAK+W,QAAQnX,GACfnC,EAAE,EAAGA,EAAEkuB,EAAQjuB,OAAQD,IAAI,KAC/BsR,EAAM4c,EAAQluB,GACdI,EAAQuI,EAAK,IAAI2I,GACjBlR,GACHs6C,EAAYv4C,EAAKmP,EAAKlR,MAEtB,YAQKs6C,EAAYthC,EAAEC,EAAEjZ,MAEpB45C,GAAa55C,GAA0B,iBAAVA,GAA6C,IAAvBA,EAAMmJ,QAAQ,KACpElI,EAAKsP,OAAOyI,GAAG,IAAIC,GAAKjZ,WAMrByW,EAAOkjC,EAAS3gC,MAChBvC,GAAQA,EAAKwC,IA2EnB,SAASshC,EAAgBC,EAAKC,EAAMxhC,EAAGD,OAElC0hC,EAAOD,EAAKzhC,GAAGC,GACnBwhC,EAAKzhC,GAAGC,GAAK,SAGR,IAAIrZ,EAAI86C,EAAK76C,OAAS,EAAQ,GAALD,EAAQA,YACjC0P,EAAOorC,EAAK96C,GACZmuB,EAAQysB,EAAIlrC,EAAK,IAAIA,EAAK,IAErBsJ,EAAImV,EAAMluB,OAAO,EAAQ,GAAL+Y,EAAQA,IAAI,KACpC+hC,EAAQ5sB,EAAMnV,GACd+hC,EAAMrtC,KAAO0L,GAAK2hC,EAAMptC,QAAU0L,GACrC8U,EAAMb,OAAOtU,EAAE,IAvFhB2hC,CAAgBhY,EAAUoX,EAAU1gC,EAAGD,GAGpChZ,GAEe,GADlBA,EAAQA,EAAMX,YACLQ,QAAqC,IAAvBG,EAAMmJ,QAAQ,KAAW,KAC3C2S,EAAUxK,GAAOtR,EAAOkiC,EAAM,IAC9B50B,EAAMrM,EAAKsP,OAAOyI,GACtB1L,EAAI2L,GAAKogC,GAASv9B,EAAQ1Q,QAAS82B,GACnC50B,EAAI,IAAI2L,GAAK6C,EAAQ/V,KAEjB+V,EAAQymB,SAAS1iC,QAuBzB,SAAS+6C,EAAaJ,EAAKC,EAAMC,EAAMprC,EAAM8T,WAIxCy3B,EAAQ,GACHj7C,EAAI,EAAGA,EAAI86C,EAAK76C,OAAQD,IAAI,KAChC6W,EAAOikC,EAAK96C,MAIA,KAAZ6W,EAAK,IAAaA,EAAK,KAAO2M,MAG7B,IAAIxK,EAAInC,EAAK,GAAImC,GAAGnC,EAAK,GAAImC,IAAI,KACjCq4B,EAAOuJ,EAAI5hC,GACVq4B,IAAMA,EAAOuJ,EAAI5hC,GAAG,QACpB,IAAIkC,EAAIrE,EAAK,GAAIqE,GAAKrE,EAAK,GAAIqE,IAAI,KACnCiT,EAAQkjB,EAAKn2B,GACZiT,IACJA,EAAQkjB,EAAKn2B,GAAK,IAEnB+/B,EAAMl3C,KAAK,CAACiV,EAAGkC,IACfiT,EAAMpqB,KAAK2L,MAUf,SAASwrC,EAAcL,EAAMntC,EAAKC,EAAQmtC,OACrCjkC,EAAOgkC,EAAKntC,GACXmJ,IACJA,EAAOgkC,EAAKntC,GAAO,IACpBmJ,EAAKlJ,GAAUmtC,EARfI,CAAcL,EAAMnrC,EAAKhC,IAAKgC,EAAK/B,OAAQstC,GAlDvCD,CAAarY,EAAUoX,EAAU79B,EAAQymB,SACxC,CAAEj1B,IAAK0L,EAAGzL,OAAQ0L,EAAG7N,QAAS0Q,EAAQ1Q,SAAWnK,EAAKuK,kBAK1DquC,EAAa,GACbC,EAAgB,GAChBG,EAAcjhC,EAAGC,IAjIlBhY,EAAK0L,OAASu1B,EAAKv1B,OAAS,IAAIwjC,GAAWlvC,GAE3CihC,EAAKxL,ECpBC,SAASzrB,EAAKhK,OAChB85C,EAAU,UAEd95C,EAAK+5C,eAAiB,SAASj5C,EAAK/B,MAChB,WAAfyH,EAAO1F,GACV,IAAK,IAAImP,KAAOnP,EACfg5C,EAAQ7pC,EAAIhI,eAAiBnH,EAAImP,QAElC6pC,EAAQh5C,EAAI1C,WAAW6J,eAAiBlJ,EAEzCiB,EAAK8C,UAAU,gBAAgB,KAGzBg3C,EDOEE,CAASh6C,GAElBA,EAAKmD,YAAY,UAAW,WAC3Bm+B,EAAW,GACXoX,EAAW,GACXC,GAAY,EACZ34C,EAAK0L,OAAO2vB,UAGbr7B,EAAKmD,YAAY,wBAkFRs3B,EAAW1iB,EAAGC,GAEtBqhC,EAAYthC,EAAGC,EAAGhY,EAAKmf,aAAapH,EAAGC,MAnFxChY,EAAKmD,YAAY,gBAAiB,WACjCg2C,IACAn5C,EAAK+B,GAAG,SAAS+G,YAGlB9I,EAAKmD,YAAY,kBAAmB,SAAC1E,UAgOtC,SAAS2T,EAAWpS,EAAMc,GACzBA,EAAI4K,OAAS1L,EAAK0L,OAAOlC,YAjOqB4I,CAAWpS,EAAMvB,KAC/DuB,EAAKmD,YAAY,cAAe,SAAC1E,GAChCuB,EAAK0L,OAAO4nB,MAAM70B,EAAKiN,QACvBitC,GAAY,EACZQ,MAGDn5C,EAAKmD,YAAY,WAAY,SAAC+oB,EAAQuJ,GACxB,sBAAVvJ,IACFuV,IAAe,GA2NlB,SAASkF,EAAehnC,EAAMiN,EAAKnO,EAAMlB,WACpCmO,EAASjN,EAAKiN,OACV/M,EAAE,EAAGA,EAAI+M,EAAO9M,OAAQD,IAC/B+M,EAAO/M,GAAG,GAAKgO,EAAYjB,EAAO/M,GAAG,GAAGgB,EAAKiN,EAAKrP,GA7NjDopC,CAAelR,EAAE91B,KAAK81B,EAAE7oB,IAAI6oB,EAAEh3B,KAAMg3B,EAAEl4B,mBrBxBzByM,EAAKhK,EAAMihC,EAAMuB,GAChCxiC,EAAKmD,YAAY,oBAAqB,kBAC9BnD,EAAKuiC,gBAAgB3D,GAAU5+B,MAEvCA,EAAKmD,YAAY,gBAAiB,SAASxD,EAAMyK,GAChDpK,EAAKo9B,QAAQnb,QAAQ,SAAC1W,OACjBwH,EAAQ,CAACsvB,YAAW,GACX,CAAC,OAAQ,UAAW,aAAc,UAC1CpgB,QAAQ,SAACg4B,GACV1uC,EAAM9F,QAAQw0C,IAChB1uC,EAAM9F,QAAQw0C,GAAOh4B,QAAQ,SAACljB,UACrBk7C,OACF,OACe,MAAhBl7C,EAAM,GAAG,KACXA,EAAM,GAAKmjC,GAAiBnjC,EAAM,GAAIY,EAAMyK,EAAS2I,cAElD,cACEhT,EAAUhB,EAAM,GAAGgB,WACtBA,KACmB,iBAAXA,EACThB,EAAM,GAAGgB,QAAUmiC,GAAiBniC,EAASJ,EAAMyK,EAAS2I,QAE5D,IAAK,IAAIpU,EAAI,EAAGA,EAAIoB,EAAQnB,OAAQD,IAAI,KACjCu7C,EAA8B,iBAAdn6C,EAAQpB,GAAiBoB,EAAQpB,GAAKoB,EAAQpB,GAAGI,MACvEgB,EAAQpB,GAAKujC,GAAiBgY,EAAQv6C,EAAMyK,EAAS2I,aAKpD,aACe,MAAhBhU,EAAM,GAAG,KACXA,EAAM,GAAKmjC,GAAiBnjC,EAAM,GAAIY,EAAMyK,EAAS2I,cAElD,SACJhU,EAAM,GAAKmjC,GAAiBnjC,EAAM,GAAIY,EAAMyK,EAAS2I,SAKlC,IAArBA,EAAMsvB,oBACDriC,EAAKuiC,gBAAgBh3B,EAAM5L,MAClC2iC,GAAYtiC,EAAMuL,EAAM5L,MACxB8hC,eAGKzhC,EAAKuiC,gBAAgB5iC,KAE7BK,EAAKmD,YAAY,gBAAiB,SAASxD,UACnCK,EAAKuiC,gBAAgB5iC,KAG7BK,EAAK6iC,eAAiB5B,EACtBjhC,EAAK4iC,kBAAoBJ,EqB6EzB/4B,CAAYzJ,EAAMihC,EAAM,CAAE3N,MAAOjjB,GAAQ2yB,QAASoV,qBE7FnD,SAASj5B,GAAanf,EAAMjB,UACxBR,MAAY,EAANQ,GACe,KAAnBA,EAAM6I,OAAO,KAChB7I,EAAQm5C,GAAUl4C,EAAMjB,IAIzBA,GAAc,EAERA,EAyCD,SAASo7C,GAAgBn6C,EAAMqM,EAAKC,OACtChL,EAAM,OAELtB,EAAKypC,WAAW2Q,OAAO,KACrB7N,EAAavsC,EAAKypC,WAAWxZ,IAAI5jB,EAAKC,MACzCigC,EAAW,KACP/8B,EAAOxP,EAAK+B,GAAG,SAAS0N,QAAQpD,EAAKC,GACvCvN,EAAQiB,EAAKsP,OAAOjD,GAAKC,GACzBvN,GAAmB,IAAVA,IACZA,EAAQ,QAEJ,IAAIJ,EAAI4tC,EAAW3tC,OAAS,EAAQ,GAALD,EAAQA,IAAI,KACzCwL,EAAUnK,EAAKypC,WAAW4Q,SAAS9N,EAAW5tC,GAAG,QAEnD2C,GAAO6I,GAAWA,EAAQpL,EAAOwtC,EAAW5tC,GAAG,IAAI,IACtD2C,EAAMirC,EAAW5tC,GAAG,IAChB6Q,EACH,MACDi4B,GAAWznC,EAAMqM,EAAKC,EAAQigC,EAAW5tC,GAAG,IAAI,QAGhD8oC,GAAWznC,EAAMqM,EAAKC,EAAQigC,EAAW5tC,GAAG,IAAI,YAI7C2C,EAIR,SAASg5C,GAAmB90B,EAAMnZ,EAAKC,EAAQiY,UAC9CA,EAAM61B,QAAS,EACX50B,EAAKnZ,KACRmZ,EAAKnZ,GAAO,IACTmZ,EAAKnZ,GAAKC,KACbkZ,EAAKnZ,GAAKC,GAAU,IACdkZ,EAAKnZ,GAAKC,GAIlB,SAASgnB,GAAM70B,WACT27C,QAAS,EACT37C,UAEDE,EAAIF,EAAKG,OACPD,KAAI,KACLqZ,EAAIvZ,EAAKE,GACI27C,GAAmBp5C,KAAKovC,MAAMt4B,EAAE,GAAGA,EAAE,GAAG9W,MAC9CwB,KAAK,CAACsV,EAAE,GAAGA,EAAE,GAAGA,EAAE,MAI/B,SAASqjB,UACHiV,MAAQ,GAGd,SAASxP,GAAOz0B,EAAKC,EAAQ8qC,GACXl2C,KAAK+uB,IAAI5jB,EAAKC,IAE9BguC,GAAmBp5C,KAAKovC,MAAOjkC,EAAKC,EAAQpL,WACxCovC,MAAMjkC,GAAKC,GAAU8qC,EAG3B,SAASnnB,GAAIsqB,EAAOppB,UACfopB,EAEAppB,EAEGjwB,KAAKovC,MAAMiK,GAAOr5C,KAAKovC,MAAMiK,GAAOppB,GAAU,KAD7CjwB,KAAKovC,MAAMiK,GAFXr5C,KAAKovC,MAMd,SAAS9T,GAAI+d,EAAOppB,EAAU/b,EAAWrW,EAAO0F,GAC9B61C,GAAmBp5C,KAAKovC,MAAOiK,EAAOppB,EAAUjwB,MACtDwB,KAAK,CAAC0S,EAAWrW,EAAO0F,IAGpC,SAASoa,GAAO07B,EAAOppB;EACLjwB,KAAK+uB,IAAIsqB,EAAOppB,WAEzBjwB,KAAKovC,MAAMiK,GAAOppB,GAG3B,SAAS3nB,SACJ8C,EAAQ8I,EAAWzW,EAAG0N,EACzB5N,EAAO,OAEH4N,KAAOnL,KAAKovC,UACXhkC,KAAUpL,KAAKovC,MAAMjkC,OACrB1N,EAAE,EAAGA,EAAIuC,KAAKovC,MAAMjkC,GAAKC,GAAQ1N,OAAQD,IAC5CyW,EAAYlU,KAAKovC,MAAMjkC,GAAKC,GAAQ3N,GACpCF,EAAKiE,KAAK,CAAC2J,EAAIC,EAAQ8I,EAAU,GAAGA,EAAU,GAAGA,EAAU,YAGvD3W,EA2BD,SAAS+7C,GAAwBx6C,EAAMqL,GAC7CnC,EAAMC,IAAI,WACToD,EAAUlB,EAAOrL,EAAM,SAASA,EAAMqO,OACjC+G,EAAYpV,EAAKypC,WAAWxZ,IAAI5hB,EAAKhC,IAAKgC,EAAK/B,QAChD8I,GACFqlC,GAAiB,SAAUpsC,EAAKhC,IAAKgC,EAAK/B,OAAQ8I,EAAW,KAAMpV,KAErEA,EAAK8I,YAIA,SAAS4xC,GAAe16C,EAAM+S,EAAO1G,EAAKlB,EAAK88B,OACjD7yB,EAAYrC,EAAMqC,UAEtBqlC,GAAiB,SAAUpuC,EAAKlB,EADfnL,EAAKypC,WAAWxZ,IAAI5jB,EAAIlB,IACS,KAAOiK,EAAWpV,GACtD,IAAXioC,GACFwS,GAAiB,SAAU1nC,EAAM1G,IAAK0G,EAAM5H,IAAKiK,EAAW,KAAMpV,GAI7D,SAASy6C,GAAiB96C,EAAM0M,EAAKC,EAAQquC,EAAcC,EAAc56C,GAC3EA,EAAK8C,UAAU,uBAAwB,CAACuJ,EAAKC,EAAQquC,EAAcC,MACtE56C,EAAKypC,WAAW9pC,GAAMoF,MAAM/E,EAAKypC,WAAY,CAACp9B,EAAKC,EAAQsuC,IAC3D56C,EAAK8C,UAAU,sBAAuB,CAACuJ,EAAKC,EAAQquC,EAAcC,gCApP7D,SAAS5wC,GAAKhK,GACpBA,EAAKypC,WAAa,CACjB2Q,QAAO,EACP9J,MAAO,GACP+J,SAAU,KACJ,SAASpzC,EAAEqQ,UACRrQ,EAAIkY,GAAanf,EAAMsX,QAE1B,SAASrQ,EAAEqQ,UACRrQ,EAAIkY,GAAanf,EAAMsX,QAE1B,SAASrQ,EAAEqQ,UACRrQ,GAAKkY,GAAanf,EAAMsX,SAE1B,SAASrQ,EAAEqQ,UACTrQ,GAAKkY,GAAanf,EAAMsX,SAE1B,SAASrQ,EAAEqQ,UACTrY,MAAM4D,QAAQyU,IAAMrQ,EAAIkY,GAAanf,EAAMsX,EAAE,KAAOrQ,EAAIkY,GAAanf,EAAMsX,EAAE,MAGtFklB,IAAKA,GACL3d,OAAQA,GACRiiB,OAAQA,GACR7Q,IAAKA,GACLqD,MAAOA,GACP9pB,UAAWA,GACX6xB,MAAOA,IAGRr7B,EAAKmD,YAAY,iBAAkB,SAAC1E,UAsCrC,SAASouC,EAAc7sC,EAAMvB,GAC5ByK,EAAMC,IAAI,WACTnJ,EAAKiS,iBAAiB,SAAC5D,OAChBk+B,EAAavsC,EAAKypC,WAAWxZ,IAAI5hB,EAAKhC,IAAKgC,EAAK/B,WACnDigC,EACF,IAAK,IAAI5tC,EAAI,EAAGA,EAAI4tC,EAAW3tC,OAAQD,IACtC8oC,GAAWznC,EAAMqO,EAAKhC,IAAKgC,EAAK/B,OAAQigC,EAAW5tC,GAAG,IAAI,GAC5D87C,GAAiB,SAAUpsC,EAAKhC,IAAKgC,EAAK/B,OAASigC,GAAY,KAAO9tC,EAAMuB,OAG9EA,EAAK8I,UAhDwC+jC,CAAc7sC,EAAMvB,KAEjEuB,EAAKmD,YAAY,SAAU,SAAC03C,EAAaxuC,EAAKC,EAAQvN,GACnC,aAAf87C,GAgDL,SAASC,EAAe96C,EAAMqM,EAAKC,EAAQvN,GACvCiB,EAAKypC,WAAWxZ,IAAI5jB,EAAKC,IAC3BtM,EAAKypC,WAAW5qB,OAAOxS,EAAKC,GAC1BvN,GACFiB,EAAKypC,WAAW3I,OAAOz0B,EAAKC,EAAQvN,GAnDnC+7C,CAAe96C,EAAMqM,EAAKC,EAAQvN,KAGpCiB,EAAKmD,YAAY,kBAAmB,SAAC1E,UAmDtC,SAAS2T,EAAWpS,EAAMc,GACzBA,EAAI2oC,WAAazpC,EAAKypC,WAAWjgC,YApDa4I,CAAWpS,EAAMvB,KAC/DuB,EAAKmD,YAAY,cAAe,SAAC1E,UAsDlC,SAAS4R,EAAOrQ,EAAMc,GACrBd,EAAKypC,WAAWnW,MAAMxyB,EAAI2oC,YAvDgBp5B,CAAOrQ,EAAMvB,KAEvDuB,EAAKmD,YAAY,eAAgB,SAACmJ,UAwDnC,SAASyuC,EAAc/6C,EAAKsM,GAC3BA,EAAO0uC,UAAY,SAAUj8C,EAAO+B,EAAKuL,EAAKC,UACtC6tC,GAAgBn6C,EAAMqM,EAAKC,IA1DUyuC,CAAc/6C,EAAMsM,KAEjEtM,EAAKmD,YAAY,UAAW,kBAAMnD,EAAKypC,WAAWpO,UAElDr7B,EAAKmD,YAAY,WAAY,SAAC+oB,EAAQuJ,GACxB,sBAAVvJ,GAwJL,SAASya,EAAehnC,EAAMiN,EAAKnO,EAAMlB,OACpCksC,EAAahrC,EAAKgrC,WACrB9qC,EAAI8qC,EAAW7qC,UAEbgO,OACIjO,KAAI,SACU8qC,EAAW9qC,MAAzB0N,OAAIC,QACE,OAAR3M,GAAiB0M,GAAM9O,EAAM8O,KAAe,UAAR1M,GAAoB2M,GAAU/O,EAAM+O,UAC9D,OAAR3M,EACC0M,EAAM9O,EAAM8O,IAAMO,EACrB68B,EAAWxd,OAAOttB,EAAE,GAEpB8qC,EAAW9qC,GAAG,GAAS,EAAJ0N,EAAQO,EACV,UAARjN,IACN2M,EAAS/O,EAAM+O,OAASM,EAC3B68B,EAAWxd,OAAOttB,EAAG,GAErB8qC,EAAW9qC,GAAG,GAAY,EAAP2N,EAAWM,KAxKjC+5B,CAAelR,EAAE91B,KAAK81B,EAAE7oB,IAAI6oB,EAAEh3B,KAAMg3B,EAAEl4B,SAkBzC,SAASsR,EAAM7O,GACdA,EAAKypC,WAAWpO,QAhBhBxsB,CAAM7O,0FCmBP,SAAS6O,GAAM7O,GACdA,EAAKgR,OAAOiqC,WAAa,GAuBnB,SAASC,GAAal7C,EAAMqL,GAClCrL,EAAKgR,OAAO0gB,WACZnlB,EAAUlB,EAAOrL,EAAM,SAASA,EAAMqO,OACjC9G,EAASvH,EAAKgR,OAAOiqC,WAAW5sC,EAAKhC,KACrC9E,GACCA,EAAO8G,EAAK/B,iBACR/E,EAAO8G,EAAK/B,QACnBtM,EAAKgR,OAAOke,cAAc7gB,EAAKhC,IAAKgC,EAAK/B,OAAQ,aACjDm7B,GAAWznC,EAAMqO,EAAKhC,IAAKgC,EAAK/B,OAAQ,aAAa,MAyClD,SAAS6uC,GAAcn7C,EAAM+S,EAAO1G,EAAKlB,EAAK88B,OAC9C1gC,EAASwL,EAAMqoC,SAErBp7C,EAAK66B,cAAcxuB,EAAKlB,EAAK5D,GACd,IAAX0gC,GACHjoC,EAAK66B,cAAc9nB,EAAM1G,IAAK0G,EAAM5H,IAAK,QChJvCkwC,GAAWC,GAAUvrC,GAAQk4B,GAAQsT,0BDDlC,SAASvxC,GAAKhK,OACdT,EAAQS,EAAKgR,OAEnBhR,EAAKmD,YAAY,UAAW,kBAAM0L,GAAM7O,KACxC6O,GAAM7O,GAENT,EAAM4D,YAAY,oBAAqB,SAASpC,OAC3CoK,EAAMjK,KAAKktB,gBAAgBrtB,EAAGuL,WAC9BpL,KAAK+5C,WAAWl6C,EAAGsL,KAAK,KACvBqkB,EAAKxvB,KAAK+5C,WAAWl6C,EAAGsL,KAAKtL,EAAGuL,QAChCokB,IACHzxB,MAAMiU,OAAO/H,EAAKulB,GAAI,GACtBzxB,MAAMiU,OAAO/H,EAAK,CAACkB,IAAKrM,EAAKsP,OAAOvO,EAAGsL,OAAO,GAC1CqkB,EAAG3wB,UACmB,iBAAd2wB,EAAG3wB,QACboL,EAAIpL,QAAU4jC,GAAa3jC,EAAM0wB,EAAG3wB,QAAS,CAAE6jC,QAAO,EAAMnsB,OAAM,EAAMosB,OAAM,IACtE5kC,MAAM4D,QAAQ6tB,EAAG3wB,WACzBoL,EAAIpL,QAAU4jC,GAAa3jC,EAAM0wB,EAAG3wB,QAAS,CAAE8jC,OAAM,UAO1DtkC,EAAM4D,YAAY,mBAAoB,SAASohB,EAAOhd,EAAQi0C,OACxDA,GAAUj0C,EAAOuL,UAAU,KACzB/T,EAAQwI,EAAOzF,WACjB4O,EAASnJ,EAAOuL,UAAU/T,GAE9BmK,EAAMC,IAAI,WACTnJ,EAAKof,aAAa7X,EAAO8E,IAAK9E,EAAO+E,OAAQvN,GACzC2R,EACH2E,GAAcrV,EAAMuH,EAAO8E,IAAK9E,EAAO+E,OAAQ+I,GAAoB3E,IAEnE2E,GAAiBrV,EAAMuH,EAAO8E,IAAK9E,EAAO+E,cAGtC+B,EAAOrO,EAAKqC,gBACdgM,GAAQA,EAAKhC,KAAO9E,EAAO8E,KAAOgC,EAAK/B,QAAU/E,EAAO+E,SAE3DoE,EAAS2E,GADT3E,EAASA,GAAU,UACa,SAAWA,EAC3C1Q,EAAK8C,UAAU,YAAa,CAAC,CAAC/B,GAAG,iBAAkBpB,KAAK,SAAUZ,MAAM2R,SAK3EnR,EAAM4D,YAAY,kBAAmB,SAASohB,EAAOhd,OAC9C4D,EAAMjK,KAAKktB,gBAAgB7mB,EAAO+E,QAExCnB,EAAI5D,OAAS,cACN4D,EAAI5G,aAAc4G,EAAIswC,cAAetwC,EAAIkB,MAGjDrM,EAAKmD,YAAY,SAAU,SAACF,EAAMoJ,EAAKC,EAAQvN,GAClC,YAARkE,GACHjD,EAAK66B,cAAcxuB,EAAKC,EAAQvN,KAGlCiB,EAAKmD,YAAY,WAAY,SAAC+oB,EAAQuJ,GACvB,YAAVvJ,EACHub,GAAWznC,EAAMy1B,EAAEppB,IAAKopB,EAAEnpB,OAAQ,YAAampB,EAAE3C,UAE/B,sBAAV5G,GAiDX,SAASya,EAAehnC,EAAMiN,EAAKnO,EAAMlB,OAClC8pB,EAAU5oB,EAAK4oB,WAEjBza,MAEC,IAAIjO,EAAE0oB,EAAQzoB,OAAO,EAAM,GAAHD,EAAMA,IAAI,SACX0oB,EAAQ1oB,MAA7B0N,OAAIC,OAAO/E,UACJ,OAAR5H,GAAiB0M,GAAO9O,EAAM8O,KAAe,UAAR1M,GAAoB2M,GAAU/O,EAAM+O,OAAO;GAEvE,OAAR3M,EAAc,IACb0M,EAAM9O,EAAM8O,IAAMO,EAAI,CACzBya,EAAQ4E,OAAOttB,EAAE,YAGjB0oB,EAAQ1oB,GAAG,GAAS,EAAJ0N,EAAQO,OAErB,GAAY,UAARjN,EAAiB,IACrB2M,EAAS/O,EAAM+O,OAASM,EAAI,CAC/Bya,EAAQ4E,OAAOttB,EAAG,YAGlB0oB,EAAQ1oB,GAAG,GAAY,EAAP2N,EAAWM,EAE7BrF,EAAOxH,QAAU4M,EAAYpF,EAAOxH,QAASJ,EAAMiN,EAAKrP,KAvEzDopC,CAAelR,EAAE91B,KAAK81B,EAAE7oB,IAAI6oB,EAAEh3B,KAAMg3B,EAAEl4B,oBAQlC,SAASiM,GAAUxJ,EAAKvB,OAC1B4N,EAAKC,EACRovC,EAAa17C,EAAKgR,OAAOiqC,WACzB5zB,EAAU,OAENhb,KAAOqvC,MACNpvC,KAAUovC,EAAWrvC,GACzBgb,EAAQ3kB,KAAK,CAAC2J,EAAKC,EAAQovC,EAAWrvC,GAAKC,KAE7C7N,EAAK4oB,QAAUA,QAGT,SAAS7M,GAAKxa,EAAKvB,OACnB4oB,EAAU5oB,EAAK4oB,WAEjBA,EACH,IAAK,IAAI1oB,EAAE,EAAGA,EAAE0oB,EAAQzoB,OAAQD,IAC/BqB,EAAK66B,cAAc91B,MAAM/E,EAAMqnB,EAAQ1oB,8BAiBnC,SAASg9C,GAAS37C,EAAMqM,EAAKC,OAC7B/E,EAASvH,EAAKgR,OAAOiqC,kBACpB1zC,EAAO8E,MAAU9E,EAAO8E,GAAKC,uBCZrC,SAASsvC,GAAkB57C,EAAMqM,EAAKlB,EAAK0wC,EAAOC,EAAW5T,OACxDpV,EAAW+oB,KAEM,WAAjBr1C,EAAOq1C,GAAmB,IAE5B/oB,EADG+oB,EAAMzrB,KACEuR,GAAWka,EAAMzrB,KAAM8X,EAAWn4B,IAElC8rC,EAAM/2C,KAEf+2C,EAAMp3C,OAASo3C,EAAMp3C,MAAMqL,MAAM,KAC7BrL,EAAQzE,EAAK6P,SAASgsC,EAAMp3C,MAAMqL,OACxC9P,EAAK2Q,SAAStE,EAAKlB,EAAK1G,OAGrBsO,EAAQ8oC,EAAM9oC,MACfA,IACCA,EAAMqC,WACRslC,GAAe16C,EAAM+S,EAAO1G,EAAKlB,EAAK88B,IACpCl1B,EAAMqoC,UACRD,GAAcn7C,EAAM+S,EAAO1G,EAAKlB,EAAK88B,IACnCl1B,EAAM1L,QAAUk0C,IAClBjS,GAAYtpC,EAAM+S,EAAO1G,EAAKlB,EAAK88B,EAAQC,IAE7CF,GAAUhoC,EAAM+S,EAAO1G,EAAKlB,EAAK88B,GAAQC,GAG1CloC,EAAKof,aAAa/S,EAAKlB,EAAK2nB,8BAtHtB,SAAS9oB,GAAKhK,OAGhByvB,EAAOzvB,EAAK+B,GAAG,SAEnB0tB,EAAKtsB,YAAY,aAAc,SAAC6R,EAAMwG,GAJzB,KAKRxG,GAJQ,KAISA,IAAmBwG,EAAEugC,UAAWvgC,EAAEwgC,UAAYvsB,EAAKptB,kBACvEg5C,GAkHH,SAASY,EAAej8C,EAAMyvB,OAEzBpjB,EAAKihB,EADL7uB,EAAO,UAGXgxB,EAAKysB,aAAa,SAASn9C,EAAOgC,EAAIoK,GACjCpK,GAAMusB,IACTjhB,EAAM,GAAI5N,EAAKiE,KAAK2J,GACpBihB,EAAOvsB,OAKJD,EAAM,CAAEgE,KAAK/F,EAAOqxB,KAFbX,EAAKxX,QAAQlX,GACR,IAAIoK,GACe1G,MAAMzE,EAAKoP,SAASrO,EAAIoK,IAEvDiK,EAAYpV,EAAKypC,WAAWxZ,IAAIlvB,EAAGoK,GACnC5D,EAASvH,EAAKsuB,cAAcvtB,EAAIoK,GAChC9D,EAASrH,EAAKuuB,cAAcxtB,EAAIoK,GAChCqE,EAAOxP,EAAKgR,OAAOvB,QAAQ1O,EAAIoK,MAE/B5D,GAAUF,GAAU+N,GAAa5F,EAAK,KACrCuD,EAAQ,CAAE1G,IAAItL,EAAIoK,IAAIA,GACtBiK,IAAWrC,EAAMqC,UAAYA,GAC7B7N,IAAQwL,EAAMqoC,SAAW7zC,GACzBF,IAAQ0L,EAAM1L,OAASA,GACvBmI,IAAMuD,EAAMvD,KAAOA,GACvB1O,EAAIiS,MAAQA,SAGb1G,EAAI3J,KAAK5B,GACF/B,IAGDN,EAlJOw9C,CAAej8C,EAAMyvB,GACjC6rB,GAAWh9B,SAAS8sB,uBAAuB,oBAAoB,GAAGrsC,MAClEgR,GAAS0f,EAAKhhB,iBACdw5B,GAAyB,GARd,KAQDjzB,KACkD,IAA/CmC,OAAOC,KAAKpX,EAAKgR,OAAOy3B,YAAY7pC,SAChD28C,GAgJJ,SAASY,EAAiBppC,EAAOhD,EAAQkjB,WACpC2V,EAAUzxB,OAAOC,KAAKrE,GACtBqpC,EAAWx+C,KAAKqiB,IAAIlb,MAAM,KAAM6jC,GAChCvb,EAASzvB,KAAKsT,IAAInM,MAAM,KAAM6jC,GAC9ByT,EAAWppB,EACXqpB,EAAS,EAEJ39C,EAAIy9C,EAAUz9C,GAAK0uB,EAAQ1uB,OAChCoU,EAAMpU,GAAG,KACPkuB,EAAU1V,OAAOC,KAAKrE,EAAMpU,IAChC09C,EAAWz+C,KAAKqiB,IAAIo8B,EAAUz+C,KAAKqiB,IAAIlb,MAAM,KAAM8nB,IACnDyvB,EAAS1+C,KAAKsT,IAAIorC,EAAQ1+C,KAAKsT,IAAInM,MAAM,KAAM8nB,WAI9C9c,EAAOxS,MAAM8O,KAAO+vC,GAAYrsC,EAAO3K,IAAIiH,KAAOghB,GAAUtd,EAAOxS,MAAM+O,QAAU+vC,GAAYtsC,EAAO3K,IAAIkH,QAAUgwC,EA/JpGH,CAAiBn8C,EAAKgR,OAAOy3B,WAAY14B,GAAQ/P,EAAKF,OAAOmzB,iBAI3EjzB,EAAKF,OAAO8kB,UAChB6K,EAAKtsB,YAAY,UAAW,SAAC2B,IAM/B,SAASy3C,EAAav8C,EAAMyvB,EAAM3qB,OAC7B03C,EAAU/sB,EAAKhhB,mBACd+tC,OACDj/C,EAAQi/C,EAAQj/C,MAChBu+C,EAAYh3C,IAASw2C,GAErB78C,EAAOq9C,EAAYT,GAAYp8C,MAAMw9C,IAAInpB,MAAMxuB,EAAM2qB,EAAK3vB,OAAO48C,YACjEZ,GAAa97C,EAAKF,OAAO0yB,4BAC5B/zB,EA2KF,SAASk+C,EAAiBl+C,EAAM+zB,OAC3B,IAAI7zB,EAAI,EAAGA,EAAIF,EAAKG,OAAQD,QAC3B,IAAIkb,EAAI,EAAGA,EAAIpb,EAAKE,GAAGC,OAAQib,IAAI,KAClC+iC,EAASn+C,EAAKE,GAAGkb,GAAGzb,WAAW2F,QAAQyuB,EAA2B,KACnEvzB,MAAMmZ,MAAMC,SAASukC,KACvBn+C,EAAKE,GAAGkb,GAAK+iC,UAETn+C,EAlLCk+C,CAAiBl+C,EAAMuB,EAAKF,OAAO0yB,gCAEvC0V,EAAY,CAAEnnC,GAAG,OAAQuL,OAAO,EAAGD,IAAK,EAAG21B,IAAIiG,IAC/C6T,GACH5T,EAAU57B,OAAS/O,EAAM+O,OAASyD,GAAOxS,MAAM+O,OAC/C47B,EAAU77B,IAAM9O,EAAM8O,IAAM0D,GAAOxS,MAAM8O,KAEzC47B,GAAS,EAGV/+B,EAAMC,IAAI,cACLoyC,IACHv7C,EAAKmqC,gBAsIR,SAAS0S,EAAa78C,EAAMzC,EAAOkB,OAC9Bq+C,EAASv/C,EAAM8O,IAAM5N,EAAKG,OAAS,EACnCm+C,EAASx/C,EAAM+O,OAAS7N,EAAK,GAAGG,OAAS,KAE1Ck+C,EAAS98C,EAAKF,OAAOozB,UAAY6pB,EAAS/8C,EAAKF,OAAOmzB,YAAY,KAChE/G,EAAS,CAAEnrB,GAAG,OACd+7C,EAAS98C,EAAKF,OAAOozB,WACxBhH,EAAOhjB,MAAQ,MACflJ,EAAK8C,UAAU,YAAa,CAC3BopB,EACA,CAAE7f,IAAKrM,EAAKF,OAAOozB,SAAW,GAC9B,CAAE7mB,IAAKywC,MAGLC,EAAS/8C,EAAKF,OAAOmzB,cACxB/G,EAAOhjB,MAAQ,SACflJ,EAAK8C,UAAU,YAAa,CAC3BopB,EACA,CAAE5f,OAAQtM,EAAKF,OAAOmzB,YAAc,GACpC,CAAE3mB,OAAQywC,OAvJZF,CAAa78C,EAAMzC,EAAOkB,GAEX,IAAXwpC,OACE,IAAI57B,EAAM0D,GAAOxS,MAAM8O,IAAKA,GAAO0D,GAAO3K,IAAIiH,IAAKA,QAClD,IAAIC,EAASyD,GAAOxS,MAAM+O,OAAQA,GAAUyD,GAAO3K,IAAIkH,OAAQA,IACnEtM,EAAKof,aAAa/S,EAAKC,EAAQ,MAC/BtM,EAAK2Q,SAAStE,EAAKC,EAAQ,MAKX,GAAf7N,EAAKG,QAAiC,GAAlBH,EAAK,GAAGG,QAAgB28C,GAW/C9rB,EAAK0Y,SACJ5qC,EAAM8O,IACN9O,EAAM+O,OACN7N,EAAKG,OACL,KACA,SAASG,EAAOsN,EAAKlB,EAAK6xC,EAASC,MAC9Bx+C,EAAKu+C,IAAYv+C,EAAKu+C,GAASp+C,OAASq+C,EAAS,KAChDpB,EAAQp9C,EAAKu+C,GAASC,GAC1BrB,GAAkB57C,EAAMqM,EAAKlB,EAAK0wC,EAAOC,EAAW5T,MAGtD,GArBDloC,EAAKiS,iBAAiB,SAAS5D,OAC1B6uC,EAAW,CACdn8C,GAAI,OACJuL,OAAQ47B,EAAU57B,OAAuB,EAAd+B,EAAK/B,OAAa/O,EAAM+O,OACnDD,IAAK67B,EAAU77B,IAAiB,EAAXgC,EAAKhC,IAAU9O,EAAM8O,IAC1C21B,IAAIiG,IAEL2T,GAAkB57C,EAAMqO,EAAKhC,IAAKgC,EAAK/B,OAAQ7N,EAAK,GAAG,GAAIq9C,EAAWoB,KAkBzD,IAAXjV,KAGHsT,KADAtT,GAAS,MAKXjoC,EAAK8I,WAvEHyzC,CAAav8C,EAAMyvB,EAAM3qB,mCCzBrB,SAASkF,GAAKhK,GAEpBA,EAAKmD,YAAY,cAAe,SAAC1E,UAgDlC,SAAS4R,EAAOrQ,EAAMc,OACjB2uB,EAAOzvB,EAAK+B,GAAG,SAEfo7C,EAAUr8C,EAAIvB,OAAS,CAAE69C,cAAgB,EAAGC,WAAa,GAC7Dr9C,EAAKs9C,eAAiBt9C,EAAKu9C,YAAc,EACrCJ,IACEl+C,MAAMwH,YAAY02C,EAAQC,gBAC9Bp9C,EAAKipB,cAAck0B,EAAQC,eACvBn+C,MAAMwH,YAAY02C,EAAQE,aAC9Br9C,EAAKkpB,WAAWi0B,EAAQE,aAGvBv8C,EAAIwH,OACNmnB,EAAK/Q,OAAO,kBAAkB,OAE1B,IAAI/f,EAAI,EAAGA,EAAImC,EAAIrC,KAAKG,OAAQD,IAAI,SACHmC,EAAIrC,KAAKE,MAAxC0N,OAAKC,OAAQvN,OAASkE,OAET,iBAATlE,IACTA,EAAQA,EAAMgF,QAAQ,YAAa,oBAEhCuD,EAAOmoB,EAAKxX,QAAQ5L,GACxB/E,EAAKgF,GAAUvN,EAGfiB,EAAKw6B,WAAW,WACfx6B,EAAK8C,UAAU,eAAgB,CAACuJ,EAAKC,EAAQvN,EAAOkE,OA1EZoN,CAAOrQ,EAAMvB,KACvDuB,EAAKmD,YAAY,kBAAmB,SAAC1E,EAAMqB,UAS5C,SAASsS,EAAWpS,EAAMc,EAAKhB,OAC1BswB,GAAQtwB,IAAwB,IAAdA,EAAOswB,KACzB3xB,EAAO,GACPgxB,EAAOzvB,EAAK+B,GAAG,SACfwiB,EAAQkL,EAAK2pB,WACbvsB,EAAUtI,EAAMgM,IAAI1xB,OAAO0lB,EAAM8B,QAGrCwG,EAAQZ;AAAOY,EAAQ3kB,QAAQ,SAAU,GAEzCunB,EAAKpB,QAAQ,SAAShiB,WACf/E,EAAOpG,KAAK+W,QAAQ5L,GACjB1N,EAAE,EAAGA,EAAEkuB,EAAQjuB,OAAQD,IAAI,KAC7BsR,EAAM4c,EAAQluB,GAChBI,EAAQuI,EAAK2I,GACX3O,EAAMgG,EAAKiI,UAAYjI,EAAKiI,SAASU,IAAc,GAGrDmgB,GAAQ9oB,EAAK,IAAI2I,KACpBlR,EAAQuI,EAAK,IAAI2I,QAGZutC,EAAWz+C,GAAmB,IAAVA,KACtBy+C,GAAYl8C,EAAK,KACd2B,EAAOu2B,GAAQx5B,EAAMqM,EAAK4D,GAChCxR,EAAKiE,KAAK,CAAK,EAAJ2J,EAAW,EAAJ4D,EAAQutC,EAAWz+C,EAAQ,GAAKuC,EAAK2B,QAGvD,GAEHnC,EAAIvB,MAAQ,CACX69C,cAAiBp9C,EAAKs9C,gBAAkB,EACxCD,WAAcr9C,EAAKu9C,aAAe,GAGnCz8C,EAAIrC,KAAOA,EA5C2C2T,CAAWpS,EAAMvB,EAAMqB,KAG7EE,EAAKmD,YAAY,SAAU,SAACF,EAAMoJ,EAAKC,EAAQvN,GACnC,SAARkE,GA0EL,SAASw6C,EAAWz9C,EAAMqM,EAAKC,EAAQvN,GACtCiB,EAAKof,aAAa/S,EAAKC,EAAQvN,GA1E7B0+C,CAAWz9C,EAAMqM,EAAKC,EAAQvN,QCkB1B,SAAS8P,GAAM7O,EAAMuO,GACxBA,EAAMvO,EAAK,WAAWuO,EAAK,SAAW,IAExCvO,EAAK09C,kBAAoB,GACzB19C,EAAK29C,kBAAoB,GACzB39C,EAAK+oC,qBAQA,SAAS6U,GAAgB59C,EAAMsM,UAC7BtM,EAAK09C,kBAAkBpxC,GAGzB,SAASuxC,GAAS79C,EAAM89C,EAASv5B,EAAOthB,MAE1C66C,EAUC,KACEvtB,EArBR,SAASwtB,EAAOh9C,UACR9B,MAAM4D,QAAQ9B,GAAMA,EAAK,CAACA,EAAIA,GAoBxBg9C,CAAOD,GACbz3B,EAAiB,OAARpjB,EAAgBjD,EAAK29C,kBAAoB39C,EAAK09C,qBAExDr3B,EAAOkK,EAAI,MAAQtxB,MAAMwH,YAAY8d,KAAUA,GAI/C,GAAI8B,EAAOkK,EAAI,MAAQtxB,MAAMwH,YAAY8d,KAAWA,GAAQ,KAC1D3X,EAAe,EAAT2jB,EAAI,GAAS,GAAK,GACrB,OAARttB,EAAgB+6C,GAAWC,IAAa,CAACl9C,GAAI,OAAQmI,MAAOjG,QAASA,EAAOstB,EAAI,GAAK3jB,QAAQ3J,EAAOstB,EAAI,GAAK3jB,GAAM5M,SAL3G,OAARiD,EAAgBi7C,GAAWC,IAAa,CAACp9C,GAAI,OAAQmI,MAAOjG,QAASA,EAAOstB,EAAI,SAAOttB,EAAOstB,EAAI,IAAKvwB,OAf9F,KACLyzB,EAAMzzB,EAAKqC,eAAc,GACzB6pB,EAAS,CACdnrB,IAAc,IAAVwjB,EAAkB,OAAS,OAC/Brb,MAAOjG,GAGLwwB,EAAI70B,QACNoB,EAAK8C,UAAU,YAAa,CAACopB,EAAQuH,EAAI,GAAIA,EAAIA,EAAI70B,OAAO,MAiBxD,SAASw/C,GAAap+C,EAAMqM,UAC1BrM,EAAK29C,kBAAkBtxC,GAkChC,SAAS8qC,GAAQjrB,GACI,UAAhBA,EAAOhjB,MACO,QAAbgjB,EAAOnrB,GACVk9C,GAAYl5C,MAAM7D,KAAM8D,WACH,QAAbknB,EAAOnrB,IACfo9C,GAAYp5C,MAAM7D,KAAM8D,WACC,OAAhBknB,EAAOhjB,QACA,QAAbgjB,EAAOnrB,GACVi9C,GAASj5C,MAAM7D,KAAM8D,WACA,QAAbknB,EAAOnrB,IACfm9C,GAASn5C,MAAM7D,KAAM8D,YAIxB,SAASi5C,GAAY/xB,EAAQ3uB,EAAO6H,EAAKpF,EAAM0R,WAC1C/S,EAAIyG,EAAIkH,OACNmjB,EAAOzvB,EAAK+B,GAAG,SAEdpD,GAAKpB,EAAM+O,QAAQ,KACrBvL,EAAKpC,KACJ+S,IACJ3Q,EAAKf,EAAK09C,kBAAoB,EAAF/+C,EAAI,IAAMqB,EAAK09C,kBAAoB,EAAF/+C,EAAI,KAAM,IAE7D,IAAPoC,EAAc,QACVf,EAAK09C,kBAAkB38C,OAC1BsN,EAAOohB,EAAKrB,gBAAgBrtB,EAAK,GAAK,SAASwkB,OAAO,GAC1DlX,EAAK/M,IAAM+M,EAAK/M,IAAIyC,QAAQ,2BAA4B,IACxD0rB,EAAK4uB,WAAWt9C,GAChBxD,EAAM+O,OAAS/O,EAAM+O,OAASvL,EAAKxD,EAAM+O,OAASvL,EAClDqE,EAAIkH,OAASlH,EAAIkH,OAASvL,EAAKqE,EAAIkH,OAASvL,EAEvC2Q,GACJ1R,EAAK8C,UAAU,oBAAqB,CAACopB,EAAQ,CAAE5f,OAAQvL,GAAM,CAAEuL,OAAOvL,GAAM,OAE9EpC,QAGK8M,EAAQzL,EAAKs9C,eAChB7xC,GAASA,GAASlO,EAAM+O,QAAUb,GAASrG,EAAIkH,SACjDtM,EAAKipB,cAAc,GACnBjpB,EAAKipB,cAAcxd,IAIrB,SAASuyC,GAAS9xB,EAAQ3uB,EAAO6H,EAAKpF,EAAM0R,OACvC/S,EAAIyG,EAAIiH,IACNojB,EAAOzvB,EAAK+B,GAAG,SAEf0J,EAAQzL,EAAKu9C,gBAChB9xC,GAEFzL,EAAKkpB,WAAW,GAGVvqB,GAAKpB,EAAM8O,KAAK,KAClBtL,EAAKpC,KACJ+S,IACJ3Q,EAAKf,EAAK29C,kBAAoB,EAAFh/C,EAAI,IAAMqB,EAAK29C,kBAAoB,EAAFh/C,EAAI,KAAM,IAE7D,IAAPoC,EAAc,WACVf,EAAK29C,kBAAkB58C,GAC1BA,EAAK,GAAM,EAAG,KACbsN,EAAOohB,EAAKrB,gBAAgB,SAAS7I,OAAO,GAChDlX,EAAK/M,IAAM+M,EAAK/M,IAAIyC,QAAQ,wBAAyB,IACrD0rB,EAAK4D,sBAEL5D,EAAKP,cAAcnuB,EAAK,EAAG,QAAS,yBAEhC2Q,GACJ1R,EAAK8C,UAAU,iBAAkB,CAACopB,EAAQ,CAAE7f,IAAKtL,GAAM,CAAEsL,IAAKtL,GAAM,OAEtEpC,IAGDqB,EAAK+oC,oBAEFt9B,GACFzL,EAAKkpB,WAAWzd,GAGlB,SAAS0yC,GAAYjyB,EAAQ3uB,EAAO6H,EAAKpF,EAAM0R,OACxC+d,EAAOzvB,EAAK+B,GAAG,SACjBpD,EAAIyG,EAAIkH,UACZtM,EAAKqf,iBAAmB,KACxBoQ,EAAK6uB,WAEDl5C,EAAIkH,OAAO,GAAK/O,EAAM+O,OAAO,SACzBtM,EAAK09C,kBAAkBngD,EAAM+O,kBAG9B3N,GAAKpB,EAAM+O,QAAQ,KACK,GAA3BmjB,EAAK8uB,eAAe5/C,GAAS,CAC/BqB,EAAK09C,kBAAkB/+C,GAAKA,MAExB0P,EAAOohB,EAAKrB,gBAAgBzvB,EAAI,GAAK,SAAS4mB,OAAO,GACzDlX,EAAK/M,KAAO+M,EAAK/M,KAAO,IAAM,4BAE9BmuB,EAAK+uB,WAAW7/C,GAEjBA,IAGI+S,GACJ1R,EAAK8C,UAAU,oBAAqB,CAACopB,EAAQ3uB,EAAO6H,EAAK,QAG3D,SAAS84C,GAAShyB,EAAQ3uB,EAAO6H,EAAKpF,EAAM0R,MACvCtM,EAAIiH,IAAI,GAAK9O,EAAM8O,IAAI,SACnBrM,EAAK29C,kBAAkBpgD,EAAM8O,cAI/BZ,EAAQzL,EAAKu9C,YAChB9xC,GAEFzL,EAAKkpB,WAAW,WAGXuG,EAAOzvB,EAAK+B,GAAG,SACjBpD,EAAIyG,EAAIiH,IAEL1N,GAAKpB,EAAM8O,KAAK,KACtBrM,EAAK29C,kBAAkBh/C,GAAKA,GAEpB,GAAM,EAAG,KACZ0P,EAAOohB,EAAKrB,gBAAgB,SAAS7I,OAAO,GAChDlX,EAAK/M,KAAO+M,EAAK/M,KAAO,IAAM,yBAC9BmuB,EAAK4D,sBAGL5D,EAAKN,WAAWxwB,EAAI,EAAG,QAAS,yBAEjCA,IAGDqB,EAAK+oC,oBAEFt9B,GACFzL,EAAKkpB,WAAWzd,GAEZiG,GACJ1R,EAAK8C,UAAU,iBAAkB,CAACopB,EAAQ3uB,EAAO6H,EAAK,mCAxPjD,SAAS4E,GAAKhK,GACpBA,EAAKmD,YAAY,YAAa,SAAC+oB,MACb,QAAbA,EAAOnrB,IAA6B,QAAbmrB,EAAOnrB,GAAa,KACxC0yB,EAAMzzB,EAAKgR,OAAOvC,gBACpBglB,GACH0jB,GAAQjrB,EAAQjtB,MAAMkG,KAAKsuB,EAAIl2B,OAAQ0B,MAAMkG,KAAKsuB,EAAIruB,KAAMpF,MAG/D6O,GAAM7O,GAENA,EAAKmD,YAAY,SAAU,SAAC+oB,EAAQ7f,EAAKC,EAAQvN,EAAOq/B,QACrC,QAAblS,EAAOnrB,IAA6B,QAAbmrB,EAAOnrB,IAAkC,UAAhBmrB,EAAOhjB,OAAqC,OAAhBgjB,EAAOhjB,OAAgB,KACnGjG,EAAOipB,EAAOnrB,GACbq9B,IACJn7B,EAAe,QAARA,EAAiB,OAAS,YAC5BnC,EAAOuL,GAAOC,EACpB6qC,GAAQ,CAAEp2C,GAAIkC,EAAMiG,MAAOgjB,EAAOhjB,OAASpI,EAAIvD,MAAOuD,EAAIsE,IAAKpF,GAAM,MAIvEA,EAAKmD,YAAY,cAAe,kBAAM0L,GAAM7O,KAE5CA,EAAKmD,YAAY,WAAY,SAAC+oB,EAAQuJ,GACxB,sBAAVvJ,GAoOL,SAASuyB,EAAgBz+C,EAAML,EAAMiN,EAAKnO,EAAMlB,MAC5CkB,EAAKc,OAASd,EAAKc,MAAM8mB,QAAU5nB,EAAKc,MAAM8mB,OAAO1mB,IAASlB,EAAKc,MAAM8mB,OAAO1mB,GAAMf,OAAO,CACpF,WAARe,GAAkBkP,GAAM7O,EAAM,QACrB,QAATL,GAAgBkP,GAAM7O,EAAM,YAE3B80B,EAAIv3B,EAAMoC,GAAO6b,EAAIsZ,EAAIloB,KACtB4O,EAAJsZ,SAAgB,CAACtZ,EAAGsZ,GAAZA,OAAGtZ,WAEV,IAAI7c,EAAIm2B,EAAGn2B,EAAI6c,EAAG7c,QACjB,IAAI+/C,EAAI,EAAGA,EAAIjgD,EAAKc,MAAM8mB,OAAO1mB,GAAMf,OAAQ8/C,IAC/CjgD,EAAKc,MAAM8mB,OAAO1mB,GAAM++C,IAAM//C,IAChCF,EAAKc,MAAM8mB,OAAO1mB,GAAM++C,GAAgC,EAA3BjgD,EAAKc,MAAM8mB,OAAO1mB,GAAM++C;AAAU,EAAJ9xC,EAAQ,GAAI,KA9OzE6xC,CAAgBz+C,EAAMy1B,EAAE91B,KAAK81B,EAAE7oB,IAAI6oB,EAAEh3B,KAAMg3B,EAAEl4B,4EAoDzC,SAASiM,GAAUxJ,EAAMvB,OAC3BkgD,EAAS,GAAQC,EAAQ,OACzB,IAAI7mC,KAAK/X,EAAK29C,kBAAmBgB,EAAMj8C,KAAKqV,OAC5C,IAAIC,KAAKhY,EAAK09C,kBAAmBkB,EAAMl8C,KAAKsV,IAE7C2mC,EAAM//C,QAAUggD,EAAMhgD,UACxBH,EAAKc,MAAM8mB,OAAS,IAClBs4B,EAAM//C,SACRH,EAAKc,MAAM8mB,OAAOha,IAAMsyC,GACtBC,EAAMhgD,SACRH,EAAKc,MAAM8mB,OAAO/Z,OAASsyC,SAGtB,SAASpkC,GAAKxa,EAAMvB,MAC1BoQ,GAAM7O,IAEFf,MAAMwH,YAAYhI,EAAKc,SAAWN,MAAMwH,YAAYhI,EAAKc,MAAM8mB,QAAQ,KACpEA,EAAS5nB,EAAKc,MAAM8mB,UAEvBA,EAAOha,KAAOga,EAAOha,IAAIzN,WACvB,IAAImZ,EAAI,EAAGA,EAAIsO,EAAOha,IAAIzN,OAAQmZ,IACrCmmC,GAAS,CAACn9C,GAAG,OAAQmI,MAAM,OAAQ,CAACmD,IAAIga,EAAOha,IAAI0L,IAAK,CAAC1L,IAAIga,EAAOha,IAAI0L,IAAK/X,GAAM,MAGlFqmB,EAAO/Z,QAAU+Z,EAAO/Z,OAAO1N,WAC7B,IAAIoZ,EAAI,EAAGA,EAAIqO,EAAO/Z,OAAO1N,OAAQoZ,IACxCmmC,GAAY,CAACp9C,GAAG,OAAQmI,MAAM,UAAW,CAACoD,OAAO+Z,EAAO/Z,OAAO0L,IAAK,CAAC1L,OAAO+Z,EAAO/Z,OAAO0L,IAAKhY,GAAM,OCczG,SAAS6+C,GAAiBxyC,EAAKC,OACxBtM,EAAOkB,KACTuD,EAAQ2K,EAASpP,EAAM,CAACqM,IAAIA,EAAKC,OAAOA,OAGxC7H,GAASA,EAAMqL,MAAM/B,KAAK,KACzBzG,EAAOtH,EAAKgR,OAAOiH,QAAQ5L,GAC3BrJ,EAASsE,EAAKonC,SAAW1uC,EAAKgR,OAAOlR,OAAO6uC,UAEhD3uC,EAAKgR,OAAO0d,WAAW,SAASvjB,EAAKrL,OAChC2E,EAAQ2K,EAASpP,EAAM,CAACqM,IAAIA,EAAKC,OAAOnB,OAEzC1G,GAASA,EAAMqL,OAA8B,SAArBrL,EAAMqL,MAAM/B,KAAgB,KAClDjJ,EAAO5D,KAAKgqB,QAAQ7e,EAAKlB,GACzB2F,EAAYhR,EAAOW,MAEjB+O,EAAOxP,EAAKgR,OAAOvB,QAAQpD,EAAKlB,GACnCqE,IACFsB,EAAY9Q,EAAKgR,OAAO2d,YAAY,CAACtiB,IAAImD,EAAK,GAAIlD,OAAOkD,EAAK,KAAK2B,cAEjEnR,EAAKsuB,cAAcjiB,EAAKlB,IAAQnL,EAAKuuB,cAAcliB,EAAKlB,MAC1D2F,GAAa,IAEd9N,EAASpF,KAAKsT,IAAIlO,EAAQ0F,EAAY1I,EAAM8E,EAAML,EAAM1D,GAAI+P,GAAW9N,WAIzEsE,EAAKonC,QAAW1rC,8BA5IX,SAASgH,GAAKhK,MAEhBA,EAAKF,OAAOwpB,WAAW,KACtBmG,EAAOzvB,EAAK+B,GAAG,SACnB0tB,EAAK/Q,OAAO,YAAa,CAAEogC,YAAY,EAAM7zC,KAAM,KACnDwkB,EAAK/Q,OAAO,eAAgB,CAAEogC,YAAY,EAAM7zC,KAAM,KACtDwkB,EAAK/Q,OAAO,kBAAkB,GAE9B+Q,EAAKtsB,YAAY,cAAe,SAACpC,GAChCf,EAAK+B,GAAG,SAASg9C,oBACjB14C,EAAKrG,EAAM,QAAS,CAAEqM,IAAKtL,EAAIuL,OAAQ,EAAGrB,KAAMjL,EAAKsP,OAAOvO,GAAI2tC,YAEjEjf,EAAKtsB,YAAY,iBAAkB,SAACpC,GACnCf,EAAK+B,GAAG,SAASg9C,oBACjB14C,EAAKrG,EAAM,QAAS,CAAEqM,IAAK,EAAGC,OAAQvL,EAAIkK,KAAMjL,EAAKg/C,UAAUj+C,GAAIN,UAIpET,EAAKmD,YAAY,SAAU,SAACF,EAAMoJ,EAAKC,EAAQvN,GACnC,YAARkE,GAA8B,YAARA,GA6D5B,SAASg8C,EAAYj/C,EAAMqM,EAAKC,EAAQvN,GACpCsN,GACFrM,EAAK+B,GAAG,SAASkW,QAAQ5L,GAAKqiC,QAAU3vC,EACxCsH,EAAKrG,EAAM,QAAS,CAAEqM,IAAIA,EAAKC,OAAQ,EAAGrB,KAAMlM,KAGhDiB,EAAKgR,OAAOwd,eAAeliB,EAAQvN,GAGpCiB,EAAKgR,OAAO+tC,oBArETE,CAAYj/C,EAAMqM,EAAKC,EAAQvN,KAIlCiB,EAAKmD,YAAY,cAAe,SAAC1E,MAC5BA,EAAK6J,MAAM,KACT,IAAI3J,EAAE,EAAGA,EAAEF,EAAK6J,MAAM1J,OAAQD,IAAI,KAClCsM,EAAOxM,EAAK6J,MAAM3J,MACV,EAARsM,EAAK,IAAS,EAAE,KACfoB,EAAMrM,EAAKsP,OAAOrE,EAAK,IACxBoB,IAAKA,EAAIqiC,QAAkB,EAARzjC,EAAK,QACrB,KACFE,EAAMnL,EAAKg/C,UAAU/zC,EAAK,IAC3BE,IAAKA,EAAI1K,MAAgB,EAARwK,EAAK,KAGvBxM,EAAK6J,MAAM1J,QACdoB,EAAK8I,SAAQ,MAKhB9I,EAAKmD,YAAY,kBAAmB,SAAC1E,WAChC6J,EAAQ,GACRmnB,EAAOzvB,EAAK+B,GAAG,SACf8qB,EAAU4C,EAAK2pB,WAAW3hC,MAC1BA,EAAQgY,EAAKhxB,KAAKgZ,MAElBynC,EAAWzvB,EAAK3vB,OAAOquB,YACvBgxB,EAAY1vB,EAAK3vB,OAAO6uC,UAEnBhwC,EAAI,EAAGA,EAAIkuB,EAAQjuB,OAAQD,IAAI,KACnC8B,EAAQgvB,EAAKrB,gBAAgBvB,EAAQluB,IAAI8B,MACzCA,GAASA,GAASy+C,GACrB52C,EAAM5F,KAAK,CAAC,EAAG/D,EAAG8B,QAGf,IAAI9B,EAAI,EAAGA,EAAI8Y,EAAM7Y,OAAQD,IAAI,KACjCqE,EAASysB,EAAKxX,QAAQR,EAAM9Y,IAAI+vC,QAChC1rC,GAAUA,GAAUm8C,GACvB72C,EAAM5F,KAAK,CAAU,EAAT+U,EAAM9Y,GAAM,EAAGqE,IAG7BvE,EAAK6J,MAAQA,IAGdtI,EAAKmD,YAAY,WAAY,SAAC+oB,EAAQuJ,GACxB,sBAAVvJ,GAyBL,SAASya,EAAehnC,EAAMiN,EAAKnO,EAAMlB,OACpCoB,EACH2J,EAAQ7J,EAAK6J,MACb82C,EAAS,MAEPxyC,EAAI,KACFjO,EAAI2J,EAAM1J,OAAO,EAAM,GAAJD,EAAMA,IAAI,SACR2J,EAAM3J,MAAzB0N,OAAIC,OAAOrB,OACboB,GAAe,OAAR1M,GAAiB0M,GAAM9O,EAAM8O,KAAOC,GAAkB,UAAR3M,GAAoB2M,GAAU/O,EAAM+O,QAE3FD,EAAe,OAAR1M,EAAkB,EAAJ0M,EAAQO,EAAIP,EACjCC,EAAiB,UAAR3M,EAAwB,EAAP2M,EAAWM,EAAIN,GAC7B,OAAR3M,GAAqB,EAAJ0M,GAAmB,UAAR1M,GAA4B,EAAR2M,IACnD8yC,EAAO18C,KAAK,CAAC2J,EAAKC,EAAQrB,KAE3Bm0C,EAAO18C,KAAK4F,EAAM3J,IAEpBF,EAAK6J,MAAQ82C,GAzCZzY,CAAelR,EAAE91B,KAAK81B,EAAE7oB,IAAI6oB,EAAEh3B,KAAMg3B,EAAEl4B,SAGxCyC,EAAKmD,YAAY,sBAAuB,SAASkJ,EAAKC,EAAQkpB,EAAG6pB,IAC5DA,GAAsB,SAAjBA,EAAEvvC,MAAM/B,MAAqBynB,GAAKA,EAAE1lB,MAAM/B,MAAQsxC,EAAEvvC,MAAM/B,aAC3D/N,EAAKgR,OAAOiH,QAAQ5L,GAAKqiC,UAGlC1uC,EAAKmD,YAAY,gBAAiB07C,IAClC7+C,EAAKmD,YAAY,eAAiB07C,kCC9E5B,SAAS70C,GAAKhK,OAChBT,EAAQS,EAAKgR,OAEbsuC,EAAK,EACT//C,EAAM4D,YAAY,aAAc,kBAAMm8C,EAAK,IAAI9hD,OAC/C+B,EAAM4D,YAAY,qBAAsB,cAInCnD,EAAKqf,kBAAqB,IAAI7hB,KAAS8hD,EAAI,IAAK,OAAO,IAG5D//C,EAAM4D,YAAY,kBAAmB,SAACmL,MAKZ,SAArBA,EAAK/Q,MAAM+O,OAAmB,OAAO,MAIrC/E,EAAShI,EAAMqxB,gBACfrpB,GACHA,EAAO8E,KAAOiC,EAAK/Q,MAAM8O,KAAO9E,EAAO+E,QAAUgC,EAAK/Q,MAAM+O,QAC5D/E,EAAO8E,KAAOiC,EAAK/Q,MAAM8O,KAAO9E,EAAO+E,QAAUgC,EAAK/Q,MAAM+O,QAC5D/M,EAAMmyB,YAEF1xB,EAAKqf,iBAAkB,OAAO,MAG/BkgC,EAAa50C,EAAO2D,EAAK/Q,MAAM+O,QAAUgC,EAAK/Q,MAAM8O,IACpDmzC,EAAW70C,EAAO2D,EAAKlJ,IAAIkH,QAAUgC,EAAKlJ,IAAIiH,IAE9CozC,EAAMz/C,EAAKqf,iBAAiB/Q,EAAK/Q,MAAO+Q,EAAKlJ,IAAKm6C,EAAYC,UAEtD,IAARC,IACHz/C,EAAKqf,iBAAmB,KACxB9f,EAAMmgD,oBAGAD,IAGRxgD,MAAMie,MAAM3d,EAAMiE,MAAO,YAAa,SAASgY,MAC1Cxb,EAAKqf,iBACR,OAAOpgB,MAAMsJ,KAAKwU,aAAavB,QCJlC,SAAS1Z,GAASiW,EAAEC,EAAGzY,OAClBR,EAAQQ,EAAM0Y,QAAQF,GAAGC,UAC1BjZ,IAAUuX,WAAuB,KAAVvX,EChC3B,IAAMklC,GAAU,OACT,SAASjlB,EAAK/O,UACZ,SAAChJ,EAAEqQ,OACLU,EAAIse,WAAWrvB,EAAEgJ,MAAU2J,SAC3Bgc,EAAIU,WAAWhf,EAAErH,MAAU2J,gBACnBgc,EAAJ5d,EAAQ,EAAKA,GAAK4d,EAAI,GAAK,GAAI5W,QAGnC,SAASA,EAAK/O,UACZ,SAAChJ,EAAEqQ,OACLU,GAAK/Q,EAAEgJ,IAAQ,IAAI7R,WAAW6J,cAC9B2tB;AAAKte,EAAErH,IAAQ,IAAI7R,WAAW6J,qBACtB2tB,EAAJ5d,EAAQ,EAAKA,GAAK4d,EAAI,GAAK,GAAI5W,KAKnC,SAAS2gC,GAAU3/C,EAAMqL,EAAO2T,EAAK/b,MAC3CoI,EAAQA,GAASrL,EAAKgR,OAAOvC,gBAEnB,KAELmxC,EADJv0C,EAAQe,EAASf,EAAOrL,GAEpBqL,EAAM9N,MAAM8O,MAAQhB,EAAMjG,IAAIiH,MACjCuzC,EDrCI,SAASC,EAAgB9nC,EAAG/X,WAC9B8/C,EAAO9/C,EAAKF,OAAOozB,SACnB6sB,EAAO//C,EAAKF,OAAOmzB,YACnB1zB,EAAQS,EAAKgR,OAEbgvC,EAAMjoC,EAAExa,MAAM8O,IAAK4zC,EAAMloC,EAAE3S,IAAIiH,IAAK6zC,EAAMnoC,EAAExa,MAAM+O,OAAQ6zC,EAAMpoC,EAAE3S,IAAIkH,OAEjE3N,EAAEqhD,EAAI,EAAK,EAAFrhD,GACbmD,GAASnD,EAAGoZ,EAAExa,MAAM+O,OAAQ/M,GADVZ,IAErBqhD,EAAMrhD,MAKH,IAAIA,EAAEshD,EAAI,EAAGthD,EAAEmhD,GACfh+C,GAASnD,EAAGoZ,EAAE3S,IAAIkH,OAAQ/M,GADLZ,IAExBshD,EAAMthD,MAKH,IAAIA,EAAEuhD,EAAI,EAAK,EAAFvhD,GACbmD,GAASiW,EAAExa,MAAM8O,IAAK1N,EAAGY,GADPZ,IAErBuhD,EAAMvhD,MAKH,IAAIA,EAAEwhD,EAAI,EAAGxhD,EAAEohD,GACfj+C,GAASiW,EAAE3S,IAAIiH,IAAK1N,EAAGY,GADFZ,IAExBwhD,EAAMxhD,MAKJyhD,EAAW,CAAE7iD,MAAM,CAAE8O,IAAI2zC,EAAK1zC,OAAO4zC,GAAQ96C,IAAI,CAAEiH,IAAK4zC,EAAK3zC,OAAQ6zC,WACrEH,GAAOjoC,EAAExa,MAAM8O,KAAO4zC,GAAOloC,EAAE3S,IAAIiH,KAAO6zC,GAAOnoC,EAAExa,MAAM+O,QAAU6zC,GAAOpoC,EAAE3S,IAAIkH,QACnFtM,EAAKgR,OAAOid,cAAcmyB,EAAS7iD,MAAO6iD,EAASh7C,KAG7Cg7C,ECHOP,CAAgBx0C,EAAOrL,QAEhCiQ,EAAMjQ,EAAKsP,OAAOjE,EAAM9N,MAAM8O,KAAKhB,EAAM9N,MAAM+O,QACnDrJ,EAAOA,IAAS1E,MAAM+3B,WAAWrmB,IAAQ,MAAQ,OACjD+O,EAAQA,GAAe,QAARA,GAAsB,EAAL,EAChC9V,EAAMC,IAAI,kBAMZ,SAASkO,EAAKhM,EAAOg1C,EAAIp9C,EAAM+b,EAAKhf,OAC9B,IAAIsM,EAASjB,EAAM9N,MAAM+O,OAAQA,GAAUjB,EAAMjG,IAAIkH,OAAQA,IAAS,SAEpE2G,EAAS,GACN5G,EAAMhB,EAAM9N,MAAM8O,IAAKA,GAAOhB,EAAMjG,IAAIiH,IAAKA,OAClDrM,EAAKo+C,aAAa/xC,GAAK,KACnBi0C,EAAUtgD,EAAKsP,OAAOjD,GACxBtN,EAAQuhD,EAAQh0C,GAChB7H,EAAQzE,EAAKoP,SAAS/C,EAAKC,GAC3B8jB,EAAOkwB,EAAQ,IAAIh0C,GACnBm9B,EAAazpC,EAAKypC,WAAWxZ,IAAI5jB,EAAIC,GACtCm9B,GACFgR,GAAiB,SAAUpuC,EAAKC,EAAQm9B,EAAY,KAAMzpC,GAE3DiT,EAAOvQ,KAAK,CACX3D,MAAOA,EACP0F,MAAOA,EACP2rB,KAAMA,EACN/jB,IAAKA,EACLo9B,WAAYA,IAMfx2B,EAAOoE,KAAK4sB,GAAQhhC,GAAM+b,EAAK,cAG1B,IAAI3S,EAAMhB,EAAM9N,MAAM8O,IAAKA,GAAOhB,EAAMjG,IAAIiH,IAAKA,OAClDrM,EAAKo+C,aAAa/xC,GAAK,KACnB+f,EAAUnZ,EAAOg+B,WAEvBjxC,EAAK2Q,SAAStE,EAAKC,EAAS8f,EAAQ3nB,OAAS,MAC1C2nB,EAAQqd,YACVgR,GAAiB,SAAUpuC,EAAKC,EAAQ,KAAM8f,EAAQqd,WAAYzpC,GAE9DosB,EAAQgE,KACR,KACE8X,EAAY,CACjBnnC,GAAI,OACJsL,IAAKA,EAAM+f,EAAQ/f,IACnBC,OAAQ,GAEHi0C,EAAU5e,GAAWvV,EAAQgE,KAAM8X,GAEzCloC,EAAKof,aAAa/S,EAAKC,EAAQi0C,QATbvgD,EAAKof,aAAa/S,EAAKC,EAAQ8f,EAAQrtB,QAe7DiB,EAAK8I,UAxDHuO,CAAKuoC,EAAWv0C,EAAM9N,MAAM+O,OAAQrJ,EAAM+b,EAAKhf,iCArC3C,SAASgK,GAAKhK,GACpBA,EAAKmD,YAAY,YAAa,SAACsjC,GAChB,aAAVA,EAAG1lC,IAA+B,cAAV0lC,EAAG1lC,IAC9B4+C,GAAU3/C,EAAM,KAAMymC,EAAG1lC,GAAGgD,QAAQ,QAAQ,uBCDxC,SAASglB,GAAc/oB,OAAMukB,gEAC/BkL,EAAOzvB,EAAK+B,GAAG,SACfwB,GAAiE,GAApDksB,EAAKjsB,MAAMC,UAAUyE,QAAQ,oBAChC,WAAVqc,IACHA,GAAShhB,IAENA,GAAcghB,GACjBtlB,MAAMsJ,KAAK+mB,OAAQG,EAAKjsB,MAAO,oBAAoB,GACnDxD,EAAK8C,UAAU,YAAa,CAAC,CAAC/B,GAAG,iBAAkBpB,KAAK,iBAAkBZ,OAAM,KAChFiB,EAAK8C,UAAU,WAAY,CAAC,iBAAkB,CAACgwB,UAAS,EAAM/zB,OAAO,MAE9DwE,IAAeghB,IACtBtlB,MAAMsJ,KAAK8mB,UAAWI,EAAKjsB,MAAO,oBAClCxD,EAAK8C,UAAU,YAAa,CAAC,CAAC/B,GAAG,iBAAkBpB,KAAK,iBAAkBZ,OAAM,KAChFiB,EAAK8C,UAAU,WAAY,CAAC,iBAAkB,CAACgwB,UAAS,EAAO/zB,OAAO,iCAtBjE,SAASiL,GAAKhK,GACpBA,EAAKmD,YAAY,SAAU,SAAC+oB,EAAQ7f,EAAKC,EAAQvN,GAClC,kBAAVmtB,GACHnD,GAAc/oB,EAAMjB,iCAuBhB,SAASyK,GAAUxJ,EAAMvB,GAC/BA,EAAKc,MAAMihD,WAA4E,GAAhExgD,EAAK+B,GAAG,SAASyB,MAAMC,UAAUyE,QAAQ,oBAAyB,EAAE,QAGrF,SAASsS,GAAKxa,EAAMvB,OACtB8P,GAAO,EACPtP,MAAMwH,YAAYhI,EAAKc,QAAWN,MAAMwH,YAAYhI,EAAKc,MAAMihD,aAClEjyC,GAAQ9P,EAAKc,MAAMihD,WACpBz3B,GAAc/oB,EAAMuO,MC1Bd,SAASya,GAAYhpB,OAAMukB,gEAC7BkL,EAAOzvB,EAAK+B,GAAG,SACL,WAAVwiB,IACHA,EAAQkL,EAAK3vB,OAAOylB,QAElBkK,EAAK3vB,OAAOylB,QAAUhB,GACxBkL,EAAK3vB,OAAOylB,QAAS,EACjBkK,EAAKmuB,gBAAgB,UACxBnuB,EAAK+uB,WAAW,QAAS,IAAI,GAAM,GACpC/uB,EAAK4D,iBACLrzB,EAAK8C,UAAU,YAAa,CAAC,CAAC/B,GAAG,iBAAkBpB,KAAK,eAAgBZ,OAAM,KAC9EiB,EAAK8C,UAAU,WAAY,CAAC,cAAe,CAACgwB,UAAS,EAAM/zB,OAAM,MAEzD0wB,EAAK3vB,OAAOylB,QAAWhB,IAC/BkL,EAAK3vB,OAAOylB,QAAS,EAChBkK,EAAKmuB,gBAAgB,UACzBnuB,EAAK4uB,WAAW,QAAS,IAAI,GAC9B5uB,EAAK4D,iBACLrzB,EAAK8C,UAAU,YAAa,CAAC,CAAC/B,GAAG,iBAAkBpB,KAAK,eAAgBZ,OAAM,KAC9EiB,EAAK8C,UAAU,WAAY,CAAC,cAAe,CAACgwB,UAAS,EAAO/zB,OAAM,iCA3B7D,SAASiL,GAAKhK,GACpBA,EAAKmD,YAAY,SAAU,SAAC+oB,EAAQ7f,EAAKC,EAAQvN,GAClC,eAAVmtB,GACHlD,GAAYhpB,EAAMjB,+BA4Bd,SAASyK,GAAUxJ,EAAMvB,GAC/BA,EAAKc,MAAMuK,QAAU9J,EAAK+B,GAAG,SAASjC,OAAOylB,OAAO,EAAE,QAGhD,SAAS/K,GAAKxa,EAAMvB,OACtB8P,GAAO,EACR9P,EAAKc,QAAUN,MAAMwH,YAAYhI,EAAKc,MAAMuK,WAC9CyE,GAAQ9P,EAAKc,MAAMuK,SACpBkf,GAAYhpB,EAAMuO,MCEnB,SAASkyC,GAAczgD,EAAMqM,EAAKC,EAAQoF,GACtCgvC,GAAW1gD,EAAMqM,EAAKC,KACnBoF,GACJ1R,EAAK8C,UAAU,WAAY,CAAC,UAAW,CAACuJ,IAAAA,EAAKC,OAAAA,EAAQwmB,SAAU,KAAM/zB,MAAOiB,EAAK2vB,SAAS2gB,MAAMjkC,GAAKC,aAC/FtM,EAAK2vB,SAAS2gB,MAAMjkC,GAAKC,IAEjCtM,EAAK+B,GAAG,SAAS8jC,WAAWx5B,EAAIC,GAG1B,SAASq0C,GAAoB3gD,EAAMqL,GACzCnC,EAAMC,IAAI,WACToD,EAAUlB,EAAOrL,EAAM,SAASA,EAAMqO,GAClCqyC,GAAW1gD,EAAMqO,EAAKhC,IAAKgC,EAAK/B,SAClCm0C,GAAczgD,EAAMqO,EAAKhC,IAAKgC,EAAK/B,UAErCtM,EAAK+B,GAAG,SAAS+G,YAInB,SAAS83C,GAAY5gD,EAAMqM,EAAKC,EAAQgiC,EAAS58B,OAC5Cq2B,EAAW2Y,GAAW1gD,EAAMqM,EAAKC,GAAUtM,EAAK2vB,SAAS2gB,MAAMjkC,GAAKC,GAAU,KAC9E/M,EAAQS,EAAK+B,GAAG,SAEC,iBAAXusC,IACTA,EAAUA,EAAQ7uB,OAAS6uB,EAAU,IACtCtuC,EAAK2vB,SAAS2gB,MAAMjkC,GAAOrM,EAAK2vB,SAAS2gB,MAAMjkC,GAAOrM,EAAK2vB,SAAS2gB,MAAMjkC,GAAO,GACjFrM,EAAK2vB,SAAS2gB,MAAMjkC,GAAKC,GAAUgiC,EAEnC/uC,EAAM4vB,WAAW9iB,EAAKC,EAAQ,yBAEzBoF,GACJ1R,EAAK8C;AAAU,WAAY,CAAC,UAAW,CAACuJ,IAAAA,EAAKC,OAAAA,EAAQwmB,SAASwb,EAASvvC,MAAMgpC,KA+C/E,SAAS2Y,GAAW1gD,EAAMqM,EAAKC,UACvBtM,EAAK2vB,SAAS2gB,MAAMjkC,IAAQrM,EAAK2vB,SAAS2gB,MAAMjkC,GAAKC,GAAUtM,EAAK2vB,SAAS2gB,MAAMjkC,GAAKC,GAAU,8BArHnG,SAAStC,GAAKhK,GACpBA,EAAK2vB,SAAW,CACfM,IAAK,SAAS5jB,EAAKC,UACXo0C,GAAW1gD,EAAMqM,EAAKC,IAE9BkwB,IAAK,SAASnwB,EAAKC,EAAQgiC,GAC1BsS,GAAY5gD,EAAMqM,EAAKC,EAAQgiC,IAEhCzvB,OAAQ,SAASxS,EAAKC,GACrBm0C,GAAczgD,EAAMqM,EAAKC,IAE1BsjB,eAAgB,GAChB0gB,MAAM,IAGPtwC,EAAKmD,YAAY,UAAW,kBAmB7B,SAAS0L,EAAM7O,GACdA,EAAK2vB,SAAS2gB,MAAQ,GApBYzhC,CAAM7O,KACxCA,EAAKmD,YAAY,SAAU,SAACF,EAAMoJ,EAAKC,EAAQvN,GACjC,YAATkE,GAUN,SAAS49C,EAAa7gD,EAAMqM,EAAKC,EAAQvN,GACrC2hD,GAAW1gD,EAAMqM,EAAKC,IACxBm0C,GAAczgD,EAAMqM,EAAKC,GAAQ,GAC/BvN,GACF6hD,GAAY5gD,EAAMqM,EAAKC,EAAQvN,GAAO,GAbrC8hD,CAAa7gD,EAAMqM,EAAKC,EAAQvN,KAGlCiB,EAAKmD,YAAY,WAAY,SAAC+oB,EAAQuJ,GACxB,sBAAVvJ,GAsEL,SAASya,EAAehnC,EAAMiN,EAAKnO,EAAMlB,OACpCoyB,EAAWlxB,EAAKkxB,SACnBhxB,EAAIgxB,EAAS/wB,UAEXgO,OACIjO,KAAI,SACUgxB,EAAShxB,MAAvB0N,OAAIC,QACND,GAAe,OAAR1M,GAAiB0M,GAAM9O,EAAM8O,KAAOC,GAAkB,UAAR3M,GAAoB2M,GAAU/O,EAAM+O,UAC/E,OAAR3M,EACC0M,EAAM9O,EAAM8O,IAAMO,EACrB+iB,EAAS1D,OAAOttB,EAAE,GAElBgxB,EAAShxB,GAAG,GAAS,EAAJ0N,EAAQO,EACR,UAARjN,IACN2M,EAAS/O,EAAM+O,OAASM,EAC3B+iB,EAAS1D,OAAOttB,EAAG,GAEnBgxB,EAAShxB,GAAG,GAAY,EAAP2N,EAAWM,KAtF/B+5B,CAAelR,EAAE91B,KAAK81B,EAAE7oB,IAAI6oB,EAAEh3B,KAAMg3B,EAAEl4B,2CAiDlC,SAASiM,GAAUxJ,EAAKvB,OAC1B4N,EAAKC,EACRqjB,EAAW,OACRtjB,KAAOrM,EAAK2vB,SAAS2gB,UACpBhkC,KAAUtM,EAAK2vB,SAAS2gB,MAAMjkC,GAC9BrM,EAAK2vB,SAAS2gB,MAAMjkC,GAAKC,IAC3BqjB,EAASjtB,KAAK,CAAC2J,EAAKC,EAAQtM,EAAK2vB,SAAS2gB,MAAMjkC,GAAKC,KAExD7N,EAAKkxB,SAAWA,QAGV,SAASnV,GAAKxa,EAAKvB,OACrBE,EACHgxB,EAAWlxB,EAAKkxB,YAEdA,EACF,IAAIhxB,EAAI,EAAGA,EAAIgxB,EAAS/wB,OAAQD,IAC/BiiD,GAAY5gD,EAAM2vB,EAAShxB,GAAG,GAAIgxB,EAAShxB,GAAG,GAAIgxB,EAAShxB,GAAG,IAAI,iCCpF9D,SAASqL,GAAKhK,OAChB8gD,EAAU,CAACC,GAAGC,GAAGC,GAAGC,GAAGC,GAAGC,GAAGC,IACjCrhD,EAAKmD,YAAY,kBAAmB,SAAS1E,OACvC,IAAIE,EAAI,EAAGA,EAAImiD,EAAQliD,OAAQD,IAChCmiD,EAAQniD,GAAG6K,WACbs3C,EAAQniD,GAAG6K,UAAUxJ,EAAKvB,KAI7BuB,EAAKmD,YAAY,cAAe,SAAS1E,OACnC,IAAIE,EAAI,EAAGA,EAAImiD,EAAQliD,OAAQD,IAChCmiD,EAAQniD,GAAG6b,MACbsmC,EAAQniD,GAAG6b,KAAKxa,EAAKvB,QCpBnBiZ,GAAQ,CAAC,OAAO,OAAO,OAAO,QAAQ,QAAQ,QAAQ,QAAQ,QAAQ,oCAErE,SAAS1N,GAAKhK,OAChBshD,EACA56C,OAAO66C,iBAAmB,IAAIA,gBAAkB5hB,UACnD2hB,EAAWriD,MAAMqB,GAAG,CACnBN,KAAK,WACLwhD,SAAQ,EACRC,OAAQ/pC,GAAM3U,UAGNI,YAAY,kBAAkBlE,MAAM0D,KAAK,SAASg9B,UACT,EAA9CjoB,GAAMxP,QAAQ,IAAIy3B,EAAO18B,KAAKgF,iBAChCjI,EAAK6O,QACL7O,EAAKszB,MAAMqM,EAAOE,KAAM,WAElB,GACN3+B,OAEFlB,EAAK69B,iBAAiBn7B,KAAK4+C,IAG5BthD,EAAKmD,YAAY,YAAa,SAACrC,GACf,iBAAXA,EAAIC,IAKV,SAAS2gD,EAAY1hD,EAAMshD,GACrBA,EAGJriD,MAAMwL,MAAM,kBAAM62C,EAASK,eAF3B3hD,EAAKolC,MAAMnmC,MAAMC,KAAKC,YAAYC,OAAO,uBANxCsiD,CAAY1hD,EAAMshD,QCxBd,SAASvT,GAAM/tC,EAAMD,OACvBoiB,EAASniB,EAAKu8B,aAEdh0B,EAqBL,SAASq5C,EAAW5hD,EAAMD,EAASoiB,OAC9B0/B,EAAM5iD,MAAMsJ,KAAK+J,OAAO,MAAO,SAAU,uBAE7CvS,EAAQ+hD,YAAc,EACtB/hD,EAAQwlB,OAASxlB,EAAQwlB,SAAU,EACnCxlB,EAAQ0f,OAAOxgB,MAAMwH,YAAY1G,EAAQ0f,OAAe1f,EAAQ0f,KAChE1f,EAAQ6tC,aAAa3uC,MAAMwH,YAAY1G,EAAQ6tC,aAAqB7tC,EAAQ6tC,eACtEmU,EAAY/hD,EAAKkP,cAEvBlP,EAAKo9B,QAAQnb,QAAQ,SAAC1W,EAAO5M,MAC5BqB,EAAKkP,OAAS6yC,EAAU,IAAIpjD,EACT,QAAhBoB,EAAQtB,MAAmC,QAAjBsB,EAAQtB,MAAkB8M,EAAM5L,OAASwiB,EAAQ,CAC7EniB,EAAK2e,UAAUpT,EAAM5L,UACjBsP,EAAS,OAAOjP,EAAKkP,UAEtBnP,EAAQ6tC,WAAW,KACjBoU,EAAY/iD,MAAMsJ,KAAK+J,OAAO,MAAO,SAAU,qCAAsC/G,EAAM5L,KAAK,KACpGkiD,EAAI5wC,YAAY+wC,GAGjBhiD,EAAK+yB,QAAS,MACVxzB,EAAQS,EAAKgR,OAAOixC,aAAaliD,GAAS,aACvCC,EAAK+yB,OAGRxzB,EAAMoF,aACTpF,EAAMoF,WAAWlB,WAAa,IAAIwL,GACnC4yC,EAAI5wC,YAAY1R,GAEG,OAAhBQ,EAAQtB,MAAiBE,EAAE,EAAIqB,EAAKo9B,QAAQx+B,OAAO,KACjDsjD,EAAKjjD,MAAMsJ,KAAK+J,OAAO,MAAO,SAAS,0BAC3CuvC,EAAI5wC,YAAYixC,OAInBliD,EAAKkP,OAAS6yC,EAEPF,EA1DID,CAAW5hD,EAAMD,EAASoiB,GACrCljB,MAAMsJ,KAAK45C,aAAa55C,EAAMxI,EAAQqiD,UAAW9jC,SAASre,MAC1DyG,OAAOqnC,QAYR,SAASsU,EAAWriD,EAAMuI,GACzBtJ,MAAMsJ,KAAKsW,OAAOtW,GAElBvI,EAAKo9B,QAAQnb,QAAQ,SAAC1W,EAAO5M,GAC5BM,MAAMsJ,KAAK4G,YAAY,QAAQnP,EAAKkP,OAAO,IAAIvQ,KAfhD0jD,CAAWriD,EAAMuI,GAEjBvI,EAAK2e,UAAUwD,uCAGT,SAASnY,GAAKhK,GACpBA,EAAKiiD,aAAe,SAASliD,GAC5BguC,GAAM/tC,EAAMD,OCoKd,SAASuiD,GAAWv3C,UAED,KADlBA,EAAMA,EAAIjD,UAAU,IACblJ,SAAcmM,GAAUA,GACxBA,EA6FR,SAASw3C,GAAclzC,EAAQmzC,OAC1Bz3C,EAAMsE,EAAO5D,MAAM,KACnBg3C,EAAM,GACPD,IACFC,EAAM,CAAEC,KAAK,GAAIC,UAAU,GAAIz0C,OAAO,SAEnC,IAAI4mB,EAAI,EAAGA,EAAE/pB,EAAInM,OAAQk2B,IACzB/pB,EAAI+pB,KACH0tB,EACFI,GAAmBH,EAAK13C,EAAK+pB,GAE7B+tB,GAAiBJ,EAAK13C,EAAK+pB,WAIvB2tB,EAGR,SAASK,GAAmB9iD,EAAM+X,EAAGC,EAAG+qC,OACjCzhD,EAAM64C,GAAgBn6C,EAAM+X,EAAGC,MAClC1W,EAAI,IACHyhD,EAAOzhD,GACT,OAAOyhD,EAAOzhD,OACT6xB,EAAKl0B,MAAMsJ,KAAK+J,OAAO,MAAO,SAAShR,IAC7Cgd,SAASre,KAAKgR,YAAYkiB,OAEpB6vB,EAAWt8C,OAAOu8C,iBAAiB9vB,GACnC+vB,EAAKF,EAASt+C,gBACdd,EAAQo/C,EAASp/C,aAEvB0a,SAASre,KAAKoR,YAAY8hB,GAE1B4vB,EAAOzhD,GAAO,CAAC4hD,EAAIt/C,GACZm/C,EAAOzhD,IAgBhB,SAASshD,GAAmBH,EAAK13C,EAAK+pB,UAC7BvnB,EAAYunB,QACd,QACJ2tB,EAAIC,KAAK9+C,MAAQ,CAACu/C,IAAIb,GAAWv3C,EAAI+pB,eAEjC,iBACEsuB,EAAOd,GAAWv3C,EAAI+pB,IACzBsuB,GAA+B,WAAvBA,EAAKn7C,gBACfw6C,EAAIW,KAAO,CAAEC,QAAQ,CAAEF,IAAIC,eAGxB,aACJX,EAAIE,UAAUW,WAAav4C,EAAI+pB,aAE3B,cACJ2tB,EAAIC,KAAK/iD,KAAOoL,EAAI+pB,GAAG/wB,QAAQ,UAAW,cAEtC,YACJ0+C,EAAIC,KAAKa,GAA8B,IAAzBx4C,EAAI+pB,GAAG/wB,QAAQ,KAAM,cAE/B,aACJ0+C,EAAIC,KAAKc,OAAmB,UAAVz4C,EAAI+pB,aAElB;AACJ2tB,EAAIC,KAAKe,UAAsB,aAAV14C,EAAI+pB,aAErB,cACJ2tB,EAAIC,KAAKgB,KAAiB,QAAV34C,EAAI+pB,aAEhB,iBACJ2tB,EAAIE,UAAU7U,SAAqB,UAAV/iC,EAAI+pB,GAAe,SAAS/pB,EAAI+pB,aAErD,OACJ2tB,EAAIE,UAAUgB,SAAqB,QAAV54C,EAAI+pB,aAEzB,oBAEA,SACJ2tB,EAAI/xC,OAAS2D,GAAgBtJ,EAAI+pB,IAAI,IAAS,aAE1C,mBACA,oBACA,kBACA,aACJ2tB,EAAIv0C,OAAQX,EAAYunB,GAAGrpB,MAAM,KAAK,IAAOm4C,GAAgB74C,EAAI+pB,IAAI,IAKxE,SAAS+tB,GAAiBJ,EAAK13C,EAAK+pB,UAC3BvnB,EAAYunB,QACd,QACJ2tB,EAAI7+C,MAAQ0+C,GAAWv3C,EAAI+pB,cAEvB,aACJ2tB,EAAI/9C,gBAAkB49C,GAAWv3C,EAAI+pB,cAEjC,aACJ2tB,EAAIoB,UAAY94C,EAAI+pB,aAEhB,wBAEA,YACJ2tB,EAAI73B,SAAoC,IAAzB7f,EAAI+pB,GAAG/wB,QAAQ,KAAM,cAEhC,aACJ0+C,EAAIe,OAAmB,UAAVz4C,EAAI+pB,aAEb,kBACJ2tB,EAAIgB,UAAsB,aAAV14C,EAAI+pB,aAEhB,cACJ2tB,EAAIiB,KAAiB,QAAV34C,EAAI+pB,aAEX,iBACJ2tB,EAAIqB,UAAY/4C,EAAI+pB,aAEhB,OACJ2tB,EAAIsB,WAAwB,UAAVh5C,EAAI+pB,aAElB,cAEA,mBAEA,mBACA,oBACA,kBACA,iBACE7mB,EAAMV,EAAYunB,GAAGrpB,MAAM,KAAK,GACtCg3C,kBAAax0C,EAAI,GAAGmY,cAAgBnY,EAAInG,UAAU,aAAa87C,GAAgB74C,EAAI+pB,KAMtF,SAAS8uB,GAAgBj8C,EAAK66C,WACP76C,EAAI8D,MAAM,QAAzB7H,OAAOX,cAEXu/C,EACK,CAAE5+C,MAAM,CAAEu/C,IAAIb,GAAW1+C,IAASa,MAAMxB,GAExCq/C,GAAW1+C,GAGpB,SAASogD,GAAa1iD,OACjBA,EAAK,MAAO,WACZyJ,EAAM,GACFpM,EAAG,EAAGA,EAAE4O,EAAY3O,OAAQD,IACnCoM,EAAIrI,KAAKpB,EAAIiM,EAAY5O,KAAK,WACxB4jD,GAAcx3C,EAAIhI,KAAK,MAAM,8BAxa9B,SAASiH,GAAKhK,GACpBA,EAAKikD,YAAc,SAASlkD,OACrBmkD,EAA6B,OAAvBnkD,EAAQokD,YACdC,EAAiB,CACtB7+B,QAAQ,EACR8+B,QAAO,EACPC,SAAQ,EACRC,WAAU,EACVxyB,OAAO,EACP1iB,QAAO,EACP+gB,MAAO8zB,EACPpC,YAAY,EACZtG,OAAO,CAACjB,OAAM,GACd9Q,YAAW,UAGZxqC,MAAMiU,OAAOnT,EAASqkD,GAEI,SAAvBrkD,EAAQokD,aAA0BD,EAOvC,SAASM,EAAYxkD,EAAMD,0BACpByiD,EAA+B,SAAvBziD,EAAQokD,aAEA,IAAnBpkD,EAAQ0J,OACV1J,EAAQ0J,OAASzJ,EAAKo9B,QAAQ7mB,IAAI,SAASue,UAAWA,EAAEn1B,OAChDI,EAAQ0J,QAAW1J,EAAQ0J,OAAO7K,OAEV,iBAAlBmB,EAAQ0J,SACtB1J,EAAQ0J,OAAS,CAAC1J,EAAQ0J,SAF1B1J,EAAQ0J,OAAS,CAACzJ,EAAKu8B,cAIxBx8B,EAAQ0kD,UAAW,UAEfhmD,EAAO,GACP0jB,EAASniB,EAAKu8B,wBAEV59B,OACD4M,EAAQxL,EAAQ0J,OAAO9K,GACvBoC,EAAKwK,EAAMxK,IAAMwK,EAEvBvL,EAAK2e,UAAU5d,GACfhB,EAAQ+hD,YAAc9hD,EAAK+B,GAAG,SAASjC,OAAOylB,OAAS,EAAI,MAErDm/B,EAAen5C,EAAMxL,QAAUd,MAAMiU,OAAO3H,EAAMxL,QAASA,GAAWd,MAAMkG,KAAKpF,GACpFgB,GAAMohB,IACRuiC,EAAaC,SAAU,GACpBD,EAAa/kD,OAChB+kD,EAAa/kD,KAAOoB,OAEf6jD,GAAYpC,GAAiC,SAAxBkC,EAAar/B,QAElCw/B,EAAa7kD,EAAKwJ,cACH2yB,GAAa0oB,EAAWpmD,KAAMomD,EAAW9yB,MAAO,EAAG,YAAjE1wB,OAAMV,WAET6hD,IACAvjD,MAAMwH,YAAYi+C,EAAaI,cACjCJ,EAAaI,WAAaJ,EAAa/kD,MACrCilD,GAAS,CACXF,EAAalJ,OAASkJ,EAAalJ,QAAU,OACzC,IAAI78C,EAAIgC,EAAK,EAAGhC,GAAKqB,EAAKF,OAAOmzB,YAAat0B,IACjD+lD,EAAalJ,OAAO78C,IAAK,MAGpB0I,EAASq9C,EAAar9C,QAAW,kBAAI,GAC3Cq9C,EAAar9C,OAAS,SAAAvG,UACdA,EAAIC,IAAMM,GAAQgG,EAAOtC,MAAMsD,EAAMrD,QAKzC+/C,EAAY9lD,MAAMujD,EAAQ,UAAY,SAASxiD,EAAKgR,OAAQ0zC,MAC/DE,GAA0C,GAA9BG,EAAU,GAAGC,OAAOpmD,OAClC,qBAEG4jD,GAASoC,IAAaF,EAAar1C,OAAO,KACvCA,EAAS01C,EAAU,GAAG11C,OAyH/B,SAAS41C,EAAWjlD,EAAMD,EAASyiD,EAAOnhD,EAAMV,GAE/CX,EAAK6R,oBAEDyZ,EAAS,GACPy3B,EAAS,GACTmC,EAAmB,GACnB1kD,EA/BP,SAAS2kD,EAAaplD,OACjB61B,EAAItoB,QACkB,SAAvBvN,EAAQokD,YACH,CACNzB,KAAK,CACJa,GAAoC,IAAjC3tB,EAAE,aAAa7xB,QAAQ,KAAM,IAChCpE,KAAKi2B,EAAE,eAAe7xB,QAAQ,UAAW,KAG1C4+C,UAAU,CACTW,WAAW1tB,EAAE,cACbkY,SAASlY,SACT+tB,SAA2B,UAAlB/tB,EAAE,iBAIN,CACNhL,SAA2C,IAAjCgL,EAAE,aAAa7xB,QAAQ,KAAM,IAEvC8/C,UAAWjuB,EAAE,cACbmuB,WAA+B,UAAlBnuB,EAAE,gBAWAuvB,CAAaplD,GAE3ByiD,GAASziD,EAAQqlD,YAAW95B,EAAUA,EAAOzsB,OAAO,CAAC,GAAGmlD,GAAajkD,EAAQqlD,UAAU9jD,MAAiB,MACxGvB,EAAQwlB,QAAQ+F,EAAO5oB,KAAK,QAEzB2iD,EAAQ/5B,EAAO1sB,OAEf6wB,EAAOzvB,EAAK+B,GAAG,SACf8qB,EAAU4C,EAAK3vB,OAAO+sB,QAExBy4B,EAASD,SACb51B,EAAKpB,QAAQ,SAAChiB,QACJhL,EAANgL,QAGE,IAAIk5C,EAASxlD,EAAQ+hD,YAAayD,EAAS14B,EAAQjuB,QAAU2mD,GAAU5kD,EAAM4kD,IAAS,KACpFjkD,EAAMtB,EAAKoP,SAAS/C,EAAKwgB,EAAQ04B,GAAQxkD,IACzC4Y,EAAQ4rC,EAASxlD,EAAQ+hD,YAE/Bx2B,EAAOg6B,GAAUh6B,EAAOg6B,IAAW,OAE/Bj2C,YACD/N,KACCyhD,EAAOzhD,EAAIP,IACbsO,EAASpQ,MAAMkG,KAAK49C,EAAOzhD,EAAIP,SAC5B,KAGC,IAAIpB,KAFR0P,EAASkzC,GAAcjhD,EAAIwD,KAAM09C,GAEjBhiD,EACZgiD,EACFvjD,MAAMiU,OAAO7D,EAAO1P,GAAOa,EAASb,IAC3B0P,EAAO1P,KAChB0P,EAAO1P,GAAQa,EAASb,IAG1BojD,EAAOzhD,EAAIP,IAAM9B,MAAMkG,KAAKkK,QAI7BA,EAASpQ,MAAMkG,KAAK3E,MAElBT,EAAQ0pC,WAAW,KAEfr0B,EAAY0tC,GAAmB9iD,EAAMqM,EAAKk5C,EAAQL,GACrD9vC,IAoDwBqtC,EAnDJpzC,EAmDoBmzC,EAnDDA,aAAXptC,EAoDNmB,IAAI,SAAA5O,UAAO1I,MAAM2E,MAAM4hD,SAAS79C,QAAvDu7C,OAAIt/C,OACN4+C,GACFC,EAAIW,KAAO,CAACC,QAAQ,CAACF,IAAID,IACzBT,EAAIC,KAAK9+C,MAAQ,CAACu/C,IAAIv/C,KAGtB6+C,EAAI/9C,gBAAkBw+C,EACtBT,EAAI7+C,MAAQA,IAxDX0nB,EAAOg6B,GAAQ3rC,GAAStK,EACxBic,EAAOg6B,GAAQ3rC,GAAO1W,KAAOu2B,GAAQx5B,EAAMqM,EAAKwgB,EAAQ04B,GAAQxkD,IAEjEukD,IA6CF,IAA+B7C,EAAgBD,IACzCU,EAAIt/C,IA3CN4+C,GAASziD,EAAQqiD,YAAW92B,EAAUA,EAAOzsB,OAAO,CAAC,GAAG,GAAGmlD,GAAajkD,EAAQqiD,UAAU9gD,SAEtFgqB,EAxLgC25B,CAAWjlD,EAAM0kD,EAAclC,EAAOnhD,EAAMV,GAE9EikD,GA4BN,SAASa,EAAep2C,EAAQ01C,EAAWL,EAAc1kD,EAAM6kD,OACxDt/B,EAASm/B,EAAan/B,OAAS,EAAI,KAErCm/B,EAAa3yB,UACX,IAAIuF,KAAOutB,EAAW9yB,SACK,EAA3B8yB,EAAW9yB,MAAMuF,GAAK,GAAQ,KAC7BjrB,EAAMw4C,EAAW9yB,MAAMuF,GAAK,GAAK,EAAI/R,EACxCpa,EAAM05C,EAAW9yB,MAAMuF,GAAK,GAAK,EACjC32B,EAAOkkD,EAAW9yB,MAAMuF,GAAK,MAC1BjoB,EAAOhD,IAAQgD,EAAOhD,GAAKlB,GAAM,CACpCkE,EAAOhD,GAAKlB,GAAKu6C,QAAU/kD,MAErBglD,EAAUZ,EAAU,GAAGa,WAAWv5C,EAAMkZ,GAC1CogC,GAEHA,EAAQ15B,OAAO9gB,EAAM,EAAGxK,EAAO,OAE5B8D,EAAQ0S,OAAOlE,OAAO5D,EAAOhD,IACjC5H,EAAMwnB,OAAO9gB,EAAM,EAAGxK,EAAO,GAC7B0O,EAAOhD,GAAO5H,WAMZhG,EAAOsmD,EAAU,GAAGa,WAClB7tC,EAAI,EAAGA,EAAItZ,EAAKG,OAAQmZ,QAC1B,IAAIC,EAAI,EAAGA,EAAIvZ,EAAKsZ,GAAGnZ,OAAQoZ,IAAK,KACpChV,EAAShD,EAAK+B,GAAG,SAASjC,OAAO6uC;AAElC+V,EAAaJ,SAAWO,EAAWv8C,MAAM1J,WACvC,IAAIk2B,EAAI,EAAGA,EAAI+vB,EAAWv8C,MAAM1J,OAAQk2B,IAAI,KACzC+wB,EAAUhB,EAAWv8C,MAAMwsB,GAAG,MACjC+wB,GAAWA,GAAW9tC,EAAE,EAAE,CAC5B/U,EAAS6hD,EAAWv8C,MAAMwsB,GAAG,cAM1B/I,EAAY1c,EAAO0I,EAAIwN,GAAQvN,GAC/BuS,EAAQwB,EAAU+3B,UAClBgC,EAAa,IAAP9iD,EAAc+oB,EAAUnB,SACpCmB,EAAUg6B,WAAuB,OAATx7B,EAAiB,EAAc,UAATA,EAAoBu7B,EAAMA,EAAM,EAC9E/5B,EAAUi6B,cAA0B,UAATz7B,EAAoB,EAAc,OAATA,EAAiBu7B,EAAMA,EAAM,GAvEhFL,CAAep2C,EAAQ01C,EAAWL,EAAc1kD,EAAM6kD,MAGxDpmD,EAAOA,EAAKI,OAAOkmD,GAEhBvC,EAAM,CACR/jD,EAAKE,GAAG+M,OAAS,WAEbA,EAAS1L,EAAK0L,OAAOg6B,YACjB3tB,EAAI,EAAGA,EAAErM,EAAO9M,OAAQmZ,IAC/BtZ,EAAKE,GAAG+M,OAAOhJ,KAAK,CACnBujD,MAAMtnD,EACNunD,KAAKx6C,EAAOqM,GAAGpY,KACfwmD,IAAIzB,EAAa/kD,KAAK,IAAI+L,EAAOqM,GAAG1M,MAAMtH,QAAQ,SAAU,SAASC,SAAe,IAAIA,WAKvFjE,EAAQmG,WA0Dd,SAASkgD,EAAapmD,EAAMD,OAEvBU,EADE4lD,EAAOtmD,EAAQumD,aAAsC,aAAvBvmD,EAAQumD,YAA6B,SAAW,QAInF7lD,EADET,EAAK6xC,OACC7xC,EAAK6xC,OAEL7xC,EAAKqmD,GAEdtmD,EAAQsmD,GAAQzoD,KAAKsT,IAAInR,EAAQsmD,IAAS,EAAG5lD,GAAS,GAlEnD2lD,CAAa1B,EAAc3kD,IA7DtBpB,EAAI,EAAGA,EAAEoB,EAAQ0J,OAAO7K,OAAQD,MAAhCA,UAgERqB,EAAK2e,UAAUwD,UACRpiB,EAAQ0kD,SACRhmD,EAvFE+lD,CAAYxkD,EAAMD,GAElBC,EAAKgR,WCSf,SAASu1C,GAAezlD,EAAK4K,EAAQiO,WAChC6sC,EAAUvnD,MAAMkG,KAAKrE,EAAIrC,MACzBA,EAAQ,GAEHE,EAAI,EAAGA,EAAI6nD,EAAQ5nD,OAAQD,QAC/B,IAAIqZ,EAAI,EAAGA,EAAEwuC,EAAQ,GAAG5nD,OAAQoZ,IAAI,KACnC3L,EAAM1N,EAAE,EAAG2N,EAAS0L,EAAE,EAC1BvZ,EAAKiE,KAAK,CAAC2J,EAAKC,EAAQk6C,EAAQ7nD,GAAGqZ,QAGrClX,EAAIrC,KAAOA,EAGRqC,EAAIixB,UACF,IAAIpzB,EAAI,EAAGA,EAAEmC,EAAIixB,MAAMnzB,OAAQD,IAClCmC,EAAIixB,MAAMpzB,GAAG,KACbmC,EAAIixB,MAAMpzB,GAAG,QAKZ+M,MACE,IAAIqM,EAAI,EAAGA,EAAErM,EAAO9M,OAAQmZ,IAE5BrM,EAAOqM,GAAGkuC,QAAUtsC,IACtB7Y,EAAI4K,OAAS5K,EAAI4K,QAAU,GAC3B5K,EAAI4K,OAAOhJ,KAAK,CAACgJ,EAAOqM,GAAGmuC,KAAK9/B,cAAe1a,EAAOqM,GAAGouC,IAAIr+C,UAAU4D,EAAOqM,GAAGouC,IAAIj+C,QAAQ,KAAK,GAAGnE,QAAQ,MAAO,UAMpHjD,EAAIuO,QAyDR,SAAS41C,EAAWnkD,WACf2lD,EAAa,GAAIp3C,EAAS,GAAIq3C,EAAc,EACxC/nD,EAAI,EAAGA,EAAEmC,EAAIuO,OAAOzQ,OAAQD,IAAI,SACnCoM,EAAM,GAAI03C,EAAM3hD,EAAIuO,OAAO1Q,GAAG,GAAI2C,SAE9BwzB,EAAK,EAAGA,EAAEvnB,EAAY3O,OAAQk2B,WAC7BvnB,EAAYunB,QACd,QACJ/pB,EAAI+pB,GAAK2tB,EAAIC,MAAQD,EAAIC,KAAK9+C,OAAO0+C,GAAWG,EAAIC,KAAK9+C,MAAMu/C,MAAU,aAErE,aACJp4C,EAAI+pB,GAAK2tB,EAAIW,MAAQX,EAAIW,KAAKC,SAASf,GAAWG,EAAIW,KAAKC,QAAQF,MAAW,aAE1E,aACJp4C,EAAI+pB,IAAM2tB,EAAIE,UAAWF,EAAIE,UAAUW,WAAW,KAAOh2C,EAAc,wBAEnE,cACJvC,EAAI+pB,GAAK2tB,EAAIC,MAAQD,EAAIC,KAAK/iD,KAAKgnD,GAAUlE,EAAIC,KAAK/iD,MAAM,aAExD,YACJoL,EAAI+pB,GAAK2tB,EAAIC,MAAQD,EAAIC,KAAKa,IAAKd,EAAIC,KAAKa,GAAG,IAAM,MAAW,aAE5D,aACJx4C,EAAI+pB,GAAK2tB,EAAIC,MAAQD,EAAIC,KAAKc,OAAO,SAAS,aAE1C,kBACJz4C,EAAI+pB,GAAK2tB,EAAIC,MAAQD,EAAIC,KAAKe,UAAU,YAAY,aAEhD,cACJ14C,EAAI+pB,GAAK2tB,EAAIC,MAAQD,EAAIC,KAAKgB,KAAK,OAAO,aAEtC,qBACAkD,EAAKnE,EAAIE,WAAaF,EAAIE,UAAU7U,UAAgB,GACxD/iC,EAAI+pB,IAAW,UAAL8xB,EAAc,SAASA,IAAOt5C,EAAc,4BAElD,OACJvC,EAAI+pB,GAAK2tB,EAAIE,WAAaF,EAAIE,UAAUgB,SAAS,OAAO,mBAEpD,cAGA,SACJ54C,EAAI+pB,GAAK,aAEL,mBACA,oBACA,kBACA,aACJ/pB,EAAI+pB,GAAK+xB,GAAiBt5C,EAAYunB,GAAI2tB,GAI7C13C,EAAMA,EAAIhI,KAAK,KACfzB,EAAMmlD,EAAW17C,IAAQ,MAAM27C,MAE3B,IAAI9wB,EAAI,EAAGA,EAAE90B,EAAIrC,KAAKG,OAAQg3B,OAC9B90B,EAAIrC,KAAKm3B,GAAG,KAAO90B,EAAIuO,OAAO1Q,GAAG,GAAG,GAAKmC,EAAIrC,KAAKm3B,GAAG,KAAO90B,EAAIuO,OAAO1Q,GAAG,GAAG,EAAE,CACjFmC,EAAIrC,KAAKm3B,GAAG,GAAKt0B,QAIfmlD,EAAW17C,KACdsE,EAAO3M,KAAK,CAACpB,EAAKyJ,IAClB07C,EAAW17C,GAAOzJ,EAClBolD,KAGF5lD,EAAIuO,OAASA,EA3HZ41C,CAAWnkD,GAETA,EAAI4W,OAgCR,SAASovC,EAAUhmD,GAClBA,EAAI4W,MAAMuK,QAAQ,SAAAhf,OACb,IAAItE,EAAI,EAAGA,EAAImC,EAAIrC,KAAKG,OAAQD,OAChCmC,EAAIrC,KAAKE,GAAG,KAAOsE,EAAK,GAAG,GAAKnC,EAAIrC,KAAKE,GAAG,KAAOsE,EAAK,GAAG,EAAE,CAC/DnC,EAAIrC,KAAKE,GAAG,GAAKsE,EAAK,YAnCxB6jD,CAAUhmD,GAGRA,EAAIwH,UACF,IAAI3J,EAAI,EAAGA,EAAEmC,EAAIwH,MAAM1J,OAAQD,IACZ,UAAnBmC,EAAIwH,MAAM3J,GAAG,GACfmC,EAAIwH,MAAM3J,GAAK,CAAC,EAAGmC,EAAIwH,MAAM3J,GAAG,GAAG,EAAGmC,EAAIwH,MAAM3J,GAAG,IAEnDmC,EAAIwH,MAAM3J,GAAK,CAACmC,EAAIwH,MAAM3J,GAAG,GAAG,EAAG,EAAGmC,EAAIwH,MAAM3J,GAAG,WAI/CmC,EAIR,SAASwhD,GAAWv3C,UAED,KADlBA,EAAMA,GAAO,UACNnM,SAAcmM,EAAMA,EAAIjD,UAAU,IAClC,IAAIiD,EAIZ,SAAS47C,GAAU57C,WACdg8C,EAAOz5C,EAAc,eACjB3O,EAAI,EAAGA,EAAEwqB,GAAWvqB,OAAQD,OAChCwqB,GAAWxqB,GAAGI,OAASgM,EAAK,CAAEg8C,EAAO59B,GAAWxqB,GAAGoC,gBAEhDgmD,EAcR,SAASF,GAAiB54C,EAAKw0C,MAC9Bx0C,EAAMA,EAAIlK,QAAQ,UAAW,IAC1B0+C,EAAIv0C,QAAUu0C,EAAIv0C,OAAOD,GAAK,KAC1BC,EAASu0C,EAAIv0C,OAAOD,GACpBrK,EAAQ0+C,GAAWp0C,EAAOtK,MAAMu/C,MAAQ,GACxClgD,EAAOiL,EAAOzJ,OAAS,mBACnBb,cAASX,SAEb,8BAvHD,SAAS+G,GAAKhK,GACpBA,EAAKgnD,YAAc,SAASlmD,EAAKmmD,OAC5BlnD,EAAUe,EAAIf,SAAW,GAC7BA,EAAQqwB,KAAOpwB,EAAKF,OAAOswB,aAEvB82B,EAAO,CAAEz9C,OAAO,IACZ9K,EAAK,EAAGA,EAAGmC,EAAIowC,MAAMtyC,OAAQD,IACpCoB,EAAQJ,KAAOmB,EAAIowC,MAAMvyC,GACzBuoD,EAAKz9C,OAAO/G,KAAK,CAChB/C,KAAKI,EAAQJ,KACb8F,QAAQ8gD,GAAeU,EAAOzoB,SAAS19B,EAAKf,GAAUe,EAAI4K,OAAQ/M,YAG7DuoD,GAERlnD,EAAKmnD,UAAY,SAASrmD,EAAKmmD,GAC9BnmD,EAAMmmD,EAAOG,WAAWtmD,WAEpB0lD,EAAUvnD,MAAMkG,KAAKrE,GACrBrC,EAAO,GAEHE,EAAI,EAAGA,EAAE6nD,EAAQ5nD,OAAQD,YAC5B2I,EAAOk/C,EAAQ7nD,GAAG8M,MAAMw7C,EAAO54C,MAC3B2J,EAAK,EAAGA,EAAE1Q,EAAK1I,OAAQoZ,IAAI,KAC9B3L,EAAM1N,EAAE,EAAG2N,EAAS0L,EAAE,EAC1BvZ,EAAKiE,KAAK,CAAC2J,EAAKC,EAAQhF,EAAK0Q,WAGxB,CAAEvZ,KAAKA,kCC9BT,SAASuL,GAAKhK,GACpBA,EAAKmD,YAAY,YAAa,SAAC+oB,UACtBA,EAAOnrB,QACT,cACJf,EAAKqnD,WAAW,KAAK,CAACp0C,QAAQ,cAE1B,cACJjT,EAAKqnD,WAAW,KAAK,CAACh4C,QAAQ,cAE1B,4BACJrP,EAAKqnD,WAAW,KAAK,CAAC5d,YAAY,cAE9B,yBACJzpC,EAAKqnD,WAAW,KAAK,CAAChgC,SAAS,cAE3B,YACJne,EAAMC,IAAI,WACTnJ,EAAKqnD,WAAW,KAAK,kBAGlB,iBACJrnD,EAAKqnD,WAAW,KAAK,CAAC13B,UAAU,UCUpC,SAAS7X,GAAS9X,EAAMe,EAAImI,MACvBnI,EAKK9B,MAAM4D,QAAQ9B,KACtBA,EAAM,CAACA,EAAGA,QANJ,KACFuN,EAAOtO,EAAK+B,GAAG,SAAS0M,gBACzBH,IACFvN,EAAK,CAACuN,EAAK/Q,MAAM2L,GAAOoF,EAAKlJ,IAAI8D,YAK5BnI,EAGR,SAASumD,GAAYtnD,EAAML,EAAMuJ,EAAOnI;MACnCxD,EAAQ,GAAI6H,EAAM,IACtBrE,EAAK+W,GAAS9X,EAAMe,EAAImI,MAGxB3L,EAAM2L,GAASnI,EAAG,GAClBqE,EAAI8D,GAASnI,EAAG,GAChBf,EAAK8C,UAAU,YAAa,CAAC,CAAC/B,GAAGpB,EAAOuJ,MAAMA,GAAQ3L,EAAO6H,KAG9D,SAASmiD,GAAQvnD,EAAMiD,EAAMlC,EAAIkK,IAChClK,EAAK+W,GAAS9X,EAAMe,EAAIkC,KAGxBiG,EAAMC,IAAI,eACJ,IAAIxK,EAAIoC,EAAG,GAAIpC,GAAKoC,EAAG,GAAIpC,IACpB,QAARsM,EACFjL,EAAK+B,GAAG,SAAiB,OAARkB,EAAgB,eAAiB,kBAAkBtE,EAAGsM,IAE9D,OAARhI,EAAgBwrB,GAAYP,IAAcvvB,EAAGqB,qCA3D3C,SAASwnD,GAAUn7C,GACzBi7C,GAAYpmD,KAAM,MAAO,MAAOmL,cAG1B,SAASo7C,GAAUp7C,GACzBi7C,GAAYpmD,KAAM,MAAO,MAAOmL,iBAG1B,SAASuiB,GAAaviB,EAAKrJ,GACjCukD,GAAQrmD,KAAM,MAAOmL,EAAKrJ,iBAKpB,SAAS0kD,GAAap7C,GAC5Bg7C,GAAYpmD,KAAM,MAAO,SAAUoL,iBAG7B,SAASq7C,GAAar7C,GAC5Bg7C,GAAYpmD,KAAM,MAAO,SAAUoL,mBAG7B,SAASkiB,GAAeliB,EAAQ7L,GACtC8mD,GAAQrmD,KAAM,SAAUoL,EAAQ7L,8CC1BjB6lC,GAASj6B,EAAKC,EAAQiY,GACrCmiB,GAAcxlC,KAAMmL,EAAKC,EAAQiY,iBAG3B,SAASsM,GAAaxkB,EAAKC,UAC1Bo6B,GAAkBxlC,KAAMmL,EAAKC,MCqDrC,SAASs7C,GAAW5nD,EAAMiD,EAAMsyB,OACzB9F,EAAOzvB,EAAK+B,GAAG,YAEV,OAARkB,UAEEmC,EAAMpF,EAAKF,OAAOmzB,YACdt0B,EAFI,EAEOA,GAAKyG,EAAKzG,IAAI,KAC1B6Q,EAAOigB,EAAKhgB,QAAQ8lB,EAAK52B,MAC5B6Q,EAAK,KACDq4C,EAAoB,EAARr4C,EAAK,GAAQA,EAAK,GAAK,EAC7B+lB,EAATsyB,GACFC,GAAW9nD,EAAMwP,EAAMA,EAAK,GAAIA,EAAK,IAAMq4C,EAAWtyB,kBAKrDh4B,EAAQkyB,EAAKhxB,KAAKgZ,MAAM,GACxBrS,EAAMqqB,EAAKhxB,KAAKgZ,MAAM7Y,OAClBD,EAAIpB,EAAOoB,GAAKyG,EAAKzG,IAAI,KAC1B6Q,EAAOigB,EAAKhgB,QAAQ9Q,EAAG42B,MAC1B/lB,EAAK,KACDq4C,EAAoB,EAARr4C,EAAK,GAAQA,EAAK,GAAK,EAC7B+lB,EAATsyB,GACFC,GAAW9nD,EAAMwP,EAAMA,EAAK,IAAMq4C,EAAWtyB,GAAM/lB,EAAK,MAM7D,SAASs4C,GAAW9nD,EAAMwP,EAAM5G,EAAGD,GAClC3I,EAAKyoB,UAAUjZ,EAAK,GAAIA,EAAK,IAC7BxP,EAAK4oB,aAAa,CACjBva,KAAK,CACJhC,IAAImD,EAAK,GACTlD,OAAOkD,EAAK,IAEb5G,EAAEA,EACFD,EAAEA,wCA/FG,SAASsgB,GAAc3c,OACvBmjB,EAAOvuB,KAAKa,GAAG,YAEjB9C,MAAMwH,YAAY6F,GAAS,KAC1BmnB,EAAMvyB,KAAKmB,eAAc,GAC7BiK,EAASmnB,EAAI70B,OAAO60B,EAAI,GAAGnnB,OAAO,MAG7B0V,EAAoC,SAA7ByN,EAAK3vB,OAAO+sB,QAAQ,GAAG9rB,GAAgB,EAAI,EACpD4Y,EAAQqI,KACR1V,GAAUA,GAAUpL,KAAKo8C,eAAe,KACtC,IAAI3+C,EAAI2N,EAAY,EAAJ3N,KACpBgb,EAAQ8V,EAAK8uB,eAAe5/C,GAAG,GADJA,KAKvBgb,IAAOA,EAAQqI,GAGrB9Y,EAAMC,IAAI,WACTy+C,GAAW1mD,KAAM,SAAUoL,GAC3BmjB,EAAK6uB,WACL7uB,EAAK/Q,OAAO,YAAa/E,GACzB8V,EAAK4D,sBAEAvwB,UAAU,WAAY,CAAE,gBAAiB,CAAE/D,MAAQmC,KAAKo8C,gBAAkB,EAAIxqB,SAAUxmB,UACxFgxC,eAAiBhxC,GAAU,GAC/BpL,kBAGI,SAASgoB,GAAW7c,OACpBojB,EAAOvuB,KAAKa,GAAG,YAEjB9C,MAAMwH,YAAY4F,GAAM,KACvBonB,EAAMvyB,KAAKmB,eAAc,GAC7BgK,EAAMonB,EAAI70B,OAAO60B,EAAI,GAAGpnB,IAAI,MAGzBsN,EAAQ,KACRtN,GAAOA,GAAOnL,KAAKq8C,gBACjB,IAAI5+C,EAAI0N,EAAS,EAAJ1N,KACjBgb,EAAQ8V,EAAKs4B,aAAappD,GAAG,GADLA,KAO1BuK,EAAMC,IAAI,WACTy+C,GAAW1mD,KAAM,MAAOmL,GACxBojB,EAAK6uB,WACL7uB,EAAK/Q,OAAO,WAAY/E,GACxB8V,EAAK4D,sBAEAvwB,UAAU,WAAY,CAAE,aAAc,CAAE/D,MAAOmC,KAAKq8C,YAAazqB,SAAUzmB,UAC3EkxC,YAAclxC,GAAO,GACzBnL,6CCvDI,SAAS6nB,GAAcxE,GAC7Bi8B,GAAwBt/C,KAAKqjB,wCCDvB,SAASyE,GAAYzE,GAC3Bza,GAAoB5I,KAAKqjB,uCCDnB,SAASi6B,GAAWlyC,EAAOiY,GACjCo6B,GAAez9C,KAAMoL,EAAQiY,EAAO,2BAE9B,SAASq5B,GAAgBtxC,UACxBqyC,GAAsBz9C,KAAMoL,YAE7B,SAAS07C,GAAQ37C,EAAIkY,GAC3Bo6B,GAAez9C,KAAMmL,EAAKkY,EAAO,qBAE3B,SAAS65B,GAAa/xC,UACrBsyC,GAAmBz9C,KAAMmL,8CCRjBq0B,GAASr0B,EAAKC,EAAQhD,QAChC8V,aAAa/S,EAAKC,EpDLjB,SAASmzB,EAAMn2B,2BACHA,QoDIam2B,CAAMn2B,SAChCR,wBAGC,SAASw8B,GAAaj5B,EAAKC,EAAQxM,OACrCf,EpDNE,SAASkpD,EAAMnoD,OACjBwrB,uBAAuBxrB,EAAOuL,mBAAUvL,EAAOmD,gBAC/B,QAAhBnD,EAAOmD,KACVqoB,eAAexrB,EAAO8D,oBAAW9D,EAAOg5B,mBACjCh5B,EAAO8D,QACd0nB,eAAexrB,EAAO8D,YAChB0nB,EAAO,IoDAF28B,CAAMnoD,QACbsf,aAAa/S,EAAKC,EAAQvN,QAC1B+J,wBAGC,SAASo/C,GAAavoD,UACrB2iC,GAAYphC,KAAMvB,gBAGnB,SAASwoD,UACVrlD,UAAU,gBAAgB,wBAGzB,SAASslD,GAAmBzoD,EAAMwK,M1DXlC,SAASk+C,EAAU1oD,EAAMwK,GAC/BivB,GAAQz5B,GAAQwK,E0DYhBk+C,CADA1oD,EAAOA,EAAKymB,cACIjc,GACbjJ,KAAKa,GAAG,cAAc,KAClBumD,EAAMpnD,KAAKa,GAAG,cAAcjC,OAAO6B,QACnCif,EAAO3hB,MAAM8C,GAAGumD,GAAKpmD,UACvB0e,EAAKuH,OAAOxoB,IACfihB,EAAK4b,IAAI,CAACz7B,GAAGpB,EAAMZ,MAAMY,2CClBrB,SAASipB,GAAavd,kBACxBA,EAAM,KACLooB,EAAMvyB,KAAKmB,eAAc,GACd,EAAXoxB,EAAI70B,SACPyM,EAAQk9C,GAAa90B,IAGvBvqB,EAAMC,IAAI,WACLkC,GACHk9C,GAAYlgD,EAAMgD,EAAMgD,KAAMhD,EAAMzC,EAAGyC,EAAM1C,UAE1CG,qBAGC,SAAS2f,GAAUpc,EAAKC,GAC1BD,GAAOC,EACVi8C,GAAernD,KAAM,CAACmL,IAAKA,EAAKC,OAAQA,IAGxCpD,EAAMC,IAAI,gBACJ8I,iBAAiB,SAAS5D,GAC9Bk6C,GAAernD,KAAMmN,MAErBnN,WAIE4H,oBAIC,SAAS+G,GAASw2C,EAAMt2C,UACvB0yC,EAAavhD,KAAMmlD,EAAMt2C,aAG1B,SAASX,GAAS/C,EAAKC,UACtBm2C,EAAavhD,KAAM,CAACmL,IAAIA,EAAKC,OAAOA,cAGrC,SAASqE,GAAStE,EAAKC,EAAQ7H,UAC9Bg+C,EAAavhD,KAAM,CAACmL,IAAKA,EAAKC,OAAQA,GAAS7H,kBAGhD,SAASoM,GAAc23C,EAAU/jD,GACvCyE,EAAMC,IAAI,WACTs5C,EAAkBvhD,KAAMsnD,EAAU/jD,IACjCvD,kBAGI,SAASmmD,GAAWmB,EAAUvlD,IAC/BulD,IACJA,EAAWtnD,KAAK8P,OAAOvC,oBAInBxL,IAAMA,EAAO,CAACoM,QAAQ,EAAM4D,QAAQ,EAAMoU,SAAQ,EAAMoiB,YAAW,EAAM9Z,UAAS,IAEnF1sB,EAAKoM,QACRozC,GAAoBvhD,KAAKsnD,GAEtBvlD,EAAKwmC,YACR+Q,GAAwBt5C,KAAKsnD,GAE1BvlD,EAAKgQ,QACR/R,KAAKunD,cAAcD,EAAU,MAE1BvlD,EAAKokB,UACR6zB,GAAah6C,KAAMsnD,GACnB3f,GAAa3nC,KAAMsnD,IAGhBvlD,EAAK0sB,UACRgxB,GAAoBz/C,KAAMsnD,QAEtB1/C,0BAGC,SAAS+I,YACR4wC,GAAkBvhD,iBAInB,SAASsI,GAAU1J,OACrBgB,EAAM,eACLgC;AAAU,kBAAkB,CAAChC,EAAKhB,IAEnCA,GAAUA,EAAO2J,OvDyLf,SAASD,EAAUxJ,EAAMc,UAC/B09B,GAASx+B,EAAMA,EAAKu8B,cAAc92B,QAAU3E,EACrCd,EAAKo9B,QuD1LJ3zB,CAAiBvI,KAAMJ,GACxBA,aAID,SAAS6d,GAAUhf,GACzB8J,GAAYvI,KAAKvB,mBAEX,SAAS4K,YACRrJ,KAAKq7B,uBAEN,SAASmsB,GAASjjD,GACxBgE,GAAWvI,KAAMuE,eAEX,SAASkjD,UACV95C,qBAEC,SAAS+5C,GAAYjpD,EAAKyK,GAChCX,GAAcvI,KAAKvB,EAAKyK,cAElB,SAASy+C,GAAUlpD,GACzB8J,GAAYvI,KAAKvB,gBAEX,SAASmpD,GAAYnpD,GAC3B8J,GAAcvI,KAAKvB,SAKb,SAASkpB,KACfkgC,GAAS7nD,YAEH,SAAS4nB,KACfigC,GAAS7nD,iBAIH,SAASy+C,GAAUt0C,EAAO2T,GAChCgqC,GAAc9nD,KAAMmK,EAAO2T,oCCpIrB,SAASlW,GAAQS,GACnBA,EACHrI,KAAK8P,OAAOqiB,iBAEZnyB,KAAK8P,OAAOlI,4BAEP,SAASmJ,GAAiBg3C,WAC5BpxC,EAAQ3W,KAAKmB,eAAc,GACtB1D,EAAE,EAAGA,EAAEkZ,EAAMjZ,OAAQD,IAC7BsqD,EAAGnlD,KAAK5C,KAAM2W,EAAMlZ,sBAEf,SAAS8mC,GAAiBl6B,OAC5B+C,EAAOpN,KAAK8P,OAAOvC,uBACnBH,GACC/C,IACHA,EAAQrK,KAAKqJ,kBACP0B,EAAQqC,EAAK/Q,MAAM8O,IAAIiC,EAAK/Q,MAAM+O,OAAOgC,EAAKlJ,IAAIiH,IAAIiC,EAAKlJ,IAAIkH,OAAOf,IAEvE,kBAED,SAASlJ,GAAckH,OACzB+E,EAAOpN,KAAK8P,OAAOvC,oBACnBlF,EACH,OAAO+E,GAAQA,EAAK/Q,MAAM8O,IAAMiC,EAAK/Q,MAAQ,SAE1CsqC,EAAY,MACbv5B,UACEka,EAAKla,EAAK/Q,MACVwP,EAAKuB,EAAKlJ,IAENzG,EAAI6pB,EAAGnc,IAAK1N,GAAIoO,EAAGV,IAAK1N,QAC3B,IAAIgZ,EAAI6Q,EAAGlc,OAAQqL,GAAK5K,EAAGT,OAAQqL,IACtCkwB,EAAUnlC,KAAK,CAAC2J,IAAK1N,EAAE2N,OAAOqL,WAK1BkwB,gBAGD,SAAS1oB,GAAa9S,EAAKC,OAC7BhF,EAAOpG,KAAKoO,OAAOjD,GACnBtN,EAAQuI,EAAK,IAAIgF,IAAWhF,EAAKgF,eAEhB,IAAVvN,EAA8B,GAClCA,gBAED,SAASqgB,GAAa/S,EAAKC,EAAQvN,iBACtCmC,KAAKie,aAAa9S,EAAKC,KAAYvN,EAAM,KACvCuI,EAAOpG,KAAKoO,OAAOjD,GACnBiF,EAAMhK,EAAK,IAAIgF,IAAShF,EAAKgF,GAGjCpD,EAAMC,IAAI,WACLd,EAAKvF,UAAU,sBAAsB,CAACuJ,EAAKC,EAAQvN,EAAOuS,MAC7DhK,EAAKgF,GAAUvN,SACRuI,EAAK,IAAIgF,GAEhBjE,EAAKvF,UAAU,eAAgB,CAACuJ,EAAKC,EAAQvN,IAC7CsJ,EAAKoJ,SAASpF,EAAKC,sBAMhB,SAASm8C,GAAcp9C,EAAOtM,GACpCmK,EAAMC,IAAI,mBACL8E,EAAM7B,EAASf,EAAOnK,MACjBmL,EAAM4B,EAAI1Q,MAAM8O,IAAKA,GAAO4B,EAAI7I,IAAIiH,IAAKA,QAC5C,IAAIC,EAAS2B,EAAI1Q,MAAM+O,OAAQA,GAAW2B,EAAI7I,IAAIkH,OAAQA,SACzD8S,aAAa/S,EAAKC,EAAQvN,IAGhCmC,cAII,SAASoO,GAAOvO,UACfG,KAAK8P,OAAOiH,QAAQlX,cAErB,SAASi+C,GAAUj+C,UAClBG,KAAK8P,OAAOod,gBAAgBrtB,UAE7B,SAAS8N,GAAMN,OACjBzN,EAAM,CAAErC,KAAK,IACb8P,GAAQA,EAAK9E,SAChB3I,EAAM29B,GAAS39B,SAGXwyB,MAAMxyB,gBAGL,SAAS+9B,KACfqqB,GAAUhoD,wCChGJ,SAASuQ,GAASpF,EAAKC,OACzB7H,EAAQvD,KAAKkO,SAAS/C,EAAKC,GAE/BjG,EAAKnF,KAAM,OAAQ,CAClBmL,IAAKA,EACLC,OAAQA,EACRvN,MAAOmC,KAAKie,aAAa9S,EAAKC,GAC9B7H,MAAQA,EAAQA,EAAM1D,GAAK,qCCTtB,SAASuO,GAAOvO,UACfG,KAAK8P,OAAOiH,QAAQlX,kBAGrB,SAAS85B,GAAcxuB,EAAKC,EAAQ/E,OACpCiO,EAAOtU,KAAK8P,OAAOiqC,WAAW5uC,GAAOnL,KAAK8P,OAAOiqC,WAAW5uC,IAAQ,GACpEtN,EAAQyW,EAAKlJ,IAAWpL,KAAKoO,OAAOjD,GAAKC,IAC/CkJ,EAAKlJ,GAAU/E,IAEDA,EAAOA,YACfyJ,OAAOme,WAAW9iB,EAAIC,EAAQ,qBAE5BpL,KAAK8P,OAAOiqC,WAAW5uC,GAAKC,QAC9B0E,OAAOke,cAAc7iB,EAAIC,EAAQ,mBAElCxJ,UAAU,WAAY,CAAC,WAAY,CAAEuJ,IAAAA,EAAKC,OAAAA,EAAQvN,MAAAA,EAAO+zB,SAASvrB,oBAGjE,SAAS+mB,GAAcjiB,EAAKC,UACvBpL,KAAK8P,OAAOiqC,WAAW5uC,IAAQ,IAC9BC,IAAW,qDClBRi9B,GAAcl9B,EAAKC,EAAQjF,OACpCmO,EAAOtU,KAAK8P,OAAOy3B,WAAWp8B,GAAOnL,KAAK8P,OAAOy3B,WAAWp8B,IAAQ,GACpEtN,EAAQyW,EAAKlJ,IAAWpL,KAAKoO,OAAOjD,GAAKC,MAE3CjF,IAAWpI,MAAM4D,QAAQwE,IAA4B,iBAAVA,KAC9CA,EAAS,CAAEtH,QAAQsH,KACpBmO,EAAKlJ,GAAUjF,IAEgB,UAAjBb,EAAOa,YACf2J,OAAOme,WAAW9iB,EAAIC,EAAQ,aAC/BjF,EAAOtI,OAAS2rC,GAAkBrjC,EAAOtI,QAC5CmC,KAAK8P,OAAOme,WAAW9iB,EAAIC,EAAQ,oBAEpCrN,MAAMiU,OAAO7L,EAAQ,CAACgF,IAAAA,EAAKC,OAAAA,IAAS,GACpCjF,EAAOtH,QAAU2qC,GAAmBxpC,KAAMmL,EAAKC,EAAQjF,EAAOtH,UAEzDsH,EAAO8C,SAAW9C,EAAOtI,OAASsI,EAAOtI,MAAMqW,UAAU,KACvD7G,EAAOlH,EAAOkH,MAAQm8B,GAAkBxpC,KAAMmL,EAAKC,GACzDjF,EAAO8C,QAAUugC,GAAsBn8B,EAAMlH,EAAOtI,oBAG9CmC,KAAK8P,OAAOy3B,WAAWp8B,GAAKC,QAC9B0E,OAAOke,cAAc7iB,EAAIC,EAAQ,kBACjC0E,OAAOke,cAAc7iB,EAAIC,EAAQ,yBAElCxJ,UAAU,WAAY,CAAC,SAAU,CAAEuJ,IAAAA,EAAKC,OAAAA,EAAQvN,MAAAA,EAAO+zB,SAASzrB,oBAG/D,SAASknB,GAAcliB,EAAKC,UACvBpL,KAAK8P,OAAOy3B,WAAWp8B,IAAQ,IAC9BC,IAAW,oBAGjB,SAAS69B,oBACTvB,EAAU8B,GAAexpC,KAAK8P,QAE3BrS,EAAE,EAAGA,EAAEiqC,EAAQhqC,OAAQD,IAAI,OACbiqC,EAAQjqC,GAAvB0N,IAAAA,IAAKC,IAAAA,YACPi9B,cAAcl9B,EAAKC,EAAQ,WAG5B0E,OAAOy3B,WAAa,QACpBz3B,OAAOvS,KAAK4I,OAAO,SAACvG,UACjBuH,EAAK+1C,aAAat9C,EAAIC,yBAKxB,SAASgoC,UACV/3B,OAAOvS,KAAKiT,OAAO,sBACjBk3B,EAAU8B,GAAexpC,KAAK8P,aAG/BA,OAAOvS,KAAK4I,OAAO,SAACvG,UACjBqc,EAAKihC,aAAat9C,EAAIC,yBAGrBpC,SACuBiqC,EAAQjqC,GAAhC0N,IAAAA,IAAKC,IAAAA,OAAQnC,IAAAA,QAEhBZ,GAAM,EACV4T,EAAKnM,OAAOvS,KAAK4I,OAAO,SAASvG,YAC5ByI,GAAc,EAAPzI,EAAIC,IAAY,EAAJsL,KAClBvL,EAAIwL,IAA2B,KAAhBxL,EAAIwL,GACE,mBAAXnC,GAAyBA,EAAS25B,OAAOhjC,EAAIwL,KADb/C,GAAM,IAEnD,GAAG,IARE5K,EAAE,EAAGA,EAAEiqC,EAAQhqC,OAAQD,MAAvBA,IAUPuC,WAEE8P,OAAOlO,UAAU,gBAAiB,SAClCkO,OAAOlI,2CCxEN,SAAS4f,GAAQ5oB,UAChBb,MAAMypB,QAAQ,CACpBpnB,IAAI,uBACJwD,KAAKhF,EAAOgF;AACZqkD,GAAIlqD,MAAMC,KAAKC,YAAYC,OAAO+pD,GAClCljD,OAAQhH,MAAMC,KAAKC,YAAYC,OAAO6G,gBAIjC,SAASm/B,GAAMtlC,UACdb,MAAMmmC,MAAM,CAClB9jC,IAAK,qBACLwD,KAAKhF,EAAOgF,KACZqkD,GAAIlqD,MAAMC,KAAKC,YAAYC,OAAO+pD,iDCVpBC,KACfvgC,GAAW3nB,iBAGL,SAASmoD,GAAUptB,GACzB/yB,EAAMC,IAAI8yB,EAAM/6B,kBAGV,SAASs5B,GAAWyB,GAC1BpT,GAAgBoT,EAAM/6B,kDCVPy5B,GAAUtuB,EAAKC,EAAQoE,GACtC2E,GAAcnU,KAAMmL,EAAKC,EAAQoE,mBAG3B,SAAS44C,GAAej9C,EAAKC,EAAQM,GAE3CyI,GAAuBnU,KAAM0L,EAAKP,EAAKC,MCRxC,IAAMi9C,GAAc,CACnB,CAAExoD,GAAG,OAAQ4jB,QAAQ,CACpB,CAAC5jB,GAAI,QAAS4jB,QAAS,CACtB,CAAC5jB,GAAI,aACL,CAACA,GAAI,cACL,CAACA,GAAI,kBAEN,CAACA,GAAI,gBACL,CAACA,GAAI,kBAEN,CAAEA,GAAG,OAAQ4jB,QAAQ,CACpB,CAAC5jB,GAAI,aACL,CAACA,GAAI,gBACL,CAACA,GAAI,YACL,CAACA,GAAI,aACL,CAACA,GAAI,sBACL,CAACA,GAAI,QAAS4jB,QAAQ,CACrB,CAAC5jB,GAAI,eACL,CAACA,GAAI,eACL,CAACA,GAAI,6BACL,CAACA,GAAI,0BACL,CAACA,GAAI,kBACL,CAAE4oB,UAAU,aACZ,CAAC5oB,GAAI,iBAGP,CAAEA,GAAG,SAAU4jB,QAAQ,CACtB,CAAC5jB,GAAI,QAAS4jB,QAAQ,CACrB,CAAE5jB,GAAI,kBACN,CAAEA,GAAI,mBAEP,CAACA,GAAI,QAAS4jB,QAAQ,CACrB,CAAE5jB,GAAI,iBACN,CAAEA,GAAI,eAEP,CAACA,GAAI,iBAEN,CAAEA,GAAG,OAAQ4jB,QAAQ,CACpB,CAAC5jB,GAAI,OAAQ4jB,QAAS,CACrB,CAAC5jB,GAAI,YACL,CAACA,GAAI,eAEN,CAACA,GAAI,mBAEN,CAAEA,GAAI,OAAQ4jB,QAAQ,CACrB,CAAC5jB,GAAI,UAAW4jB,QAAS,CACxB,CAAC5jB,GAAI,iBACL,CAACA,GAAI,iBACL,CAACA,GAAI,eACL,CAACA,GAAI,eACL,CAACA,GAAI,mBAEN,CAACA,GAAI,OAAQ4jB,QAAS,CACrB,CAAC5jB,GAAI,cACL,CAACA,GAAI,cACL,CAACA,GAAI,YACL,CAACA,GAAI,YACL,CAACA,GAAI,gBAEN,CAAE4oB,UAAU,aACZ,CAAC5oB,GAAI,kBACL,CAACA,GAAI,eACL,CAACA,GAAI,kBACL,CAACA,GAAI,mBAIDT,GAAK,CACVkpD,YAAa,SAAS5rB,EAAM99B,OACvBnB,MACAA,EAAE,EAAGA,EAAIi/B,EAAKh/B,OAAQD,IACJ,iBAAXi/B,EAAKj/B,KACdi/B,EAAKj/B,GAAK,CAACoC,GAAI68B,EAAKj/B,KACH,iBAAdi/B,EAAKj/B,GAAGoC,IAAuC,cAAd68B,EAAKj/B,GAAGoC,IAAwBjB,EAAOwpB,YAKxEsU,EAAKj/B,GAAGI,QACX6+B,EAAKj/B,GAAGI,MAAQE,MAAMC,KAAKC,YAAYG,MAAMs+B,EAAKj/B,GAAGoC,KACnD68B,EAAKj/B,GAAGgmB,UACViZ,EAAKj/B,GAAGgmB,QAAUzjB,KAAKsoD,YAAY5rB,EAAKj/B,GAAGgmB,QAAS7kB,MAPpD89B,EAAK3R,OAAOttB,EAAE,GACdA,YASKi/B,IAIF,SAAS5zB,GAAKhK,GACpBA,EAAKmD,YAAY,kBAAmB,kBAoBrC,SAASsoB,EAAMzrB,GACXA,EAAK+B,GAAG,SACV/B,EAAK+B,GAAG,QAAQoB,YAAY,kBAAkB,SAACpC,UAqDjD,SAAS+8B,EAAW99B,EAAKe,GACrBf,EAAK8C,UAAU,kBAAkB,CAAC/B,MACjCu7B,GAAUv7B,GACZu7B,GAAUv7B,GAAIf,GAEdA,EAAK8C,UAAU,YAAY,CAAC,CAAC/B,GAAIA,MA1DoB+8B,CAAW99B,EAAKe,KAtB7B0qB,CAAMzrB,SAE5CF,EAASE,EAAKF,OACjB89B,EAAO,CACN59B,KAAM,OACNuD,YAAY,EACZjC,IAAK,oBACLP,GAAI,OACJmF,WAAW,EACXjD,KAAK,CACJD,OAAQ,IAETvE,KAAM6B,GAAGkpD,YAAYvqD,MAAM4D,QAAQ/C,EAAO89B,MAAM99B,EAAO89B,KAAO3+B,MAAMkG,KAAKokD,IAAcvpD,EAAKF,gBAG9FE,EAAK8C,UAAU,aAAc,CAAC,OAAQ86B,IAC/BA,EASR,IAAMtB,GAAY,MACT,SAAUt8B,GACjBA,EAAK6oB,aAEE,SAAU7oB,GACjBA,EAAK8oB,wBAEW,SAAU9oB,GAC1BA,EAAK0nD,gCAEW,SAAU1nD,GAC1BA,EAAK2nD,8BAES,SAAU3nD,GACxBA,EAAKw+C,WAAW,MAAK,kBAEP,SAAUx+C,GACxBA,EAAKw+C,WAAW,MAAK,oBAEL,SAAUx+C,GAE1BA,EAAK8C,UAAU,YAAY,CAAC,CAAC/B,GAAI,SAAUmI,MAAO,SAAUnK,MAAOE,MAAMC,KAAKC,YAAYG,MAAM,kCAEnF,SAAUU,GACvBA,EAAKwnD,0BAEQ,SAAUxnD,GACvBA,EAAKynD,wBAEM,SAAUznD,GACrBA,EAAKgoD,QAAQ,MAAK,eAEP,SAAUhoD,GACrBA,EAAKgoD,QAAQ,MAAK,iBAEL,SAAUhoD,GAEvBA,EAAK8C,UAAU,YAAY,CAAC,CAAC/B,GAAI,SAAUmI,MAAO,MAAOnK,MAAOE,MAAMC,KAAKC,YAAYG,MAAM,mCAE5E,SAASU,GAC1BA,EAAKipB,kCAEY,SAASjpB,GAC1BA,EAAK+oB,cAAc,0BAEJ,SAAS/oB,GACxBA,EAAKgpB,YAAY,YChKnB,SAASkC,GAAQpmB,UACH7F,MAAMC,KAAKC,YAAYC,OACtB0F,IAASA,EC2BxB,IAAI2kD,GAAY,CACf9pD,KAAK,cACL+pD,YAAY,CAAE7nC,MAAM,GACpBrhB,SAAS,CACRuxB,OAAO,EACPvyB,YAAY,EACZ0zB,SAAS,GACT9C,MAAK,EACL6C,YAAY,GACZ3J,YAAY,EACZuT,cAAe,GACfwQ,eDpCK,SAASsc,WACR,CACN,CAAChqD,KAAMurB,GAAQ,UAAW5pB,IAAK,kCAC/B,CAAC3B,KAAMurB,GAAQ,WAAY5pB,IAAK,kCAChC,CAAC3B,KAAMurB,GAAQ,OAAQ5pB,IAAK,8BAC5B,CAAC3B,KAAMurB,GAAQ,QAAS5pB,IAAK,gCC+BbqoD,IAEjB9pD,MAAM,2BACAqP,OAAUhO,KAAKwoD,YAAY7nC,aAC3Bre,MAAMC,WAAa,qBAEnBhB,OAAO4hC,QAAQnjC,KAAK0oD,gBACpBnnD,OAAO4hC,QAAQ1xB,SACflQ,OAAOC,KAAKxB,KAAK2oD,oBAEjBhsB,iBAAmB,QACnB16B,YAAY,aAAc,WAC9BkF,EAAKw1B,iBAAiB5b,QAAQ,SAAAjiB,UAAQA,EAAKyjB,kBAG7CqmC,MAAM,YjGnCA,SAASC,QACTxoD,EAAOtC,MAAMsC,KAAKC,MAClBwoD,EAAmB,YAARzoD,GAA8B,QAARA;CACvC2L,EAAazM,MAAQxB,MAAMsC,KAAKsE,QAAQwc,YAAY,EACpDnV,EAAaod,YAAkC,QAApBrrB,MAAMsC,KAAKC,MAAkB,GAAK,GAE7D8L,EAAc,eAAiB08C,EAAW,uBAAyB,oBAExD,YAARzoD,IACF+L,EAAc28C,WAAa,UAC3B38C,EAAc1J,MAAQ,WiG0BtBmmD,IAEDH,UAAU,eACH9oD,EAAMI,KAAKpB,OACXuB,EAAO,IAGTP,EAAI8jB,UAAY9jB,EAAI88B,MACvBv8B,EAAKqB,KAAKk7B,GAAU18B,OACjBJ,EAAI8jB,WAA4B,IAAhB9jB,EAAIurB,SACvBhrB,EAAKqB,KAAKsqB,GAAS9rB,OAChBJ,EAAIopD,QACP7oD,EAAKqB,KAAK5B,EAAIopD,SACXppD,EAAI8jB,UAAY9jB,EAAItB,YACvB6B,EAAKqB,KAAK6E,GAAYrG,WAGjBipD,EAAS,CACdh4B,UAAYrxB,EAAI8jB,SAChB2N,UAAYzxB,EAAIyxB,UAChB/yB,WAAYsB,EAAItB,WAChBgzB,0BAA4B1xB,EAAI0xB,2BAE9B1xB,EAAI6tC,YACNwb,EAAOxb,UAAY7tC,EAAI6tC,WACrB7tC,EAAIqtB,cACNg8B,EAAOh8B,YAAcrtB,EAAIqtB,aAEvBrtB,EAAI8jB,SACNvjB,EAAKqB,KAAKwmD,GAAShoD,KAAMipD,IAEzB9oD,EAAKqB,KAAK,CAAC/B,KAAK,CAACuoD,GAAShoD,KAAMipD,GAASlC,GAAW/mD,aAE/C4M,GAA2B,IAAlBhN,EAAI0rB,UAAqB/iB,GAAqBvI,MAAQJ,EAAI0rB,UACrE1e,GACHzM,EAAKqB,KAAKoL,GAEXrE,GAAYvI,MAERJ,EAAI8jB,UC5FH,SAAS5a,EAAKhK,GACpBA,EAAKmD,YAAY,kBAAmB,kBAAMnD,EAAK+B,GAAG,WAAWqoD,SAASpqD,EAAKgR,OAAOxN,aAE9E6W,EAASpb,MAAMC,KAAKC,YAAYG,MAC9B+qD,EAAQ,CACb5rD,KAAK,CACJ,CAAEsC,GAAG,QAAUhC,MAAOsb,EAAM,MAAWsK,QAAS8E,MAChD,CAAE1oB,GAAG,YAAchC,MAAOsb,EAAO,cACjC,CAAEsP,UAAW,aACb,CAAE5oB,GAAG,OAAQhC,MAAOsb,EAAOhD,KAAMsN,QAAQ,CACxC,CAAC5jB,GAAI,WAAYhC,MAAOsb,EAAO,aAC/B,CAACtZ,GAAI,YAAahC,MAAOsb,EAAO,gBAEjC,CAACtZ,GAAG,gBAAkBhC,MAAOsb,EAAO,kBACpC,CAAEsP,UAAW,aACb,CAAE5oB,GAAG,YAAchC,MAAOsb,EAAO,cACjC,CAAEtZ,GAAG,WAAahC,MAAOsb,EAAO,aAChC,CAAEtZ,GAAG,cAAgBhC,MAAOsb,EAAO,iBAEpC/N,OAAQ8c,GAAmBppB,GAC3BqM,IAAKkd,GAAgBvpB,IAIlBk9B,EAAU,CACbl9B,KAAM,cACNe,GAAI,UACJ6E,QAAQ,EACRif,cAAc,CACbjf,QAAQ,EACR5E,GAAG,CACFikB,aAAa,gBACPqlC,mBAIR7rD,KAAK,GACLuC,GAAG,CACF+jB,yBAAgBhkB,GACff,EAAK8C,UAAU,YAAa,CAAC5B,KAAKqpD,YAAYxpD,MAE/CkkB,sBAAahX,OAERM,EAAMyV,KADV/kB,MAAM6D,UAAU,UAAW,MAG3BkhB,EAAMhkB,EAAKgR,OAAO8e,OAAO7hB,IACf,OAAO,KAEjBM,EAAO,GACHyV,EAAIuB,QAAyB,UAAfvB,EAAI1X,QAChBshB,GAAc5J,EAAI1X,OAAQtM,IAC9B0tB,GAAa1J,EAAI1X,OAAQtM,GAC1BuO,EAAO,UACGyV,EAAI3X,MAIbkC,EAHkB,UAAfyV,EAAI1X,QACFyhB,GAAc/J,EAAI3X,IAAKrM,IAC3BotB,GAAUpJ,EAAI3X,IAAKrM,GACb,QAEF8tB,GAAe9J,EAAI3X,IAAK2X,EAAI1X,OAAQtM,IACxCA,EAAKgR,OAAOid,cAAcjK,EAAKA,GACzB,SAILzV,EAAK,KACJ9P,EAoBF,SAAS+qD,EAAYxpD,EAAML,EAAMlB,OACnCkyB,EAAK,CAAEriB,KAAK3O,EAAMlB,KAAKA,UACvBuB,EAAK8C,UAAU,sBAAuB,CAAC6tB,IAC7BA,EAAGlyB,KACV,KAxBQ+qD,CAAYxpD,EAAMuO,EAAM87C,EAAM97C,OACrC9P,cACEu0B,gBACAM,MAAM70B,QACN6rD,gBACLrrD,MAAMsJ,KAAKwU,aAAa9O,IACjB,SAGF,KAKVjO,EAAK8C,UAAU,aAAc,CAAC,UAAWo6B,QACnCstB,EAAcxqD,EAAKM,GAAG48B,GAE5Bl9B,EAAK69B,iBAAiBn7B,KAAK8nD,GDUzBttB,CAAah8B,M1ChFT,SAAS8I,EAAKhK,WACdyqD,EAAU,GACVC,EAAY1qD,EAAKF,OAAO8kB,SAAW,CAAC4qB,IAAOV,GAExCnwC,EAAI,EAAGA,EAAI+rD,EAAU9rD,OAAQD,IACrC8rD,EAAQC,EAAU/rD,GAAGutB,QAAU,IAAIw+B,EAAU/rD,GAAGwgC,UAAUn/B,GAE3DA,EAAKmD,YAAY,YAAa,SAAS+oB,OAChCkT,EAAMqrB,EAAQv+B,EAAOnrB,IACvBq+B,GAAKA,EAAIwB,KAAK1U,KAGnBlsB,EAAKmD,YAAY,WAAY,SAASpC,EAAIkS,MAEhC,YAANlS,IAAqBkS,EAAO6f,SAAS,KACjCsM,EAAMqrB,EAAQ,iBACjBrrB,GAAOA,EAAIuB,QAAU1tB,EAAO5G,KAC9B+yB,EAAI75B,W0CiENklD,CAAavpD,WAERypD,YAAYtpD,IAElBwoD,cAAc,sBAET3oD,KAAK8P,cACJA,OAAS9P,KAAKa,GAAG,SE1EjB,SAAS6oD,EAAW5qD,WAItBuJ,EAAM,CAACw3C,GAAGC,GAAGG,GAAGC,GAAGC,GAAGwJ,GAAGC,GAAIC,GAAIC,GAAIC,GAAIC,GAAIC,GAAIlK,GAAGmK,GAAGC,GAAIC,GAAKC,GAAIC,GAAItK,GAAGuK,GAAIC,GAAIC,GAAIC,GAAIC,GAAIC,GAAIC,GAAIC,EAAIC,GAAIC,GAAIC,IAC9GxtD,EAAI,EAAGA,EAAI4K,EAAI3K,OAAQD,IAC3B4K,EAAI5K,GAAGqL,MACVT,EAAI5K,GAAGqL,KAAKhK,GFsEb4qD,CAAW1pD,MAGXgoD,GAAUhoD,KAAMA,KAAKpB,OAAOmzB,YAAa/xB,KAAKpB,OAAOozB,UACrDjjB,GAAS/O,WAEJ8P,OAAO7N,YAAY,iBAAkB,kBACzCga,EAAKra,UAAU,gBAAiB,CAAEqa,EAAK9a,eAAc,YAEjDS,UAAU,kBAAmB,MAEnCspD,QAAQ,SAAStrD,EAAKmmD,QAEhB4C,gBAED/oD,EAAI0hD,MACP1hD,EAAMI,KAAK8lD,YAAYlmD,EAAKmmD,GACpBnmD,EAAIrC,MAAsB,iBAAPqC,IAAoBmmD,EAAO54C,OAAQ44C,EAAO56C,MACrEvL,EAAMI,KAAKimD,UAAUrmD,EAAKmmD,IjEkKtB,SAASzsC,EAAKxa,EAAMc,KAC1BA,EAAM7B,MAAM4D,QAAQ/B,GAAK,CAAC2I,OAAO3I,GAAKA,GAE9B0hD,OAAU1hD,EAAI2I,SAAWzJ,EAAKu8B,aAOrCE,GAAQz8B,EAAMc,GAHdgI,GAAQ9I,EADRw+B,GAASx+B,EADEA,EAAKu8B,cACK92B,QAAU3E,GiEtK/B2I,CAAYvI,KAAMJ,MGhHb,SAASurD,GAAIrsD,WACfuJ,EAAM,CAAC+iD,GAAKC,GAAKC,GAAKC,GAAKC,GAAKC,GAAKC,GAAKC,GAAKC,GAAKC,GAAK5d,GAAKzE,GAAKsiB,GAAKjE,GAAK1zC,IACxE1W,EAAI,EAAGA,EAAI4K,EAAI3K,OAAQD,IAC/BM,MAAMiU,OAAOlT,EAAMuJ,EAAI5K,IHgHzB0tD,CAAI5C,IACJxqD,MAAMS,QAAQ+pD,GAAWxqD,MAAMguD,eAAgBhuD,MAAM6H,QAAS7H,MAAMqB,GAAGkgB"}